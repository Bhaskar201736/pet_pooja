var CEe=Object.defineProperty;var REe=(jn,Vn,To)=>Vn in jn?CEe(jn,Vn,{enumerable:!0,configurable:!0,writable:!0,value:To}):jn[Vn]=To;var $t=(jn,Vn,To)=>(REe(jn,typeof Vn!="symbol"?Vn+"":Vn,To),To);(function(){"use strict";var jn=(t=>(t.Available="available",t.Busy="busy",t.NotAvailable="not_available",t))(jn||{});let Vn;const To=new Uint8Array(16);function E4(){if(!Vn&&(Vn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Vn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Vn(To)}const Gr=[];for(let t=0;t<256;++t)Gr.push((t+256).toString(16).slice(1));function M4(t,r=0){return(Gr[t[r+0]]+Gr[t[r+1]]+Gr[t[r+2]]+Gr[t[r+3]]+"-"+Gr[t[r+4]]+Gr[t[r+5]]+"-"+Gr[t[r+6]]+Gr[t[r+7]]+"-"+Gr[t[r+8]]+Gr[t[r+9]]+"-"+Gr[t[r+10]]+Gr[t[r+11]]+Gr[t[r+12]]+Gr[t[r+13]]+Gr[t[r+14]]+Gr[t[r+15]]).toLowerCase()}const e1={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function t1(t,r,e){if(e1.randomUUID&&!r&&!t)return e1.randomUUID();t=t||{};const n=t.random||(t.rng||E4)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){e=e||0;for(let i=0;i<16;++i)r[e+i]=n[i];return r}return M4(n)}class Ar{}$t(Ar,"orgId"),$t(Ar,"visitorId"),$t(Ar,"cookieId"),$t(Ar,"tabId");function r1(t,r){return function(){return t.apply(r,arguments)}}const{toString:n1}=Object.prototype,{getPrototypeOf:Iv}=Object,Ov=(t=>r=>{const e=n1.call(r);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),Ji=t=>(t=t.toLowerCase(),r=>Ov(r)===t),tf=t=>r=>typeof r===t,{isArray:hs}=Array,$u=tf("undefined");function C4(t){return t!==null&&!$u(t)&&t.constructor!==null&&!$u(t.constructor)&&So(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const i1=Ji("ArrayBuffer");function R4(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&i1(t.buffer),r}const I4=tf("string"),So=tf("function"),a1=tf("number"),Nv=t=>t!==null&&typeof t=="object",O4=t=>t===!0||t===!1,rf=t=>{if(Ov(t)!=="object")return!1;const r=Iv(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},N4=Ji("Date"),A4=Ji("File"),P4=Ji("Blob"),x4=Ji("FileList"),D4=t=>Nv(t)&&So(t.pipe),L4=t=>{const r="[object FormData]";return t&&(typeof FormData=="function"&&t instanceof FormData||n1.call(t)===r||So(t.toString)&&t.toString()===r)},U4=Ji("URLSearchParams"),j4=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function zu(t,r,{allOwnKeys:e=!1}={}){if(t===null||typeof t>"u")return;let n,i;if(typeof t!="object"&&(t=[t]),hs(t))for(n=0,i=t.length;n<i;n++)r.call(null,t[n],n,t);else{const a=e?Object.getOwnPropertyNames(t):Object.keys(t),o=a.length;let s;for(n=0;n<o;n++)s=a[n],r.call(null,t[s],s,t)}}function o1(t,r){r=r.toLowerCase();const e=Object.keys(t);let n=e.length,i;for(;n-- >0;)if(i=e[n],r===i.toLowerCase())return i;return null}const s1=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),u1=t=>!$u(t)&&t!==s1;function Av(){const{caseless:t}=u1(this)&&this||{},r={},e=(n,i)=>{const a=t&&o1(r,i)||i;rf(r[a])&&rf(n)?r[a]=Av(r[a],n):rf(n)?r[a]=Av({},n):hs(n)?r[a]=n.slice():r[a]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&zu(arguments[n],e);return r}const V4=(t,r,e,{allOwnKeys:n}={})=>(zu(r,(i,a)=>{e&&So(i)?t[a]=r1(i,e):t[a]=i},{allOwnKeys:n}),t),F4=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),$4=(t,r,e,n)=>{t.prototype=Object.create(r.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),e&&Object.assign(t.prototype,e)},z4=(t,r,e,n)=>{let i,a,o;const s={};if(r=r||{},t==null)return r;do{for(i=Object.getOwnPropertyNames(t),a=i.length;a-- >0;)o=i[a],(!n||n(o,t,r))&&!s[o]&&(r[o]=t[o],s[o]=!0);t=e!==!1&&Iv(t)}while(t&&(!e||e(t,r))&&t!==Object.prototype);return r},W4=(t,r,e)=>{t=String(t),(e===void 0||e>t.length)&&(e=t.length),e-=r.length;const n=t.indexOf(r,e);return n!==-1&&n===e},B4=t=>{if(!t)return null;if(hs(t))return t;let r=t.length;if(!a1(r))return null;const e=new Array(r);for(;r-- >0;)e[r]=t[r];return e},Z4=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&Iv(Uint8Array)),q4=(t,r)=>{const n=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=n.next())&&!i.done;){const a=i.value;r.call(t,a[0],a[1])}},Q4=(t,r)=>{let e;const n=[];for(;(e=t.exec(r))!==null;)n.push(e);return n},Y4=Ji("HTMLFormElement"),G4=t=>t.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(e,n,i){return n.toUpperCase()+i}),l1=(({hasOwnProperty:t})=>(r,e)=>t.call(r,e))(Object.prototype),H4=Ji("RegExp"),c1=(t,r)=>{const e=Object.getOwnPropertyDescriptors(t),n={};zu(e,(i,a)=>{r(i,a,t)!==!1&&(n[a]=i)}),Object.defineProperties(t,n)},Ne={isArray:hs,isArrayBuffer:i1,isBuffer:C4,isFormData:L4,isArrayBufferView:R4,isString:I4,isNumber:a1,isBoolean:O4,isObject:Nv,isPlainObject:rf,isUndefined:$u,isDate:N4,isFile:A4,isBlob:P4,isRegExp:H4,isFunction:So,isStream:D4,isURLSearchParams:U4,isTypedArray:Z4,isFileList:x4,forEach:zu,merge:Av,extend:V4,trim:j4,stripBOM:F4,inherits:$4,toFlatObject:z4,kindOf:Ov,kindOfTest:Ji,endsWith:W4,toArray:B4,forEachEntry:q4,matchAll:Q4,isHTMLForm:Y4,hasOwnProperty:l1,hasOwnProp:l1,reduceDescriptors:c1,freezeMethods:t=>{c1(t,(r,e)=>{if(So(t)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=t[e];if(So(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},toObjectSet:(t,r)=>{const e={},n=i=>{i.forEach(a=>{e[a]=!0})};return hs(t)?n(t):n(String(t).split(r)),e},toCamelCase:G4,noop:()=>{},toFiniteNumber:(t,r)=>(t=+t,Number.isFinite(t)?t:r),findKey:o1,global:s1,isContextDefined:u1,toJSONObject:t=>{const r=new Array(10),e=(n,i)=>{if(Nv(n)){if(r.indexOf(n)>=0)return;if(!("toJSON"in n)){r[i]=n;const a=hs(n)?[]:{};return zu(n,(o,s)=>{const u=e(o,i+1);!$u(u)&&(a[s]=u)}),r[i]=void 0,a}}return n};return e(t,0)}};function Ht(t,r,e,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),e&&(this.config=e),n&&(this.request=n),i&&(this.response=i)}Ne.inherits(Ht,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ne.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const f1=Ht.prototype,d1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{d1[t]={value:t}}),Object.defineProperties(Ht,d1),Object.defineProperty(f1,"isAxiosError",{value:!0}),Ht.from=(t,r,e,n,i,a)=>{const o=Object.create(f1);return Ne.toFlatObject(t,o,function(u){return u!==Error.prototype},s=>s!=="isAxiosError"),Ht.call(o,t.message,r,e,n,i),o.cause=t,o.name=t.name,a&&Object.assign(o,a),o};var V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function J4(t){if(t.__esModule)return t;var r=t.default;if(typeof r=="function"){var e=function n(){if(this instanceof n){var i=[null];i.push.apply(i,arguments);var a=Function.bind.apply(r,i);return new a}return r.apply(this,arguments)};e.prototype=r.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),e}var X4=typeof self=="object"?self.FormData:window.FormData;const K4=X4;function Pv(t){return Ne.isPlainObject(t)||Ne.isArray(t)}function p1(t){return Ne.endsWith(t,"[]")?t.slice(0,-2):t}function v1(t,r,e){return t?t.concat(r).map(function(i,a){return i=p1(i),!e&&a?"["+i+"]":i}).join(e?".":""):r}function eD(t){return Ne.isArray(t)&&!t.some(Pv)}const tD=Ne.toFlatObject(Ne,{},null,function(r){return/^is[A-Z]/.test(r)});function rD(t){return t&&Ne.isFunction(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator]}function nf(t,r,e){if(!Ne.isObject(t))throw new TypeError("target must be an object");r=r||new(K4||FormData),e=Ne.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,k){return!Ne.isUndefined(k[y])});const n=e.metaTokens,i=e.visitor||c,a=e.dots,o=e.indexes,u=(e.Blob||typeof Blob<"u"&&Blob)&&rD(r);if(!Ne.isFunction(i))throw new TypeError("visitor must be a function");function l(p){if(p===null)return"";if(Ne.isDate(p))return p.toISOString();if(!u&&Ne.isBlob(p))throw new Ht("Blob is not supported. Use a Buffer instead.");return Ne.isArrayBuffer(p)||Ne.isTypedArray(p)?u&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function c(p,y,k){let I=p;if(p&&!k&&typeof p=="object"){if(Ne.endsWith(y,"{}"))y=n?y:y.slice(0,-2),p=JSON.stringify(p);else if(Ne.isArray(p)&&eD(p)||Ne.isFileList(p)||Ne.endsWith(y,"[]")&&(I=Ne.toArray(p)))return y=p1(y),I.forEach(function(L,R){!(Ne.isUndefined(L)||L===null)&&r.append(o===!0?v1([y],R,a):o===null?y:y+"[]",l(L))}),!1}return Pv(p)?!0:(r.append(v1(k,y,a),l(p)),!1)}const f=[],d=Object.assign(tD,{defaultVisitor:c,convertValue:l,isVisitable:Pv});function v(p,y){if(!Ne.isUndefined(p)){if(f.indexOf(p)!==-1)throw Error("Circular reference detected in "+y.join("."));f.push(p),Ne.forEach(p,function(I,C){(!(Ne.isUndefined(I)||I===null)&&i.call(r,I,Ne.isString(C)?C.trim():C,y,d))===!0&&v(I,y?y.concat(C):[C])}),f.pop()}}if(!Ne.isObject(t))throw new TypeError("data must be an object");return v(t),r}function h1(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function xv(t,r){this._pairs=[],t&&nf(t,this,r)}const m1=xv.prototype;m1.append=function(r,e){this._pairs.push([r,e])},m1.toString=function(r){const e=r?function(n){return r.call(this,n,h1)}:h1;return this._pairs.map(function(i){return e(i[0])+"="+e(i[1])},"").join("&")};function nD(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function g1(t,r,e){if(!r)return t;const n=e&&e.encode||nD,i=e&&e.serialize;let a;if(i?a=i(r,e):a=Ne.isURLSearchParams(r)?r.toString():new xv(r,e).toString(n),a){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class iD{constructor(){this.handlers=[]}use(r,e,n){return this.handlers.push({fulfilled:r,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){Ne.forEach(this.handlers,function(n){n!==null&&r(n)})}}const y1=iD,b1={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},aD=typeof URLSearchParams<"u"?URLSearchParams:xv,oD=FormData,sD=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),uD=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Ei={isBrowser:!0,classes:{URLSearchParams:aD,FormData:oD,Blob},isStandardBrowserEnv:sD,isStandardBrowserWebWorkerEnv:uD,protocols:["http","https","file","blob","url","data"]};function lD(t,r){return nf(t,new Ei.classes.URLSearchParams,Object.assign({visitor:function(e,n,i,a){return Ei.isNode&&Ne.isBuffer(e)?(this.append(n,e.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},r))}function cD(t){return Ne.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function fD(t){const r={},e=Object.keys(t);let n;const i=e.length;let a;for(n=0;n<i;n++)a=e[n],r[a]=t[a];return r}function _1(t){function r(e,n,i,a){let o=e[a++];const s=Number.isFinite(+o),u=a>=e.length;return o=!o&&Ne.isArray(i)?i.length:o,u?(Ne.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!s):((!i[o]||!Ne.isObject(i[o]))&&(i[o]=[]),r(e,n,i[o],a)&&Ne.isArray(i[o])&&(i[o]=fD(i[o])),!s)}if(Ne.isFormData(t)&&Ne.isFunction(t.entries)){const e={};return Ne.forEachEntry(t,(n,i)=>{r(cD(n),i,e,0)}),e}return null}const dD={"Content-Type":void 0};function pD(t,r,e){if(Ne.isString(t))try{return(r||JSON.parse)(t),Ne.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(t)}const af={transitional:b1,adapter:["xhr","http"],transformRequest:[function(r,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,a=Ne.isObject(r);if(a&&Ne.isHTMLForm(r)&&(r=new FormData(r)),Ne.isFormData(r))return i&&i?JSON.stringify(_1(r)):r;if(Ne.isArrayBuffer(r)||Ne.isBuffer(r)||Ne.isStream(r)||Ne.isFile(r)||Ne.isBlob(r))return r;if(Ne.isArrayBufferView(r))return r.buffer;if(Ne.isURLSearchParams(r))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let s;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return lD(r,this.formSerializer).toString();if((s=Ne.isFileList(r))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return nf(s?{"files[]":r}:r,u&&new u,this.formSerializer)}}return a||i?(e.setContentType("application/json",!1),pD(r)):r}],transformResponse:[function(r){const e=this.transitional||af.transitional,n=e&&e.forcedJSONParsing,i=this.responseType==="json";if(r&&Ne.isString(r)&&(n&&!this.responseType||i)){const o=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(r)}catch(s){if(o)throw s.name==="SyntaxError"?Ht.from(s,Ht.ERR_BAD_RESPONSE,this,null,this.response):s}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ei.classes.FormData,Blob:Ei.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Ne.forEach(["delete","get","head"],function(r){af.headers[r]={}}),Ne.forEach(["post","put","patch"],function(r){af.headers[r]=Ne.merge(dD)});const Dv=af,vD=Ne.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),hD=t=>{const r={};let e,n,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),e=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!e||r[e]&&vD[e])&&(e==="set-cookie"?r[e]?r[e].push(n):r[e]=[n]:r[e]=r[e]?r[e]+", "+n:n)}),r},w1=Symbol("internals");function Wu(t){return t&&String(t).trim().toLowerCase()}function of(t){return t===!1||t==null?t:Ne.isArray(t)?t.map(of):String(t)}function mD(t){const r=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(t);)r[n[1]]=n[2];return r}function gD(t){return/^[-_a-zA-Z]+$/.test(t.trim())}function k1(t,r,e,n){if(Ne.isFunction(n))return n.call(this,r,e);if(Ne.isString(r)){if(Ne.isString(n))return r.indexOf(n)!==-1;if(Ne.isRegExp(n))return n.test(r)}}function yD(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,e,n)=>e.toUpperCase()+n)}function bD(t,r){const e=Ne.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+e,{value:function(i,a,o){return this[n].call(this,r,i,a,o)},configurable:!0})})}class sf{constructor(r){r&&this.set(r)}set(r,e,n){const i=this;function a(s,u,l){const c=Wu(u);if(!c)throw new Error("header name must be a non-empty string");const f=Ne.findKey(i,c);(!f||i[f]===void 0||l===!0||l===void 0&&i[f]!==!1)&&(i[f||u]=of(s))}const o=(s,u)=>Ne.forEach(s,(l,c)=>a(l,c,u));return Ne.isPlainObject(r)||r instanceof this.constructor?o(r,e):Ne.isString(r)&&(r=r.trim())&&!gD(r)?o(hD(r),e):r!=null&&a(e,r,n),this}get(r,e){if(r=Wu(r),r){const n=Ne.findKey(this,r);if(n){const i=this[n];if(!e)return i;if(e===!0)return mD(i);if(Ne.isFunction(e))return e.call(this,i,n);if(Ne.isRegExp(e))return e.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,e){if(r=Wu(r),r){const n=Ne.findKey(this,r);return!!(n&&(!e||k1(this,this[n],n,e)))}return!1}delete(r,e){const n=this;let i=!1;function a(o){if(o=Wu(o),o){const s=Ne.findKey(n,o);s&&(!e||k1(n,n[s],s,e))&&(delete n[s],i=!0)}}return Ne.isArray(r)?r.forEach(a):a(r),i}clear(){return Object.keys(this).forEach(this.delete.bind(this))}normalize(r){const e=this,n={};return Ne.forEach(this,(i,a)=>{const o=Ne.findKey(n,a);if(o){e[o]=of(i),delete e[a];return}const s=r?yD(a):String(a).trim();s!==a&&delete e[a],e[s]=of(i),n[s]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const e=Object.create(null);return Ne.forEach(this,(n,i)=>{n!=null&&n!==!1&&(e[i]=r&&Ne.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,e])=>r+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...e){const n=new this(r);return e.forEach(i=>n.set(i)),n}static accessor(r){const n=(this[w1]=this[w1]={accessors:{}}).accessors,i=this.prototype;function a(o){const s=Wu(o);n[s]||(bD(i,o),n[s]=!0)}return Ne.isArray(r)?r.forEach(a):a(r),this}}sf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]),Ne.freezeMethods(sf.prototype),Ne.freezeMethods(sf);const Xi=sf;function Lv(t,r){const e=this||Dv,n=r||e,i=Xi.from(n.headers);let a=n.data;return Ne.forEach(t,function(s){a=s.call(e,a,i.normalize(),r?r.status:void 0)}),i.normalize(),a}function T1(t){return!!(t&&t.__CANCEL__)}function Bu(t,r,e){Ht.call(this,t??"canceled",Ht.ERR_CANCELED,r,e),this.name="CanceledError"}Ne.inherits(Bu,Ht,{__CANCEL__:!0});const _D=null;function wD(t,r,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?t(e):r(new Ht("Request failed with status code "+e.status,[Ht.ERR_BAD_REQUEST,Ht.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}const kD=Ei.isStandardBrowserEnv?function(){return{write:function(e,n,i,a,o,s){const u=[];u.push(e+"="+encodeURIComponent(n)),Ne.isNumber(i)&&u.push("expires="+new Date(i).toGMTString()),Ne.isString(a)&&u.push("path="+a),Ne.isString(o)&&u.push("domain="+o),s===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function TD(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function SD(t,r){return r?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t}function S1(t,r){return t&&!TD(r)?SD(t,r):r}const ED=Ei.isStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function i(a){let o=a;return r&&(e.setAttribute("href",o),o=e.href),e.setAttribute("href",o),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return n=i(window.location.href),function(o){const s=Ne.isString(o)?i(o):o;return s.protocol===n.protocol&&s.host===n.host}}():function(){return function(){return!0}}();function MD(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function CD(t,r){t=t||10;const e=new Array(t),n=new Array(t);let i=0,a=0,o;return r=r!==void 0?r:1e3,function(u){const l=Date.now(),c=n[a];o||(o=l),e[i]=u,n[i]=l;let f=a,d=0;for(;f!==i;)d+=e[f++],f=f%t;if(i=(i+1)%t,i===a&&(a=(a+1)%t),l-o<r)return;const v=c&&l-c;return v?Math.round(d*1e3/v):void 0}}function E1(t,r){let e=0;const n=CD(50,250);return i=>{const a=i.loaded,o=i.lengthComputable?i.total:void 0,s=a-e,u=n(s),l=a<=o;e=a;const c={loaded:a,total:o,progress:o?a/o:void 0,bytes:s,rate:u||void 0,estimated:u&&o&&l?(o-a)/u:void 0,event:i};c[r?"download":"upload"]=!0,t(c)}}const uf={http:_D,xhr:typeof XMLHttpRequest<"u"&&function(t){return new Promise(function(e,n){let i=t.data;const a=Xi.from(t.headers).normalize(),o=t.responseType;let s;function u(){t.cancelToken&&t.cancelToken.unsubscribe(s),t.signal&&t.signal.removeEventListener("abort",s)}Ne.isFormData(i)&&(Ei.isStandardBrowserEnv||Ei.isStandardBrowserWebWorkerEnv)&&a.setContentType(!1);let l=new XMLHttpRequest;if(t.auth){const v=t.auth.username||"",p=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";a.set("Authorization","Basic "+btoa(v+":"+p))}const c=S1(t.baseURL,t.url);l.open(t.method.toUpperCase(),g1(c,t.params,t.paramsSerializer),!0),l.timeout=t.timeout;function f(){if(!l)return;const v=Xi.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders()),y={data:!o||o==="text"||o==="json"?l.responseText:l.response,status:l.status,statusText:l.statusText,headers:v,config:t,request:l};wD(function(I){e(I),u()},function(I){n(I),u()},y),l=null}if("onloadend"in l?l.onloadend=f:l.onreadystatechange=function(){!l||l.readyState!==4||l.status===0&&!(l.responseURL&&l.responseURL.indexOf("file:")===0)||setTimeout(f)},l.onabort=function(){l&&(n(new Ht("Request aborted",Ht.ECONNABORTED,t,l)),l=null)},l.onerror=function(){n(new Ht("Network Error",Ht.ERR_NETWORK,t,l)),l=null},l.ontimeout=function(){let p=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const y=t.transitional||b1;t.timeoutErrorMessage&&(p=t.timeoutErrorMessage),n(new Ht(p,y.clarifyTimeoutError?Ht.ETIMEDOUT:Ht.ECONNABORTED,t,l)),l=null},Ei.isStandardBrowserEnv){const v=(t.withCredentials||ED(c))&&t.xsrfCookieName&&kD.read(t.xsrfCookieName);v&&a.set(t.xsrfHeaderName,v)}i===void 0&&a.setContentType(null),"setRequestHeader"in l&&Ne.forEach(a.toJSON(),function(p,y){l.setRequestHeader(y,p)}),Ne.isUndefined(t.withCredentials)||(l.withCredentials=!!t.withCredentials),o&&o!=="json"&&(l.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&l.addEventListener("progress",E1(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&l.upload&&l.upload.addEventListener("progress",E1(t.onUploadProgress)),(t.cancelToken||t.signal)&&(s=v=>{l&&(n(!v||v.type?new Bu(null,t,l):v),l.abort(),l=null)},t.cancelToken&&t.cancelToken.subscribe(s),t.signal&&(t.signal.aborted?s():t.signal.addEventListener("abort",s)));const d=MD(c);if(d&&Ei.protocols.indexOf(d)===-1){n(new Ht("Unsupported protocol "+d+":",Ht.ERR_BAD_REQUEST,t));return}l.send(i||null)})}};Ne.forEach(uf,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const RD={getAdapter:t=>{t=Ne.isArray(t)?t:[t];const{length:r}=t;let e,n;for(let i=0;i<r&&(e=t[i],!(n=Ne.isString(e)?uf[e.toLowerCase()]:e));i++);if(!n)throw n===!1?new Ht(`Adapter ${e} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(Ne.hasOwnProp(uf,e)?`Adapter '${e}' is not available in the build`:`Unknown adapter '${e}'`);if(!Ne.isFunction(n))throw new TypeError("adapter is not a function");return n},adapters:uf};function Uv(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Bu(null,t)}function M1(t){return Uv(t),t.headers=Xi.from(t.headers),t.data=Lv.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),RD.getAdapter(t.adapter||Dv.adapter)(t).then(function(n){return Uv(t),n.data=Lv.call(t,t.transformResponse,n),n.headers=Xi.from(n.headers),n},function(n){return T1(n)||(Uv(t),n&&n.response&&(n.response.data=Lv.call(t,t.transformResponse,n.response),n.response.headers=Xi.from(n.response.headers))),Promise.reject(n)})}const C1=t=>t instanceof Xi?t.toJSON():t;function ms(t,r){r=r||{};const e={};function n(l,c,f){return Ne.isPlainObject(l)&&Ne.isPlainObject(c)?Ne.merge.call({caseless:f},l,c):Ne.isPlainObject(c)?Ne.merge({},c):Ne.isArray(c)?c.slice():c}function i(l,c,f){if(Ne.isUndefined(c)){if(!Ne.isUndefined(l))return n(void 0,l,f)}else return n(l,c,f)}function a(l,c){if(!Ne.isUndefined(c))return n(void 0,c)}function o(l,c){if(Ne.isUndefined(c)){if(!Ne.isUndefined(l))return n(void 0,l)}else return n(void 0,c)}function s(l,c,f){if(f in r)return n(l,c);if(f in t)return n(void 0,l)}const u={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(l,c)=>i(C1(l),C1(c),!0)};return Ne.forEach(Object.keys(t).concat(Object.keys(r)),function(c){const f=u[c]||i,d=f(t[c],r[c],c);Ne.isUndefined(d)&&f!==s||(e[c]=d)}),e}const R1="1.2.2",jv={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{jv[t]=function(n){return typeof n===t||"a"+(r<1?"n ":" ")+t}});const I1={};jv.transitional=function(r,e,n){function i(a,o){return"[Axios v"+R1+"] Transitional option '"+a+"'"+o+(n?". "+n:"")}return(a,o,s)=>{if(r===!1)throw new Ht(i(o," has been removed"+(e?" in "+e:"")),Ht.ERR_DEPRECATED);return e&&!I1[o]&&(I1[o]=!0,console.warn(i(o," has been deprecated since v"+e+" and will be removed in the near future"))),r?r(a,o,s):!0}};function ID(t,r,e){if(typeof t!="object")throw new Ht("options must be an object",Ht.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let i=n.length;for(;i-- >0;){const a=n[i],o=r[a];if(o){const s=t[a],u=s===void 0||o(s,a,t);if(u!==!0)throw new Ht("option "+a+" must be "+u,Ht.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new Ht("Unknown option "+a,Ht.ERR_BAD_OPTION)}}const Vv={assertOptions:ID,validators:jv},Va=Vv.validators;class lf{constructor(r){this.defaults=r,this.interceptors={request:new y1,response:new y1}}request(r,e){typeof r=="string"?(e=e||{},e.url=r):e=r||{},e=ms(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:a}=e;n!==void 0&&Vv.assertOptions(n,{silentJSONParsing:Va.transitional(Va.boolean),forcedJSONParsing:Va.transitional(Va.boolean),clarifyTimeoutError:Va.transitional(Va.boolean)},!1),i!==void 0&&Vv.assertOptions(i,{encode:Va.function,serialize:Va.function},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let o;o=a&&Ne.merge(a.common,a[e.method]),o&&Ne.forEach(["delete","get","head","post","put","patch","common"],p=>{delete a[p]}),e.headers=Xi.concat(o,a);const s=[];let u=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(e)===!1||(u=u&&y.synchronous,s.unshift(y.fulfilled,y.rejected))});const l=[];this.interceptors.response.forEach(function(y){l.push(y.fulfilled,y.rejected)});let c,f=0,d;if(!u){const p=[M1.bind(this),void 0];for(p.unshift.apply(p,s),p.push.apply(p,l),d=p.length,c=Promise.resolve(e);f<d;)c=c.then(p[f++],p[f++]);return c}d=s.length;let v=e;for(f=0;f<d;){const p=s[f++],y=s[f++];try{v=p(v)}catch(k){y.call(this,k);break}}try{c=M1.call(this,v)}catch(p){return Promise.reject(p)}for(f=0,d=l.length;f<d;)c=c.then(l[f++],l[f++]);return c}getUri(r){r=ms(this.defaults,r);const e=S1(r.baseURL,r.url);return g1(e,r.params,r.paramsSerializer)}}Ne.forEach(["delete","get","head","options"],function(r){lf.prototype[r]=function(e,n){return this.request(ms(n||{},{method:r,url:e,data:(n||{}).data}))}}),Ne.forEach(["post","put","patch"],function(r){function e(n){return function(a,o,s){return this.request(ms(s||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}lf.prototype[r]=e(),lf.prototype[r+"Form"]=e(!0)});const cf=lf;class Fv{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(a){e=a});const n=this;this.promise.then(i=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](i);n._listeners=null}),this.promise.then=i=>{let a;const o=new Promise(s=>{n.subscribe(s),a=s}).then(i);return o.cancel=function(){n.unsubscribe(a)},o},r(function(a,o,s){n.reason||(n.reason=new Bu(a,o,s),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const e=this._listeners.indexOf(r);e!==-1&&this._listeners.splice(e,1)}static source(){let r;return{token:new Fv(function(i){r=i}),cancel:r}}}const OD=Fv;function ND(t){return function(e){return t.apply(null,e)}}function AD(t){return Ne.isObject(t)&&t.isAxiosError===!0}const $v={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries($v).forEach(([t,r])=>{$v[r]=t});const PD=$v;function O1(t){const r=new cf(t),e=r1(cf.prototype.request,r);return Ne.extend(e,cf.prototype,r,{allOwnKeys:!0}),Ne.extend(e,r,null,{allOwnKeys:!0}),e.create=function(i){return O1(ms(t,i))},e}const Vr=O1(Dv);Vr.Axios=cf,Vr.CanceledError=Bu,Vr.CancelToken=OD,Vr.isCancel=T1,Vr.VERSION=R1,Vr.toFormData=nf,Vr.AxiosError=Ht,Vr.Cancel=Vr.CanceledError,Vr.all=function(r){return Promise.all(r)},Vr.spread=ND,Vr.isAxiosError=AD,Vr.mergeConfig=ms,Vr.AxiosHeaders=Xi,Vr.formToJSON=t=>_1(Ne.isHTMLForm(t)?new FormData(t):t),Vr.HttpStatusCode=PD,Vr.default=Vr;const xD=Vr,Zu={service:{baseUrl:"https://api.revly.io",appUrl:"https://s3.ap-south-1.amazonaws.com/sdk.revly.io"},scheduler:{agentSwitchTime:"5000"}};let zv=!0;window.addEventListener("blur",()=>zv=!1),window.addEventListener("focus",()=>zv=!0);const Kr=xD.create({baseURL:Zu.service.baseUrl});Kr.interceptors.request.use(t=>(Ar.orgId&&(t.headers.RevlyOrganizationId=Ar.orgId),(Ar.visitorId||window.visitorId)&&(t.headers.RevlyVisitorId=Ar.visitorId||window.visitorId),Ar.cookieId&&(t.headers.RevlyVisitorCookieId=Ar.cookieId),Ar.tabId&&(t.headers.RevlyTabId=Ar.tabId),t.headers.RevlyPath=window.location.pathname,zv&&(t.headers.RevlyIsUserActive=!0),t));class Pr{static setCookie(r,e,n){var i="";if(n){var a=new Date;a.setTime(a.getTime()+n*1e3),i="; expires="+a.toUTCString()}document.cookie=r+"="+e+i+"; path=/"}static getCookie(r){for(var e=r+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var a=n[i];a.charAt(0)==" ";)a=a.substring(1,a.length);if(a.indexOf(e)==0)return a.substring(e.length,a.length)}return null}static eraseCookie(r){document.cookie=r+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}}function Ge(){}const qu=t=>t;function DD(t,r){for(const e in r)t[e]=r[e];return t}function LD(t){return t&&typeof t=="object"&&typeof t.then=="function"}function N1(t){return t()}function A1(){return Object.create(null)}function kr(t){t.forEach(N1)}function Mn(t){return typeof t=="function"}function Et(t,r){return t!=t?r==r:t!==r||t&&typeof t=="object"||typeof t=="function"}let ff;function Jt(t,r){return ff||(ff=document.createElement("a")),ff.href=r,t===ff.href}function UD(t){return Object.keys(t).length===0}function P1(t,...r){if(t==null)return Ge;const e=t.subscribe(...r);return e.unsubscribe?()=>e.unsubscribe():e}function Tr(t){let r;return P1(t,e=>r=e)(),r}function xr(t,r,e){t.$$.on_destroy.push(P1(r,e))}function Qu(t,r,e,n){if(t){const i=x1(t,r,e,n);return t[0](i)}}function x1(t,r,e,n){return t[1]&&n?DD(e.ctx.slice(),t[1](n(r))):e.ctx}function Yu(t,r,e,n){if(t[2]&&n){const i=t[2](n(e));if(r.dirty===void 0)return i;if(typeof i=="object"){const a=[],o=Math.max(r.dirty.length,i.length);for(let s=0;s<o;s+=1)a[s]=r.dirty[s]|i[s];return a}return r.dirty|i}return r.dirty}function Gu(t,r,e,n,i,a){if(i){const o=x1(r,e,n,a);t.p(o,i)}}function Hu(t){if(t.ctx.length>32){const r=[],e=t.ctx.length/32;for(let n=0;n<e;n++)r[n]=-1;return r}return-1}function an(t){return t??""}function gs(t,r,e){return t.set(e),r}const D1=typeof window<"u";let Wv=D1?()=>window.performance.now():()=>Date.now(),Bv=D1?t=>requestAnimationFrame(t):Ge;const ys=new Set;function L1(t){ys.forEach(r=>{r.c(t)||(ys.delete(r),r.f())}),ys.size!==0&&Bv(L1)}function Zv(t){let r;return ys.size===0&&Bv(L1),{promise:new Promise(e=>{ys.add(r={c:t,f:e})}),abort(){ys.delete(r)}}}function U(t,r){t.appendChild(r)}function Zt(t,r,e){const n=qv(t);if(!n.getElementById(r)){const i=ie("style");i.id=r,i.textContent=e,U1(n,i)}}function qv(t){if(!t)return document;const r=t.getRootNode?t.getRootNode():t.ownerDocument;return r&&r.host?r:t.ownerDocument}function jD(t){const r=ie("style");return U1(qv(t),r),r.sheet}function U1(t,r){return U(t.head||t,r),r.sheet}function Ce(t,r,e){t.insertBefore(r,e||null)}function Me(t){t.parentNode&&t.parentNode.removeChild(t)}function Fa(t,r){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(r)}function ie(t){return document.createElement(t)}function qe(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Nt(t){return document.createTextNode(t)}function Le(){return Nt(" ")}function Fn(){return Nt("")}function nt(t,r,e,n){return t.addEventListener(r,e,n),()=>t.removeEventListener(r,e,n)}function Qv(t){return function(r){return r.preventDefault(),t.call(this,r)}}function Ju(t){return function(r){return r.stopPropagation(),t.call(this,r)}}function h(t,r,e){e==null?t.removeAttribute(r):t.getAttribute(r)!==e&&t.setAttribute(r,e)}function VD(t){return Array.from(t.childNodes)}function tr(t,r){r=""+r,t.wholeText!==r&&(t.data=r)}function j1(t,r){t.value=r??""}function rt(t,r,e,n){e===null?t.style.removeProperty(r):t.style.setProperty(r,e,n?"important":"")}function FD(t,r){for(let e=0;e<t.options.length;e+=1){const n=t.options[e];if(n.__value===r){n.selected=!0;return}}t.selectedIndex=-1}function zr(t,r,e){t.classList[e?"add":"remove"](r)}function $D(t,r,{bubbles:e=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e,n,r),i}const df=new Map;let pf=0;function zD(t){let r=5381,e=t.length;for(;e--;)r=(r<<5)-r^t.charCodeAt(e);return r>>>0}function WD(t,r){const e={stylesheet:jD(r),rules:{}};return df.set(t,e),e}function vf(t,r,e,n,i,a,o,s=0){const u=16.666/n;let l=`{
`;for(let k=0;k<=1;k+=u){const I=r+(e-r)*a(k);l+=k*100+`%{${o(I,1-I)}}
`}const c=l+`100% {${o(e,1-e)}}
}`,f=`__svelte_${zD(c)}_${s}`,d=qv(t),{stylesheet:v,rules:p}=df.get(d)||WD(d,t);p[f]||(p[f]=!0,v.insertRule(`@keyframes ${f} ${c}`,v.cssRules.length));const y=t.style.animation||"";return t.style.animation=`${y?`${y}, `:""}${f} ${n}ms linear ${i}ms 1 both`,pf+=1,f}function hf(t,r){const e=(t.style.animation||"").split(", "),n=e.filter(r?a=>a.indexOf(r)<0:a=>a.indexOf("__svelte")===-1),i=e.length-n.length;i&&(t.style.animation=n.join(", "),pf-=i,pf||BD())}function BD(){Bv(()=>{pf||(df.forEach(t=>{const{ownerNode:r}=t.stylesheet;r&&Me(r)}),df.clear())})}let Xu;function Ki(t){Xu=t}function $a(){if(!Xu)throw new Error("Function called outside component initialization");return Xu}function ZD(t){$a().$$.before_update.push(t)}function ea(t){$a().$$.on_mount.push(t)}function Yv(t){$a().$$.after_update.push(t)}function Ku(t){$a().$$.on_destroy.push(t)}function qD(t,r){return $a().$$.context.set(t,r),r}function Gv(t){return $a().$$.context.get(t)}function Hr(t,r){const e=t.$$.callbacks[r.type];e&&e.slice().forEach(n=>n.call(this,r))}const el=[],ta=[],mf=[],V1=[],QD=Promise.resolve();let Hv=!1;function YD(){Hv||(Hv=!0,QD.then(Xv))}function Cn(t){mf.push(t)}const Jv=new Set;let gf=0;function Xv(){const t=Xu;do{for(;gf<el.length;){const r=el[gf];gf++,Ki(r),GD(r.$$)}for(Ki(null),el.length=0,gf=0;ta.length;)ta.pop()();for(let r=0;r<mf.length;r+=1){const e=mf[r];Jv.has(e)||(Jv.add(e),e())}mf.length=0}while(el.length);for(;V1.length;)V1.pop()();Hv=!1,Jv.clear(),Ki(t)}function GD(t){if(t.fragment!==null){t.update(),kr(t.before_update);const r=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,r),t.after_update.forEach(Cn)}}let tl;function Kv(){return tl||(tl=Promise.resolve(),tl.then(()=>{tl=null})),tl}function Eo(t,r,e){t.dispatchEvent($D(`${r?"intro":"outro"}${e}`))}const yf=new Set;let Mi;function ar(){Mi={r:0,c:[],p:Mi}}function or(){Mi.r||kr(Mi.c),Mi=Mi.p}function _e(t,r){t&&t.i&&(yf.delete(t),t.i(r))}function Ee(t,r,e,n){if(t&&t.o){if(yf.has(t))return;yf.add(t),Mi.c.push(()=>{yf.delete(t),n&&(e&&t.d(1),n())}),t.o(r)}else n&&n()}const eh={duration:0};function th(t,r,e){const n={direction:"in"};let i=r(t,e,n),a=!1,o,s,u=0;function l(){o&&hf(t,o)}function c(){const{delay:d=0,duration:v=300,easing:p=qu,tick:y=Ge,css:k}=i||eh;k&&(o=vf(t,0,1,v,d,p,k,u++)),y(0,1);const I=Wv()+d,C=I+v;s&&s.abort(),a=!0,Cn(()=>Eo(t,!0,"start")),s=Zv(L=>{if(a){if(L>=C)return y(1,0),Eo(t,!0,"end"),l(),a=!1;if(L>=I){const R=p((L-I)/v);y(R,1-R)}}return a})}let f=!1;return{start(){f||(f=!0,hf(t),Mn(i)?(i=i(n),Kv().then(c)):c())},invalidate(){f=!1},end(){a&&(l(),a=!1)}}}function HD(t,r,e){const n={direction:"out"};let i=r(t,e,n),a=!0,o;const s=Mi;s.r+=1;function u(){const{delay:l=0,duration:c=300,easing:f=qu,tick:d=Ge,css:v}=i||eh;v&&(o=vf(t,1,0,c,l,f,v));const p=Wv()+l,y=p+c;Cn(()=>Eo(t,!1,"start")),Zv(k=>{if(a){if(k>=y)return d(0,1),Eo(t,!1,"end"),--s.r||kr(s.c),!1;if(k>=p){const I=f((k-p)/c);d(1-I,I)}}return a})}return Mn(i)?Kv().then(()=>{i=i(n),u()}):u(),{end(l){l&&i.tick&&i.tick(1,0),a&&(o&&hf(t,o),a=!1)}}}function za(t,r,e,n){const i={direction:"both"};let a=r(t,e,i),o=n?0:1,s=null,u=null,l=null;function c(){l&&hf(t,l)}function f(v,p){const y=v.b-o;return p*=Math.abs(y),{a:o,b:v.b,d:y,duration:p,start:v.start,end:v.start+p,group:v.group}}function d(v){const{delay:p=0,duration:y=300,easing:k=qu,tick:I=Ge,css:C}=a||eh,L={start:Wv()+p,b:v};v||(L.group=Mi,Mi.r+=1),s||u?u=L:(C&&(c(),l=vf(t,o,v,y,p,k,C)),v&&I(0,1),s=f(L,y),Cn(()=>Eo(t,v,"start")),Zv(R=>{if(u&&R>u.start&&(s=f(u,y),u=null,Eo(t,s.b,"start"),C&&(c(),l=vf(t,o,s.b,s.duration,0,k,a.css))),s){if(R>=s.end)I(o=s.b,1-o),Eo(t,s.b,"end"),u||(s.b?c():--s.group.r||kr(s.group.c)),s=null;else if(R>=s.start){const q=R-s.start;o=s.a+s.d*k(q/s.duration),I(o,1-o)}}return!!(s||u)}))}return{run(v){Mn(a)?Kv().then(()=>{a=a(i),d(v)}):d(v)},end(){c(),s=u=null}}}function F1(t,r){const e=r.token={};function n(i,a,o,s){if(r.token!==e)return;r.resolved=s;let u=r.ctx;o!==void 0&&(u=u.slice(),u[o]=s);const l=i&&(r.current=i)(u);let c=!1;r.block&&(r.blocks?r.blocks.forEach((f,d)=>{d!==a&&f&&(ar(),Ee(f,1,1,()=>{r.blocks[d]===f&&(r.blocks[d]=null)}),or())}):r.block.d(1),l.c(),_e(l,1),l.m(r.mount(),r.anchor),c=!0),r.block=l,r.blocks&&(r.blocks[a]=l),c&&Xv()}if(LD(t)){const i=$a();if(t.then(a=>{Ki(i),n(r.then,1,r.value,a),Ki(null)},a=>{if(Ki(i),n(r.catch,2,r.error,a),Ki(null),!r.hasCatch)throw a}),r.current!==r.pending)return n(r.pending,0),!0}else{if(r.current!==r.then)return n(r.then,1,r.value,t),!0;r.resolved=t}}function $1(t,r,e){const n=r.slice(),{resolved:i}=t;t.current===t.then&&(n[t.value]=i),t.current===t.catch&&(n[t.error]=i),t.block.p(n,e)}const JD=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function XD(t,r){Ee(t,1,1,()=>{r.delete(t.key)})}function KD(t,r,e,n,i,a,o,s,u,l,c,f){let d=t.length,v=a.length,p=d;const y={};for(;p--;)y[t[p].key]=p;const k=[],I=new Map,C=new Map;for(p=v;p--;){const z=f(i,a,p),F=e(z);let D=o.get(F);D?n&&D.p(z,r):(D=l(F,z),D.c()),I.set(F,k[p]=D),F in y&&C.set(F,Math.abs(p-y[F]))}const L=new Set,R=new Set;function q(z){_e(z,1),z.m(s,c),o.set(z.key,z),c=z.first,v--}for(;d&&v;){const z=k[v-1],F=t[d-1],D=z.key,W=F.key;z===F?(c=z.first,d--,v--):I.has(W)?!o.has(D)||L.has(D)?q(z):R.has(W)?d--:C.get(D)>C.get(W)?(R.add(D),q(z)):(L.add(W),d--):(u(F,o),d--)}for(;d--;){const z=t[d];I.has(z.key)||u(z,o)}for(;v;)q(k[v-1]);return k}function Ke(t){t&&t.c()}function Je(t,r,e,n){const{fragment:i,after_update:a}=t.$$;i&&i.m(r,e),n||Cn(()=>{const o=t.$$.on_mount.map(N1).filter(Mn);t.$$.on_destroy?t.$$.on_destroy.push(...o):kr(o),t.$$.on_mount=[]}),a.forEach(Cn)}function Xe(t,r){const e=t.$$;e.fragment!==null&&(kr(e.on_destroy),e.fragment&&e.fragment.d(r),e.on_destroy=e.fragment=null,e.ctx=[])}function eL(t,r){t.$$.dirty[0]===-1&&(el.push(t),YD(),t.$$.dirty.fill(0)),t.$$.dirty[r/31|0]|=1<<r%31}function Rt(t,r,e,n,i,a,o,s=[-1]){const u=Xu;Ki(t);const l=t.$$={fragment:null,ctx:[],props:a,update:Ge,not_equal:i,bound:A1(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(u?u.$$.context:[])),callbacks:A1(),dirty:s,skip_bound:!1,root:r.target||u.$$.root};o&&o(l.root);let c=!1;if(l.ctx=e?e(t,r.props||{},(f,d,...v)=>{const p=v.length?v[0]:d;return l.ctx&&i(l.ctx[f],l.ctx[f]=p)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](p),c&&eL(t,f)),d}):[],l.update(),c=!0,kr(l.before_update),l.fragment=n?n(l.ctx):!1,r.target){if(r.hydrate){const f=VD(r.target);l.fragment&&l.fragment.l(f),f.forEach(Me)}else l.fragment&&l.fragment.c();r.intro&&_e(t.$$.fragment),Je(t,r.target,r.anchor,r.customElement),Xv()}Ki(u)}class It{$destroy(){Xe(this,1),this.$destroy=Ge}$on(r,e){if(!Mn(e))return Ge;const n=this.$$.callbacks[r]||(this.$$.callbacks[r]=[]);return n.push(e),()=>{const i=n.indexOf(e);i!==-1&&n.splice(i,1)}}$set(r){this.$$set&&!UD(r)&&(this.$$.skip_bound=!0,this.$$set(r),this.$$.skip_bound=!1)}}const bs=[];function ra(t,r=Ge){let e;const n=new Set;function i(s){if(Et(t,s)&&(t=s,e)){const u=!bs.length;for(const l of n)l[1](),bs.push(l,t);if(u){for(let l=0;l<bs.length;l+=2)bs[l][0](bs[l+1]);bs.length=0}}}function a(s){i(s(t))}function o(s,u=Ge){const l=[s,u];return n.add(l),n.size===1&&(e=r(i)||Ge),s(t),()=>{n.delete(l),n.size===0&&(e(),e=null)}}return{set:i,update:a,subscribe:o}}var _s=(t=>(t.FloatingButton="floating_button",t.PopUp="pop_up",t.CustomButton="custom_button",t))(_s||{}),rl=(t=>(t.TopLeft="top_left",t.TopRight="top_right",t.bottomLeft="bottom_left",t.bottomRight="bottom_right",t))(rl||{}),Mo=(t=>(t.Contains="contains",t.IsExactly="is-exactly",t.DoesNotContain="does-not-contain",t.IsNot="is-not",t))(Mo||{});function tL(t){const{origin:r,href:e}=window.location,n=r===e.replace(/\/$/,"")?r:e;if(!t.isEnabled)return!0;let i=[],a=[];t.events.forEach(o=>{o.urlOperator===Mo.IsNot||o.urlOperator===Mo.DoesNotContain?i.push(o):a.push(o)});for(const o of i)if(o.urlOperator===Mo.IsNot&&n===o.urlValue||o.urlOperator===Mo.DoesNotContain&&n.includes(o.urlValue))return!1;if(!a.length)return!0;for(const o of a)if(o.urlOperator===Mo.Contains&&n.includes(o.urlValue)||o.urlOperator===Mo.IsExactly&&n===o.urlValue)return!0;return!1}class ui{static set(r,e){localStorage.setItem(r,JSON.stringify(e))}static get(r){const e=localStorage.getItem(r);return e?JSON.parse(e):null}static remove(r){localStorage.removeItem(r)}}const z1="REVLY_LAST_CALL_CAMPAIGN_ID_KEY",ws="REVLY_VISITOR_DETAILS",rh="REVLY_CALL_ID",nh="REVLY_CALL_TYPE",ih="REVLY_CALL_DAILOG",ah="REVELY_CALL_ROOM_ID",oh="REVELY_CALL_TOKEN",bf="MAX_CALL_RETRY_COUNT",sh="REVLY_FLOATER_MINIMIZED";var Wa=(t=>(t.None="none",t.ExternalLink="external_link",t.Revly="revly",t))(Wa||{}),Xt=(t=>(t.Mini="mini",t.Small="small",t.Full="full",t))(Xt||{}),ks=(t=>(t.None="none",t.BeforeCall="before_call",t.OnCallJoin="on_call_join",t))(ks||{});const rL={position:rl.bottomLeft,template:1,templateConfig:null,delayInSec:0,scheduler:null,callDisqualificationText:"",schedulerDisqualificationText:""},Ts=ra({visible:!1,campaignId:null,availableAgentCount:0,uiConfig:rL,availableAgentsProfile:[],callSettings:{audio:ks.None,video:!1,visitorDetailsForm:{isEnable:!1,formJson:[]}},isMinimized:ui.get(sh)==="YES"});class nL{static updateButtonStateFromPing(r){const i=r.qualifiedCampaigns.filter(a=>a.type===_s.FloatingButton&&a.isQualified&&tL(a.qurlConfig)).sort((a,o)=>+(o.agentAvailabilityStatus.availableAgentCount+o.agentAvailabilityStatus.offlineAvailableAgents)-(a.agentAvailabilityStatus.availableAgentCount+a.agentAvailabilityStatus.offlineAvailableAgents)).sort((a,o)=>a.campaignId<o.campaignId?-1:a.campaignId>o.campaignId?1:0)[0];if(i){const{agentAvailabilityStatus:{availableAgentCount:a,offlineAvailableAgents:o},campaignId:s,availableAgentsProfile:u,callSettings:l}=i,c=i.uiConfig,f=a+o,d=f>0||[Wa.ExternalLink,Wa.Revly].includes(c.scheduler.type),v=u.sort((p,y)=>p.isAvailble&&!y.isAvailble?-1:!p.isAvailble&&y.isAvailble?1:0);Ts.update(p=>({...p,visible:d,campaignId:s,uiConfig:c,availableAgentCount:f,availableAgentsProfile:v,callSettings:l}))}else Ts.update(a=>({...a,visible:!1}))}}var He=(t=>(t.None="none",t.WatingForAgentJoin="waiting_for_agent_join",t.AgentLeft="agent_left",t.InQueue="in_queue",t.AllAgentOffline="all_agent_offline",t.VisitorEndedCall="visitor_ended_call",t.RequestingMicPermission="mic_permission_requesting",t.MicPermissionBlocked="mic_permission_blocked",t.MicPermissionDismissed="mic_permission_dismissed",t.MicPermissionTimeout="mic_permission_timeout",t.VisitorDetails="visitor_details",t.CallCompleted="call_completed",t.Scheduler="scheduler",t.Disqualified="disqualified",t))(He||{});const iL="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU3LjgzLjEwMAAAAAAAAAAAAAAA//tUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAsAABCwAAICA4OFBQZGRkfHyUlKyswMDA2Njw8QkJHR0dNTVNTWVlZXl5kZGpqcHBwdXV7e4GBh4eHjIySkpiYmJ6eo6Opqa+vr7W1urrAwMbGxszM0dHX19fd3ePj6Oju7u709Pr6//8AAAAATGF2YzU3LjEwAAAAAAAAAAAAAAAAJAUAAAAAAAAAQsCUQQKk//uUZAAAAzEaRQVvIAAwYihgp5gADqiFNbnMgAjxDio3HsACMVFTFRUBD44HGXJhtD4cRDG4HgNPzkpY4BQMKFzQVE003BxEZIeGhGwsYGhIc0RtKGYEtUwTzXZNMMgAOGU42QE22dWxIhYj8Yww7DkO5Dl6vT9r09PG5fbzxACAYKBhYPn/Lv4IIYchoGgoIjen1GhhyEEEIBSAZAVAmCoBAAhHaDCADAYDCyadg+CAIOaXD/BB3//hgAAAAAAAbbT7WAAAAABxDBowMKhMeq5iAEhFiMOn8yNbQwPGCJKEE4xQaTwJ5QVMipgRgM+YSisMLBFWGgazk7YgaBSUXOhtduzLAknltQCQDjV7IguLNPxgsAsKz6H5V+Wd75PTSuc3altPO3MOZWXfK7AOmIAKABTCd324GAAAAAAxqBAKAknztMhjo+P0M2Exqb3rAOXzJKekAEx6L6wmaorBKXrUysnUPT32hdZ+EwaAAVAHMecWkw8DLTRZFuMQcJIw//uUZAoAE48bxhd7QAI7Izn97JQByaCFMU2kbWDpDyi1pI2fjQADA4BYMDEBoFAUGBqCAYCgFhiOjtGgnL2ZVxEZiuBmmD0CCYBAChgWgOGGDroRyR9Z4CCZpu4tsBQklBrdjszLalq5+W+3s6meOfcLuG73Ma30TmOjoDGijvt9+EEwAsBOWAAB0guGCaDRTSBd1i14vwhVNQYZcaGrixWtWAEUD70AYDG8y2W6Gtu7sijgoT3W/jYvUJvrAUKCb/WN7oGxRHOmVGjCXhVpanLlTNSLVnneRM7KQHggTzWa8y4MlWVmvk53dpNCRSD5ZJHaK/5FVj/QdbUQtWWH/1GNln7//2dn/+gAyAXJzXWsiA6waPX9DKAhP+CG74RwwALHEDKxpAoX2qRE9Kxwrf3d0FhcFDPUrTNvBhnBOoZ4eKzHVRKUAwGAEDIhIoMNYgk0qgZjE4GxIOgEJxgkJRgUFANEww2EwyeOA9pMs2eJAxECc1xPsW6XrbcGVKJB//uUZB2MA2IZxhPdwMA+hAmqbygZiqxtHE7sxcF3D+LJ7pi4gFhw+BMZXjkRv8JZqzz6GYy1nbv85+8KSwISAaSt5sISJwaXeeaM+h/3Kclln//6ekHUtVHEgAHpMXLTBZU+cgB16KBzGiSkv7MMOP2lq1Gr0PMqODxQbP+leQWCwQzRVNL5j7pKJ/uYs8KV/RK0pW+lCUHTOSfx0hDxokzBwDC94kDsyLJAQRHBYSSjclw7ItBIMsZOqT3485TWn+iKxSYVkNNezGtppFHuRzX/jxvSZ7UFgNg8Fqo5zeyPMfzvp//+7/crqAKBGRgQwSsZma4XsYAgOJKC8FAbQKCwFmAAKgwEBICzgAdjIENy6CZTyyLKhp4Im7kTZq09nU5aWYl5vgb07fvku/uOnNz6J2czHK4vQH3Eg6lV9uj/4u6/+j/QZkIjAJBwMDROowdiyDL0B/LqMBMUBASrQyL9mBALGF4gmwdamH4Zq3RlYaJ2703jD08/wKAR/O2s//uUZByIAyIfRRPdQXBHg9mtcwYby6iTFS9wZcFYDeMl7ixogs98OgPrk1ZNTG7tLtutUhOEBkUi9TzPvW07cri/fdrcFm2fq999H8Fzo0ABASJRuNgAKAhiyMTFE8ILhLLFi6c8+sBylnRTJV1ljE/FqS+nceEBXhiVOvcxUN23Zb5OdvP+WYhvUuSqyuQaAsfFVC4X8IAVgEMCYHMyj05TBkN0MsIHoeBgQJmIzqksPBxlgiDgUJ58ivG1QgqF237ea7b5UpXIbot+HH2n7qAyOwgFBMfjmU8HY6QvWapxDOlhQfE6Zmz6N3mEx/6qv9KnawACA35VG0MlIlkwvk/jpWF3N0EAxqezFqIAwnKgOcBMkwYKTgW2FkYX7ijQsN6RsVtDUSl5xRqPDorh2fuYP3D2Ra9oNWAxI80mYOJ/V4m+z/3K/9PqAAKArkAMGxGO1raMP/ANaDvMMggBohmiSENAMWFRawDEIwQFji7tNEgaHmkuLO1b8o3nkxNd//uUZBsAgsIdxku8MXBVY0i2e4MuCvhvGy7tZoE8jePp7aRszN6+eP2H9wOI1kf48v47+diqLEhyymQulk7P5Xt/1+r9+gAi0gAYAoShkNn/GHJJ8ZKx8IMCcMBAA0+ANgcIXgEgyoCYkFBrHQgJismdSL1KlHS7obztIayzHKofD44em6O8pPEDQJg+wmgcqs6Qd3I/2o61/uy4Bg0T8whIAx12jZhRhR8mqphSFQsDhpAIgYDI6CFzqYyUINq2DYwhvTccU4nKnUyWIQFBBrpuQPNuolN3x7VJZVMpI5QZSVYdceNt+X/C/6tur/7OLv09B4ONIgAGAWACYLRkZhVoNGw6JScSUGIGRwresportu6YOHmSjxjoC8DX4hK0TpRtMQH4QrB2E/0SyaLGLpedOr1/lJotWs+5JhE86E7J8UoAAARAFRogAGBKAsZDw1xiQgmB375SdAocPRGXCgtZD0qEmdIAFAFTiwKdOQHO24siEE3Y5s6lkpf7vE9P//uURB6Ako4ZR+vbeMpOwzjpd4MvCYxnHS9pYylEjyQ1x42c/t5NqsDKQU6fRj+PoWg83v6XL/4gAAHH5AAECCZrWOYqAieIE+RC4CREMiL1QDaii5jA4mMwygzcBEc3tkdJUt4XZ10F2Ilfc/FSGMpSJ4jNFRjwgMAAClCQTeaE75co2q/aoAg5D9AAwDAGzJtATMIdJM2pxnD8tzOLzf1oqnlPpyFQMe1WwRBYIsbWco2KCUA8s3q17n6VJ1bYl0/TmJp7jlg1YubR2/I2/9bf/zYEAbcQBEhkzyGAXcbcNIsHgAEjYpAMfj8OIxjchiMqGXgIaL4Zkkig0AF5jSvT/KCDHUBPzHffVwSiwdWhztEIdR9b3q5GHUDA6Pe9gJliVOgAA4onCQADAANTPJnzAjaTRxWjBIQxoNTkRQFgaoKIgiYOARi0RG6JQa3BxdF3pNXi9apWq1I2o1bs1r4tgYJmwqmVvDCGSQKtr+CJpOU8ioD3l0rLgCkqA7LG//uUZC2AEqkdx9O8GXhJw7ovawMvi4hzGy9xg8D3h+h1jSA320gAGwckHYYMBGARmReIcaRJsK4fsyXC5XN9idJI7N6ZuRq/LKMv4lU7z9D0AkYWYqMGipI6OhKhilwSGPRWxzF6GdAAgB/9AAKAEMJknAwvinTZADiM2CswugDArxLLPeooNA0wYGDbfiM+CAMCa6GnvxGKe9Wl1IqiHwhFhNA9nus/OdOw5Tasvb2z9JceKIFQO85uQsZcsWFTVft/9QFFpuVttlEeSAheB4h+FJsUkPdZKo6z9AooMw/hDcUnw7Ij+wSMVEOhJvrnD3Jq/WcY+g8zvqe/W+773feaAI04kQSYCQCJhLkJmGENwbFAfZjwDxh2HJsWMQOE8HAQIAEWaShqY612QA6lUIZUXn8S9g90cwIk5FHWbP3t0y/ObPfLzWxVh+nfe8UJY+fneTuMPa91mv//rVp9n+8BCka23XQAAVTCEV2D9EmCOPvNgT3xaDpqweIalsIt//uUZD8MAvgeRrvdYMA1A4otaSNLywBVGG91g0D6Cek1nCBuRbHWc+7q1hgjdEqNnfzOuIF7xb0b/I0kAADAVAyMS4YoLoeGTEOGYCCUYFEmavF0YGAODgQHADGQGEIZGvVIA47wwBVdOLbZjo+wcsAKP6+9LvQtMreyjaIUWQKJeD7yAqtzkTIUF//7//+3/+0CPofa7bWAATQjKHHAeadECEbMq4ooYdblq8pzy6KupYlUt2IwWS+ncyY6keBVAIVMvFhZ5saDAgQKlVM+3ooAAAKVyWxgAPEZ3OphOqHpTCClQENHSeqaNTdd3kJh104dMYu6kvpDBpA1jzwCifZ0p7bqGsniGRbrWq93qNK1suYjzKZQ1WVr//YAhSuyNAADIFmHc/mDPZG/armHxYX5M+BBSLbPuvt4jSFjMOAGLi7LmQVRIWFBx3s9L5tHTykLGuaNIkgqGDISqdvdW+3///////QAYOH+gABgCNCggMfxyPlw4EoMYID8QcmC//uUZFeAElchyeuaQNpLQyj6d4gYCLRZHy7tIyELhuOl7XBNwgITdQ4AEbJaEqgrBATLIyNgu+8JyAXn8dFRvYShKKtsYtYecUAZmFDHk1ekAgkGpMCEDoxZCEDDnJSNfMLM/5YzCwzsdgkELvbqXuNKxgFA6KN9Lbefc8K12Zu2Tn1k8lhcoeo2E7dag6/bcWvSzQACQu4AE9DU0qjB2FTx9DDBoNERNMLopE90lCIAHQyaUoRgQHPq8D6xRKLqYcMhsjblFin+VTUZZuK11P5PN8nAc8HA8fa04RTGfs9vfu/7v97/qAIjG1tt0gAGJjQYqVA+ZX86KravLq5FCaKzyGKt5kiSHPUBQcla18U5Mc9tukpTcLKntSoxNK3z+jHRl+ze2wAIC33qoIAJM6i/IYPMtiaMFATUBOkM0IFprUUWEACbXemhBbtPlP4YZ/UpsIzdb+O86LHJSimKI2ezK2ZNCO7GHwoFLBca/0TVdf/u0/R6H//oAa1ev+21//uUZHYAAp4bRku8SNA/pAoNaegpylR9Gy7sZcEGD6j1lg2foAHkQg7CBgkQ1FVSWVjrnlaGCPcC5MwWnZ1YvAsTyw0uu+6kiZZqTguyVCW27zDSlewHLlfP/pI6DOj1AAPVRtlEoYABpV3GLImC76UDAuUYvAK446w5UhgEKmOF+LHdNhe7qReFZFVfESgEG18qbg4nMgl8QshjKKuDClC9YhcdSlG35obR1f/f26f/16wANBa7ttYAAvw0ydDFkbO5FAIVVuBcssT7q1VXkB6zvHDLucK7wUGp9jDPiLNrCMJAylPqD28ucIeg03Jr3nWwtskP/QARAExFJTCw5PHEVOQEBAycKgKBwwRmAQKChOIAgYzwACApMBw8Hc85e/HZYVBYU5Tk3zVbdmBcRnzjQmoWYbPDzgUEIEQXJr0VHv3/0////9YABINUuurAAWiZWUZh4Hn5AaRCAVBBatg8Dpzl02ZgkgMFhatzD07/QBz+3Js94KGgRSnTrmXL//uUZJAIApYYx1OMG6BBglldcyYZSpRPGy4wzIEJkiV1ww2cXQtyn59MxJBP3XJVAAACjV3IAhyMNpgJVH9IY4GJZDoWiKFwQHAstMTDhjTKAZ8EKcrqdUwKFuZm8SiFVe6Y3zgNKJdCiO2flcEkVZpe7MfBNGKCerRJpAEFL/0AHAbMkEZMNXJOITWMuRACQ60dSDX1F3cQyMO1CBkVH2NuyFMUyCc/ly6/vfKqFtdU251/Uw6+p2qnhEp61B9/yn/////UAYF1epGmc+GFv8bXTJgUNGARKZvBiSauFhWxp7mH8sNLYaBLfWLa8NLJplgLAvv4NyqsYZyMnhNPlcK7hfUAzj+0uf82i2tf+wAAAiYzGQAArYQxww1lTtCkMIAktsAo2lGkjI3DZoEBpIHYj2dVuLLAeAM0JF3T1y7LnpmcbpGIjubBj1O70dQ8884eL27GKQAKBdL79Yk1DRtJEuQuLMEAJpIQ69aesnewgfbSjBgXQJJq4nRoNBON//uURKgBAl4lSuNvGzxKI+jZd0sYCSRrHS4kbqkfECO1xI2kwRug2/03hGSmxZtmFMBQOizi4WRYshS6OGsd/b+1X9bLk///6wEK1LZZbGABKjEwQjEf6JTy2eNla7kxBZCZk+EB5hDpd8Ak94EjW3FaWyMrCU8ajxjlOYLaNr++9f9uAACEtSAPEa7JZgKVGSyPFDABCN7GctA44jBhgcgBHaVgaekwZKF8520sZBwN4qFQCBBkLtaWBsPKHi9gDAhYKCg0/P3q2vKdlX/26vt9SP1gBIBoyJpEABKk0DJ8wJL84pHYxkFQSR6AnVSHn1NjEaFWdykxRGeTjcYAo29XrrPZ1aXU0QkUCUe9WObvdK7rZiT++e+/VQACSu6AGvmjA2YnXh2MbiwCMAhw4CSygBrlfBVMSADI7QxIGbC/FeoyZZ2IC0SYPZzx8+KeYrbXpWzmNk1DBh6jIYk3rSZQA3FBkXJp9P////TWAIaS0gAgjOxAAxPpTGqoGBZC//uUZMKAAnAayuspG0g7Ian9YygLygg7Fy5phoEXiSP13aRlIGA7qp6us10kFHqjDWJqIegghPVxcBnPOu6upam+qWtqabhG+d6G4VvSDbD548x69CNaRBLYyTFgwpDkXLoBBMQDubHcBUFQ0clnRWOHB5JowunM6sqz1zWM3LHri0L5nZah1FBCCUsxrmZRodWjLWek9R8+E4QfTeNcNY4JOaKpZ/XTCrZtZYV9aaDv8yx/YAQIEcaQJJcQ5+7jI0TPdCIMNRYHBUGqJd1l8kbzhVxdkrI9twZ2DcxUBOBnYYPBwAtCRYRgwZcA2tePgd3LxVkO3fo/4v3/t3d9OpIBUuoArOZNDmYVuCcRkcYNgaDhUOAATKwuGACTAImAphsJHcHyZ7AREGXPgSX3eVqaUe0Vy4Pq9xHLUnWkJpbsvw0HvEpNREljkPRUlZre2nKfMzt1fxy9Aw84aWeqLzSx0CrtRlJ5pWZYiJ0WCslKddligAEAko7IADgFNpVU//uUZOCIApccxkubMbBDQ9jZc0gZC/CTFM7sZcExCaNpzYhgCAs8wQwcKEomY8UOnL5VAQoIHgAIkgRsUI1EC+QbmIQDKlNtf7D6k+GNNhOFc0ux9OD/2n5JfJrKlq+f/sS0tNMonowBiTQyABAPEKGNBq8uczdjSaI4CThN6MTAZ6zpvJvay6w8g9eOu51DNkYvdAwM0tJFQlxaxMxJc4J6XzN1bmP7rrrr1T3zxRSMgpc3/rpAZ1QVEBnPxFhcGjDSrMABEacCarNNJTcHQmePMaaMSBRDtJJKTXCcbZraK9FFxdTTmgWJvM04/yzwYhYC1ptf9f9X9/R/939bXegAAKG3GiSX5MMDEwgozpgYJhEwcZPVMCIPdSBWXoIzVJkDLq6hFOQhLcsRSAhOt8mGpZGH9Q02iVo1s90NiVGsJGToJlBRSi9YSW6GKO/vtRs/08p/17gEUqAAIBkxxgsEGwDbdAeDRQavKKGy7YbdgVAp/I2gpXsci85Tg+YU//uUZO2JE5orxDO8MeBJAqjcc2kZSqB1FM4wbMErEKLZww2oLQBtosDKBxTQeOMCqAYDzkteVeAoDWl4q5+0jZl+Q327OO7mVP26kp9jzYQJaQBYAwrFowuDw4SCMFBgoznrOAOAU7F/N+Iw4wGXIkNUIXHbxM0wLhQR5yFWrfpPGhUuWD4CYLhI+GTQkCrBcHQKTPixVqHmp/rL8WwjSPto/ZZ9veyR69GhSsGAwwdA6wKKxjsoKuAJRNrloSA89ImMjgWPd2wqgxgYCJlKfbuVIQucsdTDPNCOv3CPfXzVEybZUNCBq3io55ftnLKFpc9mqAivY7jfJSk7oq3Yh6Fi3TUICygAsowwkQJMDsBjXYYIIxxQ9hgUTrSrdBYMz/OAS3EkYuIs5b8wKqWTbVJHUz5EelZuqP19efPnOSgukwQwrM6rjCkjU33fvdODnNLKSZJ5Iw0NNuOJoldYA1kAAwUBT68zMxDw6kRCgMmACadCLwsDaqZasgMIpySq//uUZO2AkrYeRtObQMBTYrimd4MMC3RTFM7tAwFijmJZxKGQgIauESaRR2OOksrDCJUxCwZjp43sil47CwxsIscORNVsOg4Kiwsi8eiodW505c4uLvegoSGX0Sa62NOLKxRFNL6uoAAXi6hBeQhUh3aMvJ3CBpQdGUoxwBcTRBwcatWhCM3p8lndRQqpBQF9m3Mz6cxK5nzkkIMPIFXDosw6k4I3NGSWGRNv//6f/1f/s3gEk0VGiQAro4gCTA6A64hUIEB4bwip8MXTfpSQGMn2BIsmwaC6QejDS0BSezmxd88m3FfWSw9TRgWJoJwbLPNTN4ZvbUj+70f/R6u79H9yAEQoAFQEHJygK2o7aZQqBggJnKQ4LBdpDJV8pUnTuDw2UPrq90ts2C4vZ9fylHpep/R1MB95KBhxQoJ03hriV/bW+xdrEKW303xzr3LWZQ0QoSu1Cn2NCN7G/QkJEqgAOgk4RHTDo7MdlJNkwAVzRR6BwBSuYYz0dChihPRh//uUZOwAAtUgRLObMaBj40iGcWNmCYRnGS2kbME8DOMpzaAoUBCwb4ROUEqGcAgOOQhjWEG5ovHFMUdTJ6IAbHhZBEmXJCzmbjTDiumdWniKz0Lcq8JUKsMoS4Iro0AErLNzPY0TEMeDm0LwMGwWGU2mBW1YZ3XILunUoiRF1LWNfPPLerEka3Ma+yId2HLECFzI4UOdZCR2a0I6YM+HyAWA6VIQ53uGa0EW5wcTVfZyV1MWxYb+7/dKBABDTOCMOBI4oNAwCggeG7i+EAhy2Fp3AASnB/OZ6AaAICR6GL/mHAJKPRtnkm3bnwy98NJTB6jzR6mFQPSPVfvnLkAcnZ1Z4VUxd9hPxe3/+vTVAFIC8UCdk1dfGQ8r53DGCQBYuE6r4qQDBR7IAKVtWe+GKPs9WgDA2q3yzRtLglTbJSub1uC23o7yRC8Kqqrd/o9f/qX0d6JDVppAQMQACMLGTcMYrf5/0cCQ/MIBM4ICBoOMnlLVQAFjTZIBSEYOCAJo//uURO0JEuAUxLOaYaBco3iWc6NSC1CDEy7oZcFQDGJJxJmAGG8rtyJL33mRLOe9WBQ1epgiJKsUu+IQ0BGjngw3d5xC6++ivsTYvrWl76UhjbB2MXuEXkybLrGgSEojB7E2Uig088cxYJ+RUzKEq654UADUald+6qrrWxrzAs9gopJJ4XUeNqPLIHTpWdednc+5g800ZYrYxaEPxYVTdraKdhTVNqTMrEMiAAgNmScqBO+Y5VxYExRkMSgUdHThb8hUJAM+ZMDu8LKF/n4JLIod22m961d0TENaIxvlrAbXLWFVkiiTb7GtDYlOtxXuXXldfZXs/2dnX03DlQQTAwQ12JjANHODiYODaZIklYdet4xCADAAFMVNYaDDHTD83nWGNVEcrypMzOtclQMVRVlmRHaE6VpMZAnDlC4cPCMziiCjzypeoMCt6Cp0+447Zb2NeivEbkebbQeqW40AUAyjaQJLcjPTmMENs8cSgcFQUAjSoETzYI2RcsoMnAiG//uUZOcAglIZRct6MNBThCimcSNmCyBRDg5pJoFODSJZzZhgLT5ua+xpoQum7tTrHQ0YdFEfGZHdTzcjv/JPPcxfLQERsHX/27KlrI/+M3bP14CAFajNbIMG3szUaE942YvBsrli72xDQHMLuEDECMnkGx51hoIoymeQQNnYcFpKVkzmKu4gACwLBcDA6A7DoEDvo2rofW6E490/LLa8u9ZTE2+EWK7d/aMragMRKgAYDAKaUmSY4C4eAAmHMAFOzNDxhbxMoaQl4dKziwGzQsZfVEwglDVQP2+rYwbBGsKvy1RLy0T/FVUze2c8n0vutKQ+iRsbV7sgoq3T64tb/1IbFkuVAOK9SRtImGDLVgwRtPeGlNaxgwFLYJgdYYtSCYYWKaw2snMvYEgaJlxARd4buQcsGa6ltlT2CGwcDwHc8Ig6Uc+KOIRj/31abHdalf/29AQaWURYwtuQtSjsBxLKKGnMFurTQBMp7j/ArOvJR2e5UyUOHFTmraSCjsx2//uUZO+BAwkgxCuJG0BRJMjKcMNmCyBtEK4sbMFgEeJZ3aBgtvPLWZwi7YDp4SHkh4RR9dayAvJdltv6NNGle6hbvo+rSAAIVUoADANMLlXMWhgPogEIhlMAwsMWhFZAqFrrRDAYITD+sx0ByIAARDA/qcZ49oTwQLCltE3bBA87BDrnvtVbG2FGEW0umaWpJWp2Z7scEdWJVgk4mqEY9rsPNdFc3qrakZ0QiI9Hs5EswyLNuW1zok6OkqrdCsdsv2X1nNWsad+9EigAKgA4SgCx1DoapMDChwMb+GLT4MjGAo1fcAQY44LDzDCeFNJHTZU3MpBWDQnEQEeGocXBRSnpHEEvELNucvosSN6E/R2UpF022939CgAAKpkASUBGGGcYauh9oumGgAWTB0XTyijxREweIjRlmDEFDIaZRXKmEJMQjApxfRbBXTDnUgGUKLs8sTD7iTCUXA83LmQbrZ2bXurYZvWI9oBFz3/tq0xVbM6qlvZUQ1WLdrbZAAMw//uUZOuAQnkeR1NmGzBNhCi2c0MaEHl3DS6krcE4CWJJzaBgINkROdVz6QPrT2wPgu7KmazWWtfEkkK9caUwQXrWFSxcg5FHrSj6Of0gRlXzSwC+/0IUQ41dAEJDulV8yemxysGTTOQgiQ6BFTxv08FOWQPPPCJEjiluwV2p1GiVa3oVZu5hvr78yp8PWHYNAQ9wZlA/Ww+uS++3XsS3SmhVIqiMpWvszqLL1duLKAEJOONsABeRidYGE0CdlFwcOyEfTnqtqMPSbkolngPIXv/3vRhFdIVRHkeXpHbmy47nevS+9fStQNAwMLQLkEnB5l7hUNmP///r2d6/VQAwoAABBAzGGwxXWw6jHEFKQCGDtgUoBILkiiwhBzIiFO+kOoPimSaOFZKJC5oeKYQSNLdU1Gne3ayl7i/7z4PCpxUaWofvepaWXjnMZSool56PjA8sXNo+q0l36x9SVrfVUAnaVAEAPBrzJbOZLQxIAkgiYgOSbGaqiMCMijggamQI//uUZOIAAvcfRMuJGzA/JAntYYM/yphtFy5ow0E3j2NpzJhg1vs/vg+ojTTMYekBz5guBgVIlwXOhANljLxrSwotSj9aHsb/ahX0+vleqxFP3f1gAglVMINiKx7MHQ9OGwKFnxx45Y4Kp60+vI2LSZqNTNn3f2Dphpkpbumo8uKjpWmYWjkgmC5ACPFgVOSBJ1QRaDyYo2q/f/vXa2i9X1eyn+4lQAUcM1RAwpJT9RaBQ6WBIHlKcE/HYaagcuEkwa3wmFLrMKBqtHQ11UBCObm4ztZGFwuWUdc47EKTAxjGHQmhtFup7e9r1lyaag5T/vTimYEf7jAVvNhF0yHvz+qUMBA1VzrQpV0MzzljoOYG4BhFQ5mq8StgMBxubrvlEpZzpz3JSK46rC4Mi4uP2EnUV7XohoUCDy9HF9xAo2DD2nAw2s6tTfTZ+v5RIAgJR0iCYJqNQmOBYfsDZMJQKJjF4zbaTU8MiMAGpgvPfu4vHmeTCAqcPHgt5sb/lI6O//uUZO+AgxUeRDO7WMBPwkimc2YYChRnFy7lAwFMDOJJzYxgDR1YmUpcZ6dIFcg4CWJDsVgFFCU27dOMONi9xJS2UE4pZ7v9v31ZaaRcRhjzm5koYwYzedVFFFsqogRAvqsT948yYxtUQASrGjmeyeLn7Ysmh19zaVNXcX13SQtPNj7AB1QXOF9fKo0BzvcKuXxGpgxA1TiQ2yuYFpLiLyqygAkMa+GQ7IDex9BAEYCOndiQsDtpVlqUoHzigGrPlvtX8A0VzD1FbeNtb1O2vB7HogmTCDATCLBV61mibpHQcdNj9tqcte/S9VlLH2K2m/TRKgRAK6lQBEBTDSrMQNM+oIgU5jR3gL8PdRVkNAJyEiDnrLnIdmsKKBqZMhBOnnWyzTo85zGobqhBYgLJGGBEPhAecDpQ2KfI0SclM3nnWbLMbWM0KQ39O9n7wAiSACLh54wCZYdPOJgsFAwrmbi0qWYu1JMcYE5MGoqYxmFKWK42wQhPkpcq1gxyUYyr//uUZPKNArMaRAubMMBYRHipcMNmCuiTEC5lAwFMDOJJzZhgg0j5OMRzOXuKiyrD9tC0V9nxIhaq6Dw4glAEoOPYMcnRuoXp6wBjCQAAYNHAYRDgchCSHBYFwaCwFv28tFBBbsw9S0DBvKAsq7rtGgJxCMt+ReeTxjoqeRoZNAROyKXYhV4Rj5gWjVighIJWXF93uNtPGUC0uVdWmvtGLtXmLro3HgCAFKKBLrNMHkxGFgXahYrMKIDwiEWCFRtvIUQjt3oBAEOlHs+f3hYATRctHnJI5CmecoqEgs0VEoUJLoKAKeyzWrFAMKExgtYimxCye6LIv8aLKRbs97oqqQbFr9EgGAOaadiJiLIHKlGAAsAQ4JI6B5iILJReNFXYWNT8mmLmiTncwwGLYgvevV+4xtlpRsmYVbIYolhEMU7sdJHLWfOX7C8plltLm0IrC0I/smbN6luVI7dip9bzzn9z+XL/y/x4xHEGPW20AQCa6gSAjOXgwOJPNNkE46ZG//uUZPQAAsoaRUuaWMBXxJiGb4MKC5yXEK6YbMF4C6JlzZhgnmK7n1pXwLBJtbhxMuNb/PMQCjX7WzxPXfnx9eqrZ2ZSPdQwqNPCpEe84bkzEsIiNlX/+v/2baejTLKAF7jhlgx/gPZOQUWLAESv/lBkMlyDe6yZI65jpe7viQKm3dDy2QuJVeHuHEkfTVjFFh54IIWJjKwI97XHiSmGn0BHHjGVq9BG+lbCfcoklaMchO37WgAANFSADAEyn0KYZsxwmCAQ05UcUnGLkfRCNCPysVhAVlvvmC+RuLzEDIRe8mdEhAaEkEQbBoqTKCYQlmBMdFl6u2tH2Cv7G/S2/+Ebv+yQaQ1GAQCSAO4isUUdNEiRTMGOEFTT1zDl38DuhfXRzQmD2Jqkhx0kq9pxFXU3OqoWqVNRUjcQoXRS96YmFhUVOmR1zhCqjiieMY9/CVKvDi6dyv21gBADtSBPQSHYwIWQWLEgCqWmkETi4cfpEg12eVglZjVrR+zr6HOk//uUZOwMA05UwyuJG1BL43i5byY0CuhtEk3pAwE8iCKlrZgoKJkkL2szHt9u3il1LLIJAyVGTZ0Lg1Gr72NRoQ3Q2sI/oc376L4t9FFN76hBAAD7nMIpi7memhJhhQBNSAHMfqad9hByy8v6lMzTq/EmpXbmLiukdT27mEFAAMOk/EphwswCiAND8i+fvNDkEG2sHPQ0au4lfigetw0t0MF0F8RfftfeQCuQAckxaZzDBIOPB9CBAQboMt5NwS8UNmfSIkQx4SOlB2Ud3M2s3oXODBlIGwVwBA8GCvVMGpUBCE414WeRJEftY7KW/uGfZR3v0/96PQgAIALkO75jDsc5xUBgCOGxqxa7jwyphphwgcFFQ8hBoBwJa+pTSntnTpyPGjsWXDHAq6gWFyZQuMrxjRoZ4LH4sQXqlsH6TdIIdqw11lhPYjumSH5l/c+TrFLUOH1tfRLzI/Pvb6z1P6eVL7zZ7l7EPpm7t9BAJaFpIkCGj5QlyGwKv4QkAcTt//uUZOwIAqkgRAuZQMBSo3ipc2YYCwRjEM2YbMFAjqJZzYxgY/DLAi7ijMVFCZeZYQGKbMMOYoSxZ02OUDCagGAnA2PFIdBaUQ6kZqW7lOO7n+lFX/b6P16UggIRMkzCpMEEw3UHgEQhQY7ttOUS3DBxEzC1DAeCAuobKQkwZzhV9IpdIC4LGpgcPAEWDYBASZpD6nWRVVw9lRo+ku+u6jU8qhNIXQtYdempRhvpqfpWCELbibZJEcAysdkHBAus8QkSt4XaKGTPpluUbY9zSDs4l0QmFVwR8TXyLjZIWNfxicbAiwIHQ6dYeErwUAn6V2/Ne36Ef//1KgAgGSQACECEOwBJQ8w1L4CMBMnEIvAUOKKmAGRliWFUCQGgJ0oPvoiCglSLEfPxjapaX+NXRKhW6bxKRS7EJTPJ0oEJYyInS2TS/jF5na9P4ZU7mMeM2IkcfNJv2UZE13W8xDf+Q7HBPfyb7t///Q+6gKwLTUgEjDkECkw+JLOVlTZ5Syts//uUZPIBA6RdQqt8GsJJowjKY0MKCthZEM2kbAEhD+NpoI2ICHp0dsljWU0KFmEYzYhexgcMxxoWCpdgqgIFjJBxoSjXD3vf61WZr9H2+76f09jqYuiZPc5UZRn0kpHEAHEgLORVrL/BQFGkZqNBmnVROxqaSsgsWN1mqMn0h+Q+gYxogHQNc1BuQmM7aBKbBxbIgcUpuFDb7XtLOTaGXwr5afMprYb+S/3YunTaw3PIGMxoqYb8PkzJf9P/8i/LIE9djZZAEgr17kAgyM4SOi7dWjUla/ZUeEQKHrLVYk72sPukkyh4CrIaQ7CaqU4ZsIMzJ9J3e21lPzWmargUyNkajFz4/sFRKRlZteyj7igIHNEgB4Tlk/rNxhGEK7hjoWhoD10rJfDzqsRsztBDoyTwlcJkOprE7o6ZZ1a1VR5rUPfvTWTWS8rysl9W2lq96G/s6i7gTQRuRS99TPGSGqdEVE5CUMaTd2VFQSfssga3wSgfW2VMGoFRbKJLYpSH//uUZPEBE4sew0t8SoJE4oi5byMYDi1rCi4kbQDakCNloI2VcuNrnSIzFemcodzRQBTgCMgqKhkc8WQprySXOFLodppSKIKPPiY2YP1mLjqzBYwqIyV/v6BFgjJrY2IUE9MIT7ckOgkNPZbmioQxE0EXCGSAbOOIxVzM2ysHEWyBY0vDRBiMgRHGBZJRb98lqn1nUWX23sJodxSK66JNeaJMFx0VT6l0OcsMIQUY2EKCmJFayEumpIxbaIcoYyemXdEiOYUBMaGLYWFFJOOVGo50cLvKFiYhCQUXJ1Rd03IVNW7QNP30KygoUNooVbwGLtYlCo1wun1dxmoAKMgBKw65AMSaGQOGvgMAcJv8FsmVxrP5QmYvHd6eh2ygcauTCnt6vkJDr1DMKxboKwBwRFB4PoCZchFQ7VQ41jgGwzFhUqmYHQiixdz1WNVe6kgzuXRRvbWIFWAApRACOZlElFBYjCocZRaYUfWEuyZABILhL4UHVGoMDWBgVM02WBTy//uUZO+FkvBTQ4tjE9BZxAhwaMNkCihrEM3kYwFBC2IZjYwopsbhpk6IGMUkWQrB4WyouLC4XjNbjrgC5w9bhe4IjmXAA8hdFy5luuUp7LqwCSWHDa1AwajOSHlcocoe+4/UfYsathK+50LcLvKxINEs2mkKLJow56dastvNJgR2XN3fzHLvbqJzuPR5lmoofSrcMBhb0LAhoHJJ8qCQiSSB924hCKgE8cdBg29b05tjNTmkNYIADPVAEWcE7B2ZtwKFL2eMqUXNKWI1s7OzdBRdKZh3zDOgpguLnD4O1HBgw8sk4ey8sLJQWxtP/tR/R3f6b8eqACWoAMhM+ZQAji/IqFBprtilpnJQoNffyYZn1FhjOYIQuzNPTeufrXdEwk9MLCAaitDhALPUH0hINM8YX2MlWoyDX3OGp7vVEANztd/qyjBYsb7QxnhFsVIHrpuIztzctubt1CjiX7g/+v9e+yj+hAA13MAMBSOBHyTJCZAPr8s2wAi0iux0ioSj//uUZPCJAtEfRDNmG0BXY2iGZ0M0DJSXDS2kzMECiqLlLIxghh4602WmJD4Mh8OB0WAp4FD0QDRzkptRYLigSEln19v7/f/b+xe/6Mu0Yx+CMCPD6g9SDXzMQF844/T2r6B36VjLyjyE0g3zD8pa/cGq77hlFSmiGwpEt4KLiKf8JjJUm5UtuTBqU/Py6b26mnlyIULLBab5zYi8iUVTQvOSetPkzpZGcYlIPKRGwO8OFSIdywIf1AAgP/0gcZs4I/y87Yuaf19+GTSuK2Pru+O7MQC9znmdbox9ZmvdKeRkOPGiIFhq0ijhg9LiLjrnj3udbNVVL9ln+j7u23oR70YAB4RXyDPR0jrAB0maEc5cEVI2l2f/MriM0T0pLXKkDCHySj+dZlY6d3jJXhJ02QMUmhEpasn2TBaTOb5nnNv7cN+8Qs82Nt9YV8bLv1IIy4U5S/m+5ikIG53hqTqQzfJVI//Nja0pyHkmDLorwoFAVuugT2uqKE7XgUoKh7rc//uUZPMJA3knwzNmQ1JEAki5MwMKDVlvCg2YbUEgjeLlgw2gJJlMtzOcXIy8AEMxKPdLDqeaXh6wz7DNXwWx4pIGmEimBh88v+zV/5ffZ/+9RQZqQF9jEKhDEAUdlyCEIqRWUQzaYabZW7tz81u1T2hq/o2QI05O02dBT/Cfd/dGqKCyGZ0EIOpmNtU7NfoJxxqfSLzTH62ZRRwlQpcTRrqcw50hopWwJu1gCplAMEThzAeWkpRMNFrun4PRrkn3y64ptA+ZmKbEsDFELMJrNXkZ5ZIKaRBtiGDkmpmtLIAoU8dSlenaaV1o7mJxaz7nN+qefvoAAEv6QDEx48lJFIaLpkAKNityjh40khqTJfUkd+WyYe9RggbA2VCWT0icrKeJ2GTt31vGxezOUznGBc64q9ZBC2lrOzXb0PonE7EVKUtZE3ds6jeq6tQApVADoWJGbAcP1PxmP170opj5TkHOza1zGg67T1aSFnIo1pxed9r7ru8l2WhBLKhrIrFV//uUZO4AA3pewpNGG3I+I/jJYeMYCyCzEM0YbQEojmJZgw2QHUpQqLQuzMbP7qu5a7+jUZerpR1drLvpohm75Zdmnrs7Wnf2srt7pM1sGrAKcFUFYwOiiaHwm/D3ISy9YxJcjBfQxjdCpwA1jOCdVYjowJ1IiKokOPCTOlyZoxl5/c/pKm3t+893+0jlp23m5bpnzWS3hAyvS+H9pDxfpZbnkZRv7mfP1LzE5a8e1KAViQw6cNvydsSJd+mt4NFEsHH5lWVHMyPkdQhnUNgcBZmigCWQgoxoLKVWBf3M3M3goxIMaEiKxoFL0Jn9UWKGryAtenNvzjBdxxa97KbLKbKaip9nDEZxgTqS5noV68YhocBMNlaBilvHuM/wWJfVxgQcUwI9U37SqQaIkECw6rclcTEZS/Z4ENnNVPRwyGSNHRB6poC+8x48CPmfuP8JbZBZuTEVN4ubtoCVJTGpUNCzY3eq+UvbTigxHen3dhY6cALGoBtBuXkfu3VXfrdt//uUZPOIgrcjxMtYMMBfbDh2ZMJsC9VxDC1kYwFOk2IJjIwouCcko3kWCQuIfNeViVU7vfPHOFowkSdofWOHoJsA69kf+j6WaLfRXW9f7FemakApTc0qHT4nW6jWZ23qcdY1lhY0As+yfb+zL3pKJksO5h2v8xb1gYsotFJKTLsgrW9vZL21yyEbGrrzkf0WzGhQlq3I/3YwZoe7POl24Of8+teoozr+2+Bj/1/JR7XnWLFnt+uBKlckjRRGBuEDDKu1oZLutW8AXM9/nyUqQJI4Z9CzIYm+BS9Tp54s4JDCDS4xpe3N/1dHapokY0oh4r//I754IKMSeVlFhNLMKB7dmjmVgTuyy7D3u5utWMWUu5KZHU3ROWifI658EINLw8gTwjh7HeTYnEBIqqGfZWAaRUyclIzVDEguXMkRni0SWSObEUyNP/FUu6zrMRV9SVCcyLiE+DzCCop5qjM2udNB+dtGOGnDwIQBopEMVLyQbkbxGg3tfSR4HIe7B6nz//uUZO0MA3xawYM7GqI7Q/imYCNoDKyxDExoxoj6jqNo+A1AVWWU4KLWhgeFGnLFMSFhFQWUxwqIAPS7AFbXFvbtayKnUj2j1UvcQldfppOc77qQxapQI6OE3hZf2Oruxq6rshOUmbrFI/292sZZrlp2+31qYIF0WD8RGJUyG/FBlc86TmPAnjMl1BGiIDcOFYJscDZnFOpd6pELkaWRjSU6Z2zy0x+KCv1Fk2kzpZx4S55Qv+XpZgueE+l+NAQBZONJEDloVIiFZH9vi7cXaa5FAyNk0arkolKTcfIcggJCixzzL1sNtPyYbO4o7nEqT/6tC/1e/+jYiiUADQgIKHoXZSgmIckeUYHBR7WLLNu8p6+rWEBFS56efPnSegVXgToGo7Fli5MrN3mUv3wRkjhGMqqVeLdEP3N2lnndkWqCr9Cy0RRQaicjpasBtdTjIacshGrofsX6LGWlRTpmQ1IyvgvB0zsIZbVq7alAPTqnSIuFaXf/LsTAqYXr02Wv//uUZPOIA5pfwgtGG3BHQnipYCNkDUljCy0YbcDvC+Mo8I2gLr1tTc2yCdzYU7Q1XyILcRGkyFKQmLPLxEwWc5XGoHzFdBi39a61s151NGv0KqqonqKtpVgxud+/QRCInYlJ8FIe67WwoDSEsImMGVVnF+NxzytdeGVpHbCc/Yz1/IrNv+p5SnobAnKXu3a0U9CyUyMoTscq+bND3k8yPSebO/Fjzindw/c7jaX4x+UbUjAbLUtGWrqnhdrtf4ZOHoe3q81zshn/IXxAjrEC6vqkmaHTvmf1IZ1bTWiI7/kZradGz7NTS9kVbarelbMjyqiWRW6e5NZjvdkYgXaVorOkkpJ1gjoTIIiLsD0zvMWmdHKO6Fvb4HsMI6rtOsKGQKfz6pV3xNiTQaKjw+HFYiP3jXn+RF0uvYr+cKZc5DProRNTM2QpC3p80zkJ308mLlc9hOa97mR5s+fDM8wZEqkT49IBaoAYFmTDTbLdnOZX5nDLNtJn52FFuyopPHCi//uUZPENw45ewZNJG3JCw8iSYCNkC/VrCgyYbIlJK+GFgYm4TCATCYMBVlb6RQBFzoJtC59R/ALsk1tmpdR6a0Jn415ms424mfeEEDJolJeL3gWxD8GTOghbUglMCZs283kDUIfi+tGSxnex73zWFsbRGoiVzV3W+RSRaLUlDiQN0UhJj14ULPKaZ0pKxdyPZEpERlF+1B3X7MSQKocLhGWYND2EcMZ/KqlVMdyQjqOvYtpnnCO9WpcrmRj2ryoBkq4EL0aP4teCwb6SaWlVOvyreNVE1DtJxgsJIU5oxY4ZWXcZS3PigW4rH8U3KoFrqe04vQy5Q5NL84xtfc8AMqIBwShcS/LiYOFWnhpdYS6OT0Jm7PMOOhBhYMhwYxEKuEmHEoVUAQMiw3C/DfhPzsfnWucK5MbyAmP/4p1yyyKmfzP73B3kIjIjyOtcp5fCPZqZgzwfDOM+ZjZ0LLD1vcYMALVKgYHCYiTAf/t4HSncL+5c+UzSlQbJ5vUNymUN//uUZOuNgv9hwoH5GhJLgsiCPwNQDQ2PCCyYbMEFDKJY8I2QSS+wwPLEwIKEi2pk0H9C1IDDnlGgA4cvF/ktrbZLsYK2MxWvTrpymEBRpQvPpEfal0blbwHEQnjCEZz+bmDgvvsw9qpqfDpA/vnXG1JE1D/kZtmUpJsaczlGex51apHoVbeE5q7ORuUzh06XVO8ngoV2VSzFNTEwNa45GZzzuyoCng2sDodyt//MwV00IBg6zMUPhp75tAWgLq1O0R6WyhxlZhXCsY0K5GhIROVCwgCBDW9q+sm0dtEz2jHDnUqGbx1+t02/fZmjX6a3R/8zd97awbN7Sl1bCbhmn3Je6VXkBvSrVk9KWlDNaiLZDztgSv5fDJd7EL2ZtacNlOs1RSTOsd0pFsc2DBGim+ZKktI4LPWEZyodUvI1DmZM7N+dpUmDFB/iuaGPmwZrEMiEOu5mk2NsvC26ebSfffObEBMPvkZtO2AAECyAB00ew87aStN00sghytfvnPBH//uUZO8IgyBRwrGYGTJFY6iWMeNQDJGLCAyYbMFNkCHI8I2ZMzl0Drd+WkEuKYhBMxHYDCZHFooZ20GBofm8YJIdUtep6B5+Iu1qL3Zs+w4WdsVaFZVDKd7NMBZmRV4HBatiu7rxnAUR+LHI4PD1IBkabbmoKgef7UGFYpnpTqkkYllNS3gpuLfDkUUyKg7nWFmCL0McyIAY2jdQpB1kWsw9crRa4w8dw5ZE7A2Y6/MWPvxmTemJqC83ao8RACmUIK3YbIFf9Ik2cV2Q422J3MQ10jhoobCoOuUWGpYmTGjGOpjW9+fBYMrwzpq2I/aztpZ0ISSJWe+piEkAC9TQClhhHh4HlGJ2bbiDz64adHC0f87F20vNVXST7tre8K3UFBgu0EHy9P7Ls9VRC1f1lIW7ww3ZDUGbhCN6fpu+FKlCRjcuZX2h5tnDpsZJq6nAgJQmCKGa5Qlczdjg+Y5ZsrG0pSUYSREfnBCLKAHenuQ7XHOxVSG4tBIbPprkEhtj//uUZOwNgytdwYMmGzJLg8h5PkNQDWmBBifoZMjXg6Lk0LxYlqYLAg4OIArBjiEPEhcOLsWt7FXqv1s3jQKlldjA9RHG0H7r39lDvsH2rpBa+pB5jKGo4ULwd7Z5s+PhvvfZ+RFUmfkbtzt152uVSAjS9Z9tLB8N7SxT5sGInT+VthR5sFVNA1DTOZ/5HW80aOWnyZXNe/7rfeo/7//0y0Nf6TV3rd9cnC2WWDb6q1wQEJb6VGWg1MDNKsJ4SaIms6SAjrwosa0AB0IHVAo46VD5hLSQeIA9ZbRuFWqakpcpyiA7np9rntOKT3IZ6EusQkWvelSVAASGqkA5abI/P3GS8z5Xcg1bG4SvMxu7bBS9ffkmuQvCUBzIad5+4fCZDWVRCEwdslIYIp4GFktScwO6Qa7LS5KdUiK5WvlEqmX5LxaVK/Mi/5mT/eH+Dk2nacn3coRGRFfxtugi9oFN9Kp8qUtNYi4+9p0Dqq8z5TmqBZ5TrADwlqhFhm4M8sJE//uUZPEIA4NjwZNGG3BBIOiCPM8WDBFpDSwYbYkWA6KkwLxQgvFRAZewazThIuRvVW266hFGoUpWSNqeyVoSitTmd6XaakmIEBWCWRe8Pg37Q1h+MIYjVhimKPNWjOk41qa4Zv3nr293HdtCyjJSx/rNePPxnvLcvD73Dr5OdVrIeMmHaWJQ0mnR/rsnSy/uJ5sJbHAtufbFMZbx7bpd/38b5qdMtt7OUuXK/qWp87xHprxeae/Sj+0kNL/1CUEBE1L2Pm4PA3INcK6j1KpVxq4bkhF3W227OSUmI5oecOE/zx6aEJKX1qgQMq/673ndjjCAEZENe7hrtupVgBnlONIorqnRlfrftmSsA5vqhuRT/Pa9WzjwUD/QOpxrNtQoyUEJgRZNTVuK7nlqEXB1blWRi+n2DniIldB1CWLW4YKmAMGlgBeDikyKJSXYiRUklPef5bX1vVNMVBhgCKl0yZmQ0yBYYTewh1GGKEOTZhmeX3FTISKzZG4D7CZLjp60//uUZPMIgzpeQssmG2JGQziWPCNmDlWHBqfkygEElOKk0I2Ydt9GoCuhsOVQVKrMnYaHyhNCgBYBJrY+HbOzIkbJ1x5paM54VNc2jM2xPG2pHDVWgMtmFYr5VRlCkQoyh3VBXUaM5VuGzMTfkQWMSzNjXjH1s4a/6XLbp8NYpiV0FCpWErSY503hrBQUSBEGdQxqJYjUTdVWRfmpqnZTpNLdhRbampLUO9WR1nmFEnhVpgbDQ9dmX8yh6yQ+fG9S+Zsdyq6FPUr2yVpr1YG+rONs395HxOfHCPSrTrqrwmq6svy3oC+FcuX6TEFNRTMuMTAwqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqgGCAAAGDkWa//uUZPAAAkEaxNGBG0BOKahVGCKuDDmC+qMEcglHpWCkMI7JLDak1VFhrDX8mNYdJYfkzqpH/OmFQdfNXWGrUjZxIYxMYLVz+k0YKgoKTfrD9WjVYaw+aw1+wy/1CoKCoKWeU1RgslhgIIcBDBB1Y1BDgIMSFu+//cq2iDSoIBYAAFAQRrrDY14YVGwxqTVdSjKTO3SY1IMjesZZ0mOrGjKTGvrBQUmNSpcNUauWu1UMTHVjVdUFUo1PXbX+HVh1dSDOJjXNSFVSZGpfDWiRqpIKSokqJElRNgqL7lZMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//uUZLIP8w1Wt8DBGLJfKkcoDENwQAABpAAAACAAADSAAAAEqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq";var Ss={},aL={get exports(){return Ss},set exports(t){Ss=t}},_f={},Es={},wf={},oL=function(t){var r=t.location,e=t.URL;return[r,e].some(function(n){return!n})?function(i){return Promise.reject(new Error("Failed to import: "+i+": dynamicImport is not supported"))}:(t.__twilioVideoImportedModules={},function(i){return i in t.__twilioVideoImportedModules?Promise.resolve(t.__twilioVideoImportedModules[i]):new Function("scope","return import('"+new e(i,r)+"').then(m => scope.__twilioVideoImportedModules['"+i+"'] = m);")(t)})}(globalThis),W1=function(){},Ci="undefined",sL=typeof window!==Ci&&typeof window.navigator!==Ci&&/Trident\/|MSIE /.test(window.navigator.userAgent),uh=["trace","debug","info","warn","error"];function B1(t,r){var e=t[r];if(typeof e.bind=="function")return e.bind(t);try{return Function.prototype.bind.call(e,t)}catch{return function(){return Function.prototype.apply.apply(e,[t,arguments])}}}function uL(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function lL(t){return t==="debug"&&(t="log"),typeof console===Ci?!1:t==="trace"&&sL?uL:console[t]!==void 0?B1(console,t):console.log!==void 0?B1(console,"log"):W1}function Z1(t,r){for(var e=0;e<uh.length;e++){var n=uh[e];this[n]=e<t?W1:this.methodFactory(n,t,r)}this.log=this.debug}function cL(t,r,e){return function(){typeof console!==Ci&&(Z1.call(this,r,e),this[t].apply(this,arguments))}}function fL(t,r,e){return lL(t)||cL.apply(this,arguments)}function q1(t,r,e){var n=this,i,a="loglevel";typeof t=="string"?a+=":"+t:typeof t=="symbol"&&(a=void 0);function o(l){var c=(uh[l]||"silent").toUpperCase();if(!(typeof window===Ci||!a)){try{window.localStorage[a]=c;return}catch{}try{window.document.cookie=encodeURIComponent(a)+"="+c+";"}catch{}}}function s(){var l;if(!(typeof window===Ci||!a)){try{l=window.localStorage[a]}catch{}if(typeof l===Ci)try{var c=window.document.cookie,f=c.indexOf(encodeURIComponent(a)+"=");f!==-1&&(l=/^([^;]+)/.exec(c.slice(f))[1])}catch{}return n.levels[l]===void 0&&(l=void 0),l}}n.name=t,n.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},n.methodFactory=e||fL,n.getLevel=function(){return i},n.setLevel=function(l,c){if(typeof l=="string"&&n.levels[l.toUpperCase()]!==void 0&&(l=n.levels[l.toUpperCase()]),typeof l=="number"&&l>=0&&l<=n.levels.SILENT){if(i=l,c!==!1&&o(l),Z1.call(n,l,t),typeof console===Ci&&l<n.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+l},n.setDefaultLevel=function(l){s()||n.setLevel(l,!1)},n.enableAll=function(l){n.setLevel(n.levels.TRACE,l)},n.disableAll=function(l){n.setLevel(n.levels.SILENT,l)};var u=s();u==null&&(u=r??"WARN"),n.setLevel(u,!1)}var Ri=new q1,lh={};Ri.getLogger=function(r){if(typeof r!="symbol"&&typeof r!="string"||r==="")throw new TypeError("You must supply a name when creating a logger.");var e=lh[r];return e||(e=lh[r]=new q1(r,Ri.getLevel(),Ri.methodFactory)),e};var dL=typeof window!==Ci?window.log:void 0;Ri.noConflict=function(){return typeof window!==Ci&&window.log===Ri&&(window.log=dL),Ri},Ri.getLoggers=function(){return lh},Ri.default=Ri;var Q1=Ri,fr={},pL={get exports(){return fr},set exports(t){fr=t}};const Y1={name:"twilio-video",title:"Twilio Video",description:"Twilio Video JavaScript Library",version:"2.26.2",homepage:"https://twilio.com",author:"Mark Andrus Roberts <mroberts@twilio.com>",contributors:["Ryan Rowland <rrowland@twilio.com>","Manjesh Malavalli <mmalavalli@twilio.com>","Makarand Patwardhan <mpatwardhan@twilio.com>"],keywords:["twilio","webrtc","library","javascript","video","rooms"],repository:{type:"git",url:"https://github.com/twilio/twilio-video.js.git"},devDependencies:{"@babel/core":"^7.14.2","@babel/preset-env":"^7.14.2","@babel/preset-typescript":"^7.13.0","@types/express":"^4.11.0","@types/node":"^8.5.1","@types/selenium-webdriver":"^3.0.8","@types/ws":"^3.2.1","@typescript-eslint/eslint-plugin":"^4.13.0","@typescript-eslint/parser":"^4.0.0","babel-cli":"^6.26.0","babel-preset-es2015":"^6.24.1",browserify:"^17.0.0",cheerio:"^0.22.0",cors:"^2.8.5",electron:"^17.2.0",envify:"^4.0.0",eslint:"^6.2.1","eslint-config-standard":"^14.0.0","eslint-plugin-import":"^2.18.2","eslint-plugin-node":"^9.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.1",express:"^4.16.2",glob:"^7.1.7","ink-docstrap":"^1.3.2",inquirer:"^7.0.0","is-docker":"^2.0.0",jsdoc:"^3.5.5","jsdoc-babel":"^0.5.0","json-loader":"^0.5.7",karma:"6.4.1","karma-browserify":"^8.0.0","karma-chrome-launcher":"^2.0.0","karma-edgium-launcher":"^4.0.0-0","karma-electron":"^6.1.0","karma-firefox-launcher":"^1.3.0","karma-htmlfile-reporter":"^0.3.8","karma-junit-reporter":"^1.2.0","karma-mocha":"^1.3.0","karma-safari-launcher":"^1.0.0","karma-spec-reporter":"0.0.32","karma-typescript":"^5.5.1","karma-typescript-es6-transform":"^5.5.1",mocha:"^3.2.0","mock-require":"^3.0.3",ncp:"^2.0.0","node-http-server":"^8.1.2","npm-run-all":"^4.0.2",nyc:"^15.1.0",requirejs:"^2.3.3",rimraf:"^2.6.1","simple-git":"^1.126.0",sinon:"^4.0.1","ts-node":"4.0.1",tslint:"5.8.0",twilio:"^3.49.0","twilio-release-tool":"^1.0.2",typescript:"4.2.2","uglify-js":"^2.8.22","vinyl-fs":"^2.4.4","vinyl-source-stream":"^1.1.0",watchify:"^3.11.1","webrtc-adapter":"^7.7.1"},engines:{node:">=0.12"},license:"BSD-3-Clause",main:"./es5/index.js",types:"./tsdef/index.d.ts",scripts:{"lint:js":"eslint ./lib ./test/*.js ./docker/**/*.js ./test/framework/*.js ./test/lib/*.js ./test/integration/** ./test/unit/** ","lint:ts":"eslint ./tsdef/*.ts ./lib/**/*.ts",lint:"npm-run-all lint:js lint:ts",printVersion:"node --version && npm --version","test:unit":"npm-run-all printVersion build:es5 && nyc --report-dir=./coverage --include=lib/**/* --reporter=html --reporter=lcov --reporter=text mocha -r ts-node/register ./test/unit/*","test:unit:quick":"nyc --report-dir=./coverage --include=lib/**/* --reporter=html --reporter=lcov mocha -r ts-node/register","test:serversiderender":"mocha ./test/serversiderender/index.js","test:integration:adapter":"node ./scripts/karma.js karma/integration.adapter.conf.js","test:integration":"npm run build:es5 && node ./scripts/karma.js karma/integration.conf.js","test:umd:install":"npm install puppeteer@19.2.2","test:umd":"mocha ./test/umd/index.js","test:crossbrowser:build:clean":"rimraf ./test/crossbrowser/lib ./test/crossbrowser/src/browser/index.js","test:crossbrowser:build:lint":"cd ./test/crossbrowser && tslint --project tsconfig.json","test:crossbrowser:build:tsc":"cd ./test/crossbrowser && tsc","test:crossbrowser:build:browser":"cd ./test/crossbrowser && browserify lib/crossbrowser/src/browser/index.js > src/browser/index.js","test:crossbrowser:build":"npm-run-all test:crossbrowser:build:*","test:crossbrowser:test":"cd ./test/crossbrowser && mocha --compilers ts:ts-node/register test/integration/spec/**/*.ts","test:crossbrowser":"npm-run-all test:crossbrowser:*","test:sdkdriver:build:clean":"rimraf ./test/lib/sdkdriver/lib ./test/lib/sdkdriver/test/integration/browser/index.js","test:sdkdriver:build:lint":"cd ./test/lib/sdkdriver && tslint --project tsconfig.json","test:sdkdriver:build:tsc":"cd ./test/lib/sdkdriver && tsc --rootDir src","test:sdkdriver:build":"npm-run-all test:sdkdriver:build:*","test:sdkdriver:test:unit":"cd ./test/lib/sdkdriver && mocha --compilers ts:ts-node/register test/unit/spec/**/*.ts","test:sdkdriver:test:integration:browser":"cd ./test/lib/sdkdriver/test/integration && browserify browser/browser.js > browser/index.js","test:sdkdriver:test:integration:run":"cd ./test/lib/sdkdriver && mocha --compilers ts:ts-node/register test/integration/spec/**/*.ts","test:sdkdriver:test:integration":"npm-run-all test:sdkdriver:test:integration:*","test:sdkdriver:test":"npm-run-all test:sdkdriver:test:*","test:sdkdriver":"npm-run-all test:sdkdriver:*","test:framework:angular:install":"cd ./test/framework/twilio-video-angular && rimraf ./node_modules package-lock.json && npm install","test:framework:angular:run":"mocha ./test/framework/twilio-video-angular.js","test:framework:angular":"npm-run-all test:framework:angular:*","test:framework:no-framework:run":"mocha ./test/framework/twilio-video-no-framework.js","test:framework:no-framework":"npm-run-all test:framework:no-framework:*","test:framework:react:install":"cd ./test/framework/twilio-video-react && rimraf ./node_modules package-lock.json && npm install","test:framework:react:test":"node ./scripts/framework.js twilio-video-react","test:framework:react:build":"cd ./test/framework/twilio-video-react && npm run build","test:framework:react:run":"mocha ./test/framework/twilio-video-react.js","test:framework:react":"npm-run-all test:framework:react:*","test:framework:install":"npm install chromedriver && npm install selenium-webdriver && npm install geckodriver && npm install puppeteer","test:framework":"npm-run-all test:framework:install test:framework:no-framework test:framework:react",test:"npm-run-all test:unit test:integration","build:es5":"rimraf ./es5 && mkdir -p es5 && tsc tsdef/twilio-video-tests.ts --noEmit --lib es2018,dom && tsc","build:js":"node ./scripts/build.js ./src/twilio-video.js ./LICENSE.md ./dist/twilio-video.js","build:min.js":'uglifyjs ./dist/twilio-video.js -o ./dist/twilio-video.min.js --comments "/^! twilio-video.js/" -b beautify=false,ascii_only=true',build:"npm-run-all clean lint docs test:unit test:integration build:es5 build:js build:min.js test:umd","build:quick":"npm-run-all clean lint docs build:es5 build:js build:min.js",docs:"node ./scripts/docs.js ./dist/docs",watch:"tsc -w",clean:"rimraf ./coverage ./es5 ./dist"},dependencies:{events:"^3.3.0",util:"^0.12.4",ws:"^7.4.6",xmlhttprequest:"^1.8.0"},browser:{ws:"./src/ws.js",xmlhttprequest:"./src/xmlhttprequest.js"}};(function(t){var r=Y1;t.exports.SDK_NAME=r.name+".js",t.exports.SDK_VERSION=r.version,t.exports.SDP_FORMAT="unified",t.exports.hardwareDevicePublisheriPad={hwDeviceManufacturer:"Apple",hwDeviceModel:"iPad",hwDeviceType:"tablet",platformName:"iOS"},t.exports.hardwareDevicePublisheriPhone={hwDeviceManufacturer:"Apple",hwDeviceModel:"iPhone",hwDeviceType:"mobile",platformName:"iOS"},t.exports.DEFAULT_ENVIRONMENT="prod",t.exports.DEFAULT_REALM="us1",t.exports.DEFAULT_REGION="gll",t.exports.DEFAULT_LOG_LEVEL="warn",t.exports.DEFAULT_LOGGER_NAME="twilio-video",t.exports.WS_SERVER=function(n,i){return i=i==="gll"?"global":encodeURIComponent(i),n==="prod"?"wss://"+i+".vss.twilio.com/signaling":"wss://"+i+".vss."+n+".twilio.com/signaling"},t.exports.PUBLISH_MAX_ATTEMPTS=5,t.exports.PUBLISH_BACKOFF_JITTER=10,t.exports.PUBLISH_BACKOFF_MS=20;function e(n){return["a","e","i","o","u"].includes(n.toLowerCase()[0])?"an":"a"}t.exports.typeErrors={ILLEGAL_INVOKE:function(n,i){return new TypeError("Illegal call to "+n+": "+i)},INVALID_TYPE:function(n,i){return new TypeError(n+" must be "+e(i)+" "+i)},INVALID_VALUE:function(n,i){return new RangeError(n+" must be one of "+i.join(", "))},REQUIRED_ARGUMENT:function(n){return new TypeError(n+" must be specified")}},t.exports.DEFAULT_FRAME_RATE=24,t.exports.DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS=1e4,t.exports.DEFAULT_ICE_GATHERING_TIMEOUT_MS=15e3,t.exports.DEFAULT_SESSION_TIMEOUT_SEC=30,t.exports.DEFAULT_NQ_LEVEL_LOCAL=1,t.exports.DEFAULT_NQ_LEVEL_REMOTE=0,t.exports.MAX_NQ_LEVEL=3,t.exports.ICE_ACTIVITY_CHECK_PERIOD_MS=1e3,t.exports.ICE_INACTIVITY_THRESHOLD_MS=3e3,t.exports.iceRestartBackoffConfig={factor:1.1,min:1,max:t.exports.DEFAULT_SESSION_TIMEOUT_SEC*1e3,jitter:1},t.exports.reconnectBackoffConfig={factor:1.5,min:80,jitter:1},t.exports.subscriptionMode={MODE_COLLABORATION:"collaboration",MODE_GRID:"grid",MODE_PRESENTATION:"presentation"},t.exports.trackSwitchOffMode={MODE_DISABLED:"disabled",MODE_DETECTED:"detected",MODE_PREDICTED:"predicted"},t.exports.trackPriority={PRIORITY_HIGH:"high",PRIORITY_LOW:"low",PRIORITY_STANDARD:"standard"},t.exports.clientTrackSwitchOffControl={MODE_AUTO:"auto",MODE_MANUAL:"manual"},t.exports.videoContentPreferencesMode={MODE_AUTO:"auto",MODE_MANUAL:"manual"}})(pL);var vL=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},hL=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},mL=Q1.getLogger,G1=fr,H1=G1.DEFAULT_LOG_LEVEL,gL=G1.DEFAULT_LOGGER_NAME,kf=fr.typeErrors,nl;function yL(t){if(nl=nl||new Map,nl.has(t))return nl.get(t);var r=new Set;return nl.set(t,r),r}var ch=function(){function t(r,e,n,i,a){if(typeof r!="string")throw kf.INVALID_TYPE("moduleName","string");if(!e)throw kf.REQUIRED_ARGUMENT("component");typeof n!="object"&&(n={}),a=a||mL,ew(n),Object.defineProperties(this,{_component:{value:e},_logLevels:{value:n},_warnings:{value:new Set},_loggerName:{get:function(){var s=i&&typeof i=="string"?i:gL;return this._logLevelsEqual||(s=s+"-"+r),s}},_logger:{get:function(){var s=a(this._loggerName),u=this._logLevels[r]||H1;return u=u==="off"?"silent":u,s.setDefaultLevel(u),s}},_logLevelsEqual:{get:function(){return new Set(Object.values(this._logLevels)).size===1}},logLevel:{get:function(){return t.getLevelByName(n[r]||H1)}},name:{get:e.toString.bind(e)}})}return t.getLevelByName=function(r){return isNaN(r)?(r=r.toUpperCase(),K1(r),t[r]):parseInt(r,10)},t.prototype.createLog=function(r,e){var n=this._loggerName;return this._logLevelsEqual||(n=n.substring(0,n.lastIndexOf("-"))),new t(r,e,this._logLevels,n)},t.prototype.setLevels=function(r){return ew(r),Object.assign(this._logLevels,r),this},t.prototype.log=function(r,e){var n=t._levels[r];if(!n)throw kf.INVALID_VALUE("logLevel",X1);n=n.toLowerCase();var i=[new Date().toISOString(),n,this.name];return(this._logger[n]||function(){}).apply(void 0,hL([],vL(i.concat(e)))),this},t.prototype.debug=function(){return this.log(t.DEBUG,[].slice.call(arguments))},t.prototype.deprecated=function(r){var e=yL(this._component.constructor);return e.has(r)?this:(e.add(r),this.warn(r))},t.prototype.info=function(){return this.log(t.INFO,[].slice.call(arguments))},t.prototype.warn=function(){return this.log(t.WARN,[].slice.call(arguments))},t.prototype.warnOnce=function(r){return this._warnings.has(r)?this:(this._warnings.add(r),this.warn(r))},t.prototype.error=function(){return this.log(t.ERROR,[].slice.call(arguments))},t.prototype.throw=function(r,e){throw r.clone&&(r=r.clone(e)),this.log(t.ERROR,r),r},t}();Object.defineProperties(ch,{DEBUG:{value:0},INFO:{value:1},WARN:{value:2},ERROR:{value:3},OFF:{value:4},_levels:{value:["DEBUG","INFO","WARN","ERROR","OFF"]}});var J1={},X1=[],bL=ch._levels.map(function(t,r){return J1[t]=!0,X1.push(r),t});function K1(t){if(!(t in J1))throw kf.INVALID_VALUE("level",bL)}function ew(t){Object.keys(t).forEach(function(r){K1(t[r].toUpperCase())})}var na=ch,_L=V&&V.__awaiter||function(t,r,e,n){function i(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function s(c){try{l(n.next(c))}catch(f){o(f)}}function u(c){try{l(n.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((n=n.apply(t,r||[])).next())})},wL=V&&V.__generator||function(t,r){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){e.label=l[1];break}if(l[0]===6&&e.label<a[1]){e.label=a[1],a=l;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(l);break}a[2]&&e.ops.pop(),e.trys.pop();continue}l=r.call(t,e)}catch(c){l=[6,c],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(wf,"__esModule",{value:!0}),wf.createNoiseCancellationAudioProcessor=void 0;var kL=oL,TL={krisp:{supportedVersion:"1.0.0",pluginFile:"krispsdk.mjs"},rnnoise:{supportedVersion:"0.6.0",pluginFile:"rnnoise_sdk.mjs"}},SL=function(t){var r=t.supportedVersion,e=t.plugin,n=t.log;if(!e.getVersion||!e.isSupported)throw new Error("Plugin does not export getVersion/isSupported api. Are you using old version of the plugin ?");var i=e.getVersion();n.debug("Plugin Version = "+i);var a=r.split(".").map(function(l){return Number(l)}),o=i.split(".").map(function(l){return Number(l)});if(a.length!==3||o.length!==3)throw new Error("Unsupported Plugin version format: "+r+", "+i);if(a[0]!==o[0])throw new Error("Major version mismatch: [Plugin version "+i+"],  [Supported Version "+r+"]");if(o[1]<a[1])throw new Error("Minor version mismatch: [Plugin version "+i+"] < [Supported Version "+r+"]");var s=new AudioContext,u=e.isSupported(s);if(s.close(),!u)throw new Error("Noise Cancellation plugin is not supported on your browser")},tw=new Map;function EL(t,r){return _L(this,void 0,void 0,function(){var e,n,i,a,o,s,u,l,c;return wL(this,function(f){switch(f.label){case 0:if(e=tw.get(t.vendor),e)return[3,6];if(n=TL[t.vendor],!n)throw new Error("Unsupported NoiseCancellationOptions.vendor: "+t.vendor);i=n.supportedVersion,a=n.pluginFile,o=t.sdkAssetsPath,s=o+"/"+a,f.label=1;case 1:return f.trys.push([1,5,,6]),r.debug("loading noise cancellation sdk: ",s),[4,kL(s)];case 2:return u=f.sent(),r.debug("Loaded noise cancellation sdk:",u),l=u.default,SL({supportedVersion:i,plugin:l,log:r}),l.isInitialized()?[3,4]:(r.debug("initializing noise cancellation sdk: ",o),[4,l.init({rootDir:o})]);case 3:f.sent(),r.debug("noise cancellation sdk initialized!"),f.label=4;case 4:return e={vendor:t.vendor,isInitialized:function(){return l.isInitialized()},isConnected:function(){return l.isConnected()},isEnabled:function(){return l.isEnabled()},disconnect:function(){return l.disconnect()},enable:function(){return l.enable()},disable:function(){return l.disable()},destroy:function(){return l.destroy()},setLogging:function(d){return l.setLogging(d)},connect:function(d){r.debug("connect: ",d.id),l.isConnected()&&l.disconnect();var v=l.connect(new MediaStream([d]));if(!v)throw new Error("Error connecting with noise cancellation sdk");var p=v.getAudioTracks()[0];if(!p)throw new Error("Error getting clean track from noise cancellation sdk");return l.enable(),p}},tw.set(t.vendor,e),[3,6];case 5:throw c=f.sent(),r.error("Error loading noise cancellation sdk:"+s,c),c;case 6:return[2,e]}})})}wf.createNoiseCancellationAudioProcessor=EL;var rw=V&&V.__awaiter||function(t,r,e,n){function i(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function s(c){try{l(n.next(c))}catch(f){o(f)}}function u(c){try{l(n.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((n=n.apply(t,r||[])).next())})},nw=V&&V.__generator||function(t,r){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){e.label=l[1];break}if(l[0]===6&&e.label<a[1]){e.label=a[1],a=l;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(l);break}a[2]&&e.ops.pop(),e.trys.pop();continue}l=r.call(t,e)}catch(c){l=[6,c],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Es,"__esModule",{value:!0}),Es.applyNoiseCancellation=Es.NoiseCancellationImpl=void 0;var ML=wf,iw=function(){function t(r,e){this._processor=r,this._sourceTrack=e,this._disabledPermanent=!1}return Object.defineProperty(t.prototype,"vendor",{get:function(){return this._processor.vendor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceTrack",{get:function(){return this._sourceTrack},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._processor.isEnabled()},enumerable:!1,configurable:!0}),t.prototype.enable=function(){if(this._disabledPermanent)throw new Error(this.vendor+" noise cancellation is disabled permanently for this track");return this._processor.enable(),Promise.resolve()},t.prototype.disable=function(){return this._processor.disable(),Promise.resolve()},t.prototype.reacquireTrack=function(r){return rw(this,void 0,void 0,function(){var e,n,i;return nw(this,function(a){switch(a.label){case 0:return e=this._processor.isEnabled(),this._processor.disconnect(),[4,r()];case 1:return n=a.sent(),this._sourceTrack=n,[4,this._processor.connect(n)];case 2:return i=a.sent(),e?this._processor.enable():this._processor.disable(),[2,i]}})})},t.prototype.disablePermanently=function(){return this._disabledPermanent=!0,this.disable()},t.prototype.stop=function(){this._processor.disconnect(),this._sourceTrack.stop()},t}();Es.NoiseCancellationImpl=iw;function CL(t,r,e){return rw(this,void 0,void 0,function(){var n,i,a,o;return nw(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,ML.createNoiseCancellationAudioProcessor(r,e)];case 1:return n=s.sent(),i=n.connect(t),a=new iw(n,t),[2,{cleanTrack:i,noiseCancellation:a}];case 2:return o=s.sent(),e.warn("Failed to create noise cancellation. Returning normal audio track: "+o),[2,{cleanTrack:t}];case 3:return[2]}})})}Es.applyNoiseCancellation=CL;var at={},hr={},aw=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},RL=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t};function IL(){var t={};return t.promise=new Promise(function(r,e){t.resolve=r,t.reject=e}),t}function OL(t,r,e,n){if(!(n in r)&&!n.match(/^on[a-z]+$/)){var i=!1;try{var a=Object.getOwnPropertyDescriptor(t,n);i=a&&!!a.get}catch{}if(!i){var o;try{o=typeof t[n]}catch{}o==="function"&&(r[n]=function(){return this[e][n].apply(this[e],arguments)})}}}function NL(t,r,e){for(var n in t)OL(t,r,e,n)}function AL(t,r){t=Array.isArray(t)?new Set(t):new Set(t.values()),r=Array.isArray(r)?new Set(r):new Set(r.values());var e=new Set;return t.forEach(function(n){r.has(n)||e.add(n)}),e}function PL(t,r){var e=t instanceof Map||t instanceof Set?Array.from(t.values()):t;return e.reduce(function(n,i){return n.concat(r(i))},[])}function fh(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:null}function dh(t){return typeof t>"u"&&(t=fh()),/Chrome|CriOS/.test(t)?"chrome":/Firefox|FxiOS/.test(t)?"firefox":/Safari|iPhone|iPad|iPod/.test(t)?"safari":null}function xL(t){typeof t>"u"&&(t=fh());var r={chrome:"Chrome|CriOS",firefox:"Firefox|FxiOS",safari:"Version"}[dh(t)];if(!r)return null;var e=new RegExp("("+r+")/([^\\s]+)"),n=aw(t.match(e)||[],3),i=n[2];if(!i)return null;var a=i.split(".").map(Number);return{major:isNaN(a[0])?null:a[0],minor:isNaN(a[1])?null:a[1]}}function DL(t){return typeof t>"u"&&(t=fh()),/Mobi/.test(t)&&dh()==="chrome"&&/iPad|iPhone|iPod/.test(t)}function LL(t,r){var e=null;Object.defineProperty(t,"on"+r,{get:function(){return e},set:function(n){e&&this.removeEventListener(r,e),typeof n=="function"?(e=n,this.addEventListener(r,e)):e=null}})}function UL(t,r,e){return r?t.then(r,e):t}function jL(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=Math.random()*16|0,e=t==="x"?r:r&3|8;return e.toString(16)})}function VL(t,r,e){Object.getOwnPropertyNames(t).forEach(function(n){FL(t,r,e,n)})}function FL(t,r,e,n){if(!(n in r)){if(n.match(/^on[a-z]+$/)){Object.defineProperty(r,n,{value:null,writable:!0}),e.addEventListener(n.slice(2),function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return r.dispatchEvent.apply(r,RL([],aw(i)))});return}Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[n]}})}}function $L(){return typeof navigator=="object"&&typeof navigator.mediaDevices=="object"&&typeof navigator.mediaDevices.getUserMedia=="function"&&typeof RTCPeerConnection=="function"}function zL(t){if(typeof RTCRtpSender<"u"&&typeof RTCRtpSender.getCapabilities=="function")return Promise.resolve(new Set(RTCRtpSender.getCapabilities(t).codecs.map(function(e){var n=e.mimeType;return n.split("/")[1].toLowerCase()})));if(typeof RTCPeerConnection>"u"||typeof RTCPeerConnection.prototype>"u"||typeof RTCPeerConnection.prototype.addTransceiver!="function"||typeof RTCPeerConnection.prototype.close!="function"||typeof RTCPeerConnection.prototype.createOffer!="function")return Promise.resolve(new Set);var r=new RTCPeerConnection;return r.addTransceiver(t),r.createOffer().then(function(e){var n=e.sdp;return r.close(),new Set((n.match(/^a=rtpmap:.+$/gm)||[]).map(function(i){return i.match(/^a=rtpmap:.+ ([^/]+)/)[1].toLowerCase()}))},function(){return r.close(),new Set})}var ph=new Map;function WL(t,r){var e=ph.get(r);return e?Promise.resolve(e.has(t.toLowerCase())):zL(r).then(function(n){return ph.set(r,n),n.has(t.toLowerCase())})}function BL(){ph.clear()}hr.clearCachedSupportedCodecs=BL,hr.defer=IL,hr.delegateMethods=NL,hr.difference=AL,hr.flatMap=PL,hr.guessBrowser=dh,hr.guessBrowserVersion=xL,hr.isCodecSupported=WL,hr.isIOSChrome=DL,hr.interceptEvent=LL,hr.legacyPromise=UL,hr.makeUUID=jL,hr.proxyProperties=VL,hr.support=$L;var Tf={},ow="1234567890abcdef",ZL=32;function sw(t){for(var r="",e=0;e<ZL;e++)r+=ow.charAt(Math.floor(Math.random()*ow.length));return""+t+r}Tf.sessionSID=sw("SS"),Tf.createSID=sw;var qL={recordingMediaLost:"recording-media-lost"},uw=qL,QL=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),gn=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},Co=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},vh=fr,YL=vh.typeErrors,hh=vh.trackPriority,GL=hr,HL=Tf.sessionSID,JL=uw;function XL(t,r){if(t instanceof r.LocalAudioTrack||t instanceof r.LocalVideoTrack||t instanceof r.LocalDataTrack)return t;if(t instanceof r.MediaStreamTrack)return t.kind==="audio"?new r.LocalAudioTrack(t,r):new r.LocalVideoTrack(t,r);throw YL.INVALID_TYPE("track","LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack")}function KL(t,r,e,n){var i={audio:n.LocalAudioTrackPublication,video:n.LocalVideoTrackPublication,data:n.LocalDataTrackPublication}[t.kind];return new i(r,t,e,n)}function eU(t){return t[0].toUpperCase()+t.slice(1)}function tU(t,r,e,n){var i=new Set;r.on("newListener",function a(o){e.has(o)&&!i.has(o)&&(n.deprecated(t+"#"+o+" has been deprecated and scheduled for removal in twilio-video.js@2.0.0."+(e.get(o)?" Use "+t+"#"+e.get(o)+" instead.":"")),i.add(o)),i.size>=e.size&&r.removeListener("newListener",a)})}function rU(t,r){t=Array.isArray(t)?new Set(t):new Set(t.values()),r=Array.isArray(r)?new Set(r):new Set(r.values());var e=new Set;return t.forEach(function(n){r.has(n)||e.add(n)}),e}function nU(t,r){return Object.keys(t).reduce(function(e,n){return t[n]!==r&&(e[n]=t[n]),e},{})}function iU(t,r){var e=t instanceof Map||t instanceof Set?Array.from(t.values()):t;return r=r||function(i){return i},e.reduce(function(n,i){var a=r(i);return n.concat(a)},[])}function lw(){return typeof navigator<"u"&&navigator.userAgent?navigator.userAgent:"Unknown"}function aU(){var t=lw(),r=gn(t.match(/\(([^)]+)\)/)||[],2),e=r[1],n=e===void 0?"unknown":e,i=gn(n.split(";").map(function(o){return o.trim()}),1),a=i[0];return a.toLowerCase()}function oU(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=Math.random()*16|0,e=t==="x"?r:r&3|8;return e.toString(16)})}function sU(t){var r=null;function e(){r=null,t()}return function(){r&&clearTimeout(r),r=setTimeout(e)}}function uU(t,r,e,n){return new Promise(function(i,a){function o(){var u=[].slice.call(arguments);n&&r.removeListener(n,s),i.apply(void 0,Co([],gn(u)))}function s(){var u=[].slice.call(arguments);r.removeListener(e,o),a.apply(void 0,Co([],gn(u)))}r.once(e,o),n&&r.once(n,s),t()})}function lU(t,r){return r.split(".").reduce(function(e,n){return e?e[n]:null},t)}function cU(){var t={};return t.promise=new Promise(function(r,e){t.resolve=r,t.reject=e}),t}function fU(t,r,e,n){if(!(n in r)&&!n.match(/^on[a-z]+$/)){var i;try{i=typeof t[n]}catch{}i==="function"&&(r[n]=function(){for(var a,o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return(a=this[e])[n].apply(a,Co([],gn(o)))})}}function dU(t,r,e){for(var n in t)fU(t,r,e,n)}function Sf(t,r){if(t===r)return!0;if(typeof t!=typeof r)return!1;if(t===null)return r===null;if(r===null)return!1;if(Array.isArray(t))return Array.isArray(r)&&t.length===r.length&&t.every(function(i,a){return Sf(i,r[a])});if(typeof t=="object"){var e=Object.keys(t).sort(),n=Object.keys(r).sort();return!Array.isArray(r)&&Sf(e,n)&&e.every(function(i){return Sf(t[i],r[i])})}return!1}function cw(t){return typeof t=="object"&&!Array.isArray(t)}function pU(t,r,e){Object.getOwnPropertyNames(t).forEach(function(n){vU(t,r,e,n)})}function vU(t,r,e,n){if(!(n in r)){if(n.match(/^on[a-z]+$/)){Object.defineProperty(r,n,{value:null,writable:!0}),e.addEventListener(n.slice(2),function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];r.dispatchEvent.apply(r,Co([],gn(i)))});return}Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[n]}})}}function hU(t,r,e){return r?t.then(function(n){r(n)},function(n){e(n)}):t}function mU(t){return typeof t=="string"?{default:t,media:t,signaling:t,webrtc:t}:t}function gU(t,r){return r=r?"Local":"",r+(t.kind||"").replace(/\w{1}/,function(e){return e.toUpperCase()})+"Track"}function yU(t,r){return r=r?"Local":"",r+(t.kind||"").replace(/\w{1}/,function(e){return e.toUpperCase()})+"TrackPublication"}function fw(t){Object.getOwnPropertyNames(t).forEach(function(r){r.startsWith("_")&&dw(t,r)})}function bU(t,r){return function(e){QL(n,e);function n(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=e.apply(this,Co([],gn(i)))||this;return fw(o),_U(o,r),o}return n}(t)}function dw(t,r){var e=Object.getOwnPropertyDescriptor(t,r);e.enumerable=!1,Object.defineProperty(t,r,e)}function _U(t,r){r===void 0&&(r=[]),r.forEach(function(e){t.hasOwnProperty(e)&&dw(t,e)})}function pw(t){return t.map(Ef)}function wU(t){return pw(Co([],gn(t)))}function kU(t){return Co([],gn(t.entries())).reduce(function(r,e){var n,i=gn(e,2),a=i[0],o=i[1];return Object.assign((n={},n[a]=Ef(o),n),r)},{})}function TU(t){return Object.entries(t).reduce(function(r,e){var n,i=gn(e,2),a=i[0],o=i[1];return Object.assign((n={},n[a]=Ef(o),n),r)},{})}function Ef(t){return Array.isArray(t)?pw(t):t instanceof Set?wU(t):t instanceof Map?kU(t):t&&typeof t=="object"?TU(t):t}function SU(t){function r(i){return i?"true":"false"}var e={sessionSID:HL,iceServers:(t.iceServers||[]).length,audioTracks:(t.tracks||[]).filter(function(i){return i.kind==="audio"}).length,videoTracks:(t.tracks||[]).filter(function(i){return i.kind==="video"}).length,dataTracks:(t.tracks||[]).filter(function(i){return i.kind==="data"}).length};if([["audio"],["automaticSubscription"],["enableDscp"],["eventListener"],["preflight"],["video"],["dominantSpeaker","enableDominantSpeaker"]].forEach(function(i){var a=gn(i,2),o=a[0],s=a[1];s=s||o,e[s]=r(!!t[o])}),[["maxVideoBitrate"],["maxAudioBitrate"]].forEach(function(i){var a=gn(i,2),o=a[0],s=a[1];s=s||o,typeof t[o]=="number"?e[s]=t[o]:isNaN(Number(t[o]))||(e[s]=Number(t[o]))}),[["iceTransportPolicy"],["region"],["name","roomName"]].forEach(function(i){var a=gn(i,2),o=a[0],s=a[1];s=s||o,typeof t[o]=="string"?e[s]=t[o]:typeof t[o]=="number"&&o==="name"&&(e[s]=t[o].toString())}),["preferredAudioCodecs","preferredVideoCodecs"].forEach(function(i){i in t&&(e[i]=JSON.stringify(t[i]))}),"networkQuality"in t&&(e.networkQualityConfiguration={},cw(t.networkQuality)?["local","remote"].forEach(function(i){typeof t.networkQuality[i]=="number"&&(e.networkQualityConfiguration[i]=t.networkQuality[i])}):(e.networkQualityConfiguration.remote=0,e.networkQualityConfiguration.local=t.networkQuality?1:0)),t.bandwidthProfile&&t.bandwidthProfile.video){var n=t.bandwidthProfile.video||{};e.bandwidthProfileOptions={},["mode","maxTracks","trackSwitchOffMode","dominantSpeakerPriority","maxSubscriptionBitrate","renderDimensions","contentPreferencesMode","clientTrackSwitchOffControl"].forEach(function(i){typeof n[i]=="number"||typeof n[i]=="string"?e.bandwidthProfileOptions[i]=n[i]:typeof n[i]=="boolean"?e.bandwidthProfileOptions[i]=r(n[i]):typeof n[i]=="object"&&(e.bandwidthProfileOptions[i]=JSON.stringify(n[i]))})}return{group:"room",name:"connect",level:"info",payload:e}}function EU(t){return Mf(t,[{prop:"video",type:"object",transform:MU}])}function MU(t){return Mf(t,[{prop:"dominantSpeakerPriority",type:"string",payloadProp:"active_speaker_priority"},{prop:"maxSubscriptionBitrate",type:"number",payloadProp:"max_subscription_bandwidth"},{prop:"maxTracks",type:"number",payloadProp:"max_tracks"},{prop:"mode",type:"string"},{prop:"renderDimensions",type:"object",payloadProp:"render_dimensions",transform:RU},{prop:"trackSwitchOffMode",type:"string",payloadProp:"track_switch_off"}])}function CU(t,r,e,n,i,a){var o={transports:[{type:"data-channel"}]};return Object.assign(t?{active_speaker:o}:{},r?{network_quality:o}:{},a?{render_hints:o}:{},i?{publisher_hints:o}:{},e?{track_priority:o}:{},n?{track_switch_off:o}:{})}function mh(t){return Mf(t,[{prop:"height",type:"number"},{prop:"width",type:"number"}])}function RU(t){var r=hh.PRIORITY_HIGH,e=hh.PRIORITY_LOW,n=hh.PRIORITY_STANDARD;return Mf(t,[{prop:r,type:"object",transform:mh},{prop:e,type:"object",transform:mh},{prop:n,type:"object",transform:mh}])}function Mf(t,r){return r.reduce(function(e,n){var i,a=n.prop,o=n.type,s=n.payloadProp,u=s===void 0?a:s,l=n.transform,c=l===void 0?function(f){return f}:l;return typeof t[a]===o?Object.assign((i={},i[u]=c(t[a]),i),e):e},{})}function IU(t){return{rules:[{type:t?"include":"exclude",all:!0}],revision:1}}function OU(t){var r,e=(r={},r[JL.recordingMediaLost]="recordings",r);return t.map(function(n){return e[n]}).filter(function(n){return!!n})}function NU(t,r){var e=Math.random();return t-r+Math.floor(2*r*e+.5)}function AU(t,r,e){return r<=t&&t<=e}function PU(t){return GL.guessBrowser()==="chrome"&&t.kind==="video"&&"displaySurface"in t.getSettings()}function xU(t){return typeof t.getSettings().deviceId=="string"}function DU(t){return t===void 0&&(t=10),new Promise(function(r){return setTimeout(r,t)})}function LU(t,r){return new Promise(function(e){t.addEventListener(r,function n(i){t.removeEventListener(r,n),e(i)})})}at.constants=vh,at.createBandwidthProfilePayload=EU,at.createMediaSignalingPayload=CU,at.createMediaWarningsPayload=OU,at.createRoomConnectEventPayload=SU,at.createSubscribePayload=IU,at.asLocalTrack=XL,at.asLocalTrackPublication=KL,at.capitalize=eU,at.deprecateEvents=tU,at.difference=rU,at.filterObject=nU,at.flatMap=iU,at.getPlatform=aU,at.getUserAgent=lw,at.hidePrivateProperties=fw,at.hidePrivateAndCertainPublicPropertiesInClass=bU,at.isDeepEqual=Sf,at.isNonArrayObject=cw,at.inRange=AU,at.makeUUID=oU,at.oncePerTick=sU,at.promiseFromEvents=uU,at.getOrNull=lU,at.defer=cU,at.delegateMethods=dU,at.proxyProperties=pU,at.legacyPromise=hU,at.buildLogLevels=mU,at.trackClass=gU,at.trackPublicationClass=yU,at.valueToJSON=Ef,at.withJitter=NU,at.isChromeScreenShareTrack=PU,at.isUserMediaTrack=xU,at.waitForSometime=DU,at.waitForEvent=LU;var yn={},vw=hr,UU=vw.flatMap,jU=vw.guessBrowser,Ro=null;function VU(){if(typeof Ro=="boolean")return Ro;if(typeof RTCPeerConnection>"u")return Ro=!1,Ro;try{new RTCPeerConnection({sdpSemantics:"foo"}),Ro=!1}catch{Ro=!0}return Ro}var Ms=null;function FU(){Ms=null}function $U(){if(!Ms)if(typeof RTCPeerConnection<"u"&&"addTransceiver"in RTCPeerConnection.prototype){var t=new RTCPeerConnection;try{t.addTransceiver("audio"),Ms="unified"}catch{Ms="planb"}t.close()}else Ms="planb";return Ms}function zU(t){return!t||!VU()?$U():{"plan-b":"planb","unified-plan":"unified"}[t]}function WU(){return typeof RTCRtpTransceiver<"u"&&"currentDirection"in RTCRtpTransceiver.prototype?"unified":"planb"}function BU(t){return{chrome:zU(t),firefox:"unified",safari:WU()}[jU()]||null}function gh(t,r){var e=r.match(new RegExp(t,"gm"))||[];return e.reduce(function(n,i){var a=i.match(new RegExp(t));return a?n.add(a[1]):n},new Set)}function hw(t,r){return gh(t,r)}function mw(t){return hw("^a=ssrc:[0-9]+ +msid:.+ +(.+) *$",t)}function gw(t){return hw("^a=msid:.+ +(.+) *$",t)}function yw(t,r){var e="^a=ssrc:([0-9]+) +msid:[^ ]+ +"+r+" *$";return gh(e,t)}function bw(t,r,e){return r===void 0&&(r=".*"),e===void 0&&(e=".*"),t.split(`\r
m=`).slice(1).map(function(n){return"m="+n}).filter(function(n){var i=new RegExp("m="+r,"gm"),a=new RegExp("a="+e,"gm");return i.test(n)&&a.test(n)})}function ZU(t){return Array.from(gh("^a=ssrc:([0-9]+) +.*$",t))}function _w(t,r){var e=bw(t),n=new RegExp("^a=msid:[^ ]+ +"+r+" *$","gm"),i=e.filter(function(a){return a.match(n)});return new Set(UU(i,ZU))}function ww(t,r,e){return new Map(Array.from(t(e)).map(function(n){return[n,r(e,n)]}))}function qU(t){return ww(mw,yw,t)}function QU(t){return ww(gw,_w,t)}function kw(t,r,e){var n=t(e),i=new Map;n.forEach(function(s,u){if(!r.has(u)){r.set(u,s);return}var l=Array.from(r.get(u)),c=Array.from(s);l.forEach(function(f,d){var v=c[d];i.set(v,f);var p="^a=ssrc:"+v+" (.*)$",y="a=ssrc:"+f+" $1";e=e.replace(new RegExp(p,"gm"),y)})});var a="^(a=ssrc-group:[^ ]+ +)(.*)$",o=e.match(new RegExp(a,"gm"))||[];return o.forEach(function(s){var u=s.match(new RegExp(a));if(u){var l=u[1],c=u[2],f=c.split(" ").map(function(d){var v=i.get(d);return v||d}).join(" ");e=e.replace(u[0],l+f)}}),e}function YU(t,r){return kw(qU,t,r)}function GU(t,r){return kw(QU,t,r)}yn.clearChromeCachedSdpFormat=FU,yn.getSdpFormat=BU,yn.getMediaSections=bw,yn.getPlanBTrackIds=mw,yn.getUnifiedPlanTrackIds=gw,yn.getPlanBSSRCs=yw,yn.getUnifiedPlanSSRCs=_w,yn.updatePlanBTrackIdsToSSRCs=YU,yn.updateUnifiedPlanTrackIdsToSSRCs=GU;var HU=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},yh=hr,Tw=yh.flatMap,JU=yh.guessBrowser,XU=yh.guessBrowserVersion,KU=yn.getSdpFormat,bh=JU(),ej=XU(),_h=bh==="chrome",Sw=bh==="firefox",Ew=bh==="safari",Mw=_h?ej.major:null,tj=32767;function rj(t,r){return t&&typeof t.getStats=="function"?nj(t,r):Promise.reject(new Error("Given PeerConnection does not support getStats"))}function nj(t,r){var e=Cf(t,"audio","local"),n=Cf(t,"video","local"),i=Cf(t,"audio"),a=Cf(t,"video"),o={activeIceCandidatePair:null,localAudioTrackStats:[],localVideoTrackStats:[],remoteAudioTrackStats:[],remoteVideoTrackStats:[]},s=Tw([[e,"localAudioTrackStats",!1],[n,"localVideoTrackStats",!1],[i,"remoteAudioTrackStats",!0],[a,"remoteVideoTrackStats",!0]],function(u){var l=HU(u,3),c=l[0],f=l[1],d=l[2];return c.map(function(v){return sj(t,v,Object.assign({isRemote:d},r)).then(function(p){p.forEach(function(y){y.trackId=v.id,o[f].push(y)})})})});return Promise.all(s).then(function(){return ij(t,r)}).then(function(u){return o.activeIceCandidatePair=u,o})}function ij(t,r){return r===void 0&&(r={}),typeof r.testForChrome<"u"||_h||typeof r.testForSafari<"u"||Ew?t.getStats().then(aj):typeof r.testForFirefox<"u"||Sw?t.getStats().then(oj):Promise.reject(new Error("RTCPeerConnection#getStats() not supported"))}function aj(t){var r=Array.from(t.values()).find(function(u){var l=u.nominated,c=u.type;return c==="candidate-pair"&&l});if(!r)return null;var e=t.get(r.localCandidateId),n=t.get(r.remoteCandidateId),i=[{key:"candidateType",type:"string"},{key:"ip",type:"string"},{key:"port",type:"number"},{key:"priority",type:"number"},{key:"protocol",type:"string"},{key:"url",type:"string"}],a=i.concat([{key:"deleted",type:"boolean"},{key:"relayProtocol",type:"string"}]),o=e?a.reduce(function(u,l){var c=l.key,f=l.type;return u[c]=typeof e[c]===f?e[c]:c==="deleted"?!1:null,u},{}):null,s=n?i.reduce(function(u,l){var c=l.key,f=l.type;return u[c]=typeof n[c]===f?n[c]:null,u},{}):null;return[{key:"availableIncomingBitrate",type:"number"},{key:"availableOutgoingBitrate",type:"number"},{key:"bytesReceived",type:"number"},{key:"bytesSent",type:"number"},{key:"consentRequestsSent",type:"number"},{key:"currentRoundTripTime",type:"number"},{key:"lastPacketReceivedTimestamp",type:"number"},{key:"lastPacketSentTimestamp",type:"number"},{key:"nominated",type:"boolean"},{key:"priority",type:"number"},{key:"readable",type:"boolean"},{key:"requestsReceived",type:"number"},{key:"requestsSent",type:"number"},{key:"responsesReceived",type:"number"},{key:"responsesSent",type:"number"},{key:"retransmissionsReceived",type:"number"},{key:"retransmissionsSent",type:"number"},{key:"state",type:"string",fixup:function(u){return u==="inprogress"?"in-progress":u}},{key:"totalRoundTripTime",type:"number"},{key:"transportId",type:"string"},{key:"writable",type:"boolean"}].reduce(function(u,l){var c=l.key,f=l.type,d=l.fixup;return u[c]=typeof r[c]===f?d?d(r[c]):r[c]:null,u},{localCandidate:o,remoteCandidate:s})}function oj(t){var r=Array.from(t.values()).find(function(l){var c=l.nominated,f=l.type;return f==="candidate-pair"&&c});if(!r)return null;var e=t.get(r.localCandidateId),n=t.get(r.remoteCandidateId),i=[{key:"candidateType",type:"string"},{key:"ip",ffKeys:["address","ipAddress"],type:"string"},{key:"port",ffKeys:["portNumber"],type:"number"},{key:"priority",type:"number"},{key:"protocol",ffKeys:["transport"],type:"string"},{key:"url",type:"string"}],a=i.concat([{key:"deleted",type:"boolean"},{key:"relayProtocol",type:"string"}]),o={host:"host",peerreflexive:"prflx",relayed:"relay",serverreflexive:"srflx"},s=e?a.reduce(function(l,c){var f=c.ffKeys,d=c.key,v=c.type,p=f&&f.find(function(y){return y in e})||d;return l[d]=typeof e[p]===v?p==="candidateType"&&o[e[p]]||e[p]:p==="deleted"?!1:null,l},{}):null,u=n?i.reduce(function(l,c){var f=c.ffKeys,d=c.key,v=c.type,p=f&&f.find(function(y){return y in n})||d;return l[d]=typeof n[p]===v?p==="candidateType"&&o[n[p]]||n[p]:null,l},{}):null;return[{key:"availableIncomingBitrate",type:"number"},{key:"availableOutgoingBitrate",type:"number"},{key:"bytesReceived",type:"number"},{key:"bytesSent",type:"number"},{key:"consentRequestsSent",type:"number"},{key:"currentRoundTripTime",type:"number"},{key:"lastPacketReceivedTimestamp",type:"number"},{key:"lastPacketSentTimestamp",type:"number"},{key:"nominated",type:"boolean"},{key:"priority",type:"number"},{key:"readable",type:"boolean"},{key:"requestsReceived",type:"number"},{key:"requestsSent",type:"number"},{key:"responsesReceived",type:"number"},{key:"responsesSent",type:"number"},{key:"retransmissionsReceived",type:"number"},{key:"retransmissionsSent",type:"number"},{key:"state",type:"string"},{key:"totalRoundTripTime",type:"number"},{key:"transportId",type:"string"},{key:"writable",type:"boolean"}].reduce(function(l,c){var f=c.key,d=c.type;return l[f]=typeof r[f]===d?r[f]:null,l},{localCandidate:s,remoteCandidate:u})}function Cf(t,r,e){var n=e==="local"?"getSenders":"getReceivers";if(t[n])return t[n]().map(function(o){var s=o.track;return s}).filter(function(o){return o&&o.kind===r});var i=e==="local"?"getLocalStreams":"getRemoteStreams",a=r==="audio"?"getAudioTracks":"getVideoTracks";return Tw(t[i](),function(o){return o[a]()})}function sj(t,r,e){return e===void 0&&(e={}),typeof e.testForChrome<"u"||_h?Cw(t,r,e):typeof e.testForFirefox<"u"||Sw?uj(t,r,e):typeof e.testForSafari<"u"||Ew?typeof e.testForSafari<"u"||KU()==="unified"?Cw(t,r,e):Promise.reject(new Error(["getStats() is not supported on this version of Safari","due to this bug: https://bugs.webkit.org/show_bug.cgi?id=192601"].join(" "))):Promise.reject(new Error("RTCPeerConnection#getStats() not supported"))}function Cw(t,r,e){return Mw&&Mw<67?new Promise(function(n,i){t.getStats(function(a){n([lj(a,r)])},null,i)}):t.getStats(r).then(function(n){return cj(n,e)})}function uj(t,r,e){return t.getStats(r).then(function(n){return[fj(n,e)]})}function lj(t,r){var e=t.result().find(function(i){return i.type==="ssrc"&&i.stat("googTrackId")===r.id}),n={};return e&&(n.timestamp=Math.round(Number(e.timestamp)),n=e.names().reduce(function(i,a){switch(a){case"googCodecName":i.codecName=e.stat(a);break;case"googRtt":i.roundTripTime=Number(e.stat(a));break;case"googJitterReceived":i.jitter=Number(e.stat(a));break;case"googFrameWidthInput":i.frameWidthInput=Number(e.stat(a));break;case"googFrameHeightInput":i.frameHeightInput=Number(e.stat(a));break;case"googFrameWidthSent":i.frameWidthSent=Number(e.stat(a));break;case"googFrameHeightSent":i.frameHeightSent=Number(e.stat(a));break;case"googFrameWidthReceived":i.frameWidthReceived=Number(e.stat(a));break;case"googFrameHeightReceived":i.frameHeightReceived=Number(e.stat(a));break;case"googFrameRateInput":i.frameRateInput=Number(e.stat(a));break;case"googFrameRateSent":i.frameRateSent=Number(e.stat(a));break;case"googFrameRateReceived":i.frameRateReceived=Number(e.stat(a));break;case"ssrc":i[a]=e.stat(a);break;case"bytesReceived":case"bytesSent":case"packetsLost":case"packetsReceived":case"packetsSent":case"audioInputLevel":case"audioOutputLevel":i[a]=Number(e.stat(a));break}return i},n)),n}function cj(t,r){var e=r.simulateExceptionWhileStandardizingStats,n=e===void 0?!1:e;if(n)throw new Error("Error while gathering stats");var i=null,a=[],o=null,s=null,u=null,l=null,c=null;t.forEach(function(y){var k=y.type;switch(k){case"inbound-rtp":i=y;break;case"outbound-rtp":a.push(y);break;case"media-source":c=y;break;case"track":u=y;break;case"codec":l=y;break;case"remote-inbound-rtp":o=y;break;case"remote-outbound-rtp":s=y;break}});var f=u?u.remoteSource:!c,d=f?[i]:a,v=[],p=f?s:o;return d.forEach(function(y){var k={},I=[y,c,u,l,p&&p.ssrc===y.ssrc?p:null];function C($e){var ue=I.find(function(Rr){return Rr&&typeof Rr[$e]<"u"})||null;return ue?ue[$e]:null}var L=C("ssrc");typeof L=="number"&&(k.ssrc=String(L));var R=C("timestamp");k.timestamp=Math.round(R);var q=C("mimeType");typeof q=="string"&&(q=q.split("/"),k.codecName=q[q.length-1]);var z=C("roundTripTime");typeof z=="number"&&(k.roundTripTime=Math.round(z*1e3));var F=C("jitter");typeof F=="number"&&(k.jitter=Math.round(F*1e3));var D=C("frameWidth");typeof D=="number"&&(f?k.frameWidthReceived=D:(k.frameWidthSent=D,k.frameWidthInput=u?u.frameWidth:c.width));var W=C("frameHeight");typeof W=="number"&&(f?k.frameHeightReceived=W:(k.frameHeightSent=W,k.frameHeightInput=u?u.frameHeight:c.height));var X=C("framesPerSecond");typeof X=="number"&&(k[f?"frameRateReceived":"frameRateSent"]=X);var me=C("bytesReceived");typeof me=="number"&&(k.bytesReceived=me);var de=C("bytesSent");typeof de=="number"&&(k.bytesSent=de);var H=C("packetsLost");typeof H=="number"&&(k.packetsLost=H);var ee=C("packetsReceived");typeof ee=="number"&&(k.packetsReceived=ee);var Z=C("packetsSent");typeof Z=="number"&&(k.packetsSent=Z);var te=C("audioLevel");typeof te=="number"&&(te=Math.round(te*tj),f?k.audioOutputLevel=te:k.audioInputLevel=te);var re=C("totalPacketSendDelay");typeof re=="number"&&(k.totalPacketSendDelay=re);var K=C("totalEncodeTime");typeof K=="number"&&(k.totalEncodeTime=K);var fe=C("framesEncoded");typeof fe=="number"&&(k.framesEncoded=fe);var Te=C("estimatedPlayoutTimestamp");typeof Te=="number"&&(k.estimatedPlayoutTimestamp=Te);var $=C("totalDecodeTime");typeof $=="number"&&(k.totalDecodeTime=$);var We=C("framesDecoded");typeof We=="number"&&(k.framesDecoded=We);var et=C("jitterBufferDelay");typeof et=="number"&&(k.jitterBufferDelay=et);var dt=C("jitterBufferEmittedCount");typeof dt=="number"&&(k.jitterBufferEmittedCount=dt),v.push(k)}),v}function fj(t,r){t===void 0&&(t=new Map);var e=r.isRemote,n=r.simulateExceptionWhileStandardizingStats,i=n===void 0?!1:n;if(i)throw new Error("Error while gathering stats");var a=null,o=null;t.forEach(function(ee){var Z=ee.isRemote,te=ee.remoteId,re=ee.type;if(!Z)switch(re){case"inbound-rtp":a=ee,o=t.get(te);break;case"outbound-rtp":o=ee,a=t.get(te);break}});var s=e?a:o,u=e?o:a;function l(ee){return s&&typeof s[ee]<"u"?s[ee]:u&&typeof u[ee]<"u"?u[ee]:null}var c={},f=l("timestamp");c.timestamp=Math.round(f);var d=l("ssrc");typeof d=="number"&&(c.ssrc=String(d));var v=l("bytesSent");typeof v=="number"&&(c.bytesSent=v);var p=l("packetsLost");typeof p=="number"&&(c.packetsLost=p);var y=l("packetsSent");typeof y=="number"&&(c.packetsSent=y);var k=l("roundTripTime");typeof k=="number"&&(c.roundTripTime=Math.round(k*1e3));var I=l("jitter");typeof I=="number"&&(c.jitter=Math.round(I*1e3));var C=l("framerateMean");typeof C=="number"&&(c.frameRateSent=Math.round(C));var L=l("bytesReceived");typeof L=="number"&&(c.bytesReceived=L);var R=l("packetsReceived");typeof R=="number"&&(c.packetsReceived=R);var q=l("framerateMean");typeof q=="number"&&(c.frameRateReceived=Math.round(q));var z=l("totalPacketSendDelay");typeof z=="number"&&(c.totalPacketSendDelay=z);var F=l("totalEncodeTime");typeof F=="number"&&(c.totalEncodeTime=F);var D=l("framesEncoded");typeof D=="number"&&(c.framesEncoded=D);var W=l("estimatedPlayoutTimestamp");typeof W=="number"&&(c.estimatedPlayoutTimestamp=W);var X=l("totalDecodeTime");typeof X=="number"&&(c.totalDecodeTime=X);var me=l("framesDecoded");typeof me=="number"&&(c.framesDecoded=me);var de=l("jitterBufferDelay");typeof de=="number"&&(c.jitterBufferDelay=de);var H=l("jitterBufferEmittedCount");return typeof H=="number"&&(c.jitterBufferEmittedCount=H),c}var dj=rj;function pj(t){return t===void 0&&(t={audio:!0,video:!0}),typeof navigator=="object"&&typeof navigator.mediaDevices=="object"&&typeof navigator.mediaDevices.getUserMedia=="function"?navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("getUserMedia is not supported"))}var vj=pj,Rf={},Rw={get exports(){return Rf},set exports(t){Rf=t}};typeof MediaStream=="function"?Rw.exports=MediaStream:Rw.exports=function(){throw new Error("MediaStream is not supported")};var wh={},Iw={get exports(){return wh},set exports(t){wh=t}};typeof MediaStreamTrack=="function"?Iw.exports=MediaStreamTrack:Iw.exports=function(){throw new Error("MediaStreamTrack is not supported")};var kh={},Ow={get exports(){return kh},set exports(t){kh=t}};typeof RTCIceCandidate=="function"?Ow.exports=RTCIceCandidate:Ow.exports=function(){throw new Error("RTCIceCandidate is not supported")};var Th={},hj={get exports(){return Th},set exports(t){Th=t}},Sh,Nw;function Aw(){if(Nw)return Sh;Nw=1;var t=function(){function r(e){this.descriptionInitDict=e;var n=e&&e.type==="rollback"?null:new RTCSessionDescription(e);Object.defineProperties(this,{_description:{get:function(){return n}}})}return Object.defineProperty(r.prototype,"sdp",{get:function(){return this._description?this._description.sdp:this.descriptionInitDict.sdp},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"type",{get:function(){return this._description?this._description.type:this.descriptionInitDict.type},enumerable:!1,configurable:!0}),r}();return Sh=t,Sh}var Wr={},mj={get exports(){return Wr},set exports(t){Wr=t}},Cs=typeof Reflect=="object"?Reflect:null,Pw=Cs&&typeof Cs.apply=="function"?Cs.apply:function(r,e,n){return Function.prototype.apply.call(r,e,n)},If;Cs&&typeof Cs.ownKeys=="function"?If=Cs.ownKeys:Object.getOwnPropertySymbols?If=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:If=function(r){return Object.getOwnPropertyNames(r)};function gj(t){console&&console.warn&&console.warn(t)}var xw=Number.isNaN||function(r){return r!==r};function mr(){mr.init.call(this)}mj.exports=mr,Wr.once=wj,mr.EventEmitter=mr,mr.prototype._events=void 0,mr.prototype._eventsCount=0,mr.prototype._maxListeners=void 0;var Dw=10;function Of(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(mr,"defaultMaxListeners",{enumerable:!0,get:function(){return Dw},set:function(t){if(typeof t!="number"||t<0||xw(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Dw=t}}),mr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},mr.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||xw(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function Lw(t){return t._maxListeners===void 0?mr.defaultMaxListeners:t._maxListeners}mr.prototype.getMaxListeners=function(){return Lw(this)},mr.prototype.emit=function(r){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i=r==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var u=a[r];if(u===void 0)return!1;if(typeof u=="function")Pw(u,this,e);else for(var l=u.length,c=$w(u,l),n=0;n<l;++n)Pw(c[n],this,e);return!0};function Uw(t,r,e,n){var i,a,o;if(Of(e),a=t._events,a===void 0?(a=t._events=Object.create(null),t._eventsCount=0):(a.newListener!==void 0&&(t.emit("newListener",r,e.listener?e.listener:e),a=t._events),o=a[r]),o===void 0)o=a[r]=e,++t._eventsCount;else if(typeof o=="function"?o=a[r]=n?[e,o]:[o,e]:n?o.unshift(e):o.push(e),i=Lw(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=r,s.count=o.length,gj(s)}return t}mr.prototype.addListener=function(r,e){return Uw(this,r,e,!1)},mr.prototype.on=mr.prototype.addListener,mr.prototype.prependListener=function(r,e){return Uw(this,r,e,!0)};function yj(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function jw(t,r,e){var n={fired:!1,wrapFn:void 0,target:t,type:r,listener:e},i=yj.bind(n);return i.listener=e,n.wrapFn=i,i}mr.prototype.once=function(r,e){return Of(e),this.on(r,jw(this,r,e)),this},mr.prototype.prependOnceListener=function(r,e){return Of(e),this.prependListener(r,jw(this,r,e)),this},mr.prototype.removeListener=function(r,e){var n,i,a,o,s;if(Of(e),i=this._events,i===void 0)return this;if(n=i[r],n===void 0)return this;if(n===e||n.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[r],i.removeListener&&this.emit("removeListener",r,n.listener||e));else if(typeof n!="function"){for(a=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,a=o;break}if(a<0)return this;a===0?n.shift():bj(n,a),n.length===1&&(i[r]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",r,s||e)}return this},mr.prototype.off=mr.prototype.removeListener,mr.prototype.removeAllListeners=function(r){var e,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[r]),this;if(arguments.length===0){var a=Object.keys(n),o;for(i=0;i<a.length;++i)o=a[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=n[r],typeof e=="function")this.removeListener(r,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(r,e[i]);return this};function Vw(t,r,e){var n=t._events;if(n===void 0)return[];var i=n[r];return i===void 0?[]:typeof i=="function"?e?[i.listener||i]:[i]:e?_j(i):$w(i,i.length)}mr.prototype.listeners=function(r){return Vw(this,r,!0)},mr.prototype.rawListeners=function(r){return Vw(this,r,!1)},mr.listenerCount=function(t,r){return typeof t.listenerCount=="function"?t.listenerCount(r):Fw.call(t,r)},mr.prototype.listenerCount=Fw;function Fw(t){var r=this._events;if(r!==void 0){var e=r[t];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}mr.prototype.eventNames=function(){return this._eventsCount>0?If(this._events):[]};function $w(t,r){for(var e=new Array(r),n=0;n<r;++n)e[n]=t[n];return e}function bj(t,r){for(;r+1<t.length;r++)t[r]=t[r+1];t.pop()}function _j(t){for(var r=new Array(t.length),e=0;e<r.length;++e)r[e]=t[e].listener||t[e];return r}function wj(t,r){return new Promise(function(e,n){function i(o){t.removeListener(r,a),n(o)}function a(){typeof t.removeListener=="function"&&t.removeListener("error",i),e([].slice.call(arguments))}zw(t,r,a,{once:!0}),r!=="error"&&kj(t,i,{once:!0})})}function kj(t,r,e){typeof t.on=="function"&&zw(t,"error",r,e)}function zw(t,r,e,n){if(typeof t.on=="function")n.once?t.once(r,e):t.on(r,e);else if(typeof t.addEventListener=="function")t.addEventListener(r,function i(a){n.once&&t.removeEventListener(r,i),e(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Eh,Ww;function Mh(){if(Ww)return Eh;Ww=1;var t=V&&V.__read||function(i,a){var o=typeof Symbol=="function"&&i[Symbol.iterator];if(!o)return i;var s=o.call(i),u,l=[],c;try{for(;(a===void 0||a-- >0)&&!(u=s.next()).done;)l.push(u.value)}catch(f){c={error:f}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(c)throw c.error}}return l},r=V&&V.__spreadArray||function(i,a){for(var o=0,s=a.length,u=i.length;o<s;o++,u++)i[u]=a[o];return i},e=Wr.EventEmitter,n=function(){function i(){Object.defineProperties(this,{_eventEmitter:{value:new e}})}return i.prototype.dispatchEvent=function(a){return this._eventEmitter.emit(a.type,a)},i.prototype.addEventListener=function(){var a;return(a=this._eventEmitter).addListener.apply(a,r([],t(arguments)))},i.prototype.removeEventListener=function(){var a;return(a=this._eventEmitter).removeListener.apply(a,r([],t(arguments)))},i}();return Eh=n,Eh}var Ch,Bw;function Zw(){if(Bw)return Ch;Bw=1;var t=hr.defer,r={high:new Set(["low"]),low:new Set(["high"])},e=function(){function i(a){a===void 0&&(a="low");var o=a;Object.defineProperties(this,{_state:{set:function(s){var u=this;if(o!==s){o=s;var l=this._whenDeferreds.get(o);l.forEach(function(c){return c.resolve(u)}),l.clear()}},get:function(){return o}},_whenDeferreds:{value:new Map([["high",new Set],["low",new Set]])}})}return Object.defineProperty(i.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),i.prototype.lower=function(){return this.transition("low")},i.prototype.raise=function(){return this.transition("high")},i.prototype.transition=function(a){if(!r[this.state].has(a))throw n(this.state,a);return this._state=a,this},i.prototype.when=function(a){if(this.state===a)return Promise.resolve(this);if(!r[this.state].has(a))return Promise.reject(n(this.state,a));var o=t();return this._whenDeferreds.get(a).add(o),o.promise},i}();function n(i,a){return new Error('Cannot transition from "'+i+'" to "'+a+'"')}return Ch=e,Ch}var Rh,qw;function Tj(){if(qw)return Rh;qw=1;var t=function(){function r(e){Object.defineProperties(this,{track:{enumerable:!0,value:e,writable:!0}})}return r}();return Rh=t,Rh}var Ih,Qw;function Sj(){if(Qw)return Ih;Qw=1;var t=V&&V.__extends||function(){var de=function(H,ee){return de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Z,te){Z.__proto__=te}||function(Z,te){for(var re in te)Object.prototype.hasOwnProperty.call(te,re)&&(Z[re]=te[re])},de(H,ee)};return function(H,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Class extends value "+String(ee)+" is not a constructor or null");de(H,ee);function Z(){this.constructor=H}H.prototype=ee===null?Object.create(ee):(Z.prototype=ee.prototype,new Z)}}(),r=V&&V.__read||function(de,H){var ee=typeof Symbol=="function"&&de[Symbol.iterator];if(!ee)return de;var Z=ee.call(de),te,re=[],K;try{for(;(H===void 0||H-- >0)&&!(te=Z.next()).done;)re.push(te.value)}catch(fe){K={error:fe}}finally{try{te&&!te.done&&(ee=Z.return)&&ee.call(Z)}finally{if(K)throw K.error}}return re},e=V&&V.__spreadArray||function(de,H){for(var ee=0,Z=H.length,te=de.length;ee<Z;ee++,te++)de[te]=H[ee];return de},n=Aw(),i=Mh(),a=Zw(),o=Rf,s=Tj(),u=yn,l=u.getSdpFormat,c=u.updatePlanBTrackIdsToSSRCs,f=u.updateUnifiedPlanTrackIdsToSSRCs,d=hr,v=d.delegateMethods,p=d.interceptEvent,y=d.isIOSChrome,k=d.legacyPromise,I=d.proxyProperties,C=l()==="unified",L=function(de){t(H,de);function H(ee,Z){ee===void 0&&(ee={});var te=de.call(this)||this,re=Object.assign(ee.iceTransportPolicy?{iceTransports:ee.iceTransportPolicy}:{},ee);p(te,"datachannel"),p(te,"signalingstatechange");var K=l(re.sdpSemantics),fe=new RTCPeerConnection(re,Z);return Object.defineProperties(te,{_appliedTracksToSSRCs:{value:new Map,writable:!0},_localStream:{value:new o},_peerConnection:{value:fe},_pendingLocalOffer:{value:null,writable:!0},_pendingRemoteOffer:{value:null,writable:!0},_rolledBackTracksToSSRCs:{value:new Map,writable:!0},_sdpFormat:{value:K},_senders:{value:new Map},_signalingStateLatch:{value:new a},_tracksToSSRCs:{value:new Map,writable:!0}}),fe.addEventListener("datachannel",function(Te){X(Te.channel),te.dispatchEvent(Te)}),fe.addEventListener("signalingstatechange",function(){for(var Te=[],$=0;$<arguments.length;$++)Te[$]=arguments[$];fe.signalingState==="stable"&&(te._appliedTracksToSSRCs=new Map(te._tracksToSSRCs)),!te._pendingLocalOffer&&!te._pendingRemoteOffer&&te.dispatchEvent.apply(te,e([],r(Te)))}),fe.ontrack=function(){},typeof fe.addTrack!="function"&&fe.addStream(te._localStream),I(RTCPeerConnection.prototype,te,fe),te}return Object.defineProperty(H.prototype,"localDescription",{get:function(){return this._pendingLocalOffer?this._pendingLocalOffer:this._peerConnection.localDescription},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"remoteDescription",{get:function(){return this._pendingRemoteOffer?this._pendingRemoteOffer:this._peerConnection.remoteDescription},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"signalingState",{get:function(){return this._pendingLocalOffer?"have-local-offer":this._pendingRemoteOffer?"have-remote-offer":this._peerConnection.signalingState},enumerable:!1,configurable:!0}),H.prototype.addTrack=function(ee){for(var Z,te=[],re=1;re<arguments.length;re++)te[re-1]=arguments[re];if(typeof this._peerConnection.addTrack=="function")return(Z=this._peerConnection).addTrack.apply(Z,e([ee],r(te)));if(this._peerConnection.signalingState==="closed")throw new Error("Cannot add MediaStreamTrack ["+ee.id+`, 
        `+ee.kind+"]: RTCPeerConnection is closed");var K=this._senders.get(ee);if(K&&K.track)throw new Error("Cannot add MediaStreamTrack ['"+ee.id+`, 
        `+ee.kind+"]: RTCPeerConnection already has it");return this._peerConnection.removeStream(this._localStream),this._localStream.addTrack(ee),this._peerConnection.addStream(this._localStream),K=new s(ee),this._senders.set(ee,K),K},H.prototype.removeTrack=function(ee){if(this._peerConnection.signalingState==="closed")throw new Error("Cannot remove MediaStreamTrack: RTCPeerConnection is closed");if(typeof this._peerConnection.addTrack=="function")try{return this._peerConnection.removeTrack(ee)}catch{}else{var Z=ee.track;if(!Z)return;ee=this._senders.get(Z),ee&&ee.track&&(ee.track=null,this._peerConnection.removeStream(this._localStream),this._localStream.removeTrack(Z),this._peerConnection.addStream(this._localStream))}},H.prototype.getSenders=function(){return typeof this._peerConnection.addTrack=="function"?this._peerConnection.getSenders():Array.from(this._senders.values())},H.prototype.addIceCandidate=function(ee){for(var Z=this,te=[],re=1;re<arguments.length;re++)te[re-1]=arguments[re];var K;return this.signalingState==="have-remote-offer"?K=this._signalingStateLatch.when("low").then(function(){return Z._peerConnection.addIceCandidate(ee)}):K=this._peerConnection.addIceCandidate(ee),te.length>0?k.apply(void 0,e([K],r(te))):K},H.prototype.close=function(){this.signalingState!=="closed"&&(this._pendingLocalOffer=null,this._pendingRemoteOffer=null,this._peerConnection.close())},H.prototype.createAnswer=function(){for(var ee=this,Z=[],te=0;te<arguments.length;te++)Z[te]=arguments[te];var re;return this._pendingRemoteOffer?re=this._peerConnection.setRemoteDescription(this._pendingRemoteOffer).then(function(){return ee._signalingStateLatch.lower(),ee._peerConnection.createAnswer()}).then(function(K){return ee._pendingRemoteOffer=null,ee._rolledBackTracksToSSRCs.clear(),new n({type:"answer",sdp:me(ee._sdpFormat,ee._tracksToSSRCs,K.sdp)})},function(K){throw ee._pendingRemoteOffer=null,K}):re=this._peerConnection.createAnswer().then(function(K){return ee._rolledBackTracksToSSRCs.clear(),new n({type:"answer",sdp:me(ee._sdpFormat,ee._tracksToSSRCs,K.sdp)})}),Z.length>1?k.apply(void 0,e([re],r(Z))):re},H.prototype.createOffer=function(){for(var ee=this,Z=[],te=0;te<arguments.length;te++)Z[te]=arguments[te];var re=r(Z,3),K=re[0],fe=re[1],Te=re[2],$=Te||K||{};if(y()){if($.offerToReceiveVideo&&!this._audioTransceiver&&!(C&&z(this,"audio"))){delete $.offerToReceiveAudio;try{this._audioTransceiver=C?this.addTransceiver("audio",{direction:"recvonly"}):this.addTransceiver("audio")}catch(et){return Promise.reject(et)}}if($.offerToReceiveVideo&&!this._videoTransceiver&&!(C&&z(this,"video"))){delete $.offerToReceiveVideo;try{this._videoTransceiver=C?this.addTransceiver("video",{direction:"recvonly"}):this.addTransceiver("video")}catch(et){return Promise.reject(et)}}}var We=this._peerConnection.createOffer($).then(function(et){return ee._rolledBackTracksToSSRCs.clear(),new n({type:et.type,sdp:me(ee._sdpFormat,ee._tracksToSSRCs,et.sdp)})});return Z.length>1?k(We,K,fe):We},H.prototype.createDataChannel=function(ee,Z){Z=W(Z);var te=this._peerConnection.createDataChannel(ee,Z);return X(te),te},H.prototype.setLocalDescription=function(){for(var ee=[],Z=0;Z<arguments.length;Z++)ee[Z]=arguments[Z];var te=r(ee,3),re=te[0],K=te[1],fe=te[2];this._rolledBackTracksToSSRCs.size>0&&(this._tracksToSSRCs=new Map(this._rolledBackTracksToSSRCs),this._rolledBackTracksToSSRCs.clear());var Te=R(this,!0,re);return ee.length>1?k(Te,K,fe):Te},H.prototype.setRemoteDescription=function(){for(var ee=[],Z=0;Z<arguments.length;Z++)ee[Z]=arguments[Z];var te=r(ee,3),re=te[0],K=te[1],fe=te[2];this._rolledBackTracksToSSRCs.clear();var Te=R(this,!1,re);return ee.length>1?k(Te,K,fe):Te},H}(i);v(RTCPeerConnection.prototype,L.prototype,"_peerConnection");function R(de,H,ee){function Z(et){H?de._pendingLocalOffer=et:de._pendingRemoteOffer=et}function te(){H?de._pendingLocalOffer=null:de._pendingRemoteOffer=null}var re=H?de._pendingLocalOffer:de._pendingRemoteOffer,K=H?de._pendingRemoteOffer:de._pendingLocalOffer,fe=H?"have-local-offer":"have-remote-offer",Te=H?"setLocalDescription":"setRemoteDescription",$;if(!H&&K&&ee.type==="answer")$=q(de,ee);else if(ee.type==="offer"){if(de.signalingState!==fe&&de.signalingState!=="stable")return Promise.reject(new Error("Cannot set "+(H?"local":"remote")+" offer in state "+de.signalingState));!re&&de._signalingStateLatch.state==="low"&&de._signalingStateLatch.raise();var We=de.signalingState;Z(F(ee)),$=Promise.resolve(),de.signalingState!==We&&$.then(function(){return de.dispatchEvent(new Event("signalingstatechange"))})}else ee.type==="rollback"&&(de.signalingState!==fe?$=Promise.reject(new Error("Cannot rollback "+(H?"local":"remote")+" description in "+de.signalingState)):(te(),de._rolledBackTracksToSSRCs=new Map(de._tracksToSSRCs),de._tracksToSSRCs=new Map(de._appliedTracksToSSRCs),$=Promise.resolve(),$.then(function(){return de.dispatchEvent(new Event("signalingstatechange"))})));return $||de._peerConnection[Te](F(ee))}function q(de,H){var ee=de._pendingLocalOffer;return de._peerConnection.setLocalDescription(ee).then(function(){return de._pendingLocalOffer=null,de.setRemoteDescription(H)}).then(function(){de._signalingStateLatch.lower()})}function z(de,H){return!!de.getTransceivers().find(function(ee){var Z=ee.receiver,te=Z===void 0?{}:Z,re=te.track,K=re===void 0?{}:re;return K.kind===H})}function F(de){return de instanceof n&&de._description?de._description:new RTCSessionDescription(de)}function D(){return"maxRetransmitTime"in RTCDataChannel.prototype&&!("maxPacketLifeTime"in RTCDataChannel.prototype)}function W(de){return de=Object.assign({},de),D()&&"maxPacketLifeTime"in de&&(de.maxRetransmitTime=de.maxPacketLifeTime),de}function X(de){return Object.defineProperty(de,"maxRetransmits",{value:de.maxRetransmits===65535?null:de.maxRetransmits}),D()&&Object.defineProperty(de,"maxPacketLifeTime",{value:de.maxRetransmitTime===65535?null:de.maxRetransmitTime}),de}function me(de,H,ee){return de==="unified"?f(H,ee):c(H,ee)}return Ih=L,Ih}var Oh,Yw;function Gw(){return Yw||(Yw=1,Oh=RTCSessionDescription),Oh}var Nh,Hw;function Ej(){if(Hw)return Nh;Hw=1;var t=V&&V.__extends||function(){var y=function(k,I){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,L){C.__proto__=L}||function(C,L){for(var R in L)Object.prototype.hasOwnProperty.call(L,R)&&(C[R]=L[R])},y(k,I)};return function(k,I){if(typeof I!="function"&&I!==null)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");y(k,I);function C(){this.constructor=k}k.prototype=I===null?Object.create(I):(C.prototype=I.prototype,new C)}}(),r=V&&V.__read||function(y,k){var I=typeof Symbol=="function"&&y[Symbol.iterator];if(!I)return y;var C=I.call(y),L,R=[],q;try{for(;(k===void 0||k-- >0)&&!(L=C.next()).done;)R.push(L.value)}catch(z){q={error:z}}finally{try{L&&!L.done&&(I=C.return)&&I.call(C)}finally{if(q)throw q.error}}return R},e=V&&V.__spreadArray||function(y,k){for(var I=0,C=k.length,L=y.length;I<C;I++,L++)y[L]=k[I];return y},n=Mh(),i=Gw(),a=yn.updateUnifiedPlanTrackIdsToSSRCs,o=hr,s=o.delegateMethods,u=o.interceptEvent,l=o.legacyPromise,c=o.proxyProperties,f=function(y){t(k,y);function k(I){var C=y.call(this)||this;u(C,"signalingstatechange");var L=new RTCPeerConnection(I);Object.defineProperties(C,{_initiallyNegotiatedDtlsRole:{value:null,writable:!0},_isClosed:{value:!1,writable:!0},_peerConnection:{value:L},_rollingBack:{value:!1,writable:!0},_tracksToSSRCs:{value:new Map},peerIdentity:{enumerable:!0,value:Promise.resolve({idp:"",name:""})}});var R;return L.addEventListener("signalingstatechange",function(){for(var q=[],z=0;z<arguments.length;z++)q[z]=arguments[z];!C._rollingBack&&C.signalingState!==R&&(R=C.signalingState,C._isClosed?setTimeout(function(){return C.dispatchEvent.apply(C,e([],r(q)))}):C.dispatchEvent.apply(C,e([],r(q))))}),c(RTCPeerConnection.prototype,C,L),C}return Object.defineProperty(k.prototype,"iceGatheringState",{get:function(){return this._isClosed?"complete":this._peerConnection.iceGatheringState},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"localDescription",{get:function(){return p(this._peerConnection.localDescription,this._initiallyNegotiatedDtlsRole)},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"signalingState",{get:function(){return this._isClosed?"closed":this._peerConnection.signalingState},enumerable:!1,configurable:!0}),k.prototype.createAnswer=function(){for(var I=this,C=[],L=0;L<arguments.length;L++)C[L]=arguments[L];var R;return R=this._peerConnection.createAnswer().then(function(q){return v(I,q),p(q,I._initiallyNegotiatedDtlsRole)}),typeof C[0]=="function"?l.apply(void 0,e([R],r(C))):R},k.prototype.createOffer=function(){for(var I=this,C=[],L=0;L<arguments.length;L++)C[L]=arguments[L];var R=r(C,3),q=R[0],z=R[1],F=R[2],D=F||q||{},W;if(this.signalingState==="have-local-offer"||this.signalingState==="have-remote-offer"){var X=this.signalingState==="have-local-offer";W=d(this,X,function(){return I.createOffer(D)})}else W=this._peerConnection.createOffer(D);return W=W.then(function(me){return new i({type:me.type,sdp:a(I._tracksToSSRCs,me.sdp)})}),C.length>1?l(W,q,z):W},k.prototype.setLocalDescription=function(){for(var I,C=[],L=0;L<arguments.length;L++)C[L]=arguments[L];var R=r(C),q=R[0],z=R.slice(1),F;return q&&q.type==="answer"&&this.signalingState==="have-local-offer"&&(F=Promise.reject(new Error("Cannot set local answer in state have-local-offer"))),F?C.length>1?l.apply(void 0,e([F],r(z))):F:(I=this._peerConnection).setLocalDescription.apply(I,e([],r(C)))},k.prototype.setRemoteDescription=function(){for(var I=this,C=[],L=0;L<arguments.length;L++)C[L]=arguments[L];var R=r(C),q=R[0],z=R.slice(1),F;return q&&this.signalingState==="have-remote-offer"&&(q.type==="answer"?F=Promise.reject(new Error("Cannot set remote answer in state have-remote-offer")):q.type==="offer"&&(F=d(this,!1,function(){return I._peerConnection.setRemoteDescription(q)}))),F||(F=this._peerConnection.setRemoteDescription(q)),F=F.then(function(){return v(I,q,!0)}),C.length>1?l.apply(void 0,e([F],r(z))):F},k.prototype.close=function(){this.signalingState!=="closed"&&(this._isClosed=!0,this._peerConnection.close())},k}(n);s(RTCPeerConnection.prototype,f.prototype,"_peerConnection");function d(y,k,I){var C=k?"setLocalDescription":"setRemoteDescription";return y._rollingBack=!0,y._peerConnection[C](new i({type:"rollback"})).then(I).then(function(L){return y._rollingBack=!1,L},function(L){throw y._rollingBack=!1,L})}function v(y,k,I){if(!(y._initiallyNegotiatedDtlsRole||k.type==="offer")){var C=k.sdp.match(/a=setup:([a-z]+)/);if(C){var L=C[1];y._initiallyNegotiatedDtlsRole=I?{active:"passive",passive:"active"}[L]:L}}}function p(y,k){return y&&y.type==="answer"&&k?new i({type:y.type,sdp:y.sdp.replace(/a=setup:[a-z]+/g,"a=setup:"+k)}):y}return Nh=f,Nh}var Ah,Jw;function Mj(){if(Jw)return Ah;Jw=1;var t=V&&V.__extends||function(){var R=function(q,z){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,D){F.__proto__=D}||function(F,D){for(var W in D)Object.prototype.hasOwnProperty.call(D,W)&&(F[W]=D[W])},R(q,z)};return function(q,z){if(typeof z!="function"&&z!==null)throw new TypeError("Class extends value "+String(z)+" is not a constructor or null");R(q,z);function F(){this.constructor=q}q.prototype=z===null?Object.create(z):(F.prototype=z.prototype,new F)}}(),r=V&&V.__read||function(R,q){var z=typeof Symbol=="function"&&R[Symbol.iterator];if(!z)return R;var F=z.call(R),D,W=[],X;try{for(;(q===void 0||q-- >0)&&!(D=F.next()).done;)W.push(D.value)}catch(me){X={error:me}}finally{try{D&&!D.done&&(z=F.return)&&z.call(F)}finally{if(X)throw X.error}}return W},e=V&&V.__spreadArray||function(R,q){for(var z=0,F=q.length,D=R.length;z<F;z++,D++)R[D]=q[z];return R},n=Mh(),i=Zw(),a=yn,o=a.getSdpFormat,s=a.updatePlanBTrackIdsToSSRCs,u=a.updateUnifiedPlanTrackIdsToSSRCs,l=hr,c=l.delegateMethods,f=l.interceptEvent,d=l.proxyProperties,v=o()==="unified",p=v?u:s,y=function(R){t(q,R);function q(z){var F=R.call(this)||this;f(F,"datachannel"),f(F,"iceconnectionstatechange"),f(F,"signalingstatechange"),f(F,"track");var D=new RTCPeerConnection(z);return Object.defineProperties(F,{_appliedTracksToSSRCs:{value:new Map,writable:!0},_audioTransceiver:{value:null,writable:!0},_isClosed:{value:!1,writable:!0},_peerConnection:{value:D},_pendingLocalOffer:{value:null,writable:!0},_pendingRemoteOffer:{value:null,writable:!0},_rolledBackTracksToSSRCs:{value:new Map,writable:!0},_signalingStateLatch:{value:new i},_tracksToSSRCs:{value:new Map,writable:!0},_videoTransceiver:{value:null,writable:!0}}),D.addEventListener("datachannel",function(W){L(W.channel),F.dispatchEvent(W)}),D.addEventListener("iceconnectionstatechange",function(){for(var W=[],X=0;X<arguments.length;X++)W[X]=arguments[X];F._isClosed||F.dispatchEvent.apply(F,e([],r(W)))}),D.addEventListener("signalingstatechange",function(){for(var W=[],X=0;X<arguments.length;X++)W[X]=arguments[X];F._isClosed||(D.signalingState==="stable"&&(F._appliedTracksToSSRCs=new Map(F._tracksToSSRCs)),!F._pendingLocalOffer&&!F._pendingRemoteOffer&&F.dispatchEvent.apply(F,e([],r(W))))}),D.addEventListener("track",function(W){F._pendingRemoteOffer=null,F.dispatchEvent(W)}),d(RTCPeerConnection.prototype,F,D),F}return Object.defineProperty(q.prototype,"localDescription",{get:function(){return this._pendingLocalOffer||this._peerConnection.localDescription},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"iceConnectionState",{get:function(){return this._isClosed?"closed":this._peerConnection.iceConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"iceGatheringState",{get:function(){return this._isClosed?"complete":this._peerConnection.iceGatheringState},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"remoteDescription",{get:function(){return this._pendingRemoteOffer||this._peerConnection.remoteDescription},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"signalingState",{get:function(){return this._isClosed?"closed":this._pendingLocalOffer?"have-local-offer":this._pendingRemoteOffer?"have-remote-offer":this._peerConnection.signalingState},enumerable:!1,configurable:!0}),q.prototype.addIceCandidate=function(z){var F=this;return this.signalingState==="have-remote-offer"?this._signalingStateLatch.when("low").then(function(){return F._peerConnection.addIceCandidate(z)}):this._peerConnection.addIceCandidate(z)},q.prototype.createOffer=function(z){var F=this;if(z=Object.assign({},z),z.offerToReceiveVideo&&!this._audioTransceiver&&!(v&&C(this,"audio"))){delete z.offerToReceiveAudio;try{this._audioTransceiver=v?this.addTransceiver("audio",{direction:"recvonly"}):this.addTransceiver("audio")}catch(D){return Promise.reject(D)}}if(z.offerToReceiveVideo&&!this._videoTransceiver&&!(v&&C(this,"video"))){delete z.offerToReceiveVideo;try{this._videoTransceiver=v?this.addTransceiver("video",{direction:"recvonly"}):this.addTransceiver("video")}catch(D){return Promise.reject(D)}}return this._peerConnection.createOffer(z).then(function(D){return F._rolledBackTracksToSSRCs.clear(),new RTCSessionDescription({type:D.type,sdp:p(F._tracksToSSRCs,D.sdp)})})},q.prototype.createAnswer=function(z){var F=this;return this._pendingRemoteOffer?this._peerConnection.setRemoteDescription(this._pendingRemoteOffer).then(function(){return F._signalingStateLatch.lower(),F._peerConnection.createAnswer()}).then(function(D){return F._pendingRemoteOffer=null,F._rolledBackTracksToSSRCs.clear(),v?new RTCSessionDescription({type:D.type,sdp:p(F._tracksToSSRCs,D.sdp)}):D},function(D){throw F._pendingRemoteOffer=null,D}):this._peerConnection.createAnswer(z).then(function(D){return F._rolledBackTracksToSSRCs.clear(),v?new RTCSessionDescription({type:D.type,sdp:p(F._tracksToSSRCs,D.sdp)}):D})},q.prototype.createDataChannel=function(z,F){var D=this._peerConnection.createDataChannel(z,F);return L(D),D},q.prototype.removeTrack=function(z){z.replaceTrack(null),this._peerConnection.removeTrack(z)},q.prototype.setLocalDescription=function(z){return this._rolledBackTracksToSSRCs.size>0&&(this._tracksToSSRCs=new Map(this._rolledBackTracksToSSRCs),this._rolledBackTracksToSSRCs.clear()),k(this,!0,z)},q.prototype.setRemoteDescription=function(z){return this._rolledBackTracksToSSRCs.clear(),k(this,!1,z)},q.prototype.close=function(){var z=this;this._isClosed||(this._isClosed=!0,this._peerConnection.close(),setTimeout(function(){z.dispatchEvent(new Event("iceconnectionstatechange")),z.dispatchEvent(new Event("signalingstatechange"))}))},q}(n);c(RTCPeerConnection.prototype,y.prototype,"_peerConnection");function k(R,q,z){function F(ee){q?R._pendingLocalOffer=ee:R._pendingRemoteOffer=ee}function D(){q?R._pendingLocalOffer=null:R._pendingRemoteOffer=null}var W=q?R._pendingLocalOffer:R._pendingRemoteOffer,X=q?R._pendingRemoteOffer:R._pendingLocalOffer,me=q?"have-local-offer":"have-remote-offer",de=q?"setLocalDescription":"setRemoteDescription";if(!q&&X&&z.type==="answer")return I(R,z);if(z.type==="offer"){if(R.signalingState!==me&&R.signalingState!=="stable")return Promise.reject(new Error("Cannot set "+(q?"local":"remote")+`
        offer in state `+R.signalingState));!W&&R._signalingStateLatch.state==="low"&&R._signalingStateLatch.raise();var H=R.signalingState;return F(z),R.signalingState!==H?Promise.resolve().then(function(){return R.dispatchEvent(new Event("signalingstatechange"))}):Promise.resolve()}else if(z.type==="rollback")return R.signalingState!==me?Promise.reject(new Error(`Cannot rollback 
        `+(q?"local":"remote")+" description in "+R.signalingState)):(D(),R._rolledBackTracksToSSRCs=new Map(R._tracksToSSRCs),R._tracksToSSRCs=new Map(R._appliedTracksToSSRCs),Promise.resolve().then(function(){return R.dispatchEvent(new Event("signalingstatechange"))}));return R._peerConnection[de](z)}function I(R,q){var z=R._pendingLocalOffer;return R._peerConnection.setLocalDescription(z).then(function(){return R._pendingLocalOffer=null,R.setRemoteDescription(q)}).then(function(){return R._signalingStateLatch.lower()})}function C(R,q){return!!R.getTransceivers().find(function(z){var F=z.receiver,D=F===void 0?{}:F,W=D.track,X=W===void 0?{}:W;return X.kind===q})}function L(R){return Object.defineProperties(R,{maxPacketLifeTime:{value:R.maxPacketLifeTime===65535?null:R.maxPacketLifeTime},maxRetransmits:{value:R.maxRetransmits===65535?null:R.maxRetransmits}})}return Ah=y,Ah}(function(t){if(typeof RTCPeerConnection=="function"){var r=hr.guessBrowser;switch(r()){case"chrome":t.exports=Sj();break;case"firefox":t.exports=Ej();break;case"safari":t.exports=Mj();break;default:t.exports=RTCPeerConnection;break}}else t.exports=function(){throw new Error("RTCPeerConnection is not supported")}})(hj);var Ph={},Cj={get exports(){return Ph},set exports(t){Ph=t}};(function(t){if(typeof RTCSessionDescription=="function"){var r=hr.guessBrowser;switch(r()){case"chrome":t.exports=Aw();break;case"firefox":t.exports=Gw();break;default:t.exports=RTCSessionDescription;break}}else t.exports=function(){throw new Error("RTCSessionDescription is not supported")}})(Cj);var Xw={};Object.defineProperties(Xw,{getStats:{enumerable:!0,value:dj},getUserMedia:{enumerable:!0,value:vj},MediaStream:{enumerable:!0,value:Rf},MediaStreamTrack:{enumerable:!0,value:wh},RTCIceCandidate:{enumerable:!0,value:kh},RTCPeerConnection:{enumerable:!0,value:Th},RTCSessionDescription:{enumerable:!0,value:Ph}});var Io=Xw,xh=function(r,e){if(r&&e)if(r.super_=e,typeof Object.create=="function")r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}});else{var n=function(){function i(){}return i}();n.prototype=e.prototype,r.prototype=new n,r.prototype.constructor=r}},Rj=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a};function Ij(){return/Android/.test(navigator.userAgent)}function Kw(){return!!(navigator&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2)}function ek(){return Kw()&&window.screen.width>=744&&(/Macintosh/i.test(navigator.userAgent)||/iPad/.test(navigator.userAgent)||/iPad/.test(navigator.platform))}function tk(){return Kw()&&window.screen.width<=476&&(/Macintosh/i.test(navigator.userAgent)||/iPhone/.test(navigator.userAgent)||/iPhone/.test(navigator.platform))}function Oj(){return ek()||tk()}function Nj(){return/Mobi/.test(navigator.userAgent)}function Aj(t){return t==="chrome"&&/Edge/.test(navigator.userAgent)&&(typeof chrome>"u"||typeof chrome.runtime>"u")}function Pj(t){if(t!=="chrome")return null;if("brave"in navigator)return"brave";var r=Dj(navigator.userAgent),e=r.reduce(function(o,s){return o.replace(s,"")},navigator.userAgent),n=e.match(/[^\s]+/g)||[],i=Rj(n.map(function(o){return o.split("/")[0].toLowerCase()})),a=i.slice(2);return a.find(function(o){return!["chrome","mobile","safari"].includes(o)})||null}function xj(t){return t!=="safari"?null:"brave"in navigator?"brave":["edge","edg"].find(function(r){return navigator.userAgent.toLowerCase().includes(r)})||null}function Dj(t){for(var r=[],e=[],n=0;n<t.length;n++)if(t[n]==="(")r.push(n);else if(t[n]===")"&&r.length>0){var i=r.pop();r.length===0&&e.push(t.substring(i,n+1))}return e}var Oo={isAndroid:Ij,isIOS:Oj,isIpad:ek,isIphone:tk,isMobile:Nj,isNonChromiumEdge:Aj,mobileWebKitBrowser:xj,rebrandedChromeBrowser:Pj},Nf=at.defer,Lj=function(){function t(){Object.defineProperties(this,{_audio:{value:Nf(),writable:!0},_video:{value:Nf(),writable:!0}}),this._audio.resolve(),this._video.resolve()}return t.prototype.resolveDeferred=function(r){r==="audio"?this._audio.resolve():this._video.resolve()},t.prototype.startDeferred=function(r){r==="audio"?this._audio=Nf():this._video=Nf()},t.prototype.whenResolved=function(r){return r==="audio"?this._audio.promise:this._video.promise},t}(),rk=new Lj,Uj=Wr.EventEmitter,jj=at.hidePrivateAndCertainPublicPropertiesInClass,il=jj(Uj,["domain"]),Vj=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Fj=il,nk=at,$j=nk.buildLogLevels,zj=nk.valueToJSON,Wj=fr.DEFAULT_LOG_LEVEL,Bj=na,Zj=0,qj=function(t){Vj(r,t);function r(e,n,i){var a=this;i=Object.assign({name:e,log:null,logLevel:Wj},i),a=t.call(this)||this;var o=String(i.name),s=$j(i.logLevel),u=i.log?i.log.createLog("media",a):new Bj("media",a,s,i.loggerName);return Object.defineProperties(a,{_instanceId:{value:++Zj},_log:{value:u},kind:{enumerable:!0,value:n},name:{enumerable:!0,value:o}}),a}return r.prototype.toJSON=function(){return zj(this)},r}(Fj),Dh=qj,Qj=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Yj=Oo.isIOS,Gj=Io.MediaStream,ik=at,Hj=ik.waitForEvent,Jj=ik.waitForSometime,Xj=rk,Kj=Dh,e5=function(t){Qj(r,t);function r(e,n){var i=this;n=Object.assign({playPausedElementsIfNotBackgrounded:Yj()&&typeof document=="object"&&typeof document.addEventListener=="function"&&typeof document.visibilityState=="string"},n),i=t.call(this,e.id,e.kind,n)||this;var a=!1;return n=Object.assign({MediaStream:Gj},n),Object.defineProperties(i,{_attachments:{value:new Set},_dummyEl:{value:null,writable:!0},_elShims:{value:new WeakMap},_isStarted:{get:function(){return a},set:function(o){a=o}},_playPausedElementsIfNotBackgrounded:{value:n.playPausedElementsIfNotBackgrounded},_shouldShimAttachedElements:{value:n.workaroundWebKitBug212780||n.playPausedElementsIfNotBackgrounded},_unprocessedTrack:{value:null,writable:!0},_MediaStream:{value:n.MediaStream},isStarted:{enumerable:!0,get:function(){return a}},mediaStreamTrack:{enumerable:!0,get:function(){return this._unprocessedTrack||e.track}},processedTrack:{enumerable:!0,value:null,writable:!0}}),i._initialize(),i}return r.prototype._start=function(){this._log.debug("Started"),this._isStarted=!0,this._dummyEl&&(this._dummyEl.oncanplay=null),this.emit("started",this)},r.prototype._initialize=function(){var e=this;this._log.debug("Initializing"),this._dummyEl=this._createElement(),this.mediaStreamTrack.addEventListener("ended",function n(){e._end(),e.mediaStreamTrack.removeEventListener("ended",n)}),this._dummyEl&&(this._dummyEl.muted=!0,this._dummyEl.oncanplay=this._start.bind(this,this._dummyEl),this._attach(this._dummyEl,this.mediaStreamTrack),this._attachments.delete(this._dummyEl))},r.prototype._end=function(){this._log.debug("Ended"),this._dummyEl&&(this._dummyEl.remove(),this._dummyEl.srcObject=null,this._dummyEl.oncanplay=null,this._dummyEl=null)},r.prototype.attach=function(e){var n=this;if(typeof e=="string"?e=this._selectElement(e):e||(e=this._createElement()),this._log.debug("Attempting to attach to element:",e),e=this._attach(e),this._shouldShimAttachedElements&&!this._elShims.has(e)){var i=this._playPausedElementsIfNotBackgrounded?function(){return t5(e,n._log)}:null;this._elShims.set(e,r5(e,i))}return e},r.prototype._attach=function(e,n){n===void 0&&(n=this.processedTrack||this.mediaStreamTrack);var i=e.srcObject;i instanceof this._MediaStream||(i=new this._MediaStream);var a=n.kind==="audio"?"getAudioTracks":"getVideoTracks";return i[a]().forEach(function(o){i.removeTrack(o)}),i.addTrack(n),e.srcObject=i,e.autoplay=!0,e.playsInline=!0,this._attachments.has(e)||this._attachments.add(e),e},r.prototype._selectElement=function(e){var n=document.querySelector(e);if(!n)throw new Error("Selector matched no element: "+e);return n},r.prototype._updateElementsMediaStreamTrack=function(){var e=this;this._log.debug("Reattaching all elements to update mediaStreamTrack"),this._getAllAttachedElements().forEach(function(n){return e._attach(n)})},r.prototype._createElement=function(){return typeof document<"u"?document.createElement(this.kind):null},r.prototype.detach=function(e){var n;return typeof e=="string"?n=[this._selectElement(e)]:e?n=[e]:n=this._getAllAttachedElements(),this._log.debug("Attempting to detach from elements:",n),this._detachElements(n),e?n[0]:n},r.prototype._detachElements=function(e){return e.map(this._detachElement.bind(this))},r.prototype._detachElement=function(e){if(!this._attachments.has(e))return e;var n=e.srcObject;if(n instanceof this._MediaStream&&n.removeTrack(this.processedTrack||this.mediaStreamTrack),this._attachments.delete(e),this._shouldShimAttachedElements&&this._elShims.has(e)){var i=this._elShims.get(e);i.unShim(),this._elShims.delete(e)}return e},r.prototype._getAllAttachedElements=function(){var e=[];return this._attachments.forEach(function(n){e.push(n)}),e},r}(Kj);function t5(t,r){var e=t.tagName.toLowerCase();r.warn("Unintentionally paused:",t),Promise.race([Hj(document,"visibilitychange"),Jj(1e3)]).then(function(){document.visibilityState==="visible"&&Xj.whenResolved("audio").then(function(){return r.info("Playing unintentionally paused <"+e+"> element"),r.debug("Element:",t),t.play()}).then(function(){r.info("Successfully played unintentionally paused <"+e+"> element"),r.debug("Element:",t)}).catch(function(n){r.warn("Error while playing unintentionally paused <"+e+"> element:",{error:n,el:t})})})}function r5(t,r){r===void 0&&(r=null);var e=t.pause,n=t.play,i=!1;t.pause=function(){return i=!0,e.call(t)},t.play=function(){return i=!1,n.call(t)};var a=r?function(){i||r()}:null;return a&&t.addEventListener("pause",a),{pausedIntentionally:function(){return i},unShim:function(){t.pause=e,t.play=n,a&&t.removeEventListener("pause",a)}}}var ak=e5,n5=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),i5=ak,a5=function(t){n5(r,t);function r(e,n){return t.call(this,e,n)||this}return r.prototype.attach=function(){return t.prototype.attach.apply(this,arguments)},r.prototype.detach=function(){return t.prototype.detach.apply(this,arguments)},r}(i5),ok=a5;function o5(t){return t=typeof t=="number"?t:0,new Promise(function(r){return setTimeout(r,t)})}function s5(t,r,e){e=typeof e=="number"?e:250;var n=t.createMediaStreamSource(r),i=t.createAnalyser();i.fftSize=2048,n.connect(i);var a=new Uint8Array(i.fftSize),o=!1;setTimeout(function(){o=!0},e);function s(){return o?Promise.resolve(!0):(i.getByteTimeDomainData(a),a.some(function(u){return u!==128&&u!==0})?Promise.resolve(!1):o5().then(s))}return s().then(function(u){return n.disconnect(),u},function(u){throw n.disconnect(),u})}var sk=s5,Lh,uk;function Af(){if(uk)return Lh;uk=1;var t=typeof AudioContext<"u"?AudioContext:typeof webkitAudioContext<"u"?webkitAudioContext:null,r=function(){function e(n){n=Object.assign({AudioContext:t},n),Object.defineProperties(this,{_AudioContext:{value:n.AudioContext},_audioContext:{value:null,writable:!0},_holders:{value:new Set},AudioContextFactory:{enumerable:!0,value:e}})}return e.prototype.getOrCreate=function(n){if(!this._holders.has(n)&&(this._holders.add(n),this._AudioContext&&!this._audioContext))try{this._audioContext=new this._AudioContext}catch{}return this._audioContext},e.prototype.release=function(n){this._holders.has(n)&&(this._holders.delete(n),!this._holders.size&&this._audioContext&&(this._audioContext.close(),this._audioContext=null))},e}();return Lh=new r,Lh}var u5=sk,l5=3,c5=250;function f5(t){var r=Af(),e={},n=r.getOrCreate(e),i=l5;function a(){return i--,u5(n,t.srcObject,c5).then(function(o){return o?i>0?a():!0:!1}).catch(function(){return!0})}return a().finally(function(){r.release(e)})}var d5=f5,Uh=null,p5=3,lk=50,ck=250,fk=50;function v5(t){try{var r=Uh.getContext("2d");r.drawImage(t,0,0,fk,lk);var e=r.getImageData(0,0,fk,lk),n=e.data.filter(function(a,o){return(o+1)%4}),i=Math.max.apply(Math,n);return i===0}catch(a){return console.log("Error checking silence: ",a),!1}}function h5(t){return Uh=Uh||document.createElement("canvas"),new Promise(function(r){var e=p5;setTimeout(function n(){return e--,v5(t)?e>0?setTimeout(n,ck):r(!0):r(!1)},ck)})}var dk=h5,m5=function(){function t(r){var e=this;r===void 0&&(r=1),Object.defineProperties(this,{_listeners:{value:[]},_onVisibilityChange:{value:function(){e._emitVisible(document.visibilityState==="visible")}}});for(var n=0;n<r;n++)this._listeners.push([])}return t.prototype.clear=function(){for(var r=this._listeners.length,e=0;e<r;e++)this._listeners[e]=[]},t.prototype._listenerCount=function(){return this._listeners.reduce(function(r,e){return r+e.length},0)},t.prototype._emitVisible=function(r){for(var e=this,n=Promise.resolve(),i=function(o){n=n.then(function(){return e._emitVisiblePhase(o,r)})},a=1;a<=this._listeners.length;a++)i(a);return n},t.prototype._emitVisiblePhase=function(r,e){var n=this._listeners[r-1];return Promise.all(n.map(function(i){var a=i(e);return a instanceof Promise?a:Promise.resolve(a)}))},t.prototype._start=function(){document.addEventListener("visibilitychange",this._onVisibilityChange)},t.prototype._stop=function(){document.removeEventListener("visibilitychange",this._onVisibilityChange)},t.prototype.onVisibilityChange=function(r,e){if(typeof r!="number"||r<=0||r>this._listeners.length)throw new Error("invalid phase: ",r);var n=this._listeners[r-1];return n.push(e),this._listenerCount()===1&&this._start(),this},t.prototype.offVisibilityChange=function(r,e){if(typeof r!="number"||r<=0||r>this._listeners.length)throw new Error("invalid phase: ",r);var n=this._listeners[r-1],i=n.indexOf(e);return i!==-1&&(n.splice(i,1),this._listenerCount()===0&&this._stop()),this},t}(),jh=new m5(2),g5=sk;function y5(t,r,e,n,i){n=typeof n=="number"?n:3;var a=0,o=Af(),s={},u=o.getOrCreate(s);function l(){return r(e).then(function(c){var f=e.audio?g5(u,c,i).catch(function(d){return t.warn("Encountered an error while detecting silence",d),!0}):Promise.resolve(!1);return f.then(function(d){if(d){if(n<=0)return t.warn("Got a silent audio MediaStreamTrack. Normally we would try to get a new one, but we've run out of retries; returning it anyway."),c}else return t.info("Got a non-silent audio MediaStreamTrack; returning it."),c;return t.warn("Got a silent audio MediaStreamTrack. Stopping all MediaStreamTracks and calling getUserMedia again. This is retry #"+ ++a+"."),c.getTracks().forEach(function(v){return v.stop()}),n--,l()})})}return l().then(function(c){return o.release(s),c},function(c){throw o.release(s),c})}var pk=y5,b5=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),vk=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},hk=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},_5=Wr.EventEmitter,w5=function(t){b5(r,t);function r(){var e=t.call(this)||this;return Object.defineProperties(e,{_queuedEvents:{value:new Map}}),e}return r.prototype.dequeue=function(e){var n=this,i=!0;if(!e)return this._queuedEvents.forEach(function(o,s){i=this.dequeue(s)&&i},this),i;var a=this._queuedEvents.get(e)||[];return this._queuedEvents.delete(e),a.reduce(function(o,s){return n.emit.apply(n,hk([],vk([e].concat(s))))&&o},i)},r.prototype.queue=function(){var e=[].slice.call(arguments);if(this.emit.apply(this,hk([],vk(e))))return!0;var n=e[0];return this._queuedEvents.has(n)||this._queuedEvents.set(n,[]),this._queuedEvents.get(n).push(e.slice(1)),!1},r}(_5),mk=w5,k5=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),T5=mk,S5=function(t){k5(r,t);function r(e,n){var i=t.call(this)||this;return Object.defineProperties(i,{id:{enumerable:!0,value:e},kind:{enumerable:!0,value:n}}),i}return r.prototype.stop=function(){this.emit("stopped")},r}(T5),gk=S5,E5=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),M5=gk,C5=function(t){E5(r,t);function r(e,n){var i=t.call(this,e,n.kind)||this;return Object.defineProperties(i,{_track:{value:n,writable:!0},enabled:{enumerable:!0,get:function(){return this._track.enabled}},readyState:{enumerable:!0,get:function(){return this._track.readyState}},track:{enumerable:!0,get:function(){return this._track}}}),i}return r.prototype.stop=function(){this.track.stop(),t.prototype.stop.call(this)},r}(M5),yk=C5,R5=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),I5=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},O5=yk,N5=function(t){R5(r,t);function r(e){var n=t.call(this,e.id,e)||this;return Object.defineProperties(n,{_clones:{value:new Set},_eventsToReemitters:{value:new Map([["mute",function(){return n.queue("muted")}],["unmute",function(){return n.queue("unmuted")}]])},_senders:{value:new Set},_senderToPublisherHintCallbacks:{value:new Map},isPublishing:{enumerable:!0,get:function(){return!!this._clones.size}},muted:{enumerable:!0,get:function(){return this._track.muted}}}),n._reemitMediaStreamTrackEvents(),n}return r.prototype._reemitMediaStreamTrackEvents=function(e){e===void 0&&(e=this._track);var n=this,i=n._eventsToReemitters,a=n._track;if(i.forEach(function(s,u){return e.addEventListener(u,s)}),a!==e&&(i.forEach(function(s,u){return a.removeEventListener(u,s)}),a.muted!==e.muted)){var o=i.get(e.muted?"mute":"unmute");o()}},r.prototype.clone=function(){var e=new r(this.track.clone());return this._clones.add(e),e},r.prototype.removeClone=function(e){this._clones.delete(e)},r.prototype.setMediaStreamTrack=function(e){var n=this,i=Array.from(this._clones),a=Array.from(this._senders);return Promise.all(i.map(function(o){return o.setMediaStreamTrack(e.clone())}).concat(a.map(function(o){return n._replaceTrack(o,e)}))).finally(function(){n._reemitMediaStreamTrackEvents(e),n._track=e})},r.prototype.addSender=function(e,n){return this._senders.add(e),n&&this._senderToPublisherHintCallbacks.set(e,n),this},r.prototype.removeSender=function(e){return this._senders.delete(e),this._senderToPublisherHintCallbacks.delete(e),this},r.prototype.setPublisherHint=function(e){var n=I5(Array.from(this._senderToPublisherHintCallbacks.values()),1),i=n[0];return i?i(e):Promise.resolve("COULD_NOT_APPLY_HINT")},r.prototype._replaceTrack=function(e,n){var i=this;return e.replaceTrack(n).then(function(a){return i.setPublisherHint(null).catch(function(){}),i.emit("replaced"),a})},r}(O5),bk=N5,A5=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),P5=Io.getUserMedia,x5=Oo.isIOS,al=at,_k=al.capitalize,D5=al.defer,L5=al.isUserMediaTrack,U5=al.waitForSometime,j5=al.waitForEvent,V5=fr.typeErrors.ILLEGAL_INVOKE,F5=d5,$5=dk,wk=jh,kk=rk,z5=pk,W5=bk;function B5(t){return function(r){A5(e,r);function e(n,i){var a=this,o=x5()&&L5(n)&&typeof document=="object"&&typeof document.addEventListener=="function"&&typeof document.visibilityState=="string";i=Object.assign({getUserMedia:P5,isCreatedByCreateLocalTracks:!1,workaroundWebKitBug1208516:o,gUMSilentTrackWorkaround:z5},i);var s=new W5(n),u=s.kind;return a=r.call(this,s,i)||this,Object.defineProperties(a,{_constraints:{value:typeof i[u]=="object"?i[u]:{},writable:!0},_getUserMedia:{value:i.getUserMedia},_gUMSilentTrackWorkaround:{value:i.gUMSilentTrackWorkaround},_eventsToReemitters:{value:new Map([["muted",function(){return a.emit("muted",a)}],["unmuted",function(){return a.emit("unmuted",a)}]])},_workaroundWebKitBug1208516:{value:i.workaroundWebKitBug1208516},_workaroundWebKitBug1208516Cleanup:{value:null,writable:!0},_didCallEnd:{value:!1,writable:!0},_isCreatedByCreateLocalTracks:{value:i.isCreatedByCreateLocalTracks},_trackSender:{value:s},id:{enumerable:!0,value:s.id},isEnabled:{enumerable:!0,get:function(){return s.enabled}},isMuted:{enumerable:!0,get:function(){return s.muted}},isStopped:{enumerable:!0,get:function(){return s.readyState==="ended"}}}),a._workaroundWebKitBug1208516&&(a._workaroundWebKitBug1208516Cleanup=Tk(a)),a._reemitTrackSenderEvents(),a}return e.prototype._end=function(){var n=this;this._didCallEnd||(r.prototype._end.call(this),this._didCallEnd=!0,this._eventsToReemitters.forEach(function(i,a){return n._trackSender.removeListener(a,i)}),this.emit("stopped",this))},e.prototype._initialize=function(){this._didCallEnd&&(this._didCallEnd=!1),this._eventsToReemitters&&this._reemitTrackSenderEvents(),r.prototype._initialize.call(this)},e.prototype._reacquireTrack=function(n){var i,a=this,o=a._getUserMedia,s=a._gUMSilentTrackWorkaround,u=a._log,l=a.mediaStreamTrack.kind;u.info("Re-acquiring the MediaStreamTrack"),u.debug("Constraints:",n);var c=Object.assign({audio:!1,video:!1},(i={},i[l]=n,i)),f=this._workaroundWebKitBug1208516Cleanup?s(u,o,c):o(c);return f.then(function(d){return d.getTracks()[0]})},e.prototype._reemitTrackSenderEvents=function(){var n=this;this._eventsToReemitters.forEach(function(i,a){return n._trackSender.on(a,i)}),this._trackSender.dequeue("muted"),this._trackSender.dequeue("unmuted")},e.prototype._restart=function(n){var i=this,a=this._log;return n=n||this._constraints,this._stop(),this._reacquireTrack(n).catch(function(o){throw a.error("Failed to re-acquire the MediaStreamTrack:",{error:o,constraints:n}),o}).then(function(o){return a.info("Re-acquired the MediaStreamTrack"),a.debug("MediaStreamTrack:",o),i._constraints=Object.assign({},n),i._setMediaStreamTrack(o)})},e.prototype._setMediaStreamTrack=function(n){var i=this;return n.enabled=this.mediaStreamTrack.enabled,this._stop(),(this._unprocessedTrack?Promise.resolve().then(function(){i._unprocessedTrack=n}):this._trackSender.setMediaStreamTrack(n).catch(function(a){i._log.warn("setMediaStreamTrack failed:",{error:a,mediaStreamTrack:n})})).then(function(){i._initialize(),i._getAllAttachedElements().forEach(function(a){return i._attach(a)})})},e.prototype._stop=function(){return this.mediaStreamTrack.stop(),this._end(),this},e.prototype.enable=function(n){return n=typeof n=="boolean"?n:!0,n!==this.mediaStreamTrack.enabled&&(this._log.info((n?"En":"Dis")+"abling"),this.mediaStreamTrack.enabled=n,this.emit(n?"enabled":"disabled",this)),this},e.prototype.disable=function(){return this.enable(!1)},e.prototype.restart=function(n){var i=this,a=this.kind;if(!this._isCreatedByCreateLocalTracks)return Promise.reject(V5("restart","can only be called on a"+(" Local"+_k(a)+"Track that is created using createLocalTracks")+(" or createLocal"+_k(a)+"Track.")));this._workaroundWebKitBug1208516Cleanup&&(this._workaroundWebKitBug1208516Cleanup(),this._workaroundWebKitBug1208516Cleanup=null);var o=this._restart(n);return this._workaroundWebKitBug1208516&&(o=o.finally(function(){i._workaroundWebKitBug1208516Cleanup=Tk(i)})),o},e.prototype.stop=function(){return this._log.info("Stopping"),this._workaroundWebKitBug1208516Cleanup&&(this._workaroundWebKitBug1208516Cleanup(),this._workaroundWebKitBug1208516Cleanup=null),this._stop()},e}(t)}function Tk(t){var r=t._log,e=t.kind,n={audio:F5,video:$5}[e],i=t._dummyEl,a=t.mediaStreamTrack,o=null;function s(){return i.play().then(function(){return n(i)}).then(function(p){return p?r.warn("Silence detected"):r.info("Non-silence detected"),p}).catch(function(p){r.warn("Failed to detect silence:",p)}).finally(function(){i.pause()})}function u(){var p=t._workaroundWebKitBug1208516Cleanup,y=t.isStopped,k=t.mediaStreamTrack.muted,I=y&&!!p;return Promise.resolve().then(function(){return document.visibilityState==="visible"&&!o&&(k||I||s())})}function l(){return Promise.race([j5(a,"unmute"),U5(50)]).then(function(){return u()}).then(function(p){p&&!o&&(o=D5(),t._restart().finally(function(){i=t._dummyEl,d(),a=t.mediaStreamTrack,f(),o.resolve(),o=null}).catch(function(k){r.error("failed to restart track: ",k)}));var y=o&&o.promise||Promise.resolve();return y.finally(function(){return kk.resolveDeferred(e)})}).catch(function(p){r.error("error in maybeRestart: "+p.message)})}function c(){var p=t._log,y=t.kind;p.info("Muted"),p.debug("LocalMediaTrack:",t),kk.startDeferred(y)}function f(){a.addEventListener("ended",l),a.addEventListener("mute",c),a.addEventListener("unmute",l)}function d(){a.removeEventListener("ended",l),a.removeEventListener("mute",c),a.removeEventListener("unmute",l)}var v=function(p){return p?l():!1};return wk.onVisibilityChange(1,v),f(),function(){wk.offVisibilityChange(1,v),d()}}var Sk=B5,Z5=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),q5=Oo.isIOS,Q5=ok,Y5=Sk,G5=Y5(Q5),H5=function(t){Z5(r,t);function r(e,n){var i=this,a=(n==null?void 0:n.noiseCancellation)||null;i=t.call(this,e,n)||this;var o=i._log,s=e.label,u=s===void 0?"":s,l=e.getSettings(),c=l.deviceId,f=c===void 0?"":c,d=l.groupId,v=d===void 0?"":d;return Object.defineProperties(i,{_currentDefaultDeviceInfo:{value:{deviceId:f,groupId:v,label:u},writable:!0},_defaultDeviceCaptureMode:{value:!q5()&&i._isCreatedByCreateLocalTracks&&typeof navigator=="object"&&typeof navigator.mediaDevices=="object"&&typeof navigator.mediaDevices.addEventListener=="function"&&typeof navigator.mediaDevices.enumerateDevices=="function"?(n==null?void 0:n.defaultDeviceCaptureMode)||"auto":"manual"},_onDeviceChange:{value:function(){navigator.mediaDevices.enumerateDevices().then(function(p){var y=p.find(function(k){var I=k.deviceId,C=k.kind;return C==="audioinput"&&I!=="default"});y&&["deviceId","groupId"].some(function(k){return y[k]!==i._currentDefaultDeviceInfo[k]})&&(o.info("Default device changed, restarting the LocalAudioTrack"),o.debug('Old default device: "'+i._currentDefaultDeviceInfo.deviceId+'" => "'+i._currentDefaultDeviceInfo.label+'"'),o.debug('New default device: "'+y.deviceId+'" => "'+y.label+'"'),i._currentDefaultDeviceInfo=y,i._restartDefaultDevice().catch(function(k){return o.warn("Failed to restart: "+k.message)}))},function(p){o.warn("Failed to run enumerateDevices(): "+p.message)})}},_restartOnDefaultDeviceChangeCleanup:{value:null,writable:!0},noiseCancellation:{enumerable:!0,value:a,writable:!1}}),o.debug("defaultDeviceCaptureMode:",i._defaultDeviceCaptureMode),i._maybeRestartOnDefaultDeviceChange(),i}return r.prototype.toString=function(){return"[LocalAudioTrack #"+this._instanceId+": "+this.id+"]"},r.prototype.attach=function(e){return e=t.prototype.attach.call(this,e),e.muted=!0,e},r.prototype._end=function(){return t.prototype._end.apply(this,arguments)},r.prototype._maybeRestartOnDefaultDeviceChange=function(){var e=this,n=this,i=n._constraints,a=n._defaultDeviceCaptureMode,o=n._log,s=this.noiseCancellation?this.noiseCancellation.sourceTrack:this.mediaStreamTrack,u=s.getSettings().deviceId,l=function(f){return f!==u||f==="default"},c=function f(d){return d===void 0&&(d={}),typeof d=="string"?l(d):Array.isArray(d)?d.every(l):d.exact?f(d.exact):d.ideal?f(d.ideal):!0}(i.deviceId);a==="auto"&&c?this._restartOnDefaultDeviceChangeCleanup||(o.info("LocalAudioTrack will be restarted if the default device changes"),navigator.mediaDevices.addEventListener("devicechange",this._onDeviceChange),this._restartOnDefaultDeviceChangeCleanup=function(){o.info("Cleaning up the listener to restart the LocalAudioTrack if the default device changes"),navigator.mediaDevices.removeEventListener("devicechange",e._onDeviceChange),e._restartOnDefaultDeviceChangeCleanup=null}):(o.info("LocalAudioTrack will NOT be restarted if the default device changes"),this._restartOnDefaultDeviceChangeCleanup&&this._restartOnDefaultDeviceChangeCleanup())},r.prototype._reacquireTrack=function(e){var n=this;return this._log.debug("_reacquireTrack: ",e),this.noiseCancellation?this.noiseCancellation.reacquireTrack(function(){return t.prototype._reacquireTrack.call(n,e)}):t.prototype._reacquireTrack.call(this,e)},r.prototype._restartDefaultDevice=function(){var e=this,n=Object.assign({},this._constraints),i=Object.assign({},n,{deviceId:this._currentDefaultDeviceInfo.deviceId});return this.restart(i).then(function(){e._constraints=n,e._maybeRestartOnDefaultDeviceChange()})},r.prototype.disable=function(){return t.prototype.disable.apply(this,arguments)},r.prototype.enable=function(){return t.prototype.enable.apply(this,arguments)},r.prototype.restart=function(){return t.prototype.restart.apply(this,arguments)},r.prototype.stop=function(){return this.noiseCancellation&&this.noiseCancellation.stop(),this._restartOnDefaultDeviceChangeCleanup&&this._restartOnDefaultDeviceChangeCleanup(),t.prototype.stop.apply(this,arguments)},r}(G5),J5=H5,X5=xh,Ek=J5;function Vh(t,r){var e=new Ek(t,r);return Object.setPrototypeOf(e,Vh.prototype),e}X5(Vh,Ek);var K5=Vh,eV=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),tV=Wr.EventEmitter,rV=fr.DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS,nV=function(t){eV(r,t);function r(e){var n=t.call(this)||this;return Object.defineProperties(n,{_lastStatsSaveTime:{value:null,writable:!0},_lastStatsPublishTime:{value:null,writable:!0},_log:{value:e},_processorInfo:{value:null,writable:!0},_stats:{value:null,writable:!0}}),n.on("add",function(i){n._lastStatsSaveTime=Date.now(),n._lastStatsPublishTime=Date.now(),n._processorInfo=i,n._stats=[],n._reemitEvent("add",n._getEventData())}),n.on("remove",function(){var i=n._getEventData();n._lastStatsSaveTime=null,n._lastStatsPublishTime=null,n._processorInfo=null,n._stats=null,n._reemitEvent("remove",i)}),n.on("start",function(){n._reemitEvent("start",n._getEventData())}),n.on("stop",function(i){n._reemitEvent("stop",Object.assign({message:i},n._getEventData()))}),n.on("stats",function(){return n._maybeEmitStats()}),n}return r.prototype._getEventData=function(){if(!this._processorInfo)return{};var e=this._processorInfo,n=e.processor,i=e.captureHeight,a=e.captureWidth,o=e.inputFrameRate,s=e.isRemoteVideoTrack,u={captureHeight:i,captureWidth:a,inputFrameRate:o,isRemoteVideoTrack:s};return u.name=n._name||"VideoProcessor",["assetsPath","blurFilterRadius","fitType","isSimdEnabled","maskBlurRadius","version"].forEach(function(l){var c=n["_"+l];typeof c<"u"&&(u[l]=c)}),Object.keys(u).forEach(function(l){var c=u[l];typeof c=="boolean"&&(u[l]=c?"true":"false")}),u},r.prototype._maybeEmitStats=function(){if(!(!this._stats||!this._processorInfo)){var e=this._processorInfo.processor._benchmark;if(e){var n=Date.now();if(!(n-this._lastStatsSaveTime<1e3)){var i={outputFrameRate:e.getRate("totalProcessingDelay")};if(["captureFrameDelay","imageCompositionDelay","inputImageResizeDelay","processFrameDelay","segmentationDelay"].forEach(function(s){i[s]=e.getAverageDelay(s)}),this._lastStatsSaveTime=n,this._stats.push(i),!(n-this._lastStatsPublishTime<rV)){this._lastStatsPublishTime=n;var a=this._stats.splice(0),o=a.reduce(function(s,u,l){return Object.keys(i).forEach(function(c){s[c]||(s[c]=0),s[c]=(s[c]*l+u[c])/(l+1)}),s},{});Object.keys(o).forEach(function(s){o[s]=parseFloat(o[s].toFixed(2))}),this._reemitEvent("stats",Object.assign({},o,this._getEventData()))}}}}},r.prototype._reemitEvent=function(e,n){this._log.debug("VideoProcessor:"+e,n),this.emit("event",{name:e,data:n})},r}(tV),iV=nV,aV=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),oV=ak,sV=iV,Mk=fr.DEFAULT_FRAME_RATE,Ck=function(t){aV(r,t);function r(e,n){var i=t.call(this,e,n)||this;return Object.defineProperties(i,{_captureTimeoutId:{value:null,writable:!0},_isCapturing:{value:!1,writable:!0},_inputFrame:{value:null,writable:!0},_outputFrame:{value:null,writable:!0},_processorEventObserver:{value:null,writable:!0},_unmuteHandler:{value:null,writable:!0},dimensions:{enumerable:!0,value:{width:null,height:null}},processor:{enumerable:!0,value:null,writable:!0}}),i._processorEventObserver=new(n.VideoProcessorEventObserver||sV)(i._log),i}return r.prototype._checkIfCanCaptureFrames=function(e){e===void 0&&(e=!1);var n=!0,i="",a=this.mediaStreamTrack,o=a.enabled,s=a.readyState;return o||(n=!1,i="MediaStreamTrack is disabled"),s==="ended"&&(n=!1,i="MediaStreamTrack is ended"),this.processor||(n=!1,i="VideoProcessor not detected."),!this._attachments.size&&!e&&(n=!1,i="VideoTrack is not publishing and there is no attached element."),i&&this._log.debug(i),{canCaptureFrames:n,message:i}},r.prototype._captureFrames=function(){var e=this;if(this._isCapturing){this._log.debug("Ignoring captureFrames call. Capture is already in progress");return}if(!this._checkIfCanCaptureFrames().canCaptureFrames){this._isCapturing=!1,this._log.debug("Cannot capture frames. Ignoring captureFrames call.");return}this._isCapturing=!0,this._processorEventObserver.emit("start"),this._log.debug("Start capturing frames");var n=Date.now(),i;this._dummyEl.play().then(function(){var a=function(s){clearTimeout(e._captureTimeoutId);var u=e.mediaStreamTrack.getSettings().frameRate,l=u===void 0?Mk:u,c=Math.floor(1e3/l),f=c-i;(f<0||typeof i!="number")&&(f=0),e._captureTimeoutId=setTimeout(s,f)},o=function(){var s=e._checkIfCanCaptureFrames();if(!s.canCaptureFrames){e._isCapturing=!1,e._processorEventObserver.emit("stop",s.message),e._log.debug("Cannot capture frames. Stopping capturing frames.");return}n=Date.now();var u=e.mediaStreamTrack.getSettings(),l=u.width,c=l===void 0?0:l,f=u.height,d=f===void 0?0:f;e._inputFrame.width!==c&&(e._inputFrame.width=c,e._inputFrame.height=d,e._outputFrame&&(e._outputFrame.width=c,e._outputFrame.height=d)),e._inputFrame.getContext("2d").drawImage(e._dummyEl,0,0,c,d);var v=null;try{v=e.processor.processFrame(e._inputFrame,e._outputFrame)}catch(p){e._log.debug("Exception detected after calling processFrame.",p)}(v instanceof Promise?v:Promise.resolve(v)).then(function(){e._outputFrame&&(e.processedTrack.requestFrame(),e._processorEventObserver.emit("stats"))}).finally(function(){i=Date.now()-n,a(o)})};a(o)}).catch(function(a){return e._log.error("Video element cannot be played",{error:a,track:e})})},r.prototype._initialize=function(){var e=this;t.prototype._initialize.call(this),this._dummyEl&&(this._dummyEl.onloadedmetadata=function(){Rk(e,e._dummyEl)&&(e.dimensions.width=e._dummyEl.videoWidth,e.dimensions.height=e._dummyEl.videoHeight)},this._dummyEl.onresize=function(){Rk(e,e._dummyEl)&&(e.dimensions.width=e._dummyEl.videoWidth,e.dimensions.height=e._dummyEl.videoHeight,e.isStarted&&(e._log.debug("Dimensions changed:",e.dimensions),e.emit(r.DIMENSIONS_CHANGED,e)))})},r.prototype._restartProcessor=function(){var e=this.processor;e&&(this.removeProcessor(e),this.addProcessor(e))},r.prototype._start=function(e){return this.dimensions.width=e.videoWidth,this.dimensions.height=e.videoHeight,this._log.debug("Dimensions:",this.dimensions),this.emit(r.DIMENSIONS_CHANGED,this),t.prototype._start.call(this,e)},r.prototype.addProcessor=function(e){var n=this;if(typeof OffscreenCanvas!="function")return this._log.warn("Adding a VideoProcessor is not supported in this browser.");if(!e||typeof e.processFrame!="function")throw new Error("Received an invalid VideoProcessor from addProcessor.");if(this.processor)throw new Error("A VideoProcessor has already been added.");if(!this._dummyEl)throw new Error("VideoTrack has not been initialized.");this._log.debug("Adding VideoProcessor to the VideoTrack",e),this._unmuteHandler||(this._unmuteHandler=function(){n._log.debug("mediaStreamTrack unmuted"),n.processedTrack.muted&&(n._log.debug("mediaStreamTrack is unmuted but processedTrack is muted. Restarting processor."),n._restartProcessor())},this.mediaStreamTrack.addEventListener("unmute",this._unmuteHandler));var i=this.mediaStreamTrack.getSettings(),a=i.width,o=a===void 0?0:a,s=i.height,u=s===void 0?0:s,l=i.frameRate,c=l===void 0?Mk:l;return this._inputFrame=new OffscreenCanvas(o,u),this._outputFrame=document.createElement("canvas"),this._outputFrame.width=o,this._outputFrame.height=u,this.processedTrack=this._outputFrame.captureStream(0).getTracks()[0],this.processedTrack.enabled=this.mediaStreamTrack.enabled,this.processor=e,this._processorEventObserver.emit("add",{processor:e,captureHeight:u,captureWidth:o,inputFrameRate:c,isRemoteVideoTrack:this.toString().includes("RemoteVideoTrack")}),this._updateElementsMediaStreamTrack(),this._captureFrames(),this},r.prototype.attach=function(){var e=t.prototype.attach.apply(this,arguments);return this.processor&&this._captureFrames(),e},r.prototype.detach=function(){return t.prototype.detach.apply(this,arguments)},r.prototype.removeProcessor=function(e){if(!e)throw new Error("Received an invalid VideoProcessor from removeProcessor.");if(!this.processor)throw new Error("No existing VideoProcessor detected.");if(e!==this.processor)throw new Error("The provided VideoProcessor is different than the existing one.");return this._processorEventObserver.emit("remove"),this._log.debug("Removing VideoProcessor from the VideoTrack",e),clearTimeout(this._captureTimeoutId),this.mediaStreamTrack.removeEventListener("unmute",this._unmuteHandler),this._unmuteHandler=null,this._isCapturing=!1,this.processor=null,this.processedTrack=null,this._inputFrame.getContext("2d").clearRect(0,0,this._inputFrame.width,this._inputFrame.height),this._outputFrame.getContext("2d").clearRect(0,0,this._outputFrame.width,this._outputFrame.height),this._inputFrame=null,this._outputFrame=null,this._updateElementsMediaStreamTrack(),this},r}(oV);Ck.DIMENSIONS_CHANGED="dimensionsChanged";function Rk(t,r){return t.dimensions.width!==r.videoWidth||t.dimensions.height!==r.videoHeight}var Ik=Ck,uV=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),lV=Oo.isIOS,cV=dk,fV=Sk,dV=Ik,pV=at.isUserMediaTrack,vV=fV(dV),hV=function(t){uV(r,t);function r(e,n){var i=this;return n=Object.assign({workaroundSilentLocalVideo:lV()&&pV(e)&&typeof document<"u"&&typeof document.createElement=="function"},n),i=t.call(this,e,n)||this,Object.defineProperties(i,{_workaroundSilentLocalVideo:{value:n.workaroundSilentLocalVideo?mV:null},_workaroundSilentLocalVideoCleanup:{value:null,writable:!0}}),i._workaroundSilentLocalVideo&&(i._workaroundSilentLocalVideoCleanup=i._workaroundSilentLocalVideo(i,document)),i}return r.prototype.toString=function(){return"[LocalVideoTrack #"+this._instanceId+": "+this.id+"]"},r.prototype._checkIfCanCaptureFrames=function(){return t.prototype._checkIfCanCaptureFrames.call(this,this._trackSender.isPublishing)},r.prototype._end=function(){return t.prototype._end.apply(this,arguments)},r.prototype._setSenderMediaStreamTrack=function(e){var n=this,i=this.mediaStreamTrack,a=e?this.processedTrack:i;return this._trackSender.setMediaStreamTrack(a).catch(function(o){return n._log.warn("setMediaStreamTrack failed on LocalVideoTrack RTCRtpSender",{error:o,mediaStreamTrack:a})}).then(function(){n._unprocessedTrack=e?i:null})},r.prototype.addProcessor=function(){this._log.debug("Adding VideoProcessor to the LocalVideoTrack");var e=t.prototype.addProcessor.apply(this,arguments);return this.processedTrack?(this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the processed MediaStreamTrack",this.processedTrack),this._setSenderMediaStreamTrack(!0),e):this._log.warn("Unable to add a VideoProcessor to the LocalVideoTrack")},r.prototype.removeProcessor=function(){var e=this;this._log.debug("Removing VideoProcessor from the LocalVideoTrack");var n=t.prototype.removeProcessor.apply(this,arguments);return this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the original MediaStreamTrack"),this._setSenderMediaStreamTrack().then(function(){return e._updateElementsMediaStreamTrack()}),n},r.prototype.disable=function(){var e=t.prototype.disable.apply(this,arguments);return this.processedTrack&&(this.processedTrack.enabled=!1),e},r.prototype.enable=function(e){e===void 0&&(e=!0);var n=t.prototype.enable.apply(this,arguments);return this.processedTrack&&(this.processedTrack.enabled=e,e&&(this._captureFrames(),this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the processed MediaStreamTrack",this.processedTrack),this._setSenderMediaStreamTrack(!0))),n},r.prototype.restart=function(){var e=this;this._workaroundSilentLocalVideoCleanup&&(this._workaroundSilentLocalVideoCleanup(),this._workaroundSilentLocalVideoCleanup=null);var n=t.prototype.restart.apply(this,arguments);return this.processor&&n.then(function(){e._restartProcessor()}),this._workaroundSilentLocalVideo&&n.finally(function(){e._workaroundSilentLocalVideoCleanup=e._workaroundSilentLocalVideo(e,document)}),n},r.prototype.stop=function(){return this._workaroundSilentLocalVideoCleanup&&(this._workaroundSilentLocalVideoCleanup(),this._workaroundSilentLocalVideoCleanup=null),t.prototype.stop.apply(this,arguments)},r}(vV);function mV(t,r){var e=t._log,n=t._dummyEl,i=t.mediaStreamTrack;function a(){t.isEnabled&&(e.info("Unmuted, checking silence"),n.play().then(function(){return cV(n)}).then(function(o){if(!o){e.info("Non-silent frames detected, so no need to restart");return}return e.warn("Silence detected, restarting"),t._stop(),t._restart()}).catch(function(o){e.warn("Failed to detect silence and restart:",o)}).finally(function(){n=t._dummyEl,n&&!n.paused&&n.pause(),i.removeEventListener("unmute",a),i=t.mediaStreamTrack,i.addEventListener("unmute",a)}))}return i.addEventListener("unmute",a),function(){i.removeEventListener("unmute",a)}}var gV=hV,yV=xh,Ok=gV;function Fh(t,r){var e=new Ok(t,r);return Object.setPrototypeOf(e,Fh.prototype),e}yV(Fh,Ok);var bV=Fh,_V=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),wV=gk,kV=function(t){_V(r,t);function r(e,n,i,a){var o=t.call(this,e,"data")||this;return Object.defineProperties(o,{maxPacketLifeTime:{enumerable:!0,value:n},maxRetransmits:{enumerable:!0,value:i},ordered:{enumerable:!0,value:a}}),o}return r}(wV),Nk=kV,TV=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),SV=Nk,EV=at.makeUUID,MV=function(t){TV(r,t);function r(e,n,i){var a=t.call(this,EV(),e,n,i)||this;return Object.defineProperties(a,{_clones:{value:new Set},_dataChannels:{value:new Set}}),a}return r.prototype._addClone=function(e){this._clones.add(e)},r.prototype.removeClone=function(e){this._clones.delete(e)},r.prototype.addDataChannel=function(e){return this._dataChannels.add(e),this},r.prototype.clone=function(){var e=this,n=new r(this.maxPacketLifeTime,this.maxRetransmits,this.ordered);return this._addClone(n),n.once("stopped",function(){return e.removeClone(n)}),n},r.prototype.removeDataChannel=function(e){return this._dataChannels.delete(e),this},r.prototype.send=function(e){return this._dataChannels.forEach(function(n){try{n.send(e)}catch{}}),this._clones.forEach(function(n){try{n.send(e)}catch{}}),this},r.prototype.stop=function(){this._dataChannels.forEach(function(e){return e.close()}),this._clones.forEach(function(e){return e.stop()}),t.prototype.stop.call(this)},r}(SV),CV=MV,RV=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),IV=Dh,OV=CV,NV=function(t){RV(r,t);function r(e){var n=this;e=Object.assign({DataTrackSender:OV,maxPacketLifeTime:null,maxRetransmits:null,ordered:!0},e);var i=e.DataTrackSender,a=new i(e.maxPacketLifeTime,e.maxRetransmits,e.ordered);return n=t.call(this,a.id,"data",e)||this,Object.defineProperties(n,{_trackSender:{value:a},id:{enumerable:!0,value:a.id},maxPacketLifeTime:{enumerable:!0,value:e.maxPacketLifeTime},maxRetransmits:{enumerable:!0,value:e.maxRetransmits},ordered:{enumerable:!0,value:e.ordered},reliable:{enumerable:!0,value:e.maxPacketLifeTime===null&&e.maxRetransmits===null}}),n}return r.prototype.send=function(e){this._trackSender.send(e)},r}(IV),AV=NV,PV=xh,Ak=AV;function $h(t){var r=new Ak(t);return Object.setPrototypeOf(r,$h.prototype),r}PV($h,Ak);var xV=$h,Rs={LocalAudioTrack:K5,LocalVideoTrack:bV,LocalDataTrack:xV},Ii=V&&V.__assign||function(){return Ii=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++){r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ii.apply(this,arguments)},Pk=V&&V.__awaiter||function(t,r,e,n){function i(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function s(c){try{l(n.next(c))}catch(f){o(f)}}function u(c){try{l(n.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((n=n.apply(t,r||[])).next())})},xk=V&&V.__generator||function(t,r){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){e.label=l[1];break}if(l[0]===6&&e.label<a[1]){e.label=a[1],a=l;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(l);break}a[2]&&e.ops.pop(),e.trys.pop();continue}l=r.call(t,e)}catch(c){l=[6,c],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},Dk=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},Lk=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t};Object.defineProperty(_f,"__esModule",{value:!0}),_f.createLocalTracks=void 0;var DV=Es,LV=at.buildLogLevels,Uk=Io,UV=Uk.getUserMedia,jV=Uk.MediaStreamTrack,zh=Rs,VV=zh.LocalAudioTrack,FV=zh.LocalDataTrack,$V=zh.LocalVideoTrack,zV=na,Wh=fr,WV=Wh.DEFAULT_LOG_LEVEL,BV=Wh.DEFAULT_LOGGER_NAME,ZV=Wh.typeErrors.INVALID_VALUE,qV=pk,QV=0;function YV(t){return Pk(this,void 0,void 0,function(){var r,e,n,i,a,o,s,u,l,c,f,d,v,p=this;return xk(this,function(y){switch(y.label){case 0:if(r=!(t&&("audio"in t||"video"in t)),e=Ii({audio:r,getUserMedia:UV,loggerName:BV,logLevel:WV,LocalAudioTrack:VV,LocalDataTrack:FV,LocalVideoTrack:$V,MediaStreamTrack:jV,Log:zV,video:r},t),n="[createLocalTracks #"+ ++QV+"]",i=LV(e.logLevel),a=new e.Log("default",n,i,e.loggerName),o=Object.assign({log:a},e),delete o.name,e.audio===!1&&e.video===!1)return a.info("Neither audio nor video requested, so returning empty LocalTracks"),[2,[]];if(e.tracks)return a.info("Adding user-provided LocalTracks"),a.debug("LocalTracks:",e.tracks),[2,e.tracks];if(s={audio:typeof e.audio=="object"&&e.audio.name?{name:e.audio.name}:{defaultDeviceCaptureMode:"auto"},video:typeof e.video=="object"&&e.video.name?{name:e.video.name}:{}},s.audio.isCreatedByCreateLocalTracks=!0,s.video.isCreatedByCreateLocalTracks=!0,typeof e.audio=="object")if(typeof e.audio.workaroundWebKitBug1208516=="boolean"&&(s.audio.workaroundWebKitBug1208516=e.audio.workaroundWebKitBug1208516),"noiseCancellationOptions"in e.audio&&(u=e.audio.noiseCancellationOptions,delete e.audio.noiseCancellationOptions),!("defaultDeviceCaptureMode"in e.audio))s.audio.defaultDeviceCaptureMode="auto";else{if(["auto","manual"].every(function(k){return k!==e.audio.defaultDeviceCaptureMode}))throw ZV("CreateLocalAudioTrackOptions.defaultDeviceCaptureMode",["auto","manual"]);s.audio.defaultDeviceCaptureMode=e.audio.defaultDeviceCaptureMode}typeof e.video=="object"&&typeof e.video.workaroundWebKitBug1208516=="boolean"&&(s.video.workaroundWebKitBug1208516=e.video.workaroundWebKitBug1208516),typeof e.audio=="object"&&delete e.audio.name,typeof e.video=="object"&&delete e.video.name,l={audio:e.audio,video:e.video},c=typeof e.audio=="object"&&e.audio.workaroundWebKitBug180748,y.label=1;case 1:return y.trys.push([1,4,,5]),[4,c?qV(a,e.getUserMedia,l):e.getUserMedia(l)];case 2:return f=y.sent(),d=Lk(Lk([],Dk(f.getAudioTracks())),Dk(f.getVideoTracks())),a.info("Call to getUserMedia successful; got tracks:",d),[4,Promise.all(d.map(function(k){return Pk(p,void 0,void 0,function(){var I,C,L;return xk(this,function(R){switch(R.label){case 0:return k.kind==="audio"&&u?[4,DV.applyNoiseCancellation(k,u,a)]:[3,2];case 1:return I=R.sent(),C=I.cleanTrack,L=I.noiseCancellation,[2,new o.LocalAudioTrack(C,Ii(Ii(Ii({},s.audio),o),{noiseCancellation:L}))];case 2:if(k.kind==="audio")return[2,new o.LocalAudioTrack(k,Ii(Ii({},s.audio),o))];R.label=3;case 3:return[2,new o.LocalVideoTrack(k,Ii(Ii({},s.video),o))]}})})}))];case 3:return[2,y.sent()];case 4:throw v=y.sent(),a.warn("Call to getUserMedia failed:",v),v;case 5:return[2]}})})}_f.createLocalTracks=YV;var Is={},Pf={};Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.Timer=void 0;var GV=function(){function t(){this._end=void 0,this.start()}return t.prototype.start=function(){return this._start=Date.now(),this},t.prototype.stop=function(){return this._end=Date.now(),this},t.prototype.getTimeMeasurement=function(){return{start:this._start,end:this._end,duration:this._end===void 0?void 0:this._end-this._start}},t}();Pf.Timer=GV;var Os={};Object.defineProperty(Os,"__esModule",{value:!0}),Os.mosToScore=Os.calculateMOS=void 0;var jk=94.768;function HV(t,r,e){var n=t+r*2+10,i=0;switch(!0){case n<160:i=jk-n/40;break;case n<1e3:i=jk-(n-120)/10;break}switch(!0){case e<=i/2.5:i=Math.max(i-e*2.5,6.52);break;default:i=0;break}var a=1+.035*i+7e-6*i*(i-60)*(100-i);return a}Os.calculateMOS=HV;function JV(t){var r=0;return t?t>4.2?r=5:t>4?r=4:t>3.6?r=3:t>3?r=2:r=1:r=0,r}Os.mosToScore=JV;var xf={},XV=V&&V.__awaiter||function(t,r,e,n){function i(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function s(c){try{l(n.next(c))}catch(f){o(f)}}function u(c){try{l(n.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((n=n.apply(t,r||[])).next())})},KV=V&&V.__generator||function(t,r){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){e.label=l[1];break}if(l[0]===6&&e.label<a[1]){e.label=a[1],a=l;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(l);break}a[2]&&e.ops.pop(),e.trys.pop();continue}l=r.call(t,e)}catch(c){l=[6,c],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},eF=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a};Object.defineProperty(xf,"__esModule",{value:!0}),xf.getCombinedConnectionStats=void 0;function Ba(t,r,e,n){var i=[];return t.forEach(function(a){(n.length===0||n.includes(a.type))&&(e.length===0||e.includes(a.kind))&&typeof a[r]=="number"&&i.push(a[r])}),i}function tF(t){var r=t.publisher,e=t.subscriber;return XV(this,void 0,void 0,function(){var n,i,a,o,s,u,l,c,f,d,v,p,y,k,I;return KV(this,function(C){switch(C.label){case 0:return[4,Promise.all([r,e].map(function(L){return L.getStats()}))];case 1:return n=eF.apply(void 0,[C.sent(),2]),i=n[0],a=n[1],o=Ba(a,"timestamp",["audio"],["inbound-rtp"]),s=o.length>0?o[0]:0,u=Ba(a,"jitter",["audio"],["inbound-rtp"]).reduce(function(L,R){return Math.max(L,R)},0),l=Ba(a,"packetsReceived",["audio","video"],["inbound-rtp"]).reduce(function(L,R){return L+R},0),c=Ba(a,"packetsLost",["audio","video"],["inbound-rtp"]).reduce(function(L,R){return L+R},0),f=Ba(i,"roundTripTime",["audio","video"],["remote-inbound-rtp"]).reduce(function(L,R){return Math.max(L,R)},0),d=Ba(a,"currentRoundTripTime",[],["candidate-pair"]).reduce(function(L,R){return Math.max(L,R)},0),v=(d||f)*1e3,p=Ba(i,"bytesSent",[],["candidate-pair"]).reduce(function(L,R){return L+R},0),y=Ba(a,"bytesReceived",[],["candidate-pair"]).reduce(function(L,R){return L+R},0),k=rF(a),I=[],a.forEach(function(L){(L.type==="local-candidate"||L.type==="remote-candidate")&&I.push(Bh(L))}),[2,{timestamp:s,jitter:u,packets:l,packetsLost:c,roundTripTime:v,bytesSent:p,bytesReceived:y,selectedIceCandidatePairStats:k,iceCandidateStats:I}]}})})}xf.getCombinedConnectionStats=tF;function Bh(t){var r=[{key:"transportId",type:"string"},{key:"candidateType",type:"string"},{key:"port",altKeys:["portNumber"],type:"number"},{key:"address",altKeys:["ip","ipAddress"],type:"string"},{key:"priority",type:"number"},{key:"protocol",altKeys:["transport"],type:"string"},{key:"url",type:"string"},{key:"relayProtocol",type:"string"}];return r.reduce(function(e,n){var i=[n.key];n.altKeys&&(i=i.concat(n.altKeys));var a=i.find(function(o){return o in t});return a&&typeof t[a]===n.type&&(e[n.key]=t[a]),e},{})}function rF(t){var r=null,e=[];t.forEach(function(s){s.type==="transport"&&s.selectedCandidatePairId?r=s.selectedCandidatePairId:s.type==="candidate-pair"&&e.push(s)});var n=e.find(function(s){return s.selected||r&&s.id===r});if(!n)return null;var i=n,a=t.get(i.localCandidateId),o=t.get(i.remoteCandidateId);return!a||!o?null:{localCandidate:Bh(a),remoteCandidate:Bh(o)}}var Df={},nF=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),iF=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},aF=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},oF=Wr.EventEmitter,Vk=at,sF=function(t){nF(r,t);function r(e,n){var i=t.call(this)||this,a=null,o=e;return n=cF(n),Object.defineProperties(i,{_lock:{get:function(){return a},set:function(s){a=s}},_reachableStates:{value:lF(n)},_state:{get:function(){return o},set:function(s){o=s}},_states:{value:n},_whenDeferreds:{value:new Set},isLocked:{enumerable:!0,get:function(){return a!==null}},state:{enumerable:!0,get:function(){return o}}}),i.on("stateChanged",function(s){i._whenDeferreds.forEach(function(u){u.when(s,u.resolve,u.reject)})}),i}return r.prototype._whenPromise=function(e){var n=this;if(typeof e!="function")return Promise.reject(new Error("when() executor must be a function"));var i=Vk.defer();return i.when=e,this._whenDeferreds.add(i),i.promise.then(function(a){return n._whenDeferreds.delete(i),a},function(a){throw n._whenDeferreds.delete(i),a})},r.prototype.bracket=function(e,n){var i,a=this;function o(s){if(a.hasLock(i)&&a.releaseLockCompletely(i),s)throw s}return this.takeLock(e).then(function(u){return i=u,n(i)}).then(function(u){return o(),u},o)},r.prototype.hasLock=function(e){return this._lock===e},r.prototype.preempt=function(e,n,i){if(!Lf(this._states,this.state,e))throw new Error('Cannot transition from "'+this.state+'" to "'+e+'"');var a;this.isLocked&&(a=this._lock,this._lock=null);var o=null;n&&(o=this.takeLockSync(n));var s=o?null:this.takeLockSync("preemption");return this.transition(e,o||s,i),a&&a.resolve(),s&&this.releaseLock(s),o},r.prototype.releaseLock=function(e){if(this.isLocked){if(!this.hasLock(e))throw new Error("Could not release the lock for "+e.name+" because "+this._lock.name+" has the lock")}else throw new Error("Could not release the lock for "+e.name+" because the StateMachine is not locked");e.depth===0?(this._lock=null,e.resolve()):e.depth--},r.prototype.releaseLockCompletely=function(e){if(this.isLocked){if(!this.hasLock(e))throw new Error("Could not release the lock for "+e.name+" because "+this._lock.name+" has the lock")}else throw new Error("Could not release the lock for "+e.name+" because the StateMachine is not locked");e.depth=0,this._lock=null,e.resolve()},r.prototype.takeLock=function(e){var n=this;if(typeof e=="object"){var i=e;return new Promise(function(s){s(n.takeLockSync(i))})}var a=e;if(this.isLocked){var o=this.takeLock.bind(this,a);return this._lock.promise.then(o)}return Promise.resolve(this.takeLockSync(a))},r.prototype.takeLockSync=function(e){var n=typeof e=="string"?null:e,i=n?n.name:e;if(n&&!this.hasLock(n)||!n&&this.isLocked)throw new Error("Could not take the lock for "+i+" because the lock for "+this._lock.name+" was not released");if(n)return n.depth++,n;var a=uF(i);return this._lock=a,a},r.prototype.transition=function(e,n,i){if(i=i||[],this.isLocked)if(n){if(!this.hasLock(n))throw new Error("Could not transition using the key for "+n.name+" because "+this._lock.name+" has the lock")}else throw new Error("You must provide the key in order to transition");else if(n)throw new Error("Key provided for "+n.name+", but the StateMachine was not locked (possibly due to preemption)");if(!Lf(this._states,this.state,e))throw new Error('Cannot transition from "'+this.state+'" to "'+e+'"');this._state=e,this.emit.apply(this,aF([],iF(["stateChanged",e].concat(i))))},r.prototype.tryTransition=function(e,n,i){try{this.transition(e,n,i)}catch{return!1}return!0},r.prototype.when=function(e){var n=this;return this.state===e?Promise.resolve(this):Lf(this._reachableStates,this.state,e)?this._whenPromise(function(i,a,o){i===e?a(n):Lf(n._reachableStates,i,e)||o($k(i,e))}):Promise.reject($k(this.state,e))},r}(oF);function Lf(t,r,e){return t.get(r).has(e)}function uF(t){var r=Vk.defer();return r.name=t,r.depth=0,r}function lF(t){return Array.from(t.keys()).reduce(function(r,e){return r.set(e,Fk(t,e))},new Map)}function Fk(t,r,e){return e=e||new Set,t.get(r).forEach(function(n){e.has(n)||(e.add(n),Fk(t,n,e).forEach(e.add,e))}),e}function cF(t){var r=new Map;for(var e in t)r.set(e,new Set(t[e]));return r}function $k(t,r){return new Error('"'+r+'" cannot be reached from "'+t+'"')}var Ns=sF,fF=function(){function t(r,e){var n=this;e=Object.assign({navigator,window},e);var i=e.navigator,a=i.connection||{type:null},o=a.type,s=a.type?{_events:{value:["change","typechange"]},_listener:{value:function(){var f=o!==n.type&&n.isOnline;o=n.type,f&&r()}},_target:{value:a}}:{_events:{value:["online"]},_listener:{value:r},_target:{value:e.window}},u=s._events,l=s._listener,c=s._target;Object.defineProperties(this,{isOnline:{enumerable:!0,get:function(){return typeof i.onLine=="boolean"?i.onLine:!0}},type:{enumerable:!0,get:function(){return a.type||null}},_listener:l,_events:u,_target:c})}return t.prototype.start=function(){var r=this;this._events.forEach(function(e){r._target.addEventListener(e,r._listener)})},t.prototype.stop=function(){var r=this;this._events.forEach(function(e){r._target.removeEventListener(e,r._listener)})},t}(),dF=fF,pF=function(){function t(r,e,n){n===void 0&&(n=!0),Object.defineProperties(this,{_delay:{value:e,writable:!0},_fn:{value:r},_timeout:{value:null,writable:!0}}),n&&this.start()}return Object.defineProperty(t.prototype,"delay",{get:function(){return this._delay},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSet",{get:function(){return!!this._timeout},enumerable:!1,configurable:!0}),t.prototype.setDelay=function(r){this._delay=r},t.prototype.start=function(){var r=this;this.isSet||(this._timeout=setTimeout(function(){var e=r._fn;r.clear(),e()},this._delay))},t.prototype.clear=function(){clearTimeout(this._timeout),this._timeout=null},t.prototype.reset=function(){this.clear(),this.start()},t}(),No=pF,Zh,zk;function Wk(){return zk||(zk=1,Zh=WebSocket),Zh}var vF=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Bk=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},hF=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},mF=Ns,Zk=at,gF=Zk.buildLogLevels,yF=Zk.makeUUID,bF=na,_F=dF,As=No,wF=0,kF={closed:[],connecting:["closed","open","waiting"],early:["closed","connecting"],open:["closed"],waiting:["closed","connecting","early","open"]},qk={closed:"close",open:"open",waiting:"waiting"},TF=2,SF=3,EF=3,MF=5e3,CF=15e3,RF=5e3,IF=200,Qk=1e3,qh=3e3,Qh=3001,Yh=3002,Gh=3003,Yk=3004,Uf=3005,Hh=3006,Gk=3007,Hk=globalThis,OF=Hk.WebSocket?Hk.WebSocket:Wk(),li={BUSY:"busy",FAILED:"failed",LOCAL:"local",REMOTE:"remote",TIMEOUT:"timeout"},NF=new Map([[qh,li.TIMEOUT],[Qh,li.TIMEOUT],[Yh,li.FAILED],[Gh,li.FAILED],[Yk,li.TIMEOUT],[Hh,li.BUSY],[Gk,li.TIMEOUT]]),Jk=function(t){vF(r,t);function r(e,n){var i=t.call(this,"early",kF)||this;n=Object.assign({helloBody:null,maxConsecutiveFailedHellos:EF,maxConsecutiveMissedHeartbeats:SF,requestedHeartbeatTimeout:MF,openTimeout:CF,welcomeTimeout:RF,Log:bF,WebSocket:OF},n);var a=gF(n.logLevel),o=new n.Log("default",i,a,n.loggerName),s=n.networkMonitor?new _F(function(){var l=s.type,c="Network changed"+(l?" to "+l:"");o.debug(c),i._close({code:Yk,reason:c})}):null;Object.defineProperties(i,{_busyWaitTimeout:{value:null,writable:!0},_consecutiveHeartbeatsMissed:{value:0,writable:!0},_cookie:{value:null,writable:!0},_eventObserver:{value:n.eventObserver},_heartbeatTimeout:{value:null,writable:!0},_hellosLeft:{value:n.maxConsecutiveFailedHellos,writable:!0},_instanceId:{value:++wF},_log:{value:o},_messageQueue:{value:[]},_networkMonitor:{value:s},_options:{value:n},_openTimeout:{value:null,writable:!0},_sendHeartbeatTimeout:{value:null,writable:!0},_serverUrl:{value:e},_welcomeTimeout:{value:null,writable:!0},_ws:{value:null,writable:!0}});var u={connecting:"info",early:"info",open:"info",waiting:"warning",closed:"info"};return i.on("stateChanged",function(l){for(var c=[],f=1;f<arguments.length;f++)c[f-1]=arguments[f];l in qk&&i.emit.apply(i,hF([qk[l]],Bk(c)));var d={name:l,group:"signaling",level:u[i.state]};if(l==="closed"){var v=Bk(c,1),p=v[0];d.payload={reason:p},d.level=p===li.LOCAL?"info":"error"}i._eventObserver.emit("event",d)}),i._eventObserver.emit("event",{name:i.state,group:"signaling",level:u[i.state]}),i._connect(),i}return r.prototype.toString=function(){return"[TwilioConnection #"+this._instanceId+": "+this._ws.url+"]"},r.prototype._close=function(e){var n=e.code,i=e.reason;if(this.state!=="closed"){this._openTimeout&&this._openTimeout.clear(),this._welcomeTimeout&&this._welcomeTimeout.clear(),this._heartbeatTimeout&&this._heartbeatTimeout.clear(),this._sendHeartbeatTimeout&&this._sendHeartbeatTimeout.clear(),this._networkMonitor&&this._networkMonitor.stop(),this._busyWaitTimeout&&n!==Uf&&this._busyWaitTimeout.clear(),this._messageQueue.splice(0);var a=this._log;n===Qk?(a.debug("Closed"),this.transition("closed",null,[li.LOCAL])):(a.warn("Closed: "+n+" - "+i),n!==Uf&&this.transition("closed",null,[NF.get(n)||li.REMOTE]));var o=this._ws.readyState,s=this._options.WebSocket;o!==s.CLOSING&&o!==s.CLOSED&&this._ws.close(n,i)}},r.prototype._connect=function(){var e=this,n=this._log;if(this.state==="waiting")this.transition("early");else if(this.state!=="early"){n.warn('Unexpected state "'+this.state+'" for connecting to the TCMP server.');return}this._ws=new this._options.WebSocket(this._serverUrl);var i=this._ws;n.debug("Created a new WebSocket:",i),i.addEventListener("close",function(o){return e._close(o)});var a=this._options.openTimeout;this._openTimeout=new As(function(){var o="Failed to open in "+a+" ms";e._close({code:Gk,reason:o})},a),i.addEventListener("open",function(){n.debug("WebSocket opened:",i),e._openTimeout.clear(),e._startHandshake(),e._networkMonitor&&e._networkMonitor.start()}),i.addEventListener("message",function(o){n.debug("Incoming: "+o.data);try{o=JSON.parse(o.data)}catch(s){e.emit("error",s);return}switch(o.type){case"bad":e._handleBad(o);break;case"busy":e._handleBusy(o);break;case"bye":break;case"msg":e._handleMessage(o);case"heartbeat":e._handleHeartbeat();break;case"welcome":e._handleWelcome(o);break;default:e._log.debug("Unknown message type: "+o.type),e.emit("error",new Error("Unknown message type: "+o.type));break}})},r.prototype._handleBad=function(e){var n=e.reason,i=this._log;if(!["connecting","open"].includes(this.state)){i.warn('Unexpected state "'+this.state+'" for handling a "bad" message from the TCMP server.');return}if(this.state==="connecting"){i.warn("Closing: "+Yh+" - "+n),this._close({code:Yh,reason:n});return}i.debug("Error: "+n),this.emit("error",new Error(n))},r.prototype._handleBusy=function(e){var n=this,i=e.cookie,a=e.keepAlive,o=e.retryAfter,s=this._log;if(!["connecting","waiting"].includes(this.state)){s.warn('Unexpected state "'+this.state+'" for handling a "busy" message from the TCMP server.');return}this._busyWaitTimeout&&this._busyWaitTimeout.clear(),this._welcomeTimeout&&this._welcomeTimeout.clear();var u=o<0?'Received terminal "busy" message':'Received "busy" message, retrying after '+o+" ms";if(o<0){s.warn("Closing: "+Hh+" - "+u),this._close({code:Hh,reason:u});return}var l=this._options.maxConsecutiveFailedHellos;this._hellosLeft=l,this._cookie=i||null,a?(s.warn(u),this._busyWaitTimeout=new As(function(){return n._startHandshake()},o)):(s.warn("Closing: "+Uf+" - "+u),this._close({code:Uf,reason:u}),this._busyWaitTimeout=new As(function(){return n._connect()},o)),this.transition("waiting",null,[a,o])},r.prototype._handleHeartbeat=function(){if(this.state!=="open"){this._log.warn('Unexpected state "'+this.state+'" for handling a "heartbeat" message from the TCMP server.');return}this._heartbeatTimeout.reset()},r.prototype._handleHeartbeatTimeout=function(){if(this.state==="open"){var e=this._log,n=this._options.maxConsecutiveMissedHeartbeats;e.debug("Consecutive heartbeats missed: "+n);var i="Missed "+n+' "heartbeat" messages';e.warn("Closing: "+Qh+" - "+i),this._close({code:Qh,reason:i})}},r.prototype._handleMessage=function(e){var n=e.body;if(this.state!=="open"){this._log.warn('Unexpected state "'+this.state+'" for handling a "msg" message from the TCMP server.');return}this.emit("message",n)},r.prototype._handleWelcome=function(e){var n=this,i=e.negotiatedTimeout,a=this._log;if(!["connecting","waiting"].includes(this.state)){a.warn('Unexpected state "'+this.state+'" for handling a "welcome" message from the TCMP server.');return}this.state==="waiting"&&(a.debug('Received "welcome" message, no need to retry connection.'),this._busyWaitTimeout.clear());var o=this._options.maxConsecutiveMissedHeartbeats,s=i*o,u=i-IF;this._welcomeTimeout.clear(),this._heartbeatTimeout=new As(function(){return n._handleHeartbeatTimeout()},s),this._messageQueue.splice(0).forEach(function(l){return n._send(l)}),this._sendHeartbeatTimeout=new As(function(){return n._sendHeartbeat()},u),this.transition("open")},r.prototype._handleWelcomeTimeout=function(){if(this.state==="connecting"){var e=this._log;if(this._hellosLeft<=0){var n="All handshake attempts failed";e.warn("Closing: "+qh+" - "+n),this._close({code:qh,reason:n});return}var i=this._options.maxConsecutiveFailedHellos;e.warn("Handshake attempt "+(i-this._hellosLeft)+" failed"),this._startHandshake()}},r.prototype._send=function(e){var n=this._ws.readyState,i=this._options.WebSocket;if(n===i.OPEN){var a=JSON.stringify(e);this._log.debug("Outgoing: "+a);try{this._ws.send(a),this._sendHeartbeatTimeout&&this._sendHeartbeatTimeout.reset()}catch{var o="Failed to send message";this._log.warn("Closing: "+Gh+" - "+o),this._close({code:Gh,reason:o})}}},r.prototype._sendHeartbeat=function(){this.state!=="closed"&&this._send({type:"heartbeat"})},r.prototype._sendHello=function(){var e=this._options,n=e.helloBody,i=e.requestedHeartbeatTimeout,a={id:yF(),timeout:i,type:"hello",version:TF};this._cookie&&(a.cookie=this._cookie),n&&(a.body=n),this._send(a)},r.prototype._sendOrEnqueue=function(e){var n=this;if(this.state!=="closed"){var i=this.state==="open"?function(a){return n._send(a)}:function(a){return n._messageQueue.push(a)};i(e)}},r.prototype._startHandshake=function(){var e=this;if(["early","waiting"].includes(this.state)&&this.transition("connecting"),this.state==="connecting"){this._hellosLeft--,this._sendHello();var n=this._options.welcomeTimeout;this._welcomeTimeout=new As(function(){return e._handleWelcomeTimeout()},n)}},r.prototype.close=function(){this.state!=="closed"&&(this._sendOrEnqueue({type:"bye"}),this._close({code:Qk,reason:"Normal"}))},r.prototype.sendMessage=function(e){this._sendOrEnqueue({body:e,type:"msg"})},r}(mF);Jk.CloseReason=li;var Xk=Jk,lt={},AF=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),PF=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},xF=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},DF=function(t){AF(r,t);function r(e){var n=this,i=[].slice.call(arguments,1);n=t.apply(this,xF([],PF(i)))||this,Object.setPrototypeOf(n,r.prototype);var a=Error.apply(n,i);return a.name="TwilioError",Object.defineProperty(n,"code",{value:e,enumerable:!0}),Object.getOwnPropertyNames(a).forEach(function(o){Object.defineProperty(this,o,{value:a[o],enumerable:!0})},n),n}return r.prototype.toString=function(){var e=this.message?": "+this.message:"";return this.name+" "+this.code+e},r}(Error),LF=DF,bt=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),yt=LF,mt={};lt.createTwilioError=function(r,e){return r=typeof r=="number"?r:0,e=typeof e=="string"&&e?e:"Unknown error",mt[r]?new mt[r]:new yt(r,e)};var Kk=function(t){bt(r,t);function r(){var e=t.call(this,20101,"Invalid Access Token")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.AccessTokenInvalidError=Kk,Object.defineProperty(mt,20101,{value:Kk});var eT=function(t){bt(r,t);function r(){var e=t.call(this,20102,"Invalid Access Token header")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.AccessTokenHeaderInvalidError=eT,Object.defineProperty(mt,20102,{value:eT});var tT=function(t){bt(r,t);function r(){var e=t.call(this,20103,"Invalid Access Token issuer/subject")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.AccessTokenIssuerInvalidError=tT,Object.defineProperty(mt,20103,{value:tT});var rT=function(t){bt(r,t);function r(){var e=t.call(this,20104,"Access Token expired or expiration date invalid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.AccessTokenExpiredError=rT,Object.defineProperty(mt,20104,{value:rT});var nT=function(t){bt(r,t);function r(){var e=t.call(this,20105,"Access Token not yet valid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.AccessTokenNotYetValidError=nT,Object.defineProperty(mt,20105,{value:nT});var iT=function(t){bt(r,t);function r(){var e=t.call(this,20106,"Invalid Access Token grants")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.AccessTokenGrantsInvalidError=iT,Object.defineProperty(mt,20106,{value:iT});var aT=function(t){bt(r,t);function r(){var e=t.call(this,20107,"Invalid Access Token signature")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.AccessTokenSignatureInvalidError=aT,Object.defineProperty(mt,20107,{value:aT});var oT=function(t){bt(r,t);function r(){var e=t.call(this,53e3,"Signaling connection error")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.SignalingConnectionError=oT,Object.defineProperty(mt,53e3,{value:oT});var sT=function(t){bt(r,t);function r(){var e=t.call(this,53001,"Signaling connection disconnected")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.SignalingConnectionDisconnectedError=sT,Object.defineProperty(mt,53001,{value:sT});var uT=function(t){bt(r,t);function r(){var e=t.call(this,53002,"Signaling connection timed out")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.SignalingConnectionTimeoutError=uT,Object.defineProperty(mt,53002,{value:uT});var lT=function(t){bt(r,t);function r(){var e=t.call(this,53003,"Client received an invalid signaling message")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.SignalingIncomingMessageInvalidError=lT,Object.defineProperty(mt,53003,{value:lT});var cT=function(t){bt(r,t);function r(){var e=t.call(this,53004,"Client sent an invalid signaling message")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.SignalingOutgoingMessageInvalidError=cT,Object.defineProperty(mt,53004,{value:cT});var fT=function(t){bt(r,t);function r(){var e=t.call(this,53006,"Video server is busy")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.SignalingServerBusyError=fT,Object.defineProperty(mt,53006,{value:fT});var dT=function(t){bt(r,t);function r(){var e=t.call(this,53100,"Room name is invalid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomNameInvalidError=dT,Object.defineProperty(mt,53100,{value:dT});var pT=function(t){bt(r,t);function r(){var e=t.call(this,53101,"Room name is too long")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomNameTooLongError=pT,Object.defineProperty(mt,53101,{value:pT});var vT=function(t){bt(r,t);function r(){var e=t.call(this,53102,"Room name contains invalid characters")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomNameCharsInvalidError=vT,Object.defineProperty(mt,53102,{value:vT});var hT=function(t){bt(r,t);function r(){var e=t.call(this,53103,"Unable to create Room")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomCreateFailedError=hT,Object.defineProperty(mt,53103,{value:hT});var mT=function(t){bt(r,t);function r(){var e=t.call(this,53104,"Unable to connect to Room")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomConnectFailedError=mT,Object.defineProperty(mt,53104,{value:mT});var gT=function(t){bt(r,t);function r(){var e=t.call(this,53105,"Room contains too many Participants")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomMaxParticipantsExceededError=gT,Object.defineProperty(mt,53105,{value:gT});var yT=function(t){bt(r,t);function r(){var e=t.call(this,53106,"Room not found")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomNotFoundError=yT,Object.defineProperty(mt,53106,{value:yT});var bT=function(t){bt(r,t);function r(){var e=t.call(this,53107,"MaxParticipants is out of range")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomMaxParticipantsOutOfRangeError=bT,Object.defineProperty(mt,53107,{value:bT});var _T=function(t){bt(r,t);function r(){var e=t.call(this,53108,"RoomType is not valid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomTypeInvalidError=_T,Object.defineProperty(mt,53108,{value:_T});var wT=function(t){bt(r,t);function r(){var e=t.call(this,53109,"Timeout is out of range")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomTimeoutOutOfRangeError=wT,Object.defineProperty(mt,53109,{value:wT});var kT=function(t){bt(r,t);function r(){var e=t.call(this,53110,"StatusCallbackMethod is invalid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomStatusCallbackMethodInvalidError=kT,Object.defineProperty(mt,53110,{value:kT});var TT=function(t){bt(r,t);function r(){var e=t.call(this,53111,"StatusCallback is invalid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomStatusCallbackInvalidError=TT,Object.defineProperty(mt,53111,{value:TT});var ST=function(t){bt(r,t);function r(){var e=t.call(this,53112,"Status is invalid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomStatusInvalidError=ST,Object.defineProperty(mt,53112,{value:ST});var ET=function(t){bt(r,t);function r(){var e=t.call(this,53113,"Room exists")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomRoomExistsError=ET,Object.defineProperty(mt,53113,{value:ET});var MT=function(t){bt(r,t);function r(){var e=t.call(this,53114,"Room creation parameter(s) incompatible with the Room type")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomInvalidParametersError=MT,Object.defineProperty(mt,53114,{value:MT});var CT=function(t){bt(r,t);function r(){var e=t.call(this,53115,"MediaRegion is invalid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomMediaRegionInvalidError=CT,Object.defineProperty(mt,53115,{value:CT});var RT=function(t){bt(r,t);function r(){var e=t.call(this,53116,"There are no media servers available in the MediaRegion")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomMediaRegionUnavailableError=RT,Object.defineProperty(mt,53116,{value:RT});var IT=function(t){bt(r,t);function r(){var e=t.call(this,53117,"The subscription operation requested is not supported for the Room type")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomSubscriptionOperationNotSupportedError=IT,Object.defineProperty(mt,53117,{value:IT});var OT=function(t){bt(r,t);function r(){var e=t.call(this,53118,"Room completed")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomCompletedError=OT,Object.defineProperty(mt,53118,{value:OT});var NT=function(t){bt(r,t);function r(){var e=t.call(this,53124,"The AudioOnly flag is not supported for the Room type")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomAudioOnlyFlagNotSupportedError=NT,Object.defineProperty(mt,53124,{value:NT});var AT=function(t){bt(r,t);function r(){var e=t.call(this,53125,"The track kind is not supported by the Room")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.RoomTrackKindNotSupportedError=AT,Object.defineProperty(mt,53125,{value:AT});var PT=function(t){bt(r,t);function r(){var e=t.call(this,53200,"Participant identity is invalid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.ParticipantIdentityInvalidError=PT,Object.defineProperty(mt,53200,{value:PT});var xT=function(t){bt(r,t);function r(){var e=t.call(this,53201,"Participant identity is too long")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.ParticipantIdentityTooLongError=xT,Object.defineProperty(mt,53201,{value:xT});var DT=function(t){bt(r,t);function r(){var e=t.call(this,53202,"Participant identity contains invalid characters")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.ParticipantIdentityCharsInvalidError=DT,Object.defineProperty(mt,53202,{value:DT});var LT=function(t){bt(r,t);function r(){var e=t.call(this,53203,"The maximum number of published tracks allowed in the Room at the same time has been reached")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.ParticipantMaxTracksExceededError=LT,Object.defineProperty(mt,53203,{value:LT});var UT=function(t){bt(r,t);function r(){var e=t.call(this,53204,"Participant not found")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.ParticipantNotFoundError=UT,Object.defineProperty(mt,53204,{value:UT});var jT=function(t){bt(r,t);function r(){var e=t.call(this,53205,"Participant disconnected because of duplicate identity")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.ParticipantDuplicateIdentityError=jT,Object.defineProperty(mt,53205,{value:jT});var VT=function(t){bt(r,t);function r(){var e=t.call(this,53300,"Track is invalid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.TrackInvalidError=VT,Object.defineProperty(mt,53300,{value:VT});var FT=function(t){bt(r,t);function r(){var e=t.call(this,53301,"Track name is invalid")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.TrackNameInvalidError=FT,Object.defineProperty(mt,53301,{value:FT});var $T=function(t){bt(r,t);function r(){var e=t.call(this,53302,"Track name is too long")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.TrackNameTooLongError=$T,Object.defineProperty(mt,53302,{value:$T});var zT=function(t){bt(r,t);function r(){var e=t.call(this,53303,"Track name contains invalid characters")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.TrackNameCharsInvalidError=zT,Object.defineProperty(mt,53303,{value:zT});var WT=function(t){bt(r,t);function r(){var e=t.call(this,53304,"Track name is duplicated")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.TrackNameIsDuplicatedError=WT,Object.defineProperty(mt,53304,{value:WT});var BT=function(t){bt(r,t);function r(){var e=t.call(this,53305,"The server has reached capacity and cannot fulfill this request")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.TrackServerTrackCapacityReachedError=BT,Object.defineProperty(mt,53305,{value:BT});var ZT=function(t){bt(r,t);function r(){var e=t.call(this,53400,"Client is unable to create or apply a local media description")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.MediaClientLocalDescFailedError=ZT,Object.defineProperty(mt,53400,{value:ZT});var qT=function(t){bt(r,t);function r(){var e=t.call(this,53401,"Server is unable to create or apply a local media description")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.MediaServerLocalDescFailedError=qT,Object.defineProperty(mt,53401,{value:qT});var QT=function(t){bt(r,t);function r(){var e=t.call(this,53402,"Client is unable to apply a remote media description")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.MediaClientRemoteDescFailedError=QT,Object.defineProperty(mt,53402,{value:QT});var YT=function(t){bt(r,t);function r(){var e=t.call(this,53403,"Server is unable to apply a remote media description")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.MediaServerRemoteDescFailedError=YT,Object.defineProperty(mt,53403,{value:YT});var GT=function(t){bt(r,t);function r(){var e=t.call(this,53404,"No supported codec")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.MediaNoSupportedCodecError=GT,Object.defineProperty(mt,53404,{value:GT});var HT=function(t){bt(r,t);function r(){var e=t.call(this,53405,"Media connection failed or Media activity ceased")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.MediaConnectionError=HT,Object.defineProperty(mt,53405,{value:HT});var JT=function(t){bt(r,t);function r(){var e=t.call(this,53407,"Media connection failed due to DTLS handshake failure")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.MediaDTLSTransportFailedError=JT,Object.defineProperty(mt,53407,{value:JT});var XT=function(t){bt(r,t);function r(){var e=t.call(this,53500,"Unable to acquire configuration")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.ConfigurationAcquireFailedError=XT,Object.defineProperty(mt,53500,{value:XT});var KT=function(t){bt(r,t);function r(){var e=t.call(this,53501,"Unable to acquire TURN credentials")||this;return Object.setPrototypeOf(e,r.prototype),e}return r}(yt);lt.ConfigurationAcquireTurnFailedError=KT,Object.defineProperty(mt,53501,{value:KT}),Object.defineProperty(Df,"__esModule",{value:!0}),Df.getTurnCredentials=void 0;var UF=Xk,jF=fr.ICE_VERSION,eS=lt,VF=eS.createTwilioError,FF=eS.SignalingConnectionError,$F=Wr;function zF(t,r){return new Promise(function(e,n){var i=new $F.EventEmitter,a={networkMonitor:null,eventObserver:i,helloBody:{edge:"roaming",preflight:!0,token:t,type:"ice",version:jF}},o=new UF(r,a),s=!1;o.once("close",function(){s||(s=!0,n(new FF))}),o.on("message",function(u){var l=u.code,c=u.message,f=u.ice_servers,d=u.type;(d==="iced"||d==="error")&&!s&&(s=!0,d==="iced"?e(f):n(VF(l,c)),o.close())})})}Df.getTurnCredentials=zF;var jf={},tS=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},rS=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t};Object.defineProperty(jf,"__esModule",{value:!0}),jf.makeStat=void 0;function WF(t){if(t&&t.length){var r=Math.min.apply(Math,rS([],tS(t))),e=Math.max.apply(Math,rS([],tS(t))),n=t.reduce(function(i,a){return i+a},0)/t.length;return{min:r,max:e,average:n}}return null}jf.makeStat=WF;var Vf={};Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.syntheticAudio=void 0;function BF(){var t=Af(),r={},e=t.getOrCreate(r),n=e.createOscillator(),i=n.connect(e.createMediaStreamDestination());n.start();var a=i.stream.getAudioTracks()[0],o=a.stop;return a.stop=function(){o.call(a),t.release(r)},a}Vf.syntheticAudio=BF;var Ff={};Object.defineProperty(Ff,"__esModule",{value:!0}),Ff.syntheticVideo=void 0;function ZF(t){var r=t===void 0?{}:t,e=r.width,n=e===void 0?640:e,i=r.height,a=i===void 0?480:i,o=Object.assign(document.createElement("canvas"),{width:n,height:a}),s=o.getContext("2d");s.fillStyle="green",s.fillRect(0,0,o.width,o.height);var u=!1;requestAnimationFrame(function d(){if(!u){var v=Math.round(Math.random()*255),p=Math.round(Math.random()*255),y=Math.round(Math.random()*255),k=Math.round(Math.random()*255);s.fillStyle="rgba("+v+", "+p+", "+y+", "+k+")",s.fillRect(Math.random()*n,Math.random()*a,50,50),requestAnimationFrame(d)}});var l=o.captureStream(30),c=l.getTracks()[0],f=c.stop;return c.stop=function(){u=!0,f.call(c)},c}Ff.syntheticVideo=ZF;var qF=function(){function t(){Object.defineProperties(this,{_samples:{value:[{denominator:0,numerator:0},{denominator:0,numerator:0}]}})}return t.prototype.get=function(){var r=this._samples,e=r[1].denominator-r[0].denominator||1/0,n=r[1].numerator-r[0].numerator;return n/e},t.prototype.putSample=function(r,e){var n=this._samples;n.shift(),n.push({denominator:e,numerator:r})},t}(),nS=qF,QF=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),YF=Wr.EventEmitter,GF=["signaling","room","media","quality","video-processor","preflight"],HF=["debug","error","info","warning"],JF=function(t){QF(r,t);function r(e,n,i,a){a===void 0&&(a=null);var o=t.call(this)||this;return o.on("event",function(s){var u=s.name,l=s.group,c=s.level,f=s.payload;if(typeof u!="string")throw i.error("Unexpected name: ",u),new Error("Unexpected name: ",u);if(!GF.includes(l))throw i.error("Unexpected group: ",l),new Error("Unexpected group: ",l);if(!HF.includes(c))throw i.error("Unexpected level: ",c),new Error("Unexpected level: ",c);var d=Date.now(),v=d-n,p=Object.assign({elapsedTime:v,level:c},f||{});e.publish(l,u,p);var y=Object.assign({elapsedTime:v,group:l,level:c,name:u,timestamp:d},f?{payload:f}:{}),k={debug:"debug",error:"error",info:"info",warning:"warn"}[c];i[k]("event",y),a&&l==="signaling"&&a.emit("event",y)}),o}return r}(YF),iS=JF,XF=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ps=V&&V.__assign||function(){return Ps=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++){r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ps.apply(this,arguments)},KF=Wr.EventEmitter,e$=at.getUserAgent,t$=5,r$=50,n$=1e3,aS=globalThis,i$=aS.WebSocket?aS.WebSocket:Wk(),oS=fr,a$=oS.hardwareDevicePublisheriPad,o$=oS.hardwareDevicePublisheriPhone,s$=at,sS=Oo,u$=function(t){XF(r,t);function r(e,n,i,a,o,s){var u=t.call(this)||this;return s=Object.assign({gateway:l$(a,o)+"/v1/VideoEvents",maxReconnectAttempts:t$,reconnectIntervalMs:r$,userAgent:e$(),WebSocket:i$},s),Object.defineProperties(u,{_connectTimestamp:{value:0,writable:!0},_eventQueue:{value:[]},_readyToConnect:{value:s$.defer()},_reconnectAttemptsLeft:{value:s.maxReconnectAttempts,writable:!0},_ws:{value:null,writable:!0},_WebSocket:{value:s.WebSocket}}),u._readyToConnect.promise.then(function(l){var c=l.roomSid,f=l.participantSid,d=u;u.on("disconnected",function v(p){if(d._session=null,p&&d._reconnectAttemptsLeft>0){d.emit("reconnecting"),f$(d,e,n,i,c,f,s);return}d.removeListener("disconnected",v)}),Jh(u,e,n,i,c,f,s)}).catch(function(){}),u}return r.prototype.connect=function(e,n){this._readyToConnect.resolve({roomSid:e,participantSid:n})},r.prototype._publish=function(e){e.session=this._session,this._ws.send(JSON.stringify(e))},r.prototype.disconnect=function(){if(this._ws===null||this._ws.readyState===this._WebSocket.CLOSING||this._ws.readyState===this._WebSocket.CLOSED)return!1;try{this._ws.close()}catch{}return this.emit("disconnected"),!0},r.prototype.publish=function(e,n,i){if(this._ws!==null&&(this._ws.readyState===this._WebSocket.CLOSING||this._ws.readyState===this._WebSocket.CLOSED))return!1;var a=typeof this._session=="string"?this._publish.bind(this):this._eventQueue.push.bind(this._eventQueue);return a({group:e,name:n,payload:i,timestamp:Date.now(),type:"event",version:1}),!0},r}(KF);function Jh(t,r,e,n,i,a,o){t._connectTimestamp=Date.now(),t._reconnectAttemptsLeft--,t._ws=new o.WebSocket(o.gateway);var s=t._ws;s.addEventListener("close",function(u){if(u.code===n$){t.emit("disconnected");return}t.emit("disconnected",new Error("WebSocket Error "+u.code+": "+u.reason))}),s.addEventListener("message",function(u){c$(t,JSON.parse(u.data),o)}),s.addEventListener("open",function(){var u={type:"connect",token:r,version:1};u.publisher={name:e,sdkVersion:n,userAgent:o.userAgent,participantSid:a,roomSid:i},sS.isIpad()?u.publisher=Ps(Ps({},u.publisher),a$):sS.isIphone()&&(u.publisher=Ps(Ps({},u.publisher),o$)),s.send(JSON.stringify(u))})}function l$(t,r){return t==="prod"?"wss://sdkgw."+r+".twilio.com":"wss://sdkgw."+t+"-"+r+".twilio.com"}function c$(t,r,e){switch(r.type){case"connected":t._session=r.session,t._reconnectAttemptsLeft=e.maxReconnectAttempts,t._eventQueue.splice(0).forEach(t._publish,t),t.emit("connected");break;case"error":t._ws.close(),t.emit("disconnected",new Error(r.message));break}}function f$(t,r,e,n,i,a,o){var s=Date.now()-t._connectTimestamp,u=o.reconnectIntervalMs-s;if(u>0){setTimeout(function(){Jh(t,r,e,n,i,a,o)},u);return}Jh(t,r,e,n,i,a,o)}var uS=u$,d$=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),$f=V&&V.__assign||function(){return $f=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++){r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},$f.apply(this,arguments)},ol=V&&V.__awaiter||function(t,r,e,n){function i(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function s(c){try{l(n.next(c))}catch(f){o(f)}}function u(c){try{l(n.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((n=n.apply(t,r||[])).next())})},sl=V&&V.__generator||function(t,r){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){e.label=l[1];break}if(l[0]===6&&e.label<a[1]){e.label=a[1],a=l;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(l);break}a[2]&&e.ops.pop(),e.trys.pop();continue}l=r.call(t,e)}catch(c){l=[6,c],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Is,"__esModule",{value:!0}),Is.runPreflight=Is.PreflightTest=void 0;var xs=fr,Ds=Pf,p$=Os,v$=xf,h$=Df,zf=jf,m$=Vf,g$=Ff,y$=at,b$=fr.WS_SERVER,_$=na,w$=il,Xh=nS,k$=iS,T$=uS,lS=Tf,S$=lS.createSID,E$=lS.sessionSID,cS=lt,M$=cS.SignalingConnectionTimeoutError,fS=cS.MediaConnectionError,dS=1e3,C$=10*dS,Ao={mediaAcquired:"mediaAcquired",connected:"connected",mediaSubscribed:"mediaSubscribed",mediaStarted:"mediaStarted",dtlsConnected:"dtlsConnected",peerConnectionConnected:"peerConnectionConnected",iceConnected:"iceConnected"};function R$(t){return t!==null&&typeof t<"u"}var I$=0,pS=function(t){d$(r,t);function r(e,n){var i=t.call(this)||this;i._testTiming=new Ds.Timer,i._dtlsTiming=new Ds.Timer,i._iceTiming=new Ds.Timer,i._peerConnectionTiming=new Ds.Timer,i._mediaTiming=new Ds.Timer,i._connectTiming=new Ds.Timer,i._sentBytesMovingAverage=new Xh,i._packetLossMovingAverage=new Xh,i._progressEvents=[],i._receivedBytesMovingAverage=new Xh;var a=n,o=a.environment,s=o===void 0?"prod":o,u=a.region,l=u===void 0?"gll":u,c=a.duration,f=c===void 0?C$:c,d=a.wsServer||b$(s,l);return i._log=new _$("default",i,xs.DEFAULT_LOG_LEVEL,xs.DEFAULT_LOGGER_NAME),i._testDuration=f,i._instanceId=I$++,i._testTiming.start(),i._runPreflightTest(e,s,d),i}return r.prototype.toString=function(){return"[Preflight #"+this._instanceId+"]"},r.prototype.stop=function(){this._stopped=!0},r.prototype._generatePreflightReport=function(e){return this._testTiming.stop(),{testTiming:this._testTiming.getTimeMeasurement(),networkTiming:{dtls:this._dtlsTiming.getTimeMeasurement(),ice:this._iceTiming.getTimeMeasurement(),peerConnection:this._peerConnectionTiming.getTimeMeasurement(),connect:this._connectTiming.getTimeMeasurement(),media:this._mediaTiming.getTimeMeasurement()},stats:{jitter:zf.makeStat(e==null?void 0:e.jitter),rtt:zf.makeStat(e==null?void 0:e.rtt),packetLoss:zf.makeStat(e==null?void 0:e.packetLoss)},selectedIceCandidatePairStats:e?e.selectedIceCandidatePairStats:null,iceCandidateStats:e?e.iceCandidateStats:[],progressEvents:this._progressEvents,mos:zf.makeStat(e==null?void 0:e.mos)}},r.prototype._executePreflightStep=function(e,n,i){return ol(this,void 0,void 0,function(){var a,o,s,u,l;return sl(this,function(c){switch(c.label){case 0:if(this._log.debug("Executing step: ",e),a=this._testDuration+10*dS,this._stopped)throw new Error("stopped");o=Promise.resolve().then(n),s=null,u=new Promise(function(f,d){s=setTimeout(function(){d(i||new Error(e+" timeout."))},a)}),c.label=1;case 1:return c.trys.push([1,,3,4]),[4,Promise.race([u,o])];case 2:return l=c.sent(),[2,l];case 3:return s!==null&&clearTimeout(s),[7];case 4:return[2]}})})},r.prototype._collectNetworkTimings=function(e){var n=this;return new Promise(function(i){var a;e.addEventListener("iceconnectionstatechange",function(){e.iceConnectionState==="checking"&&n._iceTiming.start(),e.iceConnectionState==="connected"&&(n._iceTiming.stop(),n._updateProgress(Ao.iceConnected),(!a||a&&a.state==="connected")&&i())}),e.addEventListener("connectionstatechange",function(){e.connectionState==="connecting"&&n._peerConnectionTiming.start(),e.connectionState==="connected"&&(n._peerConnectionTiming.stop(),n._updateProgress(Ao.peerConnectionConnected))});var o=e.getSenders(),s=o.map(function(u){return u.transport}).find(R$);typeof s<"u"&&(a=s,a.addEventListener("statechange",function(){a.state==="connecting"&&n._dtlsTiming.start(),a.state==="connected"&&(n._dtlsTiming.stop(),n._updateProgress(Ao.dtlsConnected),e.iceConnectionState==="connected"&&i())}))})},r.prototype._setupInsights=function(e){var n=e.token,i=e.environment,a=i===void 0?xs.DEFAULT_ENVIRONMENT:i,o=e.realm,s=o===void 0?xs.DEFAULT_REALM:o,u={},l=new T$(n,xs.SDK_NAME,xs.SDK_VERSION,a,s,u);l.connect("PREFLIGHT_ROOM_SID","PREFLIGHT_PARTICIPANT");var c=new k$(l,Date.now(),this._log),f=void 0;return{reportToInsights:function(d){var v,p,y=d.report,k=y.stats.jitter||f,I=y.stats.rtt||f,C=y.stats.packetLoss||f,L=y.mos||f,R=new Map;y.iceCandidateStats.forEach(function(F){if(F.candidateType&&F.protocol){var D=R.get(F.candidateType)||[];D.indexOf(F.protocol)<0&&D.push(F.protocol),R.set(F.candidateType,D)}});var q=JSON.stringify(Object.fromEntries(R)),z={name:"report",group:"preflight",level:y.error?"error":"info",payload:{sessionSID:E$,preflightSID:S$("PF"),progressEvents:JSON.stringify(y.progressEvents),testTiming:y.testTiming,dtlsTiming:y.networkTiming.dtls,iceTiming:y.networkTiming.ice,peerConnectionTiming:y.networkTiming.peerConnection,connectTiming:y.networkTiming.connect,mediaTiming:y.networkTiming.media,selectedLocalCandidate:(v=y.selectedIceCandidatePairStats)===null||v===void 0?void 0:v.localCandidate,selectedRemoteCandidate:(p=y.selectedIceCandidatePairStats)===null||p===void 0?void 0:p.remoteCandidate,iceCandidateStats:q,jitterStats:k,rttStats:I,packetLossStats:C,mosStats:L,error:y.error}};c.emit("event",z),setTimeout(function(){return l.disconnect()},2e3)}}},r.prototype._runPreflightTest=function(e,n,i){return ol(this,void 0,void 0,function(){var a,o,s,u,l,c,f,d,v,p,y,k,I=this;return sl(this,function(C){switch(C.label){case 0:a=[],o=[],s=this._setupInsights({token:e,environment:n}).reportToInsights,C.label=1;case 1:return C.trys.push([1,8,9,10]),u=[],[4,this._executePreflightStep("Acquire media",function(){return[m$.syntheticAudio(),g$.syntheticVideo({width:640,height:480})]})];case 2:return a=C.sent(),this._updateProgress(Ao.mediaAcquired),this.emit("debug",{localTracks:a}),this._connectTiming.start(),[4,this._executePreflightStep("Get turn credentials",function(){return h$.getTurnCredentials(e,i)},new M$)];case 3:return l=C.sent(),this._connectTiming.stop(),this._updateProgress(Ao.connected),c=new RTCPeerConnection({iceServers:l,iceTransportPolicy:"relay",bundlePolicy:"max-bundle"}),f=new RTCPeerConnection({iceServers:l,bundlePolicy:"max-bundle"}),o.push(c),o.push(f),this._mediaTiming.start(),[4,this._executePreflightStep("Setup Peer Connections",function(){return ol(I,void 0,void 0,function(){var L,R,q,z;return sl(this,function(F){switch(F.label){case 0:return c.addEventListener("icecandidate",function(D){return D.candidate&&f.addIceCandidate(D.candidate)}),f.addEventListener("icecandidate",function(D){return D.candidate&&c.addIceCandidate(D.candidate)}),a.forEach(function(D){return c.addTrack(D)}),L=new Promise(function(D){var W=[];f.addEventListener("track",function(X){W.push(X.track),W.length===a.length&&D(W)})}),[4,c.createOffer()];case 1:return R=F.sent(),q=R,[4,c.setLocalDescription(q)];case 2:return F.sent(),[4,f.setRemoteDescription(q)];case 3:return F.sent(),[4,f.createAnswer()];case 4:return z=F.sent(),[4,f.setLocalDescription(z)];case 5:return F.sent(),[4,c.setRemoteDescription(z)];case 6:return F.sent(),[4,this._collectNetworkTimings(c)];case 7:return F.sent(),[2,L]}})})},new fS)];case 4:return d=C.sent(),this.emit("debug",{remoteTracks:d}),d.forEach(function(L){L.addEventListener("ended",function(){return I._log.warn(L.kind+":ended")}),L.addEventListener("mute",function(){return I._log.warn(L.kind+":muted")}),L.addEventListener("unmute",function(){return I._log.warn(L.kind+":unmuted")})}),this._updateProgress(Ao.mediaSubscribed),[4,this._executePreflightStep("Wait for tracks to start",function(){return new Promise(function(L){var R=document.createElement("video");R.autoplay=!0,R.playsInline=!0,R.muted=!0,R.srcObject=new MediaStream(d),u.push(R),I.emit("debugElement",R),R.oncanplay=L})},new fS)];case 5:return C.sent(),this._mediaTiming.stop(),this._updateProgress(Ao.mediaStarted),[4,this._executePreflightStep("Collect stats for duration",function(){return I._collectRTCStatsForDuration(I._testDuration,O$(),c,f)})];case 6:return v=C.sent(),[4,this._executePreflightStep("Generate report",function(){return I._generatePreflightReport(v)})];case 7:return p=C.sent(),s({report:p}),this.emit("completed",p),[3,10];case 8:return y=C.sent(),k=this._generatePreflightReport(),s({report:$f($f({},k),{error:y==null?void 0:y.toString()})}),this.emit("failed",y,k),[3,10];case 9:return o.forEach(function(L){return L.close()}),a.forEach(function(L){return L.stop()}),[7];case 10:return[2]}})})},r.prototype._collectRTCStats=function(e,n,i){return ol(this,void 0,void 0,function(){var a,o,s,u,l,c,f,d,v,p,y,k,I,C;return sl(this,function(L){switch(L.label){case 0:return[4,v$.getCombinedConnectionStats({publisher:n,subscriber:i})];case 1:return a=L.sent(),o=a.timestamp,s=a.bytesSent,u=a.bytesReceived,l=a.packets,c=a.packetsLost,f=a.roundTripTime,d=a.jitter,v=a.selectedIceCandidatePairStats,p=a.iceCandidateStats,y=e.jitter.length>0,e.jitter.push(d),e.rtt.push(f),this._sentBytesMovingAverage.putSample(s,o),this._receivedBytesMovingAverage.putSample(u,o),this._packetLossMovingAverage.putSample(c,l),y&&(e.outgoingBitrate.push(this._sentBytesMovingAverage.get()*1e3*8),e.incomingBitrate.push(this._receivedBytesMovingAverage.get()*1e3*8),k=this._packetLossMovingAverage.get(),I=Math.min(100,k*100),e.packetLoss.push(I),C=p$.calculateMOS(f,d,k),e.mos.push(C)),e.selectedIceCandidatePairStats||(e.selectedIceCandidatePairStats=v),e.iceCandidateStats.length===0&&(e.iceCandidateStats=p),[2]}})})},r.prototype._collectRTCStatsForDuration=function(e,n,i,a){return ol(this,void 0,void 0,function(){var o,s,u;return sl(this,function(l){switch(l.label){case 0:return o=Date.now(),s=Math.min(1e3,e),[4,y$.waitForSometime(s)];case 1:return l.sent(),[4,this._collectRTCStats(n,i,a)];case 2:return l.sent(),u=e-(Date.now()-o),u>0?[4,this._collectRTCStatsForDuration(u,n,i,a)]:[3,4];case 3:n=l.sent(),l.label=4;case 4:return[2,n]}})})},r.prototype._updateProgress=function(e){var n=Date.now()-this._testTiming.getTimeMeasurement().start;this._progressEvents.push({duration:n,name:e}),this.emit("progress",e)},r}(w$);Is.PreflightTest=pS;function O$(){return{mos:[],jitter:[],rtt:[],outgoingBitrate:[],incomingBitrate:[],packetLoss:[],selectedIceCandidatePairStats:null,iceCandidateStats:[]}}function N$(t,r){r===void 0&&(r={});var e=new pS(t,r);return e}Is.runPreflight=N$;var Kh=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},em=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},A$=function(){function t(r,e){var n=this;Object.defineProperties(this,{_isCancelable:{writable:!0,value:!0},_isCanceled:{writable:!0,value:!1},_onCancel:{value:e}}),Object.defineProperty(this,"_promise",{value:new Promise(function(i,a){r(function(o){n._isCancelable=!1,i(o)},function(o){n._isCancelable=!1,a(o)},function(){return n._isCanceled})})})}return t.reject=function(r){return new t(function(n,i){i(r)},function(){})},t.resolve=function(r){return new t(function(n){n(r)},function(){})},t.prototype.cancel=function(){return this._isCancelable&&(this._isCanceled=!0,this._onCancel()),this},t.prototype.catch=function(){var r=[].slice.call(arguments),e=this._promise;return new t(function(i,a){e.catch.apply(e,em([],Kh(r))).then(i,a)},this._onCancel)},t.prototype.then=function(){var r=[].slice.call(arguments),e=this._promise;return new t(function(i,a){e.then.apply(e,em([],Kh(r))).then(i,a)},this._onCancel)},t.prototype.finally=function(){var r=[].slice.call(arguments),e=this._promise;return new t(function(i,a){e.finally.apply(e,em([],Kh(r))).then(i,a)},this._onCancel)},t}(),tm=A$,vS=tm;function P$(t,r,e,n){var i,a=new Error("Canceled");return new vS(function(s,u,l){var c;t(function(d){return l()?vS.reject(a):(c=r(d),e(c).then(function(p){if(l())throw a;return i=p(),i}))}).then(function(d){if(l())throw d.disconnect(),a;s(n(c,d))}).catch(function(d){u(d)})},function(){i&&i.cancel()})}var x$=P$,D$=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),L$=Wr.EventEmitter,U$=function(t){D$(r,t);function r(e,n){var i=t.call(this)||this;return e=Object.assign({maxAudioBitrate:null,maxVideoBitrate:null},e),Object.defineProperties(i,{maxAudioBitrate:{value:e.maxAudioBitrate,writable:!0},maxVideoBitrate:{value:e.maxVideoBitrate,writable:!0},adaptiveSimulcast:{value:n}}),i}return r.prototype.toJSON=function(){return{maxAudioBitrate:this.maxAudioBitrate,maxVideoBitrate:this.maxVideoBitrate}},r.prototype.update=function(e){var n=this;e=Object.assign({maxAudioBitrate:this.maxAudioBitrate,maxVideoBitrate:this.maxVideoBitrate},e);var i=["maxAudioBitrate","maxVideoBitrate"].reduce(function(a,o){return n[o]!==e[o]&&(n[o]=e[o],a=!0),a},!1);i&&this.emit("changed")},r}(L$),j$=U$,ul={},V$=at.isNonArrayObject,Ls=fr,ll=Ls.typeErrors,F$=Ls.clientTrackSwitchOffControl,$$=Ls.videoContentPreferencesMode,z$=Ls.subscriptionMode,hS=Ls.trackPriority,W$=Ls.trackSwitchOffMode;function B$(t){var r=cl(t,"options.bandwidthProfile");return!t||r||(r=cl(t.video,"options.bandwidthProfile.video",[{prop:"contentPreferencesMode",values:Object.values($$)},{prop:"dominantSpeakerPriority",values:Object.values(hS)},{prop:"maxSubscriptionBitrate",type:"number"},{prop:"maxTracks",type:"number"},{prop:"mode",values:Object.values(z$)},{prop:"clientTrackSwitchOffControl",values:Object.values(F$)},{prop:"trackSwitchOffMode",values:Object.values(W$)}]),r)?r:t.video?"maxTracks"in t.video&&"clientTrackSwitchOffControl"in t.video?new TypeError("options.bandwidthProfile.video.maxTracks is deprecated. Use options.bandwidthProfile.video.clientTrackSwitchOffControl instead."):"renderDimensions"in t.video&&"contentPreferencesMode"in t.video?new TypeError("options.bandwidthProfile.video.renderDimensions is deprecated. Use options.bandwidthProfile.video.contentPreferencesMode instead."):q$(t.video.renderDimensions):null}function Z$(t,r){if(!(t instanceof r.LocalAudioTrack||t instanceof r.LocalDataTrack||t instanceof r.LocalVideoTrack||t instanceof r.MediaStreamTrack))throw ll.INVALID_TYPE("track","LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack")}function cl(t,r,e){return e===void 0&&(e=[]),typeof t>"u"?null:t===null||!V$(t)?ll.INVALID_TYPE(r,"object"):e.reduce(function(n,i){var a=i.prop,o=i.type,s=i.values;if(n||!(a in t))return n;var u=t[a];return o&&typeof u!==o||o==="number"&&isNaN(u)?ll.INVALID_TYPE(r+"."+a,o):Array.isArray(s)&&!s.includes(u)?ll.INVALID_VALUE(r+"."+a,s):n},null)}function q$(t){var r="options.bandwidthProfile.video.renderDimensions",e=cl(t,r);return t?e||Object.values(hS).reduce(function(n,i){return n||cl(t[i],r+"."+i,[{prop:"height",type:"number"},{prop:"width",type:"number"}])},null):e}ul.validateBandwidthProfile=B$,ul.validateLocalTrack=Z$,ul.validateObject=cl;var Q$=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Y$=il,mS=at,G$=mS.buildLogLevels,H$=mS.valueToJSON,J$=fr.DEFAULT_LOG_LEVEL,X$=na,K$=0,ez=function(t){Q$(r,t);function r(e,n,i){var a=t.call(this)||this;i=Object.assign({logLevel:J$},i);var o=G$(i.logLevel);return Object.defineProperties(a,{_instanceId:{value:K$++},_log:{value:i.log?i.log.createLog("default",a):new X$("default",a,o,i.loggerName)},trackName:{enumerable:!0,value:e},trackSid:{enumerable:!0,value:n}}),a}return r.prototype.toJSON=function(){return H$(this)},r.prototype.toString=function(){return"[TrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r}(Y$),gS=ez,tz=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),rz=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},nz=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},iz=gS,yS=fr,az=yS.typeErrors,oz=yS.trackPriority,sz=function(t){tz(r,t);function r(e,n,i,a){var o=t.call(this,n.name,e.sid,a)||this;return Object.defineProperties(o,{_reemitSignalingEvent:{value:function(){for(var s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];return o.emit.apply(o,nz([s&&s.length?"warning":"warningsCleared"],rz(s)))}},_reemitTrackEvent:{value:function(){return o.emit(o.isTrackEnabled?"trackEnabled":"trackDisabled")}},_signaling:{value:e},_unpublish:{value:i},isTrackEnabled:{enumerable:!0,get:function(){return this.track.kind==="data"?!0:this.track.isEnabled}},kind:{enumerable:!0,value:n.kind},priority:{enumerable:!0,get:function(){return e.updatedPriority}},track:{enumerable:!0,value:n}}),["disabled","enabled"].forEach(function(s){return n.on(s,o._reemitTrackEvent)}),["warning","warningsCleared"].forEach(function(s){return e.on(s,o._reemitSignalingEvent)}),o}return r.prototype.toString=function(){return"[LocalTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r.prototype.setPriority=function(e){var n=Object.values(oz);if(!n.includes(e))throw az.INVALID_VALUE("priority",n);return this._signaling.setPriority(e),this},r.prototype.unpublish=function(){var e=this;return["disabled","enabled"].forEach(function(n){return e.track.removeListener(n,e._reemitTrackEvent)}),["warning","warningsCleared"].forEach(function(n){return e._signaling.removeListener(n,e._reemitSignalingEvent)}),this._unpublish(this),this},r}(iz),rm=sz,uz=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),lz=rm,cz=function(t){uz(r,t);function r(e,n,i,a){return t.call(this,e,n,i,a)||this}return r.prototype.toString=function(){return"[LocalAudioTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r}(lz),fz=cz,dz=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),pz=rm,vz=function(t){dz(r,t);function r(e,n,i,a){return t.call(this,e,n,i,a)||this}return r.prototype.toString=function(){return"[LocalDataTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r}(pz),hz=vz,mz=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),gz=rm,yz=function(t){mz(r,t);function r(e,n,i,a){return t.call(this,e,n,i,a)||this}return r.prototype.toString=function(){return"[LocalVideoTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r}(gz),bz=yz,_z=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),wz=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},kz=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},bS=fr,Tz=bS.typeErrors,Sz=bS.trackPriority,Ez=Oo.isIOS,_S=jh;function Mz(t){return function(r){_z(e,r);function e(n,i,a,o,s,u,l){var c=this;return l=Object.assign({workaroundWebKitBug212780:Ez()&&typeof document=="object"&&typeof document.addEventListener=="function"&&typeof document.visibilityState=="string"},l),c=r.call(this,i,l)||this,Object.defineProperties(c,{_isEnabled:{value:a,writable:!0},_isSwitchedOff:{value:o,writable:!0},_priority:{value:null,writable:!0},_setPriority:{value:s},_setRenderHint:{value:function(f){c._log.debug("updating render hint:",f),u(f)}},isEnabled:{enumerable:!0,get:function(){return this._isEnabled}},isSwitchedOff:{enumerable:!0,get:function(){return this._isSwitchedOff}},priority:{enumerable:!0,get:function(){return this._priority}},sid:{enumerable:!0,value:n},_workaroundWebKitBug212780:{value:l.workaroundWebKitBug212780},_workaroundWebKitBug212780Cleanup:{value:null,writable:!0}}),c}return e.prototype.setPriority=function(n){var i=kz([null],wz(Object.values(Sz)));if(!i.includes(n))throw Tz.INVALID_VALUE("priority",i);return this._priority!==n&&(this._priority=n,this._setPriority(n)),this},e.prototype._setEnabled=function(n){this._isEnabled!==n&&(this._isEnabled=n,this.emit(this._isEnabled?"enabled":"disabled",this))},e.prototype._setSwitchedOff=function(n){this._isSwitchedOff!==n&&(this._isSwitchedOff=n,this.emit(n?"switchedOff":"switchedOn",this))},e.prototype.attach=function(n){var i=r.prototype.attach.call(this,n);return this.mediaStreamTrack.enabled!==!0&&(this.mediaStreamTrack.enabled=!0,this.processedTrack&&(this.processedTrack.enabled=!0),this.processor&&this._captureFrames()),this._workaroundWebKitBug212780&&(this._workaroundWebKitBug212780Cleanup=this._workaroundWebKitBug212780Cleanup||Cz(this)),i},e.prototype.detach=function(n){var i=r.prototype.detach.call(this,n);return this._attachments.size===0&&(this.mediaStreamTrack.enabled=!1,this.processedTrack&&(this.processedTrack.enabled=!1),this._workaroundWebKitBug212780Cleanup&&(this._workaroundWebKitBug212780Cleanup(),this._workaroundWebKitBug212780Cleanup=null)),i},e}(t)}function Cz(t){var r=t._log,e=t.kind;function n(i){i&&t._attachments.forEach(function(a){var o=t._elShims.get(a),s=a.paused&&o&&!o.pausedIntentionally();s&&(r.info("Playing inadvertently paused <"+e+"> element"),r.debug("Element:",a),r.debug("RemoteMediaTrack:",t),a.play().then(function(){r.info("Successfully played inadvertently paused <"+e+"> element"),r.debug("Element:",a),r.debug("RemoteMediaTrack:",t)}).catch(function(u){r.warn("Error while playing inadvertently paused <"+e+"> element:",{err:u,el:a,remoteMediaTrack:t})}))})}return _S.onVisibilityChange(2,n),function(){_S.offVisibilityChange(2,n)}}var wS=Mz,Rz=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Iz=ok,Oz=wS,Nz=Oz(Iz),Az=function(t){Rz(r,t);function r(e,n,i,a,o,s,u){return t.call(this,e,n,i,a,o,s,u)||this}return r.prototype.toString=function(){return"[RemoteAudioTrack #"+this._instanceId+": "+this.sid+"]"},r.prototype._start=function(){t.prototype._start.call(this),this._dummyEl&&(this._dummyEl.srcObject=null,this._dummyEl=null)},r.prototype.setPriority=function(e){return t.prototype.setPriority.call(this,e)},r}(Nz),Pz=Az,xz=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Dz=gS,Lz=function(t){xz(r,t);function r(e,n){var i=t.call(this,e.name,e.sid,n)||this;Object.defineProperties(i,{_signaling:{value:e},_track:{value:null,writable:!0},isSubscribed:{enumerable:!0,get:function(){return!!this._track}},isTrackEnabled:{enumerable:!0,get:function(){return e.isEnabled}},kind:{enumerable:!0,value:e.kind},publishPriority:{enumerable:!0,get:function(){return e.priority}},track:{enumerable:!0,get:function(){return this._track}}});var a=e.error,o=e.isEnabled,s=e.isSwitchedOff,u=e.priority;return e.on("updated",function(){if(a!==e.error){a=e.error,i.emit("subscriptionFailed",e.error);return}o!==e.isEnabled&&(o=e.isEnabled,i.track&&i.track._setEnabled(e.isEnabled),i.emit(e.isEnabled?"trackEnabled":"trackDisabled")),s!==e.isSwitchedOff&&(i._log.debug(i.trackSid+": "+(s?"OFF":"ON")+" => "+(e.isSwitchedOff?"OFF":"ON")),s=e.isSwitchedOff,i.track?(i.track._setSwitchedOff(e.isSwitchedOff),i.emit(s?"trackSwitchedOff":"trackSwitchedOn",i.track)):s&&i._log.warn("Track was not subscribed when switched Off.")),u!==e.priority&&(u=e.priority,i.emit("publishPriorityChanged",u))}),i}return r.prototype.toString=function(){return"[RemoteTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r.prototype._subscribed=function(e){!this._track&&e&&(this._track=e,this.emit("subscribed",e))},r.prototype._unsubscribe=function(){if(this._track){var e=this._track;this._track=null,this.emit("unsubscribed",e)}},r}(Dz),nm=Lz,Uz=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),jz=nm,Vz=function(t){Uz(r,t);function r(e,n){return t.call(this,e,n)||this}return r.prototype.toString=function(){return"[RemoteAudioTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r}(jz),Fz=Vz,$z=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),zz=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},Wz=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},Bz=Dh,kS=fr,Zz=kS.typeErrors,qz=kS.trackPriority,Qz=function(t){$z(r,t);function r(e,n,i){var a=t.call(this,n.id,"data",i)||this;return Object.defineProperties(a,{_isSwitchedOff:{value:!1,writable:!0},_priority:{value:null,writable:!0},isEnabled:{enumerable:!0,value:!0},isSwitchedOff:{enumerable:!0,get:function(){return this._isSwitchedOff}},maxPacketLifeTime:{enumerable:!0,value:n.maxPacketLifeTime},maxRetransmits:{enumerable:!0,value:n.maxRetransmits},ordered:{enumerable:!0,value:n.ordered},priority:{enumerable:!0,get:function(){return this._priority}},reliable:{enumerable:!0,value:n.maxPacketLifeTime===null&&n.maxRetransmits===null},sid:{enumerable:!0,value:e}}),n.on("message",function(o){a.emit("message",o,a)}),a}return r.prototype.setPriority=function(e){var n=Wz([null],zz(Object.values(qz)));if(!n.includes(e))throw Zz.INVALID_VALUE("priority",n);return this._priority=e,this},r.prototype._setEnabled=function(){},r.prototype._setSwitchedOff=function(e){this._isSwitchedOff!==e&&(this._isSwitchedOff=e,this.emit(e?"switchedOff":"switchedOn",this))},r}(Bz),Yz=Qz,Gz=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Hz=nm,Jz=function(t){Gz(r,t);function r(e,n){return t.call(this,e,n)||this}return r.prototype.toString=function(){return"[RemoteDataTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r}(Hz),Xz=Jz,TS=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),im=function(){function t(r){Object.defineProperties(this,{_callback:{value:r}})}return t.prototype.observe=function(){},t.prototype.unobserve=function(){},t.prototype.makeVisible=function(r){var e=this._makeFakeEntry(r,!0);this._callback([e])},t.prototype.makeInvisible=function(r){var e=this._makeFakeEntry(r,!1);this._callback([e])},t.prototype._makeFakeEntry=function(r,e){return{target:r,isIntersecting:e}},t}(),Kz=function(t){TS(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r}(im),e6=function(t){TS(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.resize=function(e){var n=this._makeFakeEntry(e,!0);this._callback([n])},r}(im),t6={NullIntersectionObserver:Kz,NullResizeObserver:e6,NullObserver:im},r6=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),n6=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},i6=wS,a6=Ik,SS=jh,ES=t6.NullObserver,o6=No,s6=i6(a6),u6=50,l6=function(t){r6(r,t);function r(e,n,i,a,o,s,u){var l=this;return u=Object.assign({clientTrackSwitchOffControl:"auto",contentPreferencesMode:"auto",enableDocumentVisibilityTurnOff:!0},u),u=Object.assign({IntersectionObserver:typeof IntersectionObserver>"u"||u.clientTrackSwitchOffControl!=="auto"?ES:IntersectionObserver,ResizeObserver:typeof ResizeObserver>"u"||u.contentPreferencesMode!=="auto"?ES:ResizeObserver},u),l=t.call(this,e,n,i,a,o,s,u)||this,Object.defineProperties(l,{_enableDocumentVisibilityTurnOff:{value:u.enableDocumentVisibilityTurnOff===!0&&u.clientTrackSwitchOffControl==="auto"},_documentVisibilityTurnOffCleanup:{value:null,writable:!0},_clientTrackSwitchOffControl:{value:u.clientTrackSwitchOffControl},_contentPreferencesMode:{value:u.contentPreferencesMode},_invisibleElements:{value:new WeakSet},_elToPipCallbacks:{value:new WeakMap},_elToPipWindows:{value:new WeakMap},_turnOffTimer:{value:new o6(function(){l._setRenderHint({enabled:!1})},u6,!1)},_resizeObserver:{value:new u.ResizeObserver(function(c){var f=c.find(function(d){return!l._invisibleElements.has(d.target)});f&&Wf(l)})},_intersectionObserver:{value:new u.IntersectionObserver(function(c){var f=!1;c.forEach(function(d){var v=!l._invisibleElements.has(d.target);v!==d.isIntersecting&&(d.isIntersecting?(l._log.debug("intersectionObserver detected: Off => On"),l._invisibleElements.delete(d.target)):(l._log.debug("intersectionObserver detected: On => Off"),l._invisibleElements.add(d.target)),f=!0)}),f&&(Us(l),Wf(l))},{threshold:.25})}}),l}return r.prototype._start=function(e){var n=t.prototype._start.call(this,e);return Us(this),n},r.prototype.switchOn=function(){if(this._clientTrackSwitchOffControl!=="manual")throw new Error('Invalid state. You can call switchOn only when bandwidthProfile.video.clientTrackSwitchOffControl is set to "manual"');return this._setRenderHint({enabled:!0}),this},r.prototype.switchOff=function(){if(this._clientTrackSwitchOffControl!=="manual")throw new Error('Invalid state. You can call switchOff only when bandwidthProfile.video.clientTrackSwitchOffControl is set to "manual"');return this._setRenderHint({enabled:!1}),this},r.prototype.setContentPreferences=function(e){if(this._contentPreferencesMode!=="manual")throw new Error('Invalid state. You can call switchOn only when bandwidthProfile.video.contentPreferencesMode is set to "manual"');return e.renderDimensions&&this._setRenderHint({renderDimensions:e.renderDimensions}),this},r.prototype._unObservePip=function(e){var n=this._elToPipCallbacks.get(e);n&&(e.removeEventListener("enterpictureinpicture",n.onEnterPip),e.removeEventListener("leavepictureinpicture",n.onLeavePip),this._elToPipCallbacks.delete(e))},r.prototype._observePip=function(e){var n=this,i=this._elToPipCallbacks.get(e);if(!i){var a=function(u){return n._onEnterPip(u,e)},o=function(u){return n._onLeavePip(u,e)},s=function(u){return n._onResizePip(u,e)};e.addEventListener("enterpictureinpicture",a),e.addEventListener("leavepictureinpicture",o),this._elToPipCallbacks.set(e,{onEnterPip:a,onLeavePip:o,onResizePip:s})}},r.prototype._onEnterPip=function(e,n){this._log.debug("onEnterPip");var i=e.pictureInPictureWindow;this._elToPipWindows.set(n,i);var a=this._elToPipCallbacks.get(n).onResizePip;i.addEventListener("resize",a),Us(this)},r.prototype._onLeavePip=function(e,n){this._log.debug("onLeavePip"),this._elToPipWindows.delete(n);var i=this._elToPipCallbacks.get(n).onResizePip,a=e.pictureInPictureWindow;a.removeEventListener("resize",i),Us(this)},r.prototype._onResizePip=function(){Wf(this)},r.prototype.attach=function(e){var n=t.prototype.attach.call(this,e);return this._clientTrackSwitchOffControl==="auto"&&this._invisibleElements.add(n),this._intersectionObserver.observe(n),this._resizeObserver.observe(n),this._enableDocumentVisibilityTurnOff&&(this._documentVisibilityTurnOffCleanup=this._documentVisibilityTurnOffCleanup||c6(this)),this._observePip(n),n},r.prototype.detach=function(e){var n=this,i=t.prototype.detach.call(this,e),a=Array.isArray(i)?i:[i];return a.forEach(function(o){n._intersectionObserver.unobserve(o),n._resizeObserver.unobserve(o),n._invisibleElements.delete(o),n._unObservePip(o)}),this._attachments.size===0&&this._documentVisibilityTurnOffCleanup&&(this._documentVisibilityTurnOffCleanup(),this._documentVisibilityTurnOffCleanup=null),Us(this),Wf(this),i},r.prototype.addProcessor=function(){return t.prototype.addProcessor.apply(this,arguments)},r.prototype.removeProcessor=function(){return t.prototype.removeProcessor.apply(this,arguments)},r.prototype.toString=function(){return"[RemoteVideoTrack #"+this._instanceId+": "+this.sid+"]"},r.prototype.setPriority=function(e){return t.prototype.setPriority.call(this,e)},r}(s6);function c6(t){function r(){Us(t)}return SS.onVisibilityChange(1,r),function(){SS.offVisibilityChange(1,r)}}function Us(t){if(t._clientTrackSwitchOffControl==="auto"){var r=t._getAllAttachedElements().filter(function(i){return!t._invisibleElements.has(i)}),e=t._getAllAttachedElements().filter(function(i){return t._elToPipWindows.has(i)}),n=e.length>0||document.visibilityState==="visible"&&r.length>0;n===!0?(t._turnOffTimer.clear(),t._setRenderHint({enabled:!0})):t._turnOffTimer.isSet||t._turnOffTimer.start()}}function Wf(t){if(t._contentPreferencesMode==="auto"){var r=t._getAllAttachedElements().filter(function(l){return!t._invisibleElements.has(l)}),e=t._getAllAttachedElements().map(function(l){var c=t._elToPipWindows.get(l);return c?{clientHeight:c.height,clientWidth:c.width}:{clientHeight:0,clientWidth:0}}),n=r.concat(e);if(n.length>0){var i=n6(n.sort(function(l,c){return c.clientHeight+c.clientWidth-l.clientHeight-l.clientWidth-1}),1),a=i[0],o=a.clientHeight,s=a.clientWidth,u={height:o,width:s};t._setRenderHint({renderDimensions:u})}}}var f6=l6,d6=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),p6=nm,v6=function(t){d6(r,t);function r(e,n){return t.call(this,e,n)||this}return r.prototype.toString=function(){return"[RemoteVideoTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r}(p6),h6=v6,m6=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),fl=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},am=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},g6=il,y6=Pz,b6=Fz,_6=Yz,w6=Xz,k6=f6,T6=h6,ia=at,S6=0,E6=function(t){m6(r,t);function r(e,n){var i=t.call(this)||this;n=Object.assign({RemoteAudioTrack:y6,RemoteAudioTrackPublication:b6,RemoteDataTrack:_6,RemoteDataTrackPublication:w6,RemoteVideoTrack:k6,RemoteVideoTrackPublication:T6,tracks:[]},n);var a=M6(n.tracks),o=n.log.createLog("default",i),s=new Map(a.audioTracks),u=new Map(a.dataTracks),l=new Map(a.tracks),c=new Map(a.videoTracks);return Object.defineProperties(i,{_RemoteAudioTrack:{value:n.RemoteAudioTrack},_RemoteAudioTrackPublication:{value:n.RemoteAudioTrackPublication},_RemoteDataTrack:{value:n.RemoteDataTrack},_RemoteDataTrackPublication:{value:n.RemoteDataTrackPublication},_RemoteVideoTrack:{value:n.RemoteVideoTrack},_RemoteVideoTrackPublication:{value:n.RemoteVideoTrackPublication},_audioTracks:{value:s},_dataTracks:{value:u},_instanceId:{value:++S6},_clientTrackSwitchOffControl:{value:n.clientTrackSwitchOffControl},_contentPreferencesMode:{value:n.contentPreferencesMode},_log:{value:o},_signaling:{value:e},_tracks:{value:l},_trackEventReemitters:{value:new Map},_trackPublicationEventReemitters:{value:new Map},_trackSignalingUpdatedEventCallbacks:{value:new Map},_videoTracks:{value:c},audioTracks:{enumerable:!0,value:new Map},dataTracks:{enumerable:!0,value:new Map},identity:{enumerable:!0,get:function(){return e.identity}},networkQualityLevel:{enumerable:!0,get:function(){return e.networkQualityLevel}},networkQualityStats:{enumerable:!0,get:function(){return e.networkQualityStats}},sid:{enumerable:!0,get:function(){return e.sid}},state:{enumerable:!0,get:function(){return e.state}},tracks:{enumerable:!0,value:new Map},videoTracks:{enumerable:!0,value:new Map}}),i._tracks.forEach(MS.bind(null,i)),e.on("networkQualityLevelChanged",function(){return i.emit("networkQualityLevelChanged",i.networkQualityLevel,i.networkQualityStats&&(i.networkQualityStats.audio||i.networkQualityStats.video)?i.networkQualityStats:null)}),C6(i,e),o.info("Created a new Participant"+(i.identity?": "+i.identity:"")),i}return r.prototype._getTrackEvents=function(){return[["dimensionsChanged","trackDimensionsChanged"],["message","trackMessage"],["started","trackStarted"]]},r.prototype._getTrackPublicationEvents=function(){return[]},r.prototype.toString=function(){return"[Participant #"+this._instanceId+": "+this.sid+"]"},r.prototype._addTrack=function(e,n){var i=this._log;if(this._tracks.has(n))return null;this._tracks.set(n,e);var a={audio:this._audioTracks,video:this._videoTracks,data:this._dataTracks}[e.kind];return a.set(n,e),MS(this,e,n),i.info("Added a new "+ia.trackClass(e)+":",n),i.debug(ia.trackClass(e)+":",e),e},r.prototype._addTrackPublication=function(e){var n=this._log;if(this.tracks.has(e.trackSid))return null;this.tracks.set(e.trackSid,e);var i={audio:this.audioTracks,data:this.dataTracks,video:this.videoTracks}[e.kind];return i.set(e.trackSid,e),R6(this,e),n.info("Added a new "+ia.trackPublicationClass(e)+":",e.trackSid),n.debug(ia.trackPublicationClass(e)+":",e),e},r.prototype._handleTrackSignalingEvents=function(){var e=this,n=e._log,i=e._clientTrackSwitchOffControl,a=e._contentPreferencesMode,o=this;if(this.state==="disconnected")return;var s=this._RemoteAudioTrack,u=this._RemoteAudioTrackPublication,l=this._RemoteVideoTrack,c=this._RemoteVideoTrackPublication,f=this._RemoteDataTrack,d=this._RemoteDataTrackPublication,v=this._signaling;function p(C){var L={audio:u,data:d,video:c}[C.kind],R=new L(C,{log:n});o._addTrackPublication(R);var q=C.isSubscribed;q&&k(C),o._trackSignalingUpdatedEventCallbacks.set(C.sid,function(){if(q!==C.isSubscribed){if(q=C.isSubscribed,q){k(C);return}I(C)}}),C.on("updated",o._trackSignalingUpdatedEventCallbacks.get(C.sid))}function y(C){C.isSubscribed&&C.setTrackTransceiver(null);var L=o._trackSignalingUpdatedEventCallbacks.get(C.sid);L&&(C.removeListener("updated",L),o._trackSignalingUpdatedEventCallbacks.delete(C.sid));var R=o.tracks.get(C.sid);R&&o._removeTrackPublication(R)}function k(C){var L=C.isEnabled,R=C.name,q=C.kind,z=C.sid,F=C.trackTransceiver,D=C.isSwitchedOff,W={audio:s,video:l,data:f}[q],X=o.tracks.get(z);if(!(!W||q!==F.kind)){var me={log:n,name:R,clientTrackSwitchOffControl:i,contentPreferencesMode:a},de=function(Z){return v.updateSubscriberTrackPriority(z,Z)},H=function(Z){C.isSubscribed&&v.updateTrackRenderHint(z,Z)},ee=q==="data"?new W(z,F,me):new W(z,F,L,D,de,H,me);o._addTrack(ee,X,F.id)}}function I(C){var L=fl(Array.from(o._tracks.entries()).find(function(F){var D=fl(F,2),W=D[1];return W.sid===C.sid}),2),R=L[0],q=L[1],z=o.tracks.get(C.sid);q&&o._removeTrack(q,z,R)}v.on("trackAdded",p),v.on("trackRemoved",y),v.tracks.forEach(p),v.on("stateChanged",function C(L){L==="disconnected"?(n.debug("Removing event listeners"),v.removeListener("stateChanged",C),v.removeListener("trackAdded",p),v.removeListener("trackRemoved",y)):L==="connected"&&(n.info("reconnected"),setTimeout(function(){return o.emit("reconnected")},0))})},r.prototype._removeTrack=function(e,n){if(!this._tracks.has(n))return null;this._tracks.delete(n);var i={audio:this._audioTracks,video:this._videoTracks,data:this._dataTracks}[e.kind];i.delete(n);var a=this._trackEventReemitters.get(n)||new Map;a.forEach(function(s,u){e.removeListener(u,s)});var o=this._log;return o.info("Removed a "+ia.trackClass(e)+":",n),o.debug(ia.trackClass(e)+":",e),e},r.prototype._removeTrackPublication=function(e){if(e=this.tracks.get(e.trackSid),!e)return null;this.tracks.delete(e.trackSid);var n={audio:this.audioTracks,data:this.dataTracks,video:this.videoTracks}[e.kind];n.delete(e.trackSid);var i=this._trackPublicationEventReemitters.get(e.trackSid)||new Map;i.forEach(function(o,s){e.removeListener(s,o)});var a=this._log;return a.info("Removed a "+ia.trackPublicationClass(e)+":",e.trackSid),a.debug(ia.trackPublicationClass(e)+":",e),e},r.prototype.toJSON=function(){return ia.valueToJSON(this)},r}(g6);function M6(t){var r=t.map(function(a){return[a.id,a]}),e=r.filter(function(a){return a[1].kind==="audio"}),n=r.filter(function(a){return a[1].kind==="video"}),i=r.filter(function(a){return a[1].kind==="data"});return{audioTracks:e,dataTracks:i,tracks:r,videoTracks:n}}function C6(t,r){var e=t._log;t.state!=="disconnected"&&r.on("stateChanged",function n(i){e.debug("Transitioned to state:",i),t.emit(i,t),i==="disconnected"&&(e.debug("Removing Track event reemitters"),r.removeListener("stateChanged",n),t._tracks.forEach(function(a){var o=t._trackEventReemitters.get(a.id);a&&o&&o.forEach(function(s,u){a.removeListener(u,s)})}),r.tracks.forEach(function(a){var o=t._tracks.get(a.id),s=t._trackEventReemitters.get(a.id);o&&s&&s.forEach(function(u,l){o.removeListener(l,u)})}),t._trackEventReemitters.clear(),t.tracks.forEach(function(a){t._trackPublicationEventReemitters.get(a.trackSid).forEach(function(o,s){a.removeListener(s,o)})}),t._trackPublicationEventReemitters.clear())})}function MS(t,r,e){var n=new Map;t.state!=="disconnected"&&(t._getTrackEvents().forEach(function(i){var a=i[0],o=i[1];n.set(a,function(){var s=[o].concat([].slice.call(arguments));return t.emit.apply(t,am([],fl(s)))}),r.on(a,n.get(a))}),t._trackEventReemitters.set(e,n))}function R6(t,r){var e=new Map;t.state!=="disconnected"&&(t._getTrackPublicationEvents().forEach(function(n){var i=fl(n,2),a=i[0],o=i[1];e.set(a,function(){for(var s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];t.emit.apply(t,am(am([o],fl(s)),[r]))}),r.on(a,e.get(a))}),t._trackPublicationEventReemitters.set(r.trackSid,e))}var CS=E6,I6=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),O6=Io.MediaStreamTrack,om=at,N6=om.asLocalTrack,A6=om.asLocalTrackPublication,Po=om.trackClass,RS=fr,Za=RS.typeErrors,sm=RS.trackPriority,P6=ul.validateLocalTrack,um=Rs,x6=um.LocalAudioTrack,D6=um.LocalDataTrack,L6=um.LocalVideoTrack,U6=fz,j6=hz,V6=bz,F6=CS,$6=function(t){I6(r,t);function r(e,n,i){var a=this;i=Object.assign({LocalAudioTrack:x6,LocalVideoTrack:L6,LocalDataTrack:D6,MediaStreamTrack:O6,LocalAudioTrackPublication:U6,LocalVideoTrackPublication:V6,LocalDataTrackPublication:j6,shouldStopLocalTracks:!1,tracks:n},i);var o=i.shouldStopLocalTracks?new Set(n.filter(function(s){return s.kind!=="data"})):new Set;return a=t.call(this,e,i)||this,Object.defineProperties(a,{_eventObserver:{value:i.eventObserver},_LocalAudioTrack:{value:i.LocalAudioTrack},_LocalDataTrack:{value:i.LocalDataTrack},_LocalVideoTrack:{value:i.LocalVideoTrack},_MediaStreamTrack:{value:i.MediaStreamTrack},_LocalAudioTrackPublication:{value:i.LocalAudioTrackPublication},_LocalDataTrackPublication:{value:i.LocalDataTrackPublication},_LocalVideoTrackPublication:{value:i.LocalVideoTrackPublication},_tracksToStop:{value:o},signalingRegion:{enumerable:!0,get:function(){return e.signalingRegion}}}),a._handleTrackSignalingEvents(),a}return r.prototype._addTrack=function(e,n,i){var a=t.prototype._addTrack.call(this,e,n);return a&&this.state!=="disconnected"&&this._addLocalTrack(e,i),a},r.prototype._addLocalTrack=function(e,n){var i,a=(i=e.noiseCancellation)===null||i===void 0?void 0:i.vendor;this._signaling.addTrack(e._trackSender,e.name,n,a),this._log.info("Added a new "+Po(e,!0)+":",e.id),this._log.debug(Po(e,!0)+":",e)},r.prototype._removeTrack=function(e,n){var i=t.prototype._removeTrack.call(this,e,n);return i&&this.state!=="disconnected"&&(this._signaling.removeTrack(e._trackSender),this._log.info("Removed a "+Po(e,!0)+":",e.id),this._log.debug(Po(e,!0)+":",e)),i},r.prototype._getTrackEvents=function(){return t.prototype._getTrackEvents.call(this).concat([["disabled","trackDisabled"],["enabled","trackEnabled"],["stopped","trackStopped"]])},r.prototype.toString=function(){return"[LocalParticipant #"+this._instanceId+(this.sid?": "+this.sid:"")+"]"},r.prototype._handleTrackSignalingEvents=function(){var e=this,n=this._log;if(this.state!=="disconnected"){var i=function(u){var l=e._signaling.getPublication(u._trackSender);l&&(l.disable(),n.debug("Disabled the "+Po(u,!0)+":",u.id))},a=function(u){var l=e._signaling.getPublication(u._trackSender);l&&(l.enable(),n.debug("Enabled the "+Po(u,!0)+":",u.id))},o=function(u){var l=e._signaling.getPublication(u._trackSender);return l&&l.stop(),l},s=function(u){n.debug("Transitioned to state:",u),u==="disconnected"?(n.debug("Removing LocalTrack event listeners"),e._signaling.removeListener("stateChanged",s),e.removeListener("trackDisabled",i),e.removeListener("trackEnabled",a),e.removeListener("trackStopped",o),e._tracks.forEach(function(l){var c=o(l);c&&l._trackSender.removeClone(c._trackTransceiver)}),n.info("LocalParticipant disconnected. Stopping "+e._tracksToStop.size+" automatically-acquired LocalTracks"),e._tracksToStop.forEach(function(l){l.stop()})):u==="connected"&&(n.info("reconnected"),setTimeout(function(){return e.emit("reconnected")},0))};this.on("trackDisabled",i),this.on("trackEnabled",a),this.on("trackStopped",o),this._signaling.on("stateChanged",s),this._tracks.forEach(function(u){e._addLocalTrack(u,sm.PRIORITY_STANDARD),e._getOrCreateLocalTrackPublication(u).catch(function(l){n.warn("Failed to get or create LocalTrackPublication for "+u+":",l)})})}},r.prototype._getOrCreateLocalTrackPublication=function(e){var n=Bf(this.tracks,e);if(n)return Promise.resolve(n);var i=this._log,a=this,o=this._signaling.getPublication(e._trackSender);return o?new Promise(function(s,u){function l(){var c=o.error;if(c){o.removeListener("updated",l),i.warn("Failed to publish the "+Po(e,!0)+": "+c.message),a._removeTrack(e,e.id),setTimeout(function(){a.emit("trackPublicationFailed",c,e)}),u(c);return}if(!a._tracks.has(e.id)){o.removeListener("updated",l),u(new Error("The "+e+" was unpublished"));return}var f=o.sid;if(f){o.removeListener("updated",l);var d={log:i,LocalAudioTrackPublication:a._LocalAudioTrackPublication,LocalDataTrackPublication:a._LocalDataTrackPublication,LocalVideoTrackPublication:a._LocalVideoTrackPublication};n=Bf(a.tracks,e);var v=function(I){return a.emit("trackWarning",I,n)},p=function(){return a.emit("trackWarningsCleared",n)},y=function(I){n.removeListener("trackWarning",v),n.removeListener("trackWarningsCleared",p),a.unpublishTrack(I.track)};n||(n=A6(e,o,y,d),a._addTrackPublication(n)),n.on("warning",v),n.on("warningsCleared",p);var k=a._signaling.state;(k==="connected"||k==="connecting")&&(e._processorEventObserver&&e._processorEventObserver.on("event",function(I){a._eventObserver.emit("event",{name:I.name,payload:I.data,group:"video-processor",level:"info"})}),e.processedTrack&&(e._captureFrames(),e._setSenderMediaStreamTrack(!0))),k==="connected"&&setTimeout(function(){a.emit("trackPublished",n)}),s(n)}}o.on("updated",l)}):Promise.reject(new Error("Unexpected error: The "+e+" cannot be published"))},r.prototype.publishTrack=function(e,n){var i=Bf(this.tracks,e);if(i)return Promise.resolve(i);n=Object.assign({log:this._log,priority:sm.PRIORITY_STANDARD,LocalAudioTrack:this._LocalAudioTrack,LocalDataTrack:this._LocalDataTrack,LocalVideoTrack:this._LocalVideoTrack,MediaStreamTrack:this._MediaStreamTrack},n);var a;try{a=N6(e,n)}catch(c){return Promise.reject(c)}var o=a.noiseCancellation,s=this._signaling.audioProcessors;o&&!s.includes(o.vendor)&&(this._log.warn(o.vendor+" is not supported in this room. disabling it permanently"),o.disablePermanently());var u=Object.values(sm);if(!u.includes(n.priority))return Promise.reject(Za.INVALID_VALUE("LocalTrackPublishOptions.priority",u));var l=this._addTrack(a,a.id,n.priority)||this._tracks.get(a.id);return this._getOrCreateLocalTrackPublication(l)},r.prototype.publishTracks=function(e){if(!Array.isArray(e))throw Za.INVALID_TYPE("tracks","Array of LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack");return Promise.all(e.map(this.publishTrack,this))},r.prototype.setBandwidthProfile=function(){this._log.warn("setBandwidthProfile is not implemented yet and may be available in future versions of twilio-video.js")},r.prototype.setNetworkQualityConfiguration=function(e){if(typeof e!="object"||e===null)throw Za.INVALID_TYPE("networkQualityConfiguration","NetworkQualityConfiguration");return["local","remote"].forEach(function(n){if(n in e&&(typeof e[n]!="number"||isNaN(e[n])))throw Za.INVALID_TYPE("networkQualityConfiguration."+n,"number")}),this._signaling.setNetworkQualityConfiguration(e),this},r.prototype.setParameters=function(e){if(typeof e<"u"&&typeof e!="object")throw Za.INVALID_TYPE("encodingParameters","EncodingParameters, null or undefined");if(e){if(this._signaling.getParameters().adaptiveSimulcast&&e.maxVideoBitrate)throw Za.INVALID_TYPE("encodingParameters",'encodingParameters.maxVideoBitrate is not compatible with "preferredVideoCodecs=auto"');["maxAudioBitrate","maxVideoBitrate"].forEach(function(n){if(typeof e[n]<"u"&&typeof e[n]!="number"&&e[n]!==null)throw Za.INVALID_TYPE("encodingParameters."+n,"number, null or undefined")})}else e===null&&(e={maxAudioBitrate:null,maxVideoBitrate:null});return this._signaling.setParameters(e),this},r.prototype.unpublishTrack=function(e){P6(e,{LocalAudioTrack:this._LocalAudioTrack,LocalDataTrack:this._LocalDataTrack,LocalVideoTrack:this._LocalVideoTrack,MediaStreamTrack:this._MediaStreamTrack});var n=this._tracks.get(e.id);if(!n)return null;var i=this._signaling.getPublication(n._trackSender);if(i.publishFailed(new Error("The "+n+" was unpublished")),n=this._removeTrack(n,n.id),!n)return null;var a=Bf(this.tracks,n);return a&&this._removeTrackPublication(a),a},r.prototype.unpublishTracks=function(e){var n=this;if(!Array.isArray(e))throw Za.INVALID_TYPE("tracks","Array of LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack");return e.reduce(function(i,a){var o=n.unpublishTrack(a);return o?i.concat(o):i},[])},r}(F6);function Bf(t,r){return Array.from(t.values()).find(function(e){return e.track===r||e.track.mediaStreamTrack===r})||null}var z6=$6,W6=function(){function t(){Object.defineProperties(this,{_connected:{writable:!0,value:!0}})}return t.prototype.connect=function(){},t.prototype.disconnect=function(){return this._connected?(this._connected=!1,!0):!1},t.prototype.publish=function(){return this._connected},t}(),B6=W6,Z6=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),q6=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},Q6=Wr.EventEmitter,lm=fr,Zf=lm.DEFAULT_NQ_LEVEL_LOCAL,qf=lm.DEFAULT_NQ_LEVEL_REMOTE,IS=lm.MAX_NQ_LEVEL,cm=at.inRange,Y6=function(t){Z6(r,t);function r(e){var n=t.call(this)||this;return e=Object.assign({local:Zf,remote:qf},e),Object.defineProperties(n,{local:{value:cm(e.local,Zf,IS)?e.local:Zf,writable:!0},remote:{value:cm(e.remote,qf,IS)?e.remote:qf,writable:!0}}),n}return r.prototype.update=function(e){var n=this;e=Object.assign({local:this.local,remote:this.remote},e),[["local",Zf,3],["remote",qf,3]].forEach(function(i){var a=q6(i,3),o=a[0],s=a[1],u=a[2];n[o]=typeof e[o]=="number"&&cm(e[o],s,u)?e[o]:s})},r}(Q6),G6=Y6,H6=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),J6=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},OS=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},X6=CS,K6=function(t){H6(r,t);function r(e,n){var i=t.call(this,e,n)||this;return i._handleTrackSignalingEvents(),i.once("disconnected",i._unsubscribeTracks.bind(i)),i}return r.prototype.toString=function(){return"[RemoteParticipant #"+this._instanceId+(this.sid?": "+this.sid:"")+"]"},r.prototype._addTrack=function(e,n,i){return t.prototype._addTrack.call(this,e,i)?(n._subscribed(e),this.emit("trackSubscribed",e,n),e):null},r.prototype._addTrackPublication=function(e){var n=t.prototype._addTrackPublication.call(this,e);return n?(this.emit("trackPublished",n),n):null},r.prototype._getTrackPublicationEvents=function(){return OS(OS([],J6(t.prototype._getTrackPublicationEvents.call(this))),[["subscriptionFailed","trackSubscriptionFailed"],["trackDisabled","trackDisabled"],["trackEnabled","trackEnabled"],["publishPriorityChanged","trackPublishPriorityChanged"],["trackSwitchedOff","trackSwitchedOff"],["trackSwitchedOn","trackSwitchedOn"]])},r.prototype._unsubscribeTracks=function(){var e=this;this.tracks.forEach(function(n){if(n.isSubscribed){var i=n.track;n._unsubscribe(),e.emit("trackUnsubscribed",i,n)}})},r.prototype._removeTrack=function(e,n,i){var a=this._tracks.get(i);return a?(t.prototype._removeTrack.call(this,a,i),n._unsubscribe(),this.emit("trackUnsubscribed",a,n),a):null},r.prototype._removeTrackPublication=function(e){this._signaling.clearTrackHint(e.trackSid);var n=t.prototype._removeTrackPublication.call(this,e);return n?(this.emit("trackUnpublished",n),n):null},r}(X6),eW=K6,tW=function(){function t(r,e){if(typeof r!="string")throw new Error("Track id must be a string");Object.defineProperties(this,{trackId:{value:r,enumerable:!0},trackSid:{value:e.trackSid,enumerable:!0},timestamp:{value:e.timestamp,enumerable:!0},ssrc:{value:e.ssrc,enumerable:!0},packetsLost:{value:typeof e.packetsLost=="number"?e.packetsLost:null,enumerable:!0},codec:{value:typeof e.codecName=="string"?e.codecName:null,enumerable:!0}})}return t}(),NS=tW,rW=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),nW=NS,iW=function(t){rW(r,t);function r(e,n,i){var a=t.call(this,e,n)||this;return Object.defineProperties(a,{bytesSent:{value:typeof n.bytesSent=="number"?n.bytesSent:i?0:null,enumerable:!0},packetsSent:{value:typeof n.packetsSent=="number"?n.packetsSent:i?0:null,enumerable:!0},roundTripTime:{value:typeof n.roundTripTime=="number"?n.roundTripTime:i?0:null,enumerable:!0}}),a}return r}(nW),AS=iW,aW=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),oW=AS,sW=function(t){aW(r,t);function r(e,n,i){var a=t.call(this,e,n,i)||this;return Object.defineProperties(a,{audioLevel:{value:typeof n.audioInputLevel=="number"?n.audioInputLevel:null,enumerable:!0},jitter:{value:typeof n.jitter=="number"?n.jitter:null,enumerable:!0}}),a}return r}(oW),uW=sW,lW=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),cW=AS,fW=function(t){lW(r,t);function r(e,n,i){var a=t.call(this,e,n,i)||this,o=null;typeof n.frameWidthInput=="number"&&typeof n.frameHeightInput=="number"&&(o={},Object.defineProperties(o,{width:{value:n.frameWidthInput,enumerable:!0},height:{value:n.frameHeightInput,enumerable:!0}}));var s=null;return typeof n.frameWidthSent=="number"&&typeof n.frameHeightSent=="number"&&(s={},Object.defineProperties(s,{width:{value:n.frameWidthSent,enumerable:!0},height:{value:n.frameHeightSent,enumerable:!0}})),Object.defineProperties(a,{captureDimensions:{value:o,enumerable:!0},dimensions:{value:s,enumerable:!0},captureFrameRate:{value:typeof n.frameRateInput=="number"?n.frameRateInput:null,enumerable:!0},frameRate:{value:typeof n.frameRateSent=="number"?n.frameRateSent:null,enumerable:!0}}),a}return r}(cW),dW=fW,pW=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),vW=NS,hW=function(t){pW(r,t);function r(e,n){var i=t.call(this,e,n)||this;return Object.defineProperties(i,{bytesReceived:{value:typeof n.bytesReceived=="number"?n.bytesReceived:null,enumerable:!0},packetsReceived:{value:typeof n.packetsReceived=="number"?n.packetsReceived:null,enumerable:!0}}),i}return r}(vW),PS=hW,mW=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),gW=PS,yW=function(t){mW(r,t);function r(e,n){var i=t.call(this,e,n)||this;return Object.defineProperties(i,{audioLevel:{value:typeof n.audioOutputLevel=="number"?n.audioOutputLevel:null,enumerable:!0},jitter:{value:typeof n.jitter=="number"?n.jitter:null,enumerable:!0}}),i}return r}(gW),bW=yW,_W=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),wW=PS,kW=function(t){_W(r,t);function r(e,n){var i=t.call(this,e,n)||this,a=null;return typeof n.frameWidthReceived=="number"&&typeof n.frameHeightReceived=="number"&&(a={},Object.defineProperties(a,{width:{value:n.frameWidthReceived,enumerable:!0},height:{value:n.frameHeightReceived,enumerable:!0}})),Object.defineProperties(i,{dimensions:{value:a,enumerable:!0},frameRate:{value:typeof n.frameRateReceived=="number"?n.frameRateReceived:null,enumerable:!0}}),i}return r}(wW),TW=kW,SW=uW,EW=dW,MW=bW,CW=TW,RW=function(){function t(r,e,n){if(typeof r!="string")throw new Error("RTCPeerConnection id must be a string");Object.defineProperties(this,{peerConnectionId:{value:r,enumerable:!0},localAudioTrackStats:{value:e.localAudioTrackStats.map(function(i){return new SW(i.trackId,i,n)}),enumerable:!0},localVideoTrackStats:{value:e.localVideoTrackStats.map(function(i){return new EW(i.trackId,i,n)}),enumerable:!0},remoteAudioTrackStats:{value:e.remoteAudioTrackStats.map(function(i){return new MW(i.trackId,i)}),enumerable:!0},remoteVideoTrackStats:{value:e.remoteVideoTrackStats.map(function(i){return new CW(i.trackId,i)}),enumerable:!0}})}return t}(),xS=RW,IW=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),dl=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},Qf=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},OW=il,NW=eW,AW=xS,DS=at,PW=DS.flatMap,xW=DS.valueToJSON,DW=0,LW=function(t){IW(r,t);function r(e,n,i){var a=t.call(this)||this,o=i.log.createLog("default",a),s=new Map;return Object.defineProperties(a,{_log:{value:o},_clientTrackSwitchOffControl:{value:i.clientTrackSwitchOffControl||"disabled"},_contentPreferencesMode:{value:i.contentPreferencesMode||"disabled"},_instanceId:{value:++DW},_options:{value:i},_participants:{value:s},_signaling:{value:n},dominantSpeaker:{enumerable:!0,get:function(){return this.participants.get(n.dominantSpeakerSid)||null}},isRecording:{enumerable:!0,get:function(){return n.recording.isEnabled||!1}},localParticipant:{enumerable:!0,value:e},name:{enumerable:!0,value:n.name},participants:{enumerable:!0,value:s},sid:{enumerable:!0,value:n.sid},state:{enumerable:!0,get:function(){return n.state}},mediaRegion:{enumerable:!0,value:n.mediaRegion}}),jW(a,e),VW(a,n.recording),FW(a,n),UW(a),o.info("Created a new Room:",a.name),o.debug("Initial RemoteParticipants:",Array.from(a._participants.values())),a}return r.prototype.toString=function(){return"[Room #"+this._instanceId+": "+this.sid+"]"},r.prototype.disconnect=function(){return this._log.info("Disconnecting"),this._signaling.disconnect(),this},r.prototype.getStats=function(){var e=this;return this._signaling.getStats().then(function(n){return Array.from(n).map(function(i){var a=dl(i,2),o=a[0],s=a[1];return new AW(o,Object.assign({},s,{localAudioTrackStats:LS(e,s.localAudioTrackStats),localVideoTrackStats:LS(e,s.localVideoTrackStats)}))})})},r.prototype.refreshInactiveMedia=function(){var e=this.localParticipant.tracks,n=Array.from(e.values()).filter(function(u){var l=u.track.kind;return l!=="data"}).map(function(u){var l=u.track;return l}),i=PW(this.participants,function(u){return Array.from(u.tracks.values())}).filter(function(u){var l=u.track;return l&&l.kind!=="data"}).map(function(u){var l=u.track;return l}),a=n.concat(i),o=new Event("unmute");n.forEach(function(u){var l=u.isMuted,c=u.mediaStreamTrack;l&&c.dispatchEvent(o)});var s=new Event("pause");return a.forEach(function(u){var l=u._attachments,c=u._elShims;return l.forEach(function(f){var d=c.get(f),v=f.paused&&d&&!d.pausedIntentionally();v&&f.dispatchEvent(s)})}),this},r.prototype.toJSON=function(){return xW(this)},r}(OW);function UW(t){var r=t.localParticipant._signaling.audioProcessors;t.localParticipant.audioTracks.forEach(function(e){var n=e.track,i=n.noiseCancellation;i&&!r.includes(i.vendor)&&(t._log.warn(i.vendor+" is not supported in this room. disabling it permanently"),i.disablePermanently())})}function LS(t,r){var e=t.localParticipant._signaling;return r.reduce(function(n,i){var a=e.tracks.get(i.trackId),o=e.getSender(a);return o?[Object.assign({},i,{trackId:o.id})].concat(n):n},[])}function US(t,r){var e=t._log,n=t._clientTrackSwitchOffControl,i=t._contentPreferencesMode,a=new NW(r,{log:e,clientTrackSwitchOffControl:n,contentPreferencesMode:i});e.info("A new RemoteParticipant connected:",a),t._participants.set(a.sid,a),t.emit("participantConnected",a);var o=[["reconnected","participantReconnected"],["reconnecting","participantReconnecting"],"trackDimensionsChanged","trackDisabled","trackEnabled","trackMessage","trackPublished","trackPublishPriorityChanged","trackStarted","trackSubscribed","trackSubscriptionFailed","trackSwitchedOff","trackSwitchedOn","trackUnpublished","trackUnsubscribed"].map(function(s){var u=dl(Array.isArray(s)?s:[s,s],2),l=u[0],c=u[1];function f(){var d=[].slice.call(arguments);d.unshift(c),d.push(a),t.emit.apply(t,Qf([],dl(d)))}return a.on(l,f),[l,f]});a.once("disconnected",function(){var u=t.dominantSpeaker;e.info("RemoteParticipant disconnected:",a),t._participants.delete(a.sid),o.forEach(function(l){a.removeListener(l[0],l[1])}),t.emit("participantDisconnected",a),a===u&&t.emit("dominantSpeakerChanged",t.dominantSpeaker)})}function jW(t,r){var e=["trackWarning","trackWarningsCleared"].map(function(n){return{eventName:n,handler:function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return t.emit.apply(t,Qf([n],dl(Qf(Qf([],dl(i)),[r]))))}}});e.forEach(function(n){var i=n.eventName,a=n.handler;return r.on(i,a)}),t.once("disconnected",function(){return e.forEach(function(n){var i=n.eventName,a=n.handler;return r.removeListener(i,a)})})}function VW(t,r){r.on("updated",function(){var n=r.isEnabled;t._log.info("Recording "+(n?"started":"stopped")),t.emit("recording"+(n?"Started":"Stopped"))})}function FW(t,r){var e=t._log;e.debug("Creating a new RemoteParticipant for each ParticipantSignaling in the RoomSignaling"),r.participants.forEach(US.bind(null,t)),e.debug("Setting up RemoteParticipant creation for all subsequent ParticipantSignalings that connect to the RoomSignaling"),r.on("participantConnected",US.bind(null,t)),r.on("dominantSpeakerChanged",function(){return t.emit("dominantSpeakerChanged",t.dominantSpeaker)}),r.on("stateChanged",function n(i,a){switch(e.info("Transitioned to state:",i),i){case"disconnected":t.participants.forEach(function(o){o._unsubscribeTracks()}),t.emit(i,t,a),t.localParticipant.tracks.forEach(function(o){o.unpublish()}),r.removeListener("stateChanged",n);break;case"reconnecting":setTimeout(function(){return t.emit("reconnecting",a)},0);break;default:setTimeout(function(){return t.emit("reconnected")},0)}})}var $W=LW,zW=function(){function t(r){Object.defineProperties(this,{_min:{value:r.min||100},_max:{value:r.max||1e4},_jitter:{value:r.jitter>0&&r.jitter<=1?r.jitter:0},_factor:{value:r.factor||2},_attempts:{value:0,writable:!0},_duration:{enumerable:!1,get:function(){var e=this._min*Math.pow(this._factor,this._attempts);if(this._jitter){var n=Math.random(),i=Math.floor(n*this._jitter*e);e=Math.floor(n*10)&1?e+i:e-i}return Math.min(e,this._max)|0}},_timeoutID:{value:null,writable:!0}})}return t.prototype.backoff=function(r){var e=this,n=this._duration;this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null),this._timeoutID=setTimeout(function(){e._attempts++,r()},n)},t.prototype.reset=function(){this._attempts=0,this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)},t}(),jS=zW,on={},WW=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},VS=at,fm=VS.difference,aa=VS.flatMap;function dm(){var t=4294967295;return String(Math.floor(Math.random()*t))}var BW=function(){function t(r,e,n){Object.defineProperties(this,{cName:{enumerable:!0,value:n},isSimulcastEnabled:{enumerable:!0,value:!1,writable:!0},primarySSRCs:{enumerable:!0,value:new Set},rtxPairs:{enumerable:!0,value:new Map},streamId:{enumerable:!0,value:e},trackId:{enumerable:!0,value:r}})}return t.prototype.addSimulcastSSRCs=function(){if(!this.isSimulcastEnabled){var r=[dm(),dm()];r.forEach(function(e){this.primarySSRCs.add(e)},this),this.rtxPairs.size&&r.forEach(function(e){this.rtxPairs.set(dm(),e)},this)}},t.prototype.addSSRC=function(r,e,n){e?this.rtxPairs.set(r,e):this.primarySSRCs.add(r),this.isSimulcastEnabled=this.isSimulcastEnabled||n},t.prototype.toSdpLines=function(r){var e=this,n=r?[]:Array.from(this.rtxPairs.entries()).map(function(l){return l.reverse()}),i=Array.from(this.primarySSRCs.values()),a=n.length?aa(n):i,o=aa(a,function(l){return["a=ssrc:"+l+" cname:"+e.cName,"a=ssrc:"+l+" msid:"+e.streamId+" "+e.trackId]}),s=n.map(function(l){return"a=ssrc-group:FID "+l.join(" ")}),u=["a=ssrc-group:SIM "+i.join(" ")];return s.concat(o).concat(u)},t}();function Yf(t,r){var e=t.match(new RegExp(r,"gm"))||[];return e.map(function(n){var i=n.match(new RegExp(r))||[];return i.slice(1)})}function ZW(t){var r="^a=ssrc-group:SIM ([0-9]+) ([0-9]+) ([0-9]+)$";return new Set(aa(Yf(t,r)))}function qW(t,r,e){var n="a=ssrc:"+r+" "+e+":(.+)";return t.match(new RegExp(n))[1]}function QW(t){var r="^a=ssrc-group:FID ([0-9]+) ([0-9]+)$";return new Map(Yf(t,r).map(function(e){return e.reverse()}))}function YW(t){var r=WW(aa(Yf(t,"^a=msid:(.+) (.+)$")),2),e=r[0],n=r[1],i=aa(Yf(t,"^a=ssrc:(.+) cname:.+$"));return i.map(function(a){return[a,e,n]})}function GW(t){var r=ZW(t),e=QW(t),n=YW(t);return n.reduce(function(i,a){var o=a[0],s=a[1],u=a[2],l=i.get(u)||new BW(u,s,qW(t,o,"cname")),c=e.get(o)||null;return l.addSSRC(o,c,r.has(o)),i.set(u,l)},new Map)}function HW(t,r){var e=GW(t),n=Array.from(e.keys()),i=Array.from(r.keys()),a=fm(n,i),o=fm(i,n),s=aa(a,function(p){return e.get(p)});s.forEach(function(p){p.addSimulcastSSRCs(),r.set(p.trackId,p)}),i=Array.from(r.keys());var u=fm(i,o),l=aa(u,function(p){return r.get(p)}),c=!t.match(/a=rtpmap:[0-9]+ rtx/),f=aa(l,function(p){return p.toSdpLines(c)}),d=aa(new Set(t.split(`\r
`).concat(f))),v="a=x-google-flag:conference";return t.match(v)||d.push(v),d.join(`\r
`)}var JW=HW,pl=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},FS=at,XW=FS.difference,pm=FS.flatMap,KW=JW,$S={0:"PCMU",8:"PCMA"};function js(t){return Array.from(Gf(t)).reduce(function(r,e){var n=e[0],i=e[1],a=r.get(i)||[];return r.set(i,a.concat(n))},new Map)}function vm(t){return Oi(t).reduce(function(r,e){var n=Vs(e);return n?r.set(n,e):r},new Map)}function Gf(t){return vl(t).reduce(function(r,e){var n=new RegExp("a=rtpmap:"+e+" ([^/]+)"),i=t.match(n),a=i?i[1].toLowerCase():$S[e]?$S[e].toLowerCase():"";return r.set(e,a)},new Map)}function Hf(t,r){var e=new RegExp("^a=fmtp:"+t+" (.+)$","m"),n=r.match(e);return n&&n[1].split(";").reduce(function(i,a){var o=pl(a.split("="),2),s=o[0],u=o[1];return i[s]=isNaN(u)?u:parseInt(u,10),i},{})}function Vs(t){var r=t.match(/^a=mid:(.+)$/m);return r&&r[1]}function Oi(t,r,e){return t.replace(/\r\n\r\n$/,`\r
`).split(`\r
m=`).slice(1).map(function(n){return"m="+n}).filter(function(n){var i=new RegExp("m="+(r||".*"),"gm"),a=new RegExp("a="+(e||".*"),"gm");return i.test(n)&&a.test(n)})}function vl(t){var r=t.split(`\r
`)[0],e=r.match(/([0-9]+)/g);return e?e.slice(1).map(function(n){return parseInt(n,10)}):[]}function e9(t,r){r=r.map(function(a){var o=a.codec;return o.toLowerCase()});var e=pm(r,function(a){return t.get(a)||[]}),n=XW(Array.from(t.keys()),r),i=pm(n,function(a){return t.get(a)});return e.concat(i)}function hm(t,r){var e=r.split(`\r
`),n=e[0],i=e.slice(1);return n=n.replace(/([0-9]+\s?)+$/,t.join(" ")),[n].concat(i).join(`\r
`)}function t9(t,r,e){var n=Oi(t),i=t.split(`\r
m=`)[0];return[i].concat(n.map(function(a){if(!/^m=(audio|video)/.test(a))return a;var o=a.match(/^m=(audio|video)/)[1],s=js(a),u=o==="audio"?r:e,l=e9(s,u),c=hm(l,a),f=s.get("pcma")||[],d=s.get("pcmu")||[],v=o==="audio"?new Set(f.concat(d)):new Set;return v.has(l[0])?c.replace(/\r\nb=(AS|TIAS):([0-9]+)/g,""):c})).join(`\r
`)}function r9(t,r){var e=Oi(t),n=t.split(`\r
m=`)[0];return[n].concat(e.map(function(i){if(i=i.replace(/\r\n$/,""),!/^m=video/.test(i))return i;var a=js(i),o=vl(i),s=new Set(a.get("vp8")||[]),u=o.some(function(l){return s.has(l)});return u?KW(i,r):i})).concat("").join(`\r
`)}function n9(t,r,e,n,i){var a=e.get(t)||[];if(a.length<=1)return a;var o=Hf(r,i);if(!o)return a;var s=a.find(function(u){var l=Hf(u,n);return l&&Object.keys(o).every(function(c){return o[c]===l[c]})});return typeof s=="number"?[s]:a}function i9(t,r,e){if(!/^m=(audio|video)/.test(t))return t;var n=Vs(t),i=n&&r.get(n);if(!i)return t;var a=Gf(i),o=js(t),s=pm(Array.from(a),function(f){var d=pl(f,2),v=d[0],p=d[1];return p!=="rtx"&&!e.includes(p)?n9(p,v,o,t,i):[]}),u=o.get("rtx")||[];s=s.concat(u.filter(function(f){var d=Hf(f,t);return d&&s.includes(d.apt)}));var l=t.split(`\r
`).filter(function(f){var d=f.match(/^a=(rtpmap|fmtp|rtcp-fb):(.+) .+$/),v=d&&d[2];return!d||v&&s.includes(parseInt(v,10))}),c=vl(t).filter(function(f){return s.includes(f)});return hm(c,l.join(`\r
`))}function a9(t,r){var e=Oi(t),n=t.split(`\r
m=`)[0],i=vm(r);return[n].concat(e.map(function(a){return i9(a,i,[])})).join(`\r
`)}function o9(t,r,e,n){n===void 0&&(n=!1);var i=vm(e),a=vm(r),o=Oi(t),s=t.split(`\r
m=`)[0];return[s].concat(o.map(function(u){if(u=u.replace(/\r\n$/,""),!/^m=video/.test(u))return u;var l=u.match(/^a=mid:(.+)$/m),c=l&&l[1];if(!c)return u;var f=i.get(c),d=Gf(f),v=vl(f),p=v.length&&d.get(v[0])==="vp8",y=n||!p;return y?a.get(c).replace(/\r\n$/,""):u})).concat("").join(`\r
`)}function s9(t,r,e){var n=Array.from(e).reduce(function(i,a){var o=pl(a,2),s=o[0],u=o[1],l=Oi(t,s,"send(only|recv)"),c=l.map(Vs).filter(function(f){return!r.has(f)});return c.forEach(function(f,d){return i.set(f,u[d])}),i},new Map);return zS(t,n)}function zS(t,r){var e=Oi(t),n=t.split(`\r
m=`)[0];return[n].concat(e.map(function(i){if(!/^m=(audio|video)/.test(i))return i;var a=Vs(i);if(!a)return i;var o=r.get(a);if(!o)return i;var s=(i.match(/^a=msid:(.+)$/m)||[])[1];if(!s)return i;var u=pl(s.split(" "),2),l=u[0],c=u[1],f=new RegExp("msid:"+l+(c?" "+c:"")+"$","gm");return i.replace(f,"msid:"+l+" "+o)})).join(`\r
`)}function u9(t,r){return t.split(`\r
`).filter(function(e){return!r.find(function(n){return new RegExp("a=ssrc:.*"+n+":","g").test(e)})}).join(`\r
`)}function l9(t){var r=Oi(t),e=t.split(`\r
m=`)[0];return[e].concat(r.map(function(n){if(!/^m=video/.test(n))return n;var i=js(n),a=i.get("rtx");if(!a)return n;var o=new Set(vl(n));a.forEach(function(c){return o.delete(c)});var s=n.match(/a=ssrc-group:FID [0-9]+ ([0-9]+)/),u=s&&s[1],l=[/^a=fmtp:.+ apt=.+$/,/^a=rtpmap:.+ rtx\/.+$/,/^a=ssrc-group:.+$/].concat(u?[new RegExp("^a=ssrc:"+u+" .+$")]:[]);return n=n.split(`\r
`).filter(function(c){return l.every(function(f){return!f.test(c)})}).join(`\r
`),hm(Array.from(o),n)})).join(`\r
`)}function WS(t,r){var e=Object.entries(r).map(function(n){var i=pl(n,2),a=i[0],o=i[1];return a+"="+o}).join(";");return"a=fmtp:"+t+" "+e}function c9(t,r){var e=Oi(t),n=t.split(`\r
m=`)[0];return r=r||e.filter(function(i){return/^m=audio/.test(i)}).map(Vs),[n].concat(e.map(function(i){if(!/^m=audio/.test(i))return i;var a=js(i),o=a.get("opus");if(!o)return i;var s=Hf(o,i);if(!s)return i;var u=WS(o,s),l=new RegExp(u),c=Vs(i);r.includes(c)?s.usedtx=1:delete s.usedtx;var f=WS(o,s);return i.replace(l,f)})).join(`\r
`)}on.addOrRewriteNewTrackIds=s9,on.addOrRewriteTrackIds=zS,on.createCodecMapForMediaSection=js,on.createPtToCodecName=Gf,on.disableRtx=l9,on.enableDtxForOpus=c9,on.filterLocalCodecs=a9,on.getMediaSections=Oi,on.removeSSRCAttributes=u9,on.revertSimulcast=o9,on.setCodecPreferences=t9,on.setSimulcast=r9;var f9=function(){function t(r){r=Object.assign({getKey:function(n){return n},getValue:function(n){return n},isLessThanOrEqualTo:function(n,i){return n<=i}},r),Object.defineProperties(this,{_getKey:{value:r.getKey},_getValue:{value:r.getValue},_isLessThanOrEqualTo:{value:r.isLessThanOrEqualTo},_map:{value:new Map}})}return t.prototype.toMap=function(){return new Map(this._map)},t.prototype.updateAndFilter=function(r){return r.filter(this.update,this)},t.prototype.update=function(r){var e=this._getKey(r),n=this._getValue(r);return this._map.has(e)&&this._isLessThanOrEqualTo(n,this._map.get(e))?!1:(this._map.set(e,n),!0)},t}(),d9=f9,p9=d9,v9=function(){function t(){Object.defineProperties(this,{_filter:{value:new p9({getKey:function(e){return e.ufrag},isLessThanOrEqualTo:function(e,n){return e.revision<=n.revision}})},_ufrag:{writable:!0,value:null},ufrag:{enumerable:!0,get:function(){return this._ufrag}}})}return t.prototype.setUfrag=function(r){this._ufrag=r;var e=this._filter.toMap().get(r);return e?e.candidates:[]},t.prototype.update=function(r){r.candidates=r.candidates||[];var e=this._filter.toMap().get(r.ufrag),n=e?e.candidates:[];return this._filter.update(r)&&this._ufrag===r.ufrag?r.candidates.slice(n.length):[]},t}(),h9=v9,BS=fr,m9=BS.ICE_ACTIVITY_CHECK_PERIOD_MS,g9=BS.ICE_INACTIVITY_THRESHOLD_MS,y9=function(){function t(r,e){e=Object.assign({activityCheckPeriodMs:m9,inactivityThresholdMs:g9},e),Object.defineProperties(this,{_activityCheckPeriodMs:{value:e.activityCheckPeriodMs},_inactivityThresholdMs:{value:e.inactivityThresholdMs},_lastActivity:{value:null,writable:!0},_peerConnection:{value:r},_timer:{value:null,writable:!0},_onIceConnectionStateChanged:{value:null,writable:!0}})}return t.prototype._getActivePairStat=function(r){var e=Array.from(r.values()),n=e.find(function(i){return i.type==="candidate-pair"&&i.nominated});return n||{bytesReceived:0,timestamp:Math.round(new Date().getTime())}},t.prototype._getIceConnectionStats=function(){var r=this;return this._peerConnection.getStats().then(function(e){return r._getActivePairStat(e)}).catch(function(){return null})},t.prototype._scheduleInactivityCallback=function(r){var e=this;r&&this._onIceConnectionStateChanged===null?(this._onIceConnectionStateChanged=function(){e._peerConnection.iceConnectionState==="disconnected"&&r()},this._peerConnection.addEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged)):!r&&this._onIceConnectionStateChanged&&(this._peerConnection.removeEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged),this._onIceConnectionStateChanged=null)},t.prototype.start=function(r){var e=this;this.stop(),this._timer=setInterval(function(){e._getIceConnectionStats().then(function(n){n&&((!e._lastActivity||e._lastActivity.bytesReceived!==n.bytesReceived)&&(e._lastActivity=n,e._scheduleInactivityCallback(null)),n.timestamp-e._lastActivity.timestamp>=e._inactivityThresholdMs&&(e._peerConnection.iceConnectionState==="disconnected"?r():e._onIceConnectionStateChanged===null&&e._scheduleInactivityCallback(r)))})},this._activityCheckPeriodMs)},t.prototype.stop=function(){this._scheduleInactivityCallback(null),this._timer!==null&&(clearInterval(this._timer),this._timer=null,this._lastActivity=null)},t}(),b9=y9,_9=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),w9=Wr.EventEmitter,k9=function(t){_9(r,t);function r(e){var n=t.call(this)||this;return Object.defineProperties(n,{_dataChannel:{value:e},_messageQueue:{value:[]}}),e.addEventListener("open",function(){n._messageQueue.splice(0).forEach(function(i){return n._publish(i)})}),e.addEventListener("message",function(i){var a=i.data;try{var o=JSON.parse(a);n.emit("message",o)}catch{}}),n.publish({type:"ready"}),n}return r.prototype._publish=function(e){var n=JSON.stringify(e);try{this._dataChannel.send(n)}catch{}},r.prototype.publish=function(e){var n=this._dataChannel;return n.readyState==="closing"||n.readyState==="closed"?!1:n.readyState==="connecting"?(this._messageQueue.push(e),!0):(this._publish(e),!0)},r}(w9),T9=k9,S9=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),E9=Nk,M9=T9,C9=function(t){S9(r,t);function r(e){var n=t.call(this,e.label,e.maxPacketLifeTime,e.maxRetransmits,e.ordered)||this;return Object.defineProperties(n,{_dataChannel:{value:e}}),e.binaryType="arraybuffer",e.addEventListener("message",function(i){n.emit("message",i.data)}),e.addEventListener("close",function(){n.emit("close")}),n}return r.prototype.stop=function(){this._dataChannel.close(),t.prototype.stop.call(this)},r.prototype.toDataTransport=function(){return new M9(this._dataChannel)},r}(E9),R9=C9,I9=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),O9=yk,N9=function(t){I9(r,t);function r(e,n){return t.call(this,e,n)||this}return r}(O9),A9=N9,P9=on.getMediaSections,x9=function(){function t(){Object.defineProperties(this,{_midsToTrackIds:{value:new Map,writable:!0}})}return t.prototype.match=function(r){return this._midsToTrackIds.get(r.transceiver.mid)||null},t.prototype.update=function(r){var e=P9(r,"(audio|video)");this._midsToTrackIds=e.reduce(function(n,i){var a=i.match(/^a=mid:(.+)$/m)||[],o=i.match(/^a=msid:.+ (.+)$/m)||[],s=a[1],u=o[1];return s&&u?n.set(s,u):n},this._midsToTrackIds)},t}(),D9=x9,L9=Io.RTCSessionDescription,ZS=on,U9=ZS.createPtToCodecName,j9=ZS.getMediaSections;function V9(t){var r={type:t.type};return t.type!=="rollback"&&(r.sdp=F9(t.sdp)),new L9(r)}function F9(t){var r=j9(t),e=t.split(`\r
m=`)[0];return[e].concat(r.map($9)).join(`\r
`)}function $9(t){var r=U9(t);t=z9(t,r);var e=W9(r),n=e.get("rtx")||new Set,i=new Set,a=B9(t,r,n,i),o=Z9(a,i),s=Array.from(i),u=["h264","vp8","vp9"],l=u.reduce(function(c,f){var d=e.get(f)||new Set;return Array.from(d).reduce(function(v,p){return o.has(p)?v:v.add(p)},c)},new Set);return l.forEach(function(c){if(s.length){var f=s.shift();t=qS(t,f),t=Q9(t,f,c)}}),s.forEach(function(c){t=qS(t,c),t=q9(t,c)}),t}function z9(t,r){return Array.from(r.keys()).reduce(function(e,n){var i=new RegExp("^a=rtpmap:"+n+" rtx.+$","gm");return(e.match(i)||[]).slice(r.get(n)==="rtx"?1:0).reduce(function(a,o){var s=new RegExp(`\r
`+o),u=new RegExp(`\r
a=fmtp:`+n+" apt=[0-9]+");return a.replace(s,"").replace(u,"")},e)},t)}function W9(t){var r=new Map;return t.forEach(function(e,n){var i=r.get(e)||new Set;return r.set(e,i.add(n))}),r}function B9(t,r,e,n){return Array.from(e).reduce(function(i,a){var o=new RegExp("a=fmtp:"+a+" apt=(\\d+)"),s=t.match(o);if(!s)return n.add(a),i;var u=Number.parseInt(s[1]);if(!r.has(u))return n.add(a),i;var l=r.get(u);return l==="rtx"?(n.add(a),i):i.set(a,u)},new Map)}function Z9(t,r){var e=Array.from(t).reduce(function(n,i){var a=i[0],o=i[1],s=n.get(o)||new Set;return n.set(o,s.add(a))},new Map);return Array.from(e).reduce(function(n,i){var a=i[0],o=Array.from(i[1]);return o.length>1?(o.forEach(function(s){r.add(s)}),n):n.set(a,o[0])},new Map)}function qS(t,r){var e=new RegExp("a=fmtp:"+r+`.*\r
`,"gm");return t.replace(e,"")}function q9(t,r){var e=new RegExp("a=rtpmap:"+r+`.*\r
`,"gm");return t.replace(e,"")}function Q9(t,r,e){return t.endsWith(`\r
`)?t+"a=fmtp:"+r+" apt="+e+`\r
`:t+`\r
a=fmtp:`+r+" apt="+e}var Y9=V9,G9=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),H9=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},J9=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},X9=jS,Jf=Io,K9=Jf.RTCIceCandidate,eB=Jf.RTCPeerConnection,tB=Jf.RTCSessionDescription,rB=Jf.getStats,QS=hr,Xf=fr,nB=Xf.DEFAULT_ICE_GATHERING_TIMEOUT_MS,iB=Xf.DEFAULT_LOG_LEVEL,aB=Xf.DEFAULT_SESSION_TIMEOUT_SEC,oB=Xf.iceRestartBackoffConfig,ci=on,sB=ci.addOrRewriteNewTrackIds,uB=ci.addOrRewriteTrackIds,YS=ci.createCodecMapForMediaSection,GS=ci.disableRtx,Kf=ci.enableDtxForOpus,lB=ci.filterLocalCodecs,hl=ci.getMediaSections,HS=ci.removeSSRCAttributes,cB=ci.revertSimulcast,fB=ci.setCodecPreferences,dB=ci.setSimulcast,pB=No,JS=lt,mm=JS.MediaClientLocalDescFailedError,gm=JS.MediaClientRemoteDescFailedError,ml=at,vB=ml.buildLogLevels,hB=ml.getPlatform,mB=ml.isChromeScreenShareTrack,gB=ml.oncePerTick,yB=ml.defer,bB=h9,_B=b9,wB=R9,kB=A9,TB=Ns,SB=na,EB=D9,XS=Y9,ym=QS.guessBrowser(),MB=hB(),CB=/android/.test(MB),RB=ym==="chrome",xo=ym==="firefox",IB=ym==="safari",OB=0,NB={open:["closed","updating"],updating:["closed","open"],closed:[]},AB=function(t){G9(r,t);function r(e,n,i,a){var o=t.call(this,"open",NB)||this;a=Object.assign({enableDscp:!1,dummyAudioMediaStreamTrack:null,isChromeScreenShareTrack:mB,iceServers:[],logLevel:iB,offerOptions:{},revertSimulcast:cB,sessionTimeout:aB*1e3,setCodecPreferences:fB,setSimulcast:dB,Backoff:X9,IceConnectionMonitor:_B,RTCIceCandidate:K9,RTCPeerConnection:eB,RTCSessionDescription:tB,Timeout:pB},a);var s=r2(a),u=vB(a.logLevel),l=a.RTCPeerConnection;a.enableDscp===!0&&(a.chromeSpecificConstraints=a.chromeSpecificConstraints||{},a.chromeSpecificConstraints.optional=a.chromeSpecificConstraints.optional||[],a.chromeSpecificConstraints.optional.push({googDscp:!0}));var c=a.log?a.log.createLog("webrtc",o):new SB("webrtc",o,u,a.loggerName),f=new l(s,a.chromeSpecificConstraints);a.dummyAudioMediaStreamTrack&&f.addTrack(a.dummyAudioMediaStreamTrack),Object.defineProperties(o,{_appliedTrackIdsToAttributes:{value:new Map,writable:!0},_dataChannels:{value:new Map},_dataTrackReceivers:{value:new Set},_descriptionRevision:{writable:!0,value:0},_didGenerateLocalCandidates:{writable:!0,value:!1},_enableDscp:{value:a.enableDscp},_encodingParameters:{value:n},_isChromeScreenShareTrack:{value:a.isChromeScreenShareTrack},_iceGatheringFailed:{value:!1,writable:!0},_iceGatheringTimeout:{value:new a.Timeout(function(){return o._handleIceGatheringTimeout()},nB,!1)},_iceRestartBackoff:{value:new a.Backoff(oB)},_instanceId:{value:++OB},_isIceConnectionInactive:{writable:!0,value:!1},_isIceLite:{writable:!0,value:!1},_isIceRestartBackoffInProgress:{writable:!0,value:!1},_isRestartingIce:{writable:!0,value:!1},_lastIceConnectionState:{writable:!0,value:null},_lastStableDescriptionRevision:{writable:!0,value:0},_localCandidates:{writable:!0,value:[]},_localCodecs:{value:new Set},_localCandidatesRevision:{writable:!0,value:1},_localDescriptionWithoutSimulcast:{writable:!0,value:null},_localDescription:{writable:!0,value:null},_localUfrag:{writable:!0,value:null},_log:{value:c},_eventObserver:{value:a.eventObserver},_remoteCodecMaps:{value:new Map},_rtpSenders:{value:new Map},_rtpNewSenders:{value:new Set},_iceConnectionMonitor:{value:new a.IceConnectionMonitor(f)},_mediaTrackReceivers:{value:new Set},_needsAnswer:{writable:!0,value:!1},_negotiationRole:{writable:!0,value:null},_offerOptions:{writable:!0,value:a.offerOptions},_onEncodingParametersChanged:{value:gB(function(){o._needsAnswer||i2(o)})},_peerConnection:{value:f},_preferredAudioCodecs:{value:i.audio},_preferredVideoCodecs:{value:i.video},_shouldApplyDtx:{value:i.audio.every(function(v){var p=v.codec;return p!=="opus"})||i.audio.some(function(v){var p=v.codec,y=v.dtx;return p==="opus"&&y})},_queuedDescription:{writable:!0,value:null},_iceReconnectTimeout:{value:new a.Timeout(function(){c.debug("ICE reconnect timed out"),o.close()},a.sessionTimeout,!1)},_recycledTransceivers:{value:{audio:[],video:[]}},_replaceTrackPromises:{value:new Map},_remoteCandidates:{writable:!0,value:new bB},_setCodecPreferences:{value:xo&&CB&&i.video[0]&&i.video[0].codec.toLowerCase()!=="h264"?function(v){return v}:a.setCodecPreferences},_setSimulcast:{value:a.setSimulcast},_revertSimulcast:{value:a.revertSimulcast},_RTCIceCandidate:{value:a.RTCIceCandidate},_RTCPeerConnection:{value:a.RTCPeerConnection},_RTCSessionDescription:{value:a.RTCSessionDescription},_shouldOffer:{writable:!0,value:!1},_shouldRestartIce:{writable:!0,value:!1},_trackIdsToAttributes:{value:new Map,writable:!0},_trackMatcher:{writable:!0,value:null},_mediaTrackSenderToPublisherHints:{value:new Map},id:{enumerable:!0,value:e}}),n.on("changed",o._onEncodingParametersChanged),f.addEventListener("connectionstatechange",o._handleConnectionStateChange.bind(o)),f.addEventListener("datachannel",o._handleDataChannelEvent.bind(o)),f.addEventListener("icecandidate",o._handleIceCandidateEvent.bind(o)),f.addEventListener("iceconnectionstatechange",o._handleIceConnectionStateChange.bind(o)),f.addEventListener("icegatheringstatechange",o._handleIceGatheringStateChange.bind(o)),f.addEventListener("signalingstatechange",o._handleSignalingStateChange.bind(o)),f.addEventListener("track",o._handleTrackEvent.bind(o));var d=o;return o.on("stateChanged",function v(p){p==="closed"&&(d.removeListener("stateChanged",v),d._dataChannels.forEach(function(y,k){d.removeDataTrackSender(k)}))}),o}return r.prototype.toString=function(){return"[PeerConnectionV2 #"+this._instanceId+": "+this.id+"]"},r.prototype.setEffectiveAdaptiveSimulcast=function(e){this._log.debug("Setting setEffectiveAdaptiveSimulcast: ",e),this._preferredVideoCodecs.forEach(function(n){"adaptiveSimulcast"in n&&(n.adaptiveSimulcast=e)})},Object.defineProperty(r.prototype,"_shouldApplySimulcast",{get:function(){if(!RB&&!IB)return!1;var e=this._preferredVideoCodecs.some(function(n){return n.codec.toLowerCase()==="vp8"&&n.simulcast&&n.adaptiveSimulcast!==!1});return e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"connectionState",{get:function(){return this.iceConnectionState==="failed"?"failed":this._peerConnection.connectionState||this.iceConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"iceConnectionState",{get:function(){return this._isIceConnectionInactive&&this._peerConnection.iceConnectionState==="disconnected"||this._iceGatheringFailed?"failed":this._peerConnection.iceConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isApplicationSectionNegotiated",{get:function(){return this._peerConnection.signalingState!=="closed"?this._peerConnection.localDescription?hl(this._peerConnection.localDescription.sdp,"application").length>0:!1:!0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_isAdaptiveSimulcastEnabled",{get:function(){var e=this._preferredVideoCodecs.find(function(n){return"adaptiveSimulcast"in n});return e&&e.adaptiveSimulcast===!0},enumerable:!1,configurable:!0}),r.prototype._maybeUpdateEncodings=function(e,n,i){if(i===void 0&&(i=!1),e.kind!=="video"||e.readyState==="ended")return!1;var a=e.getSettings(),o=a.height,s=a.width;if(typeof o!="number"||typeof s!="number")return!1;var u=QS.guessBrowser();return u==="safari"||u==="chrome"&&this._isAdaptiveSimulcastEnabled?(this._updateEncodings(e,n,i),!0):!1},r.prototype._updateEncodings=function(e,n,i){if(this._isChromeScreenShareTrack(e)){var a=[{scaleResolutionDownBy:1},{scaleResolutionDownBy:1}];n.forEach(function(v,p){var y=a[p];y?(v.scaleResolutionDownBy=y.scaleResolutionDownBy,i&&delete v.active):(v.active=!1,delete v.scaleResolutionDownBy)})}else{var o=e.getSettings(),s=o.width,u=o.height,l=[{pixels:960*540,maxActiveLayers:3},{pixels:480*270,maxActiveLayers:2},{pixels:0,maxActiveLayers:1}],c=s*u,f=l.find(function(v){return c>=v.pixels}),d=Math.min(n.length,f.maxActiveLayers);n.forEach(function(v,p){var y=p<d;y?(v.scaleResolutionDownBy=1<<d-p-1,i&&(v.active=!0)):(v.active=!1,delete v.scaleResolutionDownBy)})}this._log.debug("_updateEncodings:",n.map(function(v,p){var y=v.active,k=v.scaleResolutionDownBy;return"["+p+": "+y+", "+(k||0)+"]"}).join(", "))},r.prototype._addIceCandidate=function(e){var n=this;return Promise.resolve().then(function(){return e=new n._RTCIceCandidate(e),n._peerConnection.addIceCandidate(e)}).catch(function(i){n._log.warn("Failed to add RTCIceCandidate "+(e?'"'+e.candidate+'"':"null")+": "+i.message)})},r.prototype._addIceCandidates=function(e){return Promise.all(e.map(this._addIceCandidate,this)).then(function(){})},r.prototype._addOrUpdateTransceiver=function(e){var n=this,i=UB(this,e.kind);if(i&&i.sender){var a=i.sender.track?i.sender.track.id:null;return a&&this._log.warn("Reusing transceiver: "+i.mid+"] "+a+" => "+e.id),this._replaceTrackPromises.set(i,i.sender.replaceTrack(e).then(function(){i.direction="sendrecv"},function(){}).finally(function(){n._replaceTrackPromises.delete(i)})),i}return this._peerConnection.addTransceiver(e)},r.prototype._checkIceBox=function(e){var n=t2(e);if(!n)return Promise.resolve();var i=this._remoteCandidates.setUfrag(n);return this._addIceCandidates(i)},r.prototype._answer=function(e){var n=this;return Promise.resolve().then(function(){return n._negotiationRole||(n._negotiationRole="answerer"),n._setRemoteDescription(e)}).catch(function(){throw new gm}).then(function(){return n._peerConnection.createAnswer()}).then(function(i){xo?i=new n._RTCSessionDescription({sdp:GS(i.sdp),type:i.type}):i=XS(i);var a=HS(i.sdp,["mslabel","label"]);if(n._shouldApplySimulcast){var o=a;a=n._setSimulcast(o,n._trackIdsToAttributes),a=n._revertSimulcast(a,o,e.sdp)}return a=a.replace(/42e015/g,"42e01f"),n._setLocalDescription({type:i.type,sdp:a})}).then(function(){return n._checkIceBox(e)}).then(function(){return n._queuedDescription&&n._updateDescription(n._queuedDescription)}).then(function(){return n._queuedDescription=null,n._maybeReoffer(n._peerConnection.localDescription)}).catch(function(i){var a=i instanceof gm?i:new mm;throw n._publishMediaWarning({message:"Failed to _answer",code:a.code,error:i}),a})},r.prototype._close=function(){return this._iceConnectionMonitor.stop(),this._peerConnection.signalingState!=="closed"?(this._peerConnection.close(),this.preempt("closed"),this._encodingParameters.removeListener("changed",this._onEncodingParametersChanged),!0):!1},r.prototype._handleConnectionStateChange=function(){this.emit("connectionStateChanged")},r.prototype._handleDataChannelEvent=function(e){var n=this,i=e.channel,a=new wB(i);this._dataTrackReceivers.add(a),i.addEventListener("close",function(){n._dataTrackReceivers.delete(a)}),this.emit("trackAdded",a)},r.prototype._handleGlare=function(e){var n=this;return this._log.debug("Glare detected; rolling back"),this._isRestartingIce&&(this._log.debug("An ICE restart was in progress; we'll need to restart ICE again after rolling back"),this._isRestartingIce=!1,this._shouldRestartIce=!0),Promise.resolve().then(function(){return n._trackIdsToAttributes=new Map(n._appliedTrackIdsToAttributes),n._setLocalDescription({type:"rollback"})}).then(function(){return n._needsAnswer=!1,n._answer(e)}).then(function(i){return i?Promise.resolve():n._offer()})},r.prototype._publishMediaWarning=function(e){var n=e.message,i=e.code,a=e.error,o=e.sdp;this._eventObserver.emit("event",{level:"warning",name:"error",group:"media",payload:{message:n,code:i,context:JSON.stringify({error:a.message,sdp:o})}})},r.prototype._handleIceCandidateEvent=function(e){e.candidate&&(this._log.debug("Clearing ICE gathering timeout"),this._didGenerateLocalCandidates=!0,this._iceGatheringTimeout.clear(),this._localCandidates.push(e.candidate));var n={ice:{candidates:this._isIceLite?[]:this._localCandidates.slice(),ufrag:this._localUfrag},id:this.id};e.candidate||(n.ice.complete=!0),this._isIceLite&&e.candidate||(n.ice.revision=this._localCandidatesRevision++,this.emit("candidates",n))},r.prototype._handleIceConnectionStateChange=function(){var e=this,n=this._peerConnection.iceConnectionState,i=["connected","completed"].includes(n),a=this._log;a.debug('ICE connection state is "'+n+'"'),i&&(this._iceReconnectTimeout.clear(),this._iceRestartBackoff.reset()),this._lastIceConnectionState!=="failed"&&n==="failed"&&!this._shouldRestartIce&&!this._isRestartingIce?(a.warn("ICE failed"),this._initiateIceRestartBackoff()):["disconnected","failed"].includes(this._lastIceConnectionState)&&i&&a.debug("ICE reconnected"),n==="connected"?(this._isIceConnectionInactive=!1,this._iceConnectionMonitor.start(function(){e._iceConnectionMonitor.stop(),!e._shouldRestartIce&&!e._isRestartingIce&&(a.warn("ICE Connection Monitor detected inactivity"),e._isIceConnectionInactive=!0,e._initiateIceRestartBackoff(),e.emit("iceConnectionStateChanged"),e.emit("connectionStateChanged"))})):["disconnected","completed"].includes(n)||(this._iceConnectionMonitor.stop(),this._isIceConnectionInactive=!1),this._lastIceConnectionState=n,this.emit("iceConnectionStateChanged")},r.prototype._handleIceGatheringTimeout=function(){this._log.warn("ICE failed to gather any local candidates"),this._iceGatheringFailed=!0,this._initiateIceRestartBackoff(),this.emit("iceConnectionStateChanged"),this.emit("connectionStateChanged")},r.prototype._handleIceGatheringStateChange=function(){var e=this._peerConnection.iceGatheringState,n=this._log;n.debug('ICE gathering state is "'+e+'"');var i=this._iceGatheringTimeout,a=i.delay,o=i.isSet;e==="gathering"&&!this._didGenerateLocalCandidates&&!o&&(n.debug("Starting ICE gathering timeout: "+a),this._iceGatheringFailed=!1,this._iceGatheringTimeout.start())},r.prototype._handleSignalingStateChange=function(){this._peerConnection.signalingState==="stable"&&(this._appliedTrackIdsToAttributes=new Map(this._trackIdsToAttributes))},r.prototype._handleTrackEvent=function(e){var n=this,i=this._peerConnection.remoteDescription?this._peerConnection.remoteDescription.sdp:null;this._trackMatcher=this._trackMatcher||new EB,this._trackMatcher.update(i);var a=e.track,o=this._trackMatcher.match(e)||a.id,s=new kB(o,a);this._mediaTrackReceivers.forEach(function(u){u.track.id===s.track.id&&n._mediaTrackReceivers.delete(u)}),this._mediaTrackReceivers.add(s),a.addEventListener("ended",function(){return n._mediaTrackReceivers.delete(s)}),this.emit("trackAdded",s)},r.prototype._initiateIceRestart=function(){if(this._peerConnection.signalingState!=="closed"){var e=this._log;e.warn("Attempting to restart ICE"),this._didGenerateLocalCandidates=!1,this._isIceRestartBackoffInProgress=!1,this._shouldRestartIce=!0;var n=this._iceReconnectTimeout,i=n.delay,a=n.isSet;a||(e.debug("Starting ICE reconnect timeout: "+i),this._iceReconnectTimeout.start()),this.offer().catch(function(o){e.error("offer failed in _initiateIceRestart with: "+o.message)})}},r.prototype._initiateIceRestartBackoff=function(){var e=this;this._peerConnection.signalingState==="closed"||this._isIceRestartBackoffInProgress||(this._log.warn("An ICE restart has been scheduled"),this._isIceRestartBackoffInProgress=!0,this._iceRestartBackoff.backoff(function(){return e._initiateIceRestart()}))},r.prototype._maybeReoffer=function(e){var n=this._shouldOffer;if(e&&e.sdp){var i=this._peerConnection.getSenders().filter(function(l){return l.track});n=["audio","video"].reduce(function(l,c){var f=hl(e.sdp,c,"(sendrecv|sendonly)"),d=i.filter(xB.bind(null,c));return l||f.length<d.length},n);var a=this._dataChannels.size>0,o=hl(e.sdp,"application").length>0,s=a&&!o;n=n||s}var u=n?this._offer():Promise.resolve();return u.then(function(){return n})},r.prototype._offer=function(){var e=this,n=Object.assign({},this._offerOptions);return this._needsAnswer=!0,this._shouldRestartIce&&(this._shouldRestartIce=!1,this._isRestartingIce=!0,n.iceRestart=!0),Promise.all(this._replaceTrackPromises.values()).then(function(){return e._peerConnection.createOffer(n)}).catch(function(i){var a=new mm;throw e._publishMediaWarning({message:"Failed to create offer",code:a.code,error:i}),a}).then(function(i){xo?i=new e._RTCSessionDescription({sdp:GS(i.sdp),type:i.type}):i=XS(i);var a=HS(i.sdp,["mslabel","label"]);a=e._peerConnection.remoteDescription?lB(a,e._peerConnection.remoteDescription.sdp):a;var o=e._setCodecPreferences(a,e._preferredAudioCodecs,e._preferredVideoCodecs);return e._shouldOffer=!1,e._negotiationRole||(e._negotiationRole="offerer"),e._shouldApplySimulcast&&(e._localDescriptionWithoutSimulcast={type:"offer",sdp:o},o=e._setSimulcast(o,e._trackIdsToAttributes)),e._setLocalDescription({type:"offer",sdp:o})})},r.prototype._getMediaTrackSenderId=function(e){var n=Array.from(this._rtpSenders.keys()).find(function(i){var a=i.track.id;return a===e});return n?n.id:e},r.prototype._addOrRewriteLocalTrackIds=function(e){var n=this,i=this._peerConnection.getTransceivers(),a=i.filter(function(d){var v=d.sender,p=d.stopped;return!p&&v&&v.track}),o=a.filter(function(d){var v=d.mid;return v}),s=new Map(o.map(function(d){var v=d.mid,p=d.sender;return[v,n._getMediaTrackSenderId(p.track.id)]})),u=uB(e.sdp,s),l=a.filter(function(d){var v=d.mid;return!v}),c=new Map(["audio","video"].map(function(d){return[d,l.filter(function(v){var p=v.sender;return p.track.kind===d}).map(function(v){var p=v.sender;return n._getMediaTrackSenderId(p.track.id)})]})),f=sB(u,s,c);return new this._RTCSessionDescription({sdp:f,type:e.type})},r.prototype._rollbackAndApplyOffer=function(e){var n=this;return this._setLocalDescription({type:"rollback"}).then(function(){return n._setLocalDescription(e)})},r.prototype._setLocalDescription=function(e){var n=this;return e.type!=="rollback"&&this._shouldApplyDtx&&(e=new this._RTCSessionDescription({sdp:Kf(e.sdp),type:e.type})),this._peerConnection.setLocalDescription(e).catch(function(i){n._log.warn('Calling setLocalDescription with an RTCSessionDescription of type "'+e.type+'" failed with the error "'+i.message+'".',i);var a=new mm,o={message:'Calling setLocalDescription with an RTCSessionDescription of type "'+e.type+'" failed',code:a.code,error:i};throw e.sdp&&(n._log.warn("The SDP was "+e.sdp),o.sdp=e.sdp),n._publishMediaWarning(o),a}).then(function(){e.type!=="rollback"&&(n._localDescription=n._addOrRewriteLocalTrackIds(e),n._shouldApplyDtx&&(n._localDescription=new n._RTCSessionDescription({sdp:Kf(n._localDescription.sdp,[]),type:n._localDescription.type})),n._localCandidates=[],e.type==="offer"?n._descriptionRevision++:e.type==="answer"&&(n._lastStableDescriptionRevision=n._descriptionRevision,n2(n)),n._localUfrag=t2(e),n.emit("description",n.getState()))})},r.prototype._setRemoteDescription=function(e){var n=this;return e.sdp&&(e.sdp=this._setCodecPreferences(e.sdp,this._preferredAudioCodecs,this._preferredVideoCodecs),this._shouldApplyDtx?e.sdp=Kf(e.sdp):e.sdp=Kf(e.sdp,[]),xo&&(e.sdp=DB(e.sdp)),this._peerConnection.remoteDescription||(this._isIceLite=/a=ice-lite/.test(e.sdp))),e=new this._RTCSessionDescription(e),Promise.resolve().then(function(){if(e.type==="answer"&&n._localDescriptionWithoutSimulcast){var i=n._preferredVideoCodecs.find(function(s){return"adaptiveSimulcast"in s}),a=!!i&&i.adaptiveSimulcast===!1,o=n._revertSimulcast(n._localDescription.sdp,n._localDescriptionWithoutSimulcast.sdp,e.sdp,a);if(n._localDescriptionWithoutSimulcast=null,o!==n._localDescription.sdp)return n._rollbackAndApplyOffer({type:n._localDescription.type,sdp:o})}}).then(function(){return n._peerConnection.setRemoteDescription(e)}).then(function(){e.type==="answer"&&(n._isRestartingIce&&(n._log.debug("An ICE restart was in-progress and is now completed"),n._isRestartingIce=!1),n2(n))},function(i){throw n._log.warn('Calling setRemoteDescription with an RTCSessionDescription of type "'+e.type+'" failed with the error "'+i.message+'".',i),e.sdp&&n._log.warn("The SDP was "+e.sdp),i})},r.prototype._updateDescription=function(e){var n=this;switch(e.type){case"answer":case"pranswer":if(e.revision!==this._descriptionRevision||this._peerConnection.signalingState!=="have-local-offer")return Promise.resolve();this._descriptionRevision=e.revision;break;case"close":return this._close();case"create-offer":return e.revision<=this._lastStableDescriptionRevision?Promise.resolve():this._needsAnswer?(this._queuedDescription=e,Promise.resolve()):(this._descriptionRevision=e.revision,this._offer());case"offer":return e.revision<=this._lastStableDescriptionRevision||this._peerConnection.signalingState==="closed"?Promise.resolve():this._peerConnection.signalingState==="have-local-offer"?this._needsAnswer&&this._lastStableDescriptionRevision===0?(this._queuedDescription=e,Promise.resolve()):(this._descriptionRevision=e.revision,this._handleGlare(e)):(this._descriptionRevision=e.revision,this._answer(e).then(function(){}))}var i=e.revision;return Promise.resolve().then(function(){return n._setRemoteDescription(e)}).catch(function(a){var o=new gm;throw n._publishMediaWarning({message:'Calling setRemoteDescription with an RTCSessionDescription of type "'+e.type+'" failed',code:o.code,error:a,sdp:e.sdp}),o}).then(function(){return n._lastStableDescriptionRevision=i,n._needsAnswer=!1,n._checkIceBox(e)}).then(function(){return n._queuedDescription&&n._updateDescription(n._queuedDescription)}).then(function(){return n._queuedDescription=null,n._maybeReoffer(n._peerConnection.localDescription).then(function(){})})},r.prototype._updateIce=function(e){var n=this._remoteCandidates.update(e);return this._addIceCandidates(n)},r.prototype.addDataTrackSender=function(e){if(!this._dataChannels.has(e))try{var n={ordered:e.ordered};e.maxPacketLifeTime!==null&&(n.maxPacketLifeTime=e.maxPacketLifeTime),e.maxRetransmits!==null&&(n.maxRetransmits=e.maxRetransmits);var i=this._peerConnection.createDataChannel(e.id,n);e.addDataChannel(i),this._dataChannels.set(e,i)}catch(a){this._log.warn('Error creating an RTCDataChannel for DataTrack "'+e.id+'": '+a.message)}},r.prototype._handleQueuedPublisherHints=function(){var e=this;this._peerConnection.signalingState==="stable"&&this._mediaTrackSenderToPublisherHints.forEach(function(n,i){var a=n.deferred,o=n.encodings;e._mediaTrackSenderToPublisherHints.delete(i),e._setPublisherHint(i,o).then(function(s){return a.resolve(s)}).catch(function(s){return a.reject(s)})})},r.prototype._setPublisherHint=function(e,n){var i=this;if(xo)return Promise.resolve("COULD_NOT_APPLY_HINT");if(this._mediaTrackSenderToPublisherHints.has(e)){var a=this._mediaTrackSenderToPublisherHints.get(e);a.deferred.resolve("REQUEST_SKIPPED"),this._mediaTrackSenderToPublisherHints.delete(e)}var o=this._rtpSenders.get(e);if(!o)return this._log.warn("Could not apply publisher hint because RTCRtpSender was not found"),Promise.resolve("UNKNOWN_TRACK");if(this._peerConnection.signalingState==="closed")return this._log.warn('Could not apply publisher hint because signalingState was "closed"'),Promise.resolve("COULD_NOT_APPLY_HINT");if(this._peerConnection.signalingState!=="stable"){this._log.debug("Queuing up publisher hint because signalingState:",this._peerConnection.signalingState);var s=yB();return this._mediaTrackSenderToPublisherHints.set(e,{deferred:s,encodings:n}),s.promise}var u=o.getParameters();return n!==null&&n.forEach(function(l){var c=l.enabled,f=l.layer_index;u.encodings.length>f?(i._log.debug("layer:"+f+", active:"+u.encodings[f].active+" => "+c),u.encodings[f].active=c):i._log.warn("invalid layer:"+f+", active:"+c)}),this._maybeUpdateEncodings(o.track,u.encodings,n===null),o.setParameters(u).then(function(){return"OK"}).catch(function(l){return i._log.error("Failed to apply publisher hints:",l),"COULD_NOT_APPLY_HINT"})},r.prototype.addMediaTrackSender=function(e){var n=this;if(!(this._peerConnection.signalingState==="closed"||this._rtpSenders.has(e))){var i=this._addOrUpdateTransceiver(e.track),a=i.sender;e.addSender(a,function(o){return n._setPublisherHint(e,o)}),this._rtpNewSenders.add(a),this._rtpSenders.set(e,a)}},r.prototype.close=function(){this._close()&&(this._descriptionRevision++,this._localDescription={type:"close"},this.emit("description",this.getState()))},r.prototype.getTrackReceivers=function(){return Array.from(this._dataTrackReceivers).concat(Array.from(this._mediaTrackReceivers))},r.prototype.getState=function(){if(!this._localDescription)return null;var e=this._localDescription.type==="answer"?this._lastStableDescriptionRevision:this._descriptionRevision,n={type:this._localDescription.type,revision:e};return this._localDescription.sdp&&(n.sdp=this._localDescription.sdp),{description:n,id:this.id}},r.prototype.offer=function(){var e=this;return this._needsAnswer||this._isRestartingIce?(this._shouldOffer=!0,Promise.resolve()):this.bracket("offering",function(n){e.transition("updating",n);var i=e._needsAnswer||e._isRestartingIce?Promise.resolve():e._offer();return i.then(function(){e.tryTransition("open",n)},function(a){throw e.tryTransition("open",n),a})})},r.prototype.removeDataTrackSender=function(e){var n=this._dataChannels.get(e);n&&(e.removeDataChannel(n),this._dataChannels.delete(e),n.close())},r.prototype.removeMediaTrackSender=function(e){var n=this._rtpSenders.get(e);if(n){if(this._peerConnection.signalingState!=="closed"&&this._peerConnection.removeTrack(n),e.removeSender(n),this._mediaTrackSenderToPublisherHints.has(e)){var i=this._mediaTrackSenderToPublisherHints.get(e);i.deferred.resolve("UNKNOWN_TRACK"),this._mediaTrackSenderToPublisherHints.delete(e)}this._rtpNewSenders.delete(n),this._rtpSenders.delete(e)}},r.prototype.setConfiguration=function(e){typeof this._peerConnection.setConfiguration=="function"&&this._peerConnection.setConfiguration(r2(e))},r.prototype.setIceReconnectTimeout=function(e){return this._iceReconnectTimeout.setDelay(e),this._log.debug("Updated ICE reconnection timeout period:",this._iceReconnectTimeout.delay),this},r.prototype.update=function(e){var n=this;return this.bracket("updating",function(i){if(n.state==="closed")return Promise.resolve();n.transition("updating",i);var a=[];return e.ice&&a.push(n._updateIce(e.ice)),e.description&&a.push(n._updateDescription(e.description)),Promise.all(a).then(function(){n.tryTransition("open",i)},function(o){throw n.tryTransition("open",i),o})})},r.prototype.getStats=function(){var e=this;return rB(this._peerConnection).then(function(n){return PB(e,n)})},r}(TB);function KS(t,r){var e=t._getMediaTrackSenderId(r.trackId);return Object.assign(r,{trackId:e})}function e2(t,r){var e=J9([],H9(t._mediaTrackReceivers)).find(function(i){return i.track.id===r.trackId}),n=e?e.id:null;return Object.assign(r,{trackId:n})}function PB(t,r){return Object.assign(r,{remoteAudioTrackStats:r.remoteAudioTrackStats.map(function(e){return e2(t,e)}),remoteVideoTrackStats:r.remoteVideoTrackStats.map(function(e){return e2(t,e)}),localAudioTrackStats:r.localAudioTrackStats.map(function(e){return KS(t,e)}),localVideoTrackStats:r.localVideoTrackStats.map(function(e){return KS(t,e)})})}function t2(t){if(t.sdp){var r=t.sdp.match(/^a=ice-ufrag:([a-zA-Z0-9+/]+)/m);if(r)return r[1]}return null}function r2(t){return Object.assign({bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},t)}function xB(t,r){var e=r.track;return e&&e.kind===t&&e.readyState!=="ended"}function DB(t){return t.replace(/a=msid:[^ ]+ /g,"a=msid:- ")}function LB(t,r){return!t.stopped&&!r._replaceTrackPromises.has(t)&&["inactive","recvonly"].includes(t.direction)}function UB(t,r){var e={audio:t._preferredAudioCodecs.map(function(o){var s=o.codec;return s.toLowerCase()}),video:t._preferredVideoCodecs.map(function(o){var s=o.codec;return s.toLowerCase()})}[r],n=t._recycledTransceivers[r],i=e.find(function(o){return t._localCodecs.has(o)});if(!i)return n.shift();var a=n.find(function(o){var s=t._remoteCodecMaps.get(o.mid);return s&&s.has(i)});return a&&n.splice(n.indexOf(a),1),a}function jB(t){var r=t._peerConnection.localDescription;!r||!r.sdp||hl(r.sdp).forEach(function(e){var n=YS(e);n.forEach(function(i,a){return t._localCodecs.add(a)})})}function VB(t){var r=t._peerConnection.remoteDescription;!r||!r.sdp||hl(r.sdp).forEach(function(e){var n=e.match(/^a=mid:(.+)$/m);if(!(!n||!n[1])){var i=n[1],a=YS(e);t._remoteCodecMaps.set(i,a)}})}function FB(t){t._recycledTransceivers.audio=[],t._recycledTransceivers.video=[],t._peerConnection.getTransceivers().forEach(function(r){if(LB(r,t)){var e=r.receiver.track;t._recycledTransceivers[e.kind].push(r)}})}function n2(t){FB(t),jB(t),VB(t),i2(t).then(function(){t._handleQueuedPublisherHints()})}function i2(t){var r=t._encodingParameters,e=r.maxAudioBitrate,n=r.maxVideoBitrate,i=new Map([["audio",e],["video",n]]),a=[];return t._peerConnection.getSenders().filter(function(o){return o.track}).forEach(function(o){var s=i.get(o.track.kind),u=o.getParameters();s===null||s===0?$B(u):t._isChromeScreenShareTrack(o.track)?t._log.warn("Not setting maxBitrate for "+o.track.kind+" Track "+o.track.id+" because it appears to be screen share track: "+o.track.label):zB(u,s),!xo&&u.encodings.length>0&&(o.track.kind==="audio"?u.encodings[0].priority="high":t._isChromeScreenShareTrack(o.track)&&(u.encodings[0].priority="medium"),t._enableDscp&&(u.encodings[0].networkPriority="high"));var l=t._rtpNewSenders.has(o);t._maybeUpdateEncodings(o.track,u.encodings,l),t._rtpNewSenders.delete(o);var c=o.setParameters(u).catch(function(f){t._log.warn("Error while setting encodings parameters for "+o.track.kind+" Track "+o.track.id+": "+(f.message||f.name))});a.push(c)}),Promise.all(a)}function $B(t){Array.isArray(t.encodings)&&t.encodings.forEach(function(r){return delete r.maxBitrate})}function zB(t,r){xo?t.encodings=[{maxBitrate:r}]:t.encodings.forEach(function(e){e.maxBitrate=r})}var WB=AB,BB=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),a2=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},o2=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},ZB=hr.guessBrowser,qB=WB,QB=bk,YB=mk,qa=at,GB=lt.MediaConnectionError,HB=ZB()==="firefox",JB=function(t){BB(r,t);function r(e,n,i){var a=t.call(this)||this;i=Object.assign({audioContextFactory:HB?Af():null,PeerConnectionV2:qB},i);var o=i.audioContextFactory?i.audioContextFactory.getOrCreate(a):null,s=o?{offerToReceiveVideo:!0}:{offerToReceiveAudio:!0,offerToReceiveVideo:!0};return Object.defineProperties(a,{_audioContextFactory:{value:i.audioContextFactory},_closedPeerConnectionIds:{value:new Set},_configuration:{writable:!0,value:null},_configurationDeferred:{writable:!0,value:qa.defer()},_connectionState:{value:"new",writable:!0},_dummyAudioTrackSender:{value:o?new QB(XB(o)):null},_encodingParameters:{value:e},_iceConnectionState:{writable:!0,value:"new"},_dataTrackSenders:{writable:!0,value:new Set},_lastConnectionState:{value:"new",writable:!0},_lastIceConnectionState:{writable:!0,value:"new"},_mediaTrackSenders:{writable:!0,value:new Set},_offerOptions:{value:s},_peerConnections:{value:new Map},_preferredCodecs:{value:n},_sessionTimeout:{value:null,writable:!0},_PeerConnectionV2:{value:i.PeerConnectionV2}}),a}return r.prototype.setEffectiveAdaptiveSimulcast=function(e){this._peerConnections.forEach(function(n){return n.setEffectiveAdaptiveSimulcast(e)}),this._preferredCodecs.video.forEach(function(n){"adaptiveSimulcast"in n&&(n.adaptiveSimulcast=e)})},Object.defineProperty(r.prototype,"connectionState",{get:function(){return this._connectionState},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"iceConnectionState",{get:function(){return this._iceConnectionState},enumerable:!1,configurable:!0}),r.prototype._closeAbsentPeerConnections=function(e){var n=new Set(e.map(function(i){return i.id}));return this._peerConnections.forEach(function(i){n.has(i.id)||i._close()}),this},r.prototype._getConfiguration=function(){return this._configurationDeferred.promise},r.prototype._getOrCreate=function(e,n){var i=this,a=this,o=this._peerConnections.get(e);if(!o){var s=this._PeerConnectionV2,u=Object.assign({dummyAudioMediaStreamTrack:this._dummyAudioTrackSender?this._dummyAudioTrackSender.track:null,offerOptions:this._offerOptions},this._sessionTimeout?{sessionTimeout:this._sessionTimeout}:{},n);try{o=new s(e,this._encodingParameters,this._preferredCodecs,u)}catch{throw new GB}this._peerConnections.set(o.id,o),o.on("candidates",this.queue.bind(this,"candidates")),o.on("description",this.queue.bind(this,"description")),o.on("trackAdded",this.queue.bind(this,"trackAdded")),o.on("stateChanged",function l(c){c==="closed"&&(o.removeListener("stateChanged",l),a._dataTrackSenders.forEach(function(f){return o.removeDataTrackSender(f)}),a._mediaTrackSenders.forEach(function(f){return o.removeMediaTrackSender(f)}),a._peerConnections.delete(o.id),a._closedPeerConnectionIds.add(o.id),u2(a),td(a))}),o.on("connectionStateChanged",function(){return u2(i)}),o.on("iceConnectionStateChanged",function(){return td(i)}),this._dataTrackSenders.forEach(o.addDataTrackSender,o),this._mediaTrackSenders.forEach(o.addMediaTrackSender,o),td(this)}return o},r.prototype.close=function(){return this._peerConnections.forEach(function(e){e.close()}),this._dummyAudioTrackSender&&this._dummyAudioTrackSender.stop(),this._audioContextFactory&&this._audioContextFactory.release(this),td(this),this},r.prototype.createAndOffer=function(){var e=this;return this._getConfiguration().then(function(n){var i;do i=qa.makeUUID();while(e._peerConnections.has(i));return e._getOrCreate(i,n)}).then(function(n){return n.offer()}).then(function(){return e})},r.prototype.getTrackReceivers=function(){return qa.flatMap(this._peerConnections,function(e){return e.getTrackReceivers()})},r.prototype.getStates=function(){var e=[];return this._peerConnections.forEach(function(n){var i=n.getState();i&&e.push(i)}),e},r.prototype.setConfiguration=function(e){return this._configuration&&(this._configurationDeferred=qa.defer(),this._peerConnections.forEach(function(n){n.setConfiguration(e)})),this._configuration=e,this._configurationDeferred.resolve(e),this},r.prototype.setIceReconnectTimeout=function(e){return this._sessionTimeout===null&&(this._peerConnections.forEach(function(n){n.setIceReconnectTimeout(e)}),this._sessionTimeout=e),this},r.prototype.setTrackSenders=function(e){var n=new Set(e.filter(function(o){return o.kind==="data"})),i=new Set(e.filter(function(o){return o&&(o.kind==="audio"||o.kind==="video")})),a=tZ(this,n,i);return this._dataTrackSenders=n,this._mediaTrackSenders=i,KB(this,a),this},r.prototype.update=function(e,n){var i=this;return n===void 0&&(n=!1),n&&this._closeAbsentPeerConnections(e),this._getConfiguration().then(function(a){return Promise.all(e.map(function(o){if(i._closedPeerConnectionIds.has(o.id))return null;var s=i._getOrCreate(o.id,a);return s.update(o)}))}).then(function(){return i})},r.prototype.getStats=function(){var e=Array.from(this._peerConnections.values());return Promise.all(e.map(function(n){return n.getStats().then(function(i){return[n.id,i]})})).then(function(n){return new Map(n)})},r}(YB);function XB(t){var r=t.createMediaStreamDestination();return r.stream.getAudioTracks()[0]}function KB(t,r){(r.data.add.size||r.data.remove.size||r.media.add.size||r.media.remove.size)&&t._peerConnections.forEach(function(e){r.data.remove.forEach(e.removeDataTrackSender,e),r.media.remove.forEach(e.removeMediaTrackSender,e),r.data.add.forEach(e.addDataTrackSender,e),r.media.add.forEach(e.addMediaTrackSender,e),(r.media.add.size||r.media.remove.size||r.data.add.size&&!e.isApplicationSectionNegotiated)&&e.offer()})}function eZ(t,r){var e=qa.difference(r,t._dataTrackSenders),n=qa.difference(t._dataTrackSenders,r);return{add:e,remove:n}}function tZ(t,r,e){return{data:eZ(t,r),media:rZ(t,e)}}function rZ(t,r){var e=qa.difference(r,t._mediaTrackSenders),n=qa.difference(t._mediaTrackSenders,r);return{add:e,remove:n}}var ed={new:0,checking:1,connecting:2,connected:3,completed:4,disconnected:-1,failed:-2,closed:-3},bm;function nZ(){return Object.keys(ed).reduce(function(t,r){var e;return Object.assign(t,(e={},e[ed[r]]=r,e))},{})}function s2(t){return t.length?(bm=bm||nZ(),t.reduce(function(r,e){return bm[Math.max(ed[r],ed[e])]})):"new"}function td(t){t._lastIceConnectionState=t.iceConnectionState,t._iceConnectionState=s2(o2([],a2(t._peerConnections.values())).map(function(r){return r.iceConnectionState})),t.iceConnectionState!==t._lastIceConnectionState&&t.emit("iceConnectionStateChanged")}function u2(t){t._lastConnectionState=t.connectionState,t._connectionState=s2(o2([],a2(t._peerConnections.values())).map(function(r){return r.connectionState})),t.connectionState!==t._lastConnectionState&&t.emit("connectionStateChanged")}var iZ=JB,aZ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),oZ=Wr,sZ=0,uZ=function(t){aZ(r,t);function r(e,n,i){var a=t.call(this)||this;return Object.defineProperties(a,{_instanceId:{value:sZ++},channel:{value:n},_log:{value:i.log.createLog("default",a)},_getReceiver:{value:e},_receiverPromise:{value:null,writable:!0},_transport:{value:null,writable:!0}}),a}return Object.defineProperty(r.prototype,"isSetup",{get:function(){return!!this._receiverPromise},enumerable:!1,configurable:!0}),r.prototype.toString=function(){return"[MediaSignaling #"+this._instanceId+":"+this.channel+"]"},r.prototype.setup=function(e){var n=this;this._teardown(),this._log.info("setting up msp transport for id:",e);var i=this._getReceiver(e).then(function(a){if(a.kind!=="data"&&n._log.error("Expected a DataTrackReceiver"),n._receiverPromise===i){try{n._transport=a.toDataTransport(),n.emit("ready",n._transport)}catch(o){n._log.error("Failed to toDataTransport: "+o.message)}a.once("close",function(){return n._teardown()})}});this._receiverPromise=i},r.prototype._teardown=function(){this._transport&&(this._log.info("Tearing down"),this._transport=null,this._receiverPromise=null,this.emit("teardown"))},r}(oZ),Fs=uZ,lZ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),cZ=Fs,fZ=function(t){lZ(r,t);function r(e,n){var i=t.call(this,e,"active_speaker",n)||this;return Object.defineProperties(i,{_loudestParticipantSid:{value:null,writable:!0}}),i.on("ready",function(a){a.on("message",function(o){switch(o.type){case"active_speaker":i._setLoudestParticipantSid(o.participant);break}})}),i}return Object.defineProperty(r.prototype,"loudestParticipantSid",{get:function(){return this._loudestParticipantSid},enumerable:!1,configurable:!0}),r.prototype._setLoudestParticipantSid=function(e){this.loudestParticipantSid!==e&&(this._loudestParticipantSid=e,this.emit("updated"))},r}(cZ),dZ=fZ,pZ=function(){function t(r,e,n,i){Object.defineProperties(this,{availableSend:{enumerable:!0,value:n},recv:{enumerable:!0,value:e},rtt:{enumerable:!0,value:i},send:{enumerable:!0,value:r}})}return t.of=function(r,e){var n=(e.timestamp-r.timestamp)/1e3,i=e.bytesSent-r.bytesSent,a=e.bytesReceived-r.bytesReceived,o=n>0?i/n*8:0,s=n>0?a/n*8:0,u=e.availableOutgoingBitrate,l=e.currentRoundTripTime;return new t(o,s,u,l)},t}(),vZ=pZ,_m=vZ,hZ=function(){function t(){Object.defineProperties(this,{lastReport:{enumerable:!0,value:new _m(0,0),writable:!0},lastStats:{enumerable:!0,value:null,writable:!0}})}return t.prototype.next=function(r){var e=this.lastStats;if(this.lastStats=r,e){var n=e.id===r.id?_m.of(e,r):new _m(0,0);this.lastReport=n}return this.lastReport},t}(),mZ=hZ;function gZ(t){return t=t.filter(function(r){return typeof r=="number"}),t.length<1?void 0:t.reduce(function(r,e){return e+r})/t.length}var l2=gZ,yZ=function(){function t(r,e,n){Object.defineProperties(this,{id:{enumerable:!0,value:r},trackId:{enumerable:!0,value:e},bitrate:{enumerable:!0,value:n}})}return t}(),c2=yZ;function bZ(t){return t.reduce(function(r,e){return typeof e=="number"?e+r:r},0)}var f2=bZ,_Z=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),d2=l2,wZ=c2,kZ=f2,TZ=function(t){_Z(r,t);function r(e,n,i,a,o,s,u){var l=t.call(this,e,n,i)||this,c=o>0?a/o:0;return Object.defineProperties(l,{deltaPacketsLost:{enumerable:!0,value:a},deltaPacketsReceived:{enumerable:!0,value:o},fractionLost:{enumerable:!0,value:s},jitter:{enumerable:!0,value:u},phonyFractionLost:{enumerable:!0,value:c}}),l}return r.of=function(e,n,i){if(n.id!==i.id)throw new Error("RTCStats IDs must match");var a=(i.timestamp-n.timestamp)/1e3,o=i.bytesReceived-n.bytesReceived,s=a>0?o/a*8:0,u=Math.max(i.packetsLost-n.packetsLost,0),l=i.packetsReceived-n.packetsReceived,c=i.fractionLost,f=i.jitter;return new r(n.id,e,s,u,l,c,f)},r.summarize=function(e){var n=e.map(function(s){return s.summarize()}),i=kZ(n.map(function(s){return s.bitrate})),a=d2(n.map(function(s){return s.fractionLost})),o=d2(n.map(function(s){return s.jitter}));return{bitrate:i,fractionLost:a,jitter:o}},r.prototype.summarize=function(){return{bitrate:this.bitrate,fractionLost:typeof this.fractionLost=="number"?this.fractionLost:this.phonyFractionLost,jitter:this.jitter}},r}(wZ),p2=TZ,SZ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),EZ=l2,MZ=c2,CZ=f2,RZ=function(t){SZ(r,t);function r(e,n,i,a){var o=t.call(this,e,n,i)||this;return Object.defineProperties(o,{rtt:{enumerable:!0,value:a}}),o}return r.of=function(e,n,i,a){if(n.id!==i.id)throw new Error("RTCStats IDs must match");var o=(i.timestamp-n.timestamp)/1e3,s=i.bytesSent-n.bytesSent,u=o>0?s/o*8:0,l=a&&typeof a.roundTripTime=="number"?a.roundTripTime/1e3:void 0;return new r(n.id,e,u,l)},r.summarize=function(e){var n=CZ(e.map(function(a){return a.bitrate})),i=EZ(e.map(function(a){return a.rtt}));return{bitrate:n,rtt:i}},r}(MZ),v2=RZ,wm=p2,km=v2,IZ=function(){function t(r,e,n){Object.defineProperties(this,{ice:{enumerable:!0,value:r},audio:{enumerable:!0,value:e},video:{enumerable:!0,value:n}})}return t.prototype.summarize=function(){var r=this.audio.send.concat(this.video.send),e=km.summarize(r),n=this.audio.recv.concat(this.video.recv),i=wm.summarize(n);return{ice:this.ice,send:e,recv:i,audio:{send:km.summarize(this.audio.send),recv:wm.summarize(this.audio.recv)},video:{send:km.summarize(this.video.send),recv:wm.summarize(this.video.recv)}}},t}(),OZ=IZ,NZ=function(){function t(r,e,n){Object.defineProperties(this,{id:{enumerable:!0,value:r,writable:!0},trackId:{enumerable:!0,value:e,writable:!0},lastStats:{enumerable:!0,value:n,writable:!0}})}return t}(),h2=NZ,AZ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),PZ=p2,xZ=h2,DZ=function(t){AZ(r,t);function r(e,n){var i=t.call(this,n.id,e,n)||this;return Object.defineProperties(i,{lastReport:{enumerable:!0,value:null,writable:!0}}),i}return r.prototype.next=function(e,n){var i=this.lastStats;this.lastStats=n,this.trackId=e;var a=PZ.of(e,i,n);return this.lastReport=a,a},r}(xZ),LZ=DZ,UZ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),jZ=h2,VZ=v2,FZ=function(t){UZ(r,t);function r(e,n){var i=t.call(this,n.id,e,n)||this;return Object.defineProperties(i,{lastReport:{enumerable:!0,value:null,writable:!0}}),i}return r.prototype.next=function(e,n,i){var a=this.lastStats;this.lastStats=n,this.trackId=e;var o=VZ.of(e,a,n,i);return this.lastReport=o,o},r}(jZ),$Z=FZ,gl=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},rd=V&&V.__spreadArray||function(t,r){for(var e=0,n=r.length,i=t.length;e<n;e++,i++)t[i]=r[e];return t},yl=V&&V.__values||function(t){var r=typeof Symbol=="function"&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},m2=hr.guessBrowser,zZ=mZ,WZ=OZ,BZ=LZ,ZZ=$Z,qZ=function(){function t(r){Object.defineProperties(this,{pc:{enumerable:!0,value:r},ice:{enumerable:!0,value:new zZ},audio:{enumerable:!0,value:{send:new Map,recv:new Map}},video:{enumerable:!0,value:{send:new Map,recv:new Map}},lastReport:{enumerable:!0,value:null,writable:!0}})}return t.prototype.next=function(){var r=this,e=m2()==="firefox"?GZ(this):HZ(this);return e.then(function(){var n=rd([],gl(r.audio.send.values())),i=rd([],gl(r.video.send.values())),a=rd([],gl(r.audio.recv.values())),o=rd([],gl(r.video.recv.values())),s=new WZ(r.ice.lastReport,{send:n.map(function(u){return u.lastReport}).filter(function(u){return u}),recv:a.map(function(u){return u.lastReport}).filter(function(u){return u})},{send:i.map(function(u){return u.lastReport}).filter(function(u){return u}),recv:o.map(function(u){return u.lastReport}).filter(function(u){return u})});return r.lastReport=s,s})},t}();function g2(t){return Promise.all(t.map(function(r){var e=r.track.id;return r.getStats().then(function(n){var i,a;try{for(var o=yl(n.values()),s=o.next();!s.done;s=o.next()){var u=s.value;u.type==="inbound-rtp"&&(u.id=e+"-"+u.id)}}catch(l){i={error:l}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(i)throw i.error}}return[e,n]})})).then(function(r){return new Map(r)})}function y2(t,r,e,n,i){var a=r[n.mediaType];if(!i){var o=e.get(n.trackId);o&&(i=o.trackIdentifier)}if(a&&i){if(a.has(n.id))return a.get(n.id);var s=new t(i,n);a.set(n.id,s)}return null}function Tm(t){return{audio:t.audio.send,video:t.video.send}}function Sm(t){return{audio:t.audio.recv,video:t.video.recv}}function QZ(t,r,e,n){return y2(ZZ,Tm(t),r,e,n)}function YZ(t,r,e,n){return y2(BZ,Sm(t),r,e,n)}function b2(t){return{audio:new Set(t.audio.send.keys()),video:new Set(t.video.send.keys())}}function _2(t){return{audio:new Set(t.audio.recv.keys()),video:new Set(t.video.recv.keys())}}function w2(t,r,e,n){var i,a;try{for(var o=yl(r.values()),s=o.next();!s.done;s=o.next()){var u=s.value;if(u.type==="outbound-rtp"&&!u.isRemote){if(m2()!=="firefox"&&!u.trackId)continue;var l=e[u.mediaType];l&&l.delete(u.id);var c=QZ(t,r,u,n);if(c){var f=r.get(u.remoteId);c.next(n||c.trackId,u,f)}}}}catch(d){i={error:d}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(i)throw i.error}}}function k2(t,r,e,n){var i,a;try{for(var o=yl(r.values()),s=o.next();!s.done;s=o.next()){var u=s.value;if(u.type==="inbound-rtp"&&!u.isRemote){var l=e[u.mediaType];l&&l.delete(u.id);var c=YZ(t,r,u,n);c&&c.next(n||c.trackId,u)}}}catch(f){i={error:f}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(i)throw i.error}}}function nd(t,r){var e=function(i){var a=t[i],o=r[i];o.forEach(function(s){return a.delete(s)})};for(var n in r)e(n)}function T2(t,r){var e,n,i,a,o;try{for(var s=yl(r.values()),u=s.next();!u.done;u=s.next()){var l=u.value;l.type==="transport"&&(o=r.get(l.selectedCandidatePairId))}}catch(d){e={error:d}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}if(o){t.next(o);return}try{for(var c=yl(r.values()),f=c.next();!f.done;f=c.next()){var l=f.value;l.type==="candidate-pair"&&l.nominated&&(!("selected"in l)||l.selected)&&t.next(l)}}catch(d){i={error:d}}finally{try{f&&!f.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}}function GZ(t){var r=t.pc.getTransceivers().filter(function(n){return n.currentDirection&&n.currentDirection.match(/send/)&&n.sender.track}).map(function(n){return n.sender}),e=t.pc.getTransceivers().filter(function(n){return n.currentDirection&&n.currentDirection.match(/recv/)}).map(function(n){return n.receiver});return Promise.all([g2(r),g2(e),t.pc.getStats()]).then(function(n){var i=gl(n,3),a=i[0],o=i[1],s=i[2],u=Tm(t),l=b2(t);a.forEach(function(d,v){return w2(t,d,l,v)}),nd(u,l);var c=Sm(t),f=_2(t);o.forEach(function(d,v){return k2(t,d,f,v)}),nd(c,f),T2(t.ice,s)})}function HZ(t){return t.pc.getStats().then(function(r){var e=Tm(t),n=b2(t);w2(t,r,n),nd(e,n);var i=Sm(t),a=_2(t);k2(t,r,a),nd(i,a),T2(t.ice,r)})}var JZ=qZ,XZ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),KZ=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},e8=Wr,t8=JZ,r8=function(t){XZ(r,t);function r(e,n){var i=t.call(this)||this;return Object.defineProperties(i,{_factories:{value:new WeakMap},_manager:{value:e},_signaling:{value:n}}),n.on("updated",function(){return i.emit("updated")}),i}return Object.defineProperty(r.prototype,"level",{get:function(){return this._signaling.level},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"levels",{get:function(){return this._signaling.levels},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"remoteLevels",{get:function(){return this._signaling.remoteLevels},enumerable:!1,configurable:!0}),r.prototype.start=function(){var e=this;this.stop();var n=setTimeout(function(){e._timeout===n&&n8(e).then(function(i){if(e._timeout===n){if(i.length){var a=KZ(i,1),o=a[0];e._signaling.put(o)}e.start()}})},200);this._timeout=n},r.prototype.stop=function(){clearTimeout(this._timeout),this._timeout=null},r}(e8);function n8(t){var r=t._manager._peerConnections?Array.from(t._manager._peerConnections.values()):[],e=r.map(function(a){return a._peerConnection}).filter(function(a){return a.signalingState!=="closed"}),n=e.map(function(a){if(t._factories.has(a))return t._factories.get(a);var o=new t8(a);return t._factories.set(a,o),o}),i=n.map(function(a){return a.next().catch(function(){return null})});return Promise.all(i).then(function(a){return a.filter(function(o){return o}).map(function(o){return o.summarize()})})}var i8=r8,a8=at.defer,o8=function(){function t(){Object.defineProperties(this,{_deferreds:{value:[]},_hasValue:{value:!1,writable:!0},_value:{value:null,writable:!0}})}return t.prototype.put=function(r){this._hasValue=!0,this._value=r;var e=this._deferreds.shift();return e&&e.resolve(r),this},t.prototype.take=function(){var r=this;if(this._hasValue&&!this._deferreds.length)return this._hasValue=!1,Promise.resolve(this._value);var e=a8();return this._deferreds.push(e),e.promise.then(function(n){return r._hasValue=!1,n})},t}(),s8=o8,u8=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),l8=Fs,c8=s8,f8=No,S2=5e3,d8=function(t){u8(r,t);function r(e,n,i){var a=t.call(this,e,"network_quality",i)||this;return Object.defineProperties(a,{_level:{value:null,writable:!0},_levels:{value:null,writable:!0},_remoteLevels:{value:new Map,writable:!0},_networkQualityInputs:{value:new c8},_resendTimer:{value:new f8(function(){a._resendTimer.setDelay(a._resendTimer.delay*1.5),a._sendNetworkQualityInputs()},S2,!1)},_networkQualityReportLevels:{get:function(){return{reportLevel:n.local,remoteReportLevel:n.remote}}}}),a.on("ready",function(o){o.on("message",function(s){switch(a._log.debug("Incoming: ",s),s.type){case"network_quality":a._handleNetworkQualityMessage(s);break}})}),a._sendNetworkQualityInputs(),a}return Object.defineProperty(r.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"levels",{get:function(){return this._levels},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"remoteLevels",{get:function(){return this._remoteLevels},enumerable:!1,configurable:!0}),r.prototype._handleNetworkQualityMessage=function(e){var n=this,i=!1,a=null,o=e?e.local:null;typeof o=="number"?(a=o,this._levels=null):typeof o=="object"&&o&&(this._levels=o,a=typeof o.level=="number"?o.level:Math.min(o.audio.send,o.audio.recv,o.video.send,o.video.recv)),a!==null&&this.level!==a&&(this._level=a,i=!0),this._remoteLevels=e&&e.remotes?e.remotes.reduce(function(s,u){var l=n._remoteLevels.get(u.sid)||{};return l.level!==u.level&&(i=!0),s.set(u.sid,u)},new Map):this._remoteLevels,i&&this.emit("updated"),this._resendTimer.setDelay(S2),this._resendTimer.isSet&&setTimeout(function(){return n._sendNetworkQualityInputs()},1e3)},r.prototype._sendNetworkQualityInputs=function(){var e=this;return this._resendTimer.clear(),this._networkQualityInputs.take().then(function(n){e._transport&&e._transport.publish(p8(n,e._networkQualityReportLevels))}).finally(function(){e._resendTimer.start()})},r.prototype.put=function(e){this._networkQualityInputs.put(e)},r}(l8);function p8(t,r){return Object.assign({type:"network_quality"},t,r)}var v8=d8,h8=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),m8=Wr.EventEmitter,g8=function(t){h8(r,t);function r(){var e=t.call(this)||this;return Object.defineProperties(e,{_isEnabled:{value:null,writable:!0},isEnabled:{enumerable:!0,get:function(){return this._isEnabled}}}),e}return r.prototype.disable=function(){return this.enable(!1)},r.prototype.enable=function(e){return e=typeof e=="boolean"?e:!0,this.isEnabled!==e&&(this._isEnabled=e,this.emit("updated")),this},r}(m8),E2=g8,y8=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),b8=E2,_8=function(t){y8(r,t);function r(){var e=t.call(this)||this;return Object.defineProperties(e,{_revision:{value:1,writable:!0}}),e}return r.prototype.update=function(e){return e.revision<this._revision?this:(this._revision=e.revision,this.enable(e.is_recording))},r}(b8),w8=_8,k8=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),T8=E2,S8=Ns,E8=No,M8=at.buildLogLevels,C8=fr.DEFAULT_LOG_LEVEL,R8=na,Em=lt,I8=Em.MediaConnectionError,O8=Em.MediaDTLSTransportFailedError,N8=Em.SignalingConnectionDisconnectedError,A8=0,P8={connected:["reconnecting","disconnected"],reconnecting:["connected","disconnected"],disconnected:[]},x8=function(t){k8(r,t);function r(e,n,i,a){var o=this;a=Object.assign({logLevel:C8,RecordingSignaling:T8,Timeout:E8},a);var s=M8(a.logLevel);o=t.call(this,"connected",P8)||this;var u=a.RecordingSignaling,l=new a.Timeout(function(){o._disconnect(o._reconnectingError)},a.sessionTimeout,!1);return Object.defineProperties(o,{_instanceId:{value:A8++},_log:{value:a.log?a.log.createLog("default",o):new R8("default",o,s,a.loggerName)},_mediaConnectionIsReconnecting:{writable:!0,value:!1},_options:{value:a},_reconnectingError:{value:null,writable:!0},_sessionTimeout:{value:l},dominantSpeakerSid:{enumerable:!0,value:null,writable:!0},localParticipant:{enumerable:!0,value:e},name:{enumerable:!0,value:i},participants:{enumerable:!0,value:new Map},recording:{enumerable:!0,value:new u},sid:{enumerable:!0,value:n}}),o.on("connectionStateChanged",function(){o.connectionState==="failed"&&!["disconnected","failed"].includes(o.iceConnectionState)&&o._disconnect(new O8)}),o.on("iceConnectionStateChanged",function(){return Mm(o)}),o.on("signalingConnectionStateChanged",function(){return Mm(o)}),setTimeout(function(){return Mm(o)}),o}return r.prototype._disconnect=function(e){return this.state!=="disconnected"?(this.preempt("disconnected",null,[e]),!0):!1},r.prototype.toString=function(){return"[RoomSignaling #"+this._instanceId+": "+(this.localParticipant?this.localParticipant.sid:"null")+"]"},r.prototype.connectParticipant=function(e){var n=this;return e.state==="disconnected"||this.participants.has(e.sid)?!1:(this.participants.set(e.sid,e),e.on("stateChanged",function i(a){a==="disconnected"&&(e.removeListener("stateChanged",i),n.participants.delete(e.sid),n.emit("participantDisconnected",e))}),this.emit("participantConnected",e),!0)},r.prototype.disconnect=function(){return this._disconnect()},r.prototype.setDominantSpeaker=function(e){this.dominantSpeakerSid=e,this.emit("dominantSpeakerChanged")},r}(S8);function Mm(t){if(t.state==="disconnected"||t.signalingConnectionState==="disconnected"){t._sessionTimeout.clear();return}var r;t.signalingConnectionState==="reconnecting"?r=t.signalingConnectionState:t.iceConnectionState==="failed"?(t._mediaConnectionIsReconnecting=!0,r="reconnecting"):t.iceConnectionState==="new"||t.iceConnectionState==="checking"?r=t._mediaConnectionIsReconnecting?"reconnecting":"connected":(t._mediaConnectionIsReconnecting=!1,t._reconnectingError=null,t._sessionTimeout.clear(),r="connected"),r!==t.state&&(r==="reconnecting"?(t._reconnectingError=t.signalingConnectionState==="reconnecting"?new N8:new I8,t._sessionTimeout.start(),t.preempt(r,null,[t._reconnectingError])):t.preempt(r))}var M2=x8,D8=function(){function t(r){var e=r.actual,n=e===void 0?null:e,i=r.available,a=i===void 0?null:i,o=r.level,s=o===void 0?null:o;Object.defineProperties(this,{actual:{value:n,enumerable:!0},available:{value:a,enumerable:!0},level:{value:s,enumerable:!0}})}return t}(),L8=D8,U8=function(){function t(r){var e=r.fractionLost,n=e===void 0?null:e,i=r.level,a=i===void 0?null:i;Object.defineProperties(this,{fractionLost:{value:n,enumerable:!0},level:{value:a,enumerable:!0}})}return t}(),j8=U8,V8=function(){function t(r){var e=r.jitter,n=e===void 0?null:e,i=r.rtt,a=i===void 0?null:i,o=r.level,s=o===void 0?null:o;Object.defineProperties(this,{jitter:{value:n,enumerable:!0},rtt:{value:a,enumerable:!0},level:{value:s,enumerable:!0}})}return t}(),F8=V8,$8=L8,z8=j8,W8=F8,B8=function(){function t(r){var e=r.bandwidth,n=e===void 0?null:e,i=r.fractionLost,a=i===void 0?null:i,o=r.latency,s=o===void 0?null:o;Object.defineProperties(this,{bandwidth:{value:n?new $8(n):null,enumerable:!0},fractionLost:{value:a?new z8(a):null,enumerable:!0},latency:{value:s?new W8(s):null,enumerable:!0}})}return t}(),C2=B8,Z8=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),q8=C2,Q8=function(t){Z8(r,t);function r(e){return t.call(this,e)||this}return r}(q8),Y8=Q8,G8=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),H8=C2,J8=function(t){G8(r,t);function r(e){return t.call(this,e)||this}return r}(H8),X8=J8,K8=Y8,eq=X8,tq=function(){function t(r){var e=r.send,n=r.recv,i=r.sendStats,a=i===void 0?null:i,o=r.recvStats,s=o===void 0?null:o;Object.defineProperties(this,{send:{value:e,enumerable:!0},recv:{value:n,enumerable:!0},sendStats:{value:a?new K8(a):null,enumerable:!0},recvStats:{value:s?new eq(s):null,enumerable:!0}})}return t}(),R2=tq,rq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),nq=R2,iq=function(t){rq(r,t);function r(e){return t.call(this,e)||this}return r}(nq),aq=iq,oq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),sq=R2,uq=function(t){oq(r,t);function r(e){return t.call(this,e)||this}return r}(sq),lq=uq,cq=aq,fq=lq,dq=function(){function t(r){var e=r.level,n=r.audio,i=r.video;Object.defineProperties(this,{level:{value:e,enumerable:!0},audio:{value:n?new cq(n):null,enumerable:!0},video:{value:i?new fq(i):null,enumerable:!0}})}return t}(),pq=dq,vq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),hq=Ns,mq=pq,gq={connecting:["connected"],connected:["disconnected","reconnecting"],reconnecting:["connected","disconnected"],disconnected:[]},yq=function(t){vq(r,t);function r(){var e=t.call(this,"connecting",gq)||this;return Object.defineProperties(e,{_identity:{writable:!0,value:null},_networkQualityLevel:{value:null,writable:!0},_networkQualityStats:{value:null,writable:!0},_sid:{writable:!0,value:null},identity:{enumerable:!0,get:function(){return this._identity}},sid:{enumerable:!0,get:function(){return this._sid}},tracks:{enumerable:!0,value:new Map}}),e}return Object.defineProperty(r.prototype,"networkQualityLevel",{get:function(){return this._networkQualityLevel},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"networkQualityStats",{get:function(){return this._networkQualityStats},enumerable:!1,configurable:!0}),r.prototype.addTrack=function(e){return this.tracks.set(e.id||e.sid,e),this.emit("trackAdded",e),this},r.prototype.disconnect=function(){return this.state!=="disconnected"?(this.preempt("disconnected"),!0):!1},r.prototype.removeTrack=function(e){var n=this.tracks.get(e.id||e.sid);return this.tracks.delete(e.id||e.sid),n&&this.emit("trackRemoved",e),n||null},r.prototype.setNetworkQualityLevel=function(e,n){this._networkQualityLevel!==e&&(this._networkQualityLevel=e,this._networkQualityStats=n&&(n.audio||n.video)?new mq(n):null,this.emit("networkQualityLevelChanged"))},r.prototype.connect=function(e,n){return this.state==="connecting"||this.state==="reconnecting"?(this._sid||(this._sid=e),this._identity||(this._identity=n),this.preempt("connected"),!0):!1},r.prototype.reconnecting=function(){return this.state==="connecting"||this.state==="connected"?(this.preempt("reconnecting"),!0):!1},r}(hq),Cm=yq,bq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),_q=Cm,wq=function(t){bq(r,t);function r(e,n){var i=t.call(this)||this;return i.connect(e,n),i}return r}(_q),kq=wq,Tq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Sq=Wr.EventEmitter,Eq=function(t){Tq(r,t);function r(e,n,i,a){var o=t.call(this)||this,s=null;return Object.defineProperties(o,{_error:{value:null,writable:!0},_isEnabled:{value:i,writable:!0},_priority:{value:a,writable:!0},_trackTransceiver:{value:null,writable:!0},_sid:{get:function(){return s},set:function(u){s===null&&(s=u)}},kind:{enumerable:!0,value:n},name:{enumerable:!0,value:e}}),o}return Object.defineProperty(r.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"priority",{get:function(){return this._priority},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"sid",{get:function(){return this._sid},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"trackTransceiver",{get:function(){return this._trackTransceiver},enumerable:!1,configurable:!0}),r.prototype.disable=function(){return this.enable(!1)},r.prototype.enable=function(e){return e=typeof e=="boolean"?e:!0,this.isEnabled!==e&&(this._isEnabled=e,this.emit("updated")),this},r.prototype.setTrackTransceiver=function(e){return e=e||null,this.trackTransceiver!==e&&(this._trackTransceiver=e,this.emit("updated")),this},r.prototype.setSid=function(e){return this.sid===null&&(this._sid=e,this.emit("updated")),this},r}(Sq),I2=Eq,Mq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Cq=I2,Rq=function(t){Mq(r,t);function r(e,n,i,a,o,s){var u=t.call(this,n,i,a,o)||this;return Object.defineProperties(u,{_isSwitchedOff:{value:s,writable:!0}}),u.setSid(e),u}return Object.defineProperty(r.prototype,"isSubscribed",{get:function(){return!!this.trackTransceiver},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isSwitchedOff",{get:function(){return this._isSwitchedOff},enumerable:!1,configurable:!0}),r.prototype.subscribeFailed=function(e){return this.error||(this._error=e,this.emit("updated")),this},r.prototype.setPriority=function(e){return this._priority!==e&&(this._priority=e,this.emit("updated")),this},r.prototype.setSwitchedOff=function(e){return this._isSwitchedOff!==e&&(this._isSwitchedOff=e,this.emit("updated")),this},r}(Cq),Iq=Rq,Oq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Nq=Iq,Aq=function(t){Oq(r,t);function r(e,n){return t.call(this,e.sid,e.name,e.kind,e.enabled,e.priority,n)||this}return r.prototype.update=function(e){return this.enable(e.enabled),this.setPriority(e.priority),this},r}(Nq),Pq=Aq,xq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Dq=kq,Lq=Pq,Uq=function(t){xq(r,t);function r(e,n,i,a,o,s){var u=t.call(this,e.sid,e.identity)||this;return s=Object.assign({RemoteTrackPublicationV2:Lq},s),Object.defineProperties(u,{_revision:{writable:!0,value:null},_RemoteTrackPublicationV2:{value:s.RemoteTrackPublicationV2},_getInitialTrackSwitchOffState:{value:n},updateSubscriberTrackPriority:{value:function(l,c){return i(l,c)}},updateTrackRenderHint:{value:function(l,c){return a(l,c)}},clearTrackHint:{value:function(l){return o(l)}},revision:{enumerable:!0,get:function(){return this._revision}}}),u.update(e)}return r.prototype._getOrCreateTrack=function(e){var n=this._RemoteTrackPublicationV2,i=this.tracks.get(e.sid);if(!i){var a=this._getInitialTrackSwitchOffState(e.sid);i=new n(e,a),this.addTrack(i)}return i},r.prototype.update=function(e){var n=this;if(this.revision!==null&&e.revision<=this.revision)return this;this._revision=e.revision;var i=new Set;switch(e.tracks.forEach(function(a){var o=n._getOrCreateTrack(a);o.update(a),i.add(o)}),this.tracks.forEach(function(a){i.has(a)||n.removeTrack(a)}),e.state){case"disconnected":this.disconnect();break;case"reconnecting":this.reconnecting();break;case"connected":this.connect(this.sid,this.identity);break}return this},r}(Dq),jq=Uq,Vq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Fq=Fs,$q=function(t){Vq(r,t);function r(e,n){var i=t.call(this,e,"track_priority",n)||this;return Object.defineProperties(i,{_enqueuedPriorityUpdates:{value:new Map}}),i.on("ready",function(a){Array.from(i._enqueuedPriorityUpdates.keys()).forEach(function(o){a.publish({type:"track_priority",track:o,subscribe:i._enqueuedPriorityUpdates.get(o)})})}),i}return r.prototype.sendTrackPriorityUpdate=function(e,n,i){if(n!=="subscribe")throw new Error("only subscribe priorities are supported, found: "+n);this._enqueuedPriorityUpdates.set(e,i),this._transport&&this._transport.publish({type:"track_priority",track:e,subscribe:i})},r}(Fq),zq=$q,Wq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Bq=Fs,Zq=function(t){Wq(r,t);function r(e,n){var i=t.call(this,e,"track_switch_off",n)||this;return i.on("ready",function(a){a.on("message",function(o){switch(o.type){case"track_switch_off":i._setTrackSwitchOffUpdates(o.off||[],o.on||[]);break}})}),i}return r.prototype._setTrackSwitchOffUpdates=function(e,n){this.emit("updated",e,n)},r}(Bq),qq=Zq,Qq=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Yq=Fs,Gq=No,Hq=at.isDeepEqual,O2=2e3,Jq=1,Xq=function(t){Qq(r,t);function r(e,n){var i=t.call(this,e,"render_hints",n)||this;return Object.defineProperties(i,{_trackSidsToRenderHints:{value:new Map},_responseTimer:{value:new Gq(function(){i._sendAllHints(),i._responseTimer.setDelay(i._responseTimer.delay*2)},O2,!1)}}),i.on("ready",function(a){a.on("message",function(o){switch(i._log.debug("Incoming: ",o),o.type){case"render_hints":i._processHintResults(o&&o.subscriber&&o.subscriber.hints||[]);break;default:i._log.warn("Unknown message type: ",o.type);break}}),i._sendAllHints()}),i}return r.prototype._sendAllHints=function(){var e=this;Array.from(this._trackSidsToRenderHints.keys()).forEach(function(n){var i=e._trackSidsToRenderHints.get(n);i.renderDimensions&&(i.isDimensionDirty=!0),"enabled"in i&&(i.isEnabledDirty=!0)}),this._sendHints()},r.prototype._processHintResults=function(e){var n=this;this._responseTimer.clear(),this._responseTimer.setDelay(O2),e.forEach(function(i){i.result!=="OK"&&n._log.debug("Server error processing hint:",i)}),this._sendHints()},r.prototype._sendHints=function(){var e=this;if(!(!this._transport||this._responseTimer.isSet)){var n=[];if(Array.from(this._trackSidsToRenderHints.keys()).forEach(function(a){var o=e._trackSidsToRenderHints.get(a);if(o.isEnabledDirty||o.isDimensionDirty){var s={track:a};o.isEnabledDirty&&(s.enabled=o.enabled,o.isEnabledDirty=!1),o.isDimensionDirty&&(s.render_dimensions=o.renderDimensions,o.isDimensionDirty=!1),n.push(s)}}),n.length>0){var i={type:"render_hints",subscriber:{id:Jq++,hints:n}};this._log.debug("Outgoing: ",i),this._transport.publish(i),this._responseTimer.start()}}},r.prototype.setTrackHint=function(e,n){var i=this._trackSidsToRenderHints.get(e)||{isEnabledDirty:!1,isDimensionDirty:!1};"enabled"in n&&i.enabled!==n.enabled&&(i.enabled=!!n.enabled,i.isEnabledDirty=!0),n.renderDimensions&&!Hq(n.renderDimensions,i.renderDimensions)&&(i.renderDimensions=n.renderDimensions,i.isDimensionDirty=!0),this._trackSidsToRenderHints.set(e,i),this._sendHints()},r.prototype.clearTrackHint=function(e){this._trackSidsToRenderHints.delete(e)},r}(Yq),Kq=Xq,e7=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),t7=Fs,r7=1,n7=function(t){e7(r,t);function r(e,n){var i=t.call(this,e,"publisher_hints",n)||this;return i.on("ready",function(a){i._log.debug("publisher_hints transport ready:",a),a.on("message",function(o){switch(i._log.debug("Incoming: ",o),o.type){case"publisher_hints":o.publisher&&o.publisher.hints&&o.publisher.id&&i._processPublisherHints(o.publisher.hints,o.publisher.id);break;default:i._log.warn("Unknown message type: ",o.type);break}})}),i}return r.prototype.sendTrackReplaced=function(e){var n=e.trackSid;if(this._transport){var i={type:"client_reset",track:n,id:r7++};this._log.debug("Outgoing: ",i),this._transport.publish(i)}},r.prototype.sendHintResponse=function(e){var n=e.id,i=e.hints;if(this._transport){var a={type:"publisher_hints",id:n,hints:i};this._log.debug("Outgoing: ",a),this._transport.publish(a)}},r.prototype._processPublisherHints=function(e,n){try{this.emit("updated",e,n)}catch(i){this._log.error("error processing hints:",i)}},r}(t7),i7=n7,a7=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),N2=V&&V.__read||function(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a},o7=dZ,s7=i8,u7=v8,l7=w8,c7=M2,f7=jq,d7=xS,p7=zq,v7=qq,h7=Kq,m7=i7,Do=at,g7=Do.constants.DEFAULT_SESSION_TIMEOUT_SEC,y7=Do.createBandwidthProfilePayload,b7=Do.defer,_7=Do.difference,Rm=Do.filterObject,Im=Do.flatMap,A2=Do.oncePerTick,id=nS,w7=lt.createTwilioError,k7=1e4,T7=function(t){a7(r,t);function r(e,n,i,a,o){var s=this;n.options=Object.assign({session_timeout:g7},n.options),o=Object.assign({DominantSpeakerSignaling:o7,NetworkQualityMonitor:s7,NetworkQualitySignaling:u7,RecordingSignaling:l7,RemoteParticipantV2:f7,TrackPrioritySignaling:p7,TrackSwitchOffSignaling:v7,bandwidthProfile:null,sessionTimeout:n.options.session_timeout*1e3,statsPublishIntervalMs:k7},o),e.setBandwidthProfile(o.bandwidthProfile);var u=n.options,l=u.signaling_region,c=u.audio_processors,f=c===void 0?[]:c;e.setSignalingRegion(l),f.includes("krisp")&&f.push("rnnoise"),e.setAudioProcessors(f),a.setIceReconnectTimeout(o.sessionTimeout),s=t.call(this,e,n.sid,n.name,o)||this;var d=function(p){return s._getTrackReceiver(p)},v=s._log;return Object.defineProperties(s,{_disconnectedParticipantRevisions:{value:new Map},_NetworkQualityMonitor:{value:o.NetworkQualityMonitor},_lastBandwidthProfileRevision:{value:e.bandwidthProfileRevision,writable:!0},_mediaStatesWarningsRevision:{value:0,writable:!0},_networkQualityMonitor:{value:null,writable:!0},_networkQualityConfiguration:{value:e.networkQualityConfiguration},_peerConnectionManager:{value:a},_published:{value:new Map},_publishedRevision:{value:0,writable:!0},_RemoteParticipantV2:{value:o.RemoteParticipantV2},_subscribed:{value:new Map},_subscribedRevision:{value:0,writable:!0},_subscriptionFailures:{value:new Map},_dominantSpeakerSignaling:{value:new o.DominantSpeakerSignaling(d,{log:v})},_networkQualitySignaling:{value:new o.NetworkQualitySignaling(d,e.networkQualityConfiguration,{log:v})},_renderHintsSignaling:{value:new h7(d,{log:v})},_publisherHintsSignaling:{value:new m7(d,{log:v})},_trackPrioritySignaling:{value:new o.TrackPrioritySignaling(d,{log:v})},_trackSwitchOffSignaling:{value:new o.TrackSwitchOffSignaling(d,{log:v})},_pendingSwitchOffStates:{value:new Map},_transport:{value:i},_trackReceiverDeferreds:{value:new Map},mediaRegion:{enumerable:!0,value:n.options.media_region||null}}),s._initTrackSwitchOffSignaling(),s._initDominantSpeakerSignaling(),s._initNetworkQualityMonitorSignaling(),s._initPublisherHintSignaling(),S7(s,e),E7(s,a),M7(s,i),C7(s,i,o.statsPublishIntervalMs),s._update(n),s._peerConnectionManager.setEffectiveAdaptiveSimulcast(s._publisherHintsSignaling.isSetup),s}return Object.defineProperty(r.prototype,"connectionState",{get:function(){return this._peerConnectionManager.connectionState},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"signalingConnectionState",{get:function(){return this._transport.state==="syncing"?"reconnecting":this._transport.state},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"iceConnectionState",{get:function(){return this._peerConnectionManager.iceConnectionState},enumerable:!1,configurable:!0}),r.prototype._deleteTrackReceiverDeferred=function(e){return this._trackReceiverDeferreds.delete(e)},r.prototype._getOrCreateTrackReceiverDeferred=function(e){var n=this._trackReceiverDeferreds.get(e)||b7(),i=this._peerConnectionManager.getTrackReceivers(),a=i.find(function(o){return o.id===e&&o.readyState!=="ended"});return a?n.resolve(a):this._trackReceiverDeferreds.set(e,n),n},r.prototype._addTrackReceiver=function(e){var n=this._getOrCreateTrackReceiverDeferred(e.id);return n.resolve(e),this},r.prototype._disconnect=function(e){var n=t.prototype._disconnect.call(this,e);return n&&(this._teardownNetworkQualityMonitor(),this._transport.disconnect(),this._peerConnectionManager.close()),this.localParticipant.tracks.forEach(function(i){i.publishFailed(e||new Error("LocalParticipant disconnected"))}),n},r.prototype._getTrackReceiver=function(e){var n=this;return this._getOrCreateTrackReceiverDeferred(e).promise.then(function(i){return n._deleteTrackReceiverDeferred(e),i})},r.prototype._getInitialTrackSwitchOffState=function(e){var n=this._pendingSwitchOffStates.get(e)||!1;return this._pendingSwitchOffStates.delete(e),n&&this._log.warn("["+e+"] was initially switched off! "),n},r.prototype._getTrackSidsToTrackSignalings=function(){var e=Im(this.participants,function(n){return Array.from(n.tracks)});return new Map(e)},r.prototype._getOrCreateRemoteParticipant=function(e){var n=this,i=this._RemoteParticipantV2,a=this.participants.get(e.sid),o=this;return a||(a=new i(e,function(s){return n._getInitialTrackSwitchOffState(s)},function(s,u){return n._trackPrioritySignaling.sendTrackPriorityUpdate(s,"subscribe",u)},function(s,u){return n._renderHintsSignaling.setTrackHint(s,u)},function(s){return n._renderHintsSignaling.clearTrackHint(s)}),a.on("stateChanged",function s(u){u==="disconnected"&&(a.removeListener("stateChanged",s),o.participants.delete(a.sid),o._disconnectedParticipantRevisions.set(a.sid,a.revision))}),this.connectParticipant(a)),a},r.prototype._getState=function(){return{participant:this.localParticipant.getState()}},r.prototype._maybeAddBandwidthProfile=function(e){var n=this.localParticipant,i=n.bandwidthProfile,a=n.bandwidthProfileRevision;return i&&this._lastBandwidthProfileRevision<a?(this._lastBandwidthProfileRevision=a,Object.assign({bandwidth_profile:y7(i)},e)):e},r.prototype._publishNewLocalParticipantState=function(){this._transport.publish(this._maybeAddBandwidthProfile(this._getState()))},r.prototype._publishPeerConnectionState=function(e){this._transport.publish(Object.assign({peer_connections:[e]},this._getState()))},r.prototype._update=function(e){var n=this;if(e.subscribed&&e.subscribed.revision>this._subscribedRevision){this._subscribedRevision=e.subscribed.revision,e.subscribed.tracks.forEach(function(o){o.id?(n._subscriptionFailures.delete(o.sid),n._subscribed.set(o.sid,o.id)):o.error&&!n._subscriptionFailures.has(o.sid)&&n._subscriptionFailures.set(o.sid,o.error)});var i=new Set(e.subscribed.tracks.filter(function(o){return!!o.id}).map(function(o){return o.sid}));this._subscribed.forEach(function(o,s){i.has(s)||n._subscribed.delete(s)})}var a=new Set;return(e.participants||[]).forEach(function(o){if(o.sid!==n.localParticipant.sid){var s=n._disconnectedParticipantRevisions.get(o.sid);if(!(s&&o.revision<=s)){s&&n._disconnectedParticipantRevisions.delete(o.sid);var u=n._getOrCreateRemoteParticipant(o);u.update(o),a.add(u)}}}),e.type==="synced"&&this.participants.forEach(function(o){a.has(o)||o.disconnect()}),R7(this),e.peer_connections&&this._peerConnectionManager.update(e.peer_connections,e.type==="synced"),e.recording&&this.recording.update(e.recording),e.published&&e.published.revision>this._publishedRevision&&(this._publishedRevision=e.published.revision,e.published.tracks.forEach(function(o){o.sid&&n._published.set(o.id,o.sid)}),this.localParticipant.update(e.published)),e.participant&&this.localParticipant.connect(e.participant.sid,e.participant.identity),[this._dominantSpeakerSignaling,this._networkQualitySignaling,this._trackPrioritySignaling,this._trackSwitchOffSignaling,this._renderHintsSignaling,this._publisherHintsSignaling].forEach(function(o){var s=o.channel;!o.isSetup&&e.media_signaling&&e.media_signaling[s]&&e.media_signaling[s].transport&&e.media_signaling[s].transport.type==="data-channel"&&o.setup(e.media_signaling[s].transport.label)}),e.type==="warning"&&e.states&&e.states.revision>this._mediaStatesWarningsRevision&&(this._mediaStatesWarningsRevision=e.states.revision,this.localParticipant.updateMediaStates(e.states)),this},r.prototype._initPublisherHintSignaling=function(){var e=this;this._publisherHintsSignaling.on("updated",function(i,a){Promise.all(i.map(function(o){return e.localParticipant.setPublisherHint(o.track,o.encodings).then(function(s){return{track:o.track,result:s}})})).then(function(o){e._publisherHintsSignaling.sendHintResponse({id:a,hints:o})})});var n=function(i){i.kind==="video"&&i.trackTransceiver.on("replaced",function(){e._publisherHintsSignaling.sendTrackReplaced({trackSid:i.sid})})};Array.from(this.localParticipant.tracks.values()).forEach(function(i){return n(i)}),this.localParticipant.on("trackAdded",function(i){return n(i)})},r.prototype._initTrackSwitchOffSignaling=function(){var e=this;this._trackSwitchOffSignaling.on("updated",function(n,i){try{e._log.debug("received trackSwitch: ",{tracksOn:i,tracksOff:n});var a=new Map;i.forEach(function(o){return a.set(o,!0)}),n.forEach(function(o){a.get(o)&&e._log.warn(o+" is DUPLICATED in both tracksOff and tracksOn list"),a.set(o,!1)}),e.participants.forEach(function(o){o.tracks.forEach(function(s){var u=a.get(s.sid);typeof u<"u"&&(s.setSwitchedOff(!u),a.delete(s.sid))})}),a.forEach(function(o,s){return e._pendingSwitchOffStates.set(s,!o)})}catch(o){e._log.error("error processing track switch off:",o)}})},r.prototype._initDominantSpeakerSignaling=function(){var e=this;this._dominantSpeakerSignaling.on("updated",function(){return e.setDominantSpeaker(e._dominantSpeakerSignaling.loudestParticipantSid)})},r.prototype._initNetworkQualityMonitorSignaling=function(){var e=this;this._networkQualitySignaling.on("ready",function(){var n=new e._NetworkQualityMonitor(e._peerConnectionManager,e._networkQualitySignaling);e._networkQualityMonitor=n,n.on("updated",function(){e.iceConnectionState!=="failed"&&(e.localParticipant.setNetworkQualityLevel(n.level,n.levels),e.participants.forEach(function(i){var a=n.remoteLevels.get(i.sid);a&&i.setNetworkQualityLevel(a.level,a)}))}),n.start()}),this._networkQualitySignaling.on("teardown",function(){return e._teardownNetworkQualityMonitor()})},r.prototype._teardownNetworkQualityMonitor=function(){this._networkQualityMonitor&&(this._networkQualityMonitor.stop(),this._networkQualityMonitor=null)},r.prototype.getStats=function(){var e=this;return this._peerConnectionManager.getStats().then(function(n){return new Map(Array.from(n).map(function(i){var a=N2(i,2),o=a[0],s=a[1];return[o,Object.assign({},s,{localAudioTrackStats:x2(e,s.localAudioTrackStats),localVideoTrackStats:x2(e,s.localVideoTrackStats),remoteAudioTrackStats:D2(e,s.remoteAudioTrackStats),remoteVideoTrackStats:D2(e,s.remoteVideoTrackStats)})]}))})},r}(c7);function P2(t,r){return r.reduce(function(e,n){var i=t.get(n.trackId);return i?[Object.assign({},n,{trackSid:i})].concat(e):e},[])}function x2(t,r){return P2(t._published,r)}function D2(t,r){var e=new Map(Array.from(t._subscribed.entries()).map(function(n){var i=N2(n,2),a=i[0],o=i[1];return[o,a]}));return P2(e,r)}function S7(t,r){var e=A2(function(){t._publishNewLocalParticipantState()}),n=A2(function(){var i=Im(r.tracks,function(a){return a.trackTransceiver});t._peerConnectionManager.setTrackSenders(i)});r.on("trackAdded",n),r.on("trackRemoved",n),r.on("updated",e),t.on("stateChanged",function i(a){a==="disconnected"&&(r.removeListener("trackAdded",n),r.removeListener("trackRemoved",n),r.removeListener("updated",e),t.removeListener("stateChanged",i),r.disconnect())}),t.on("signalingConnectionStateChanged",function(){var i=t.localParticipant,a=t.signalingConnectionState,o=i.identity,s=i.sid;switch(a){case"connected":i.connect(s,o);break;case"reconnecting":i.reconnecting();break}})}function E7(t,r){r.on("description",function(n){t._publishPeerConnectionState(n)}),r.dequeue("description"),r.on("candidates",function(n){t._publishPeerConnectionState(n)}),r.dequeue("candidates"),r.on("trackAdded",t._addTrackReceiver.bind(t)),r.dequeue("trackAdded"),r.getTrackReceivers().forEach(t._addTrackReceiver,t),r.on("connectionStateChanged",function(){t.emit("connectionStateChanged")}),r.on("iceConnectionStateChanged",function(){t.emit("iceConnectionStateChanged"),t.iceConnectionState==="failed"&&(t.localParticipant.networkQualityLevel!==null&&t.localParticipant.setNetworkQualityLevel(0),t.participants.forEach(function(e){e.networkQualityLevel!==null&&e.setNetworkQualityLevel(0)}))})}function M7(t,r){r.on("message",t._update.bind(t)),r.on("stateChanged",function e(n,i){n==="disconnected"&&(t.state!=="disconnected"&&t._disconnect(i),r.removeListener("stateChanged",e)),t.emit("signalingConnectionStateChanged")})}function C7(t,r,e){var n=new Map,i=!1,a=setInterval(function(){t.getStats().then(function(o){i=!i,o.forEach(function(s,u){var l=new d7(u,s,!0);r.publishEvent("quality","stats-report","info",{audioTrackStats:l.remoteAudioTrackStats.map(function(v,p){return U2(v,s.remoteAudioTrackStats[p],n)}),localAudioTrackStats:l.localAudioTrackStats.map(function(v,p){return L2(v,s.localAudioTrackStats[p],n)}),localVideoTrackStats:l.localVideoTrackStats.map(function(v,p){return L2(v,s.localVideoTrackStats[p],n)}),peerConnectionId:l.peerConnectionId,videoTrackStats:l.remoteVideoTrackStats.map(function(v,p){return U2(v,s.remoteVideoTrackStats[p],n)})});var c=Im(["localAudioTrackStats","localVideoTrackStats","remoteAudioTrackStats","remoteVideoTrackStats"],function(v){return l[v].map(function(p){var y=p.ssrc,k=p.trackSid;return k+"+"+y})}),f=_7(Array.from(n.keys()),c);if(f.forEach(function(v){return n.delete(v)}),i){var d=I7(s.activeIceCandidatePair,l.peerConnectionId);r.publishEvent("quality","active-ice-candidate-pair","info",d)}})},function(){})},e);t.on("stateChanged",function o(s){s==="disconnected"&&(clearInterval(a),t.removeListener("stateChanged",o))})}function R7(t){var r=t._getTrackSidsToTrackSignalings();t._subscriptionFailures.forEach(function(e,n){var i=r.get(n);i&&(t._subscriptionFailures.delete(n),i.subscribeFailed(w7(e.code,e.message)))}),r.forEach(function(e){var n=t._subscribed.get(e.sid);(!n||e.isSubscribed&&e.trackTransceiver.id!==n)&&e.setTrackTransceiver(null),n&&t._getTrackReceiver(n).then(function(i){return e.setTrackTransceiver(i)})})}function L2(t,r,e){var n=r.framesEncoded,i=r.packetsSent,a=r.totalEncodeTime,o=r.totalPacketSendDelay,s=Object.assign({},t),u=t.trackSid+"+"+t.ssrc,l=e.get(u)||new Map;if(typeof a=="number"&&typeof n=="number"){var c=l.get("avgEncodeDelay")||new id;c.putSample(a*1e3,n),s.avgEncodeDelay=Math.round(c.get()),l.set("avgEncodeDelay",c)}if(typeof o=="number"&&typeof i=="number"){var f=l.get("avgPacketSendDelay")||new id;f.putSample(o*1e3,i),s.avgPacketSendDelay=Math.round(f.get()),l.set("avgPacketSendDelay",f)}return e.set(u,l),s}function U2(t,r,e){var n=r.estimatedPlayoutTimestamp,i=r.framesDecoded,a=r.jitterBufferDelay,o=r.jitterBufferEmittedCount,s=r.totalDecodeTime,u=Object.assign({},t),l=t.trackSid+"+"+t.ssrc,c=e.get(l)||new Map;if(typeof n=="number"&&(u.estimatedPlayoutTimestamp=n),typeof i=="number"&&typeof s=="number"){var f=c.get("avgDecodeDelay")||new id;f.putSample(s*1e3,i),u.avgDecodeDelay=Math.round(f.get()),c.set("avgDecodeDelay",f)}if(typeof a=="number"&&typeof o=="number"){var d=c.get("avgJitterBufferDelay")||new id;d.putSample(a*1e3,o),u.avgJitterBufferDelay=Math.round(d.get()),c.set("avgJitterBufferDelay",d)}return e.set(l,c),u}function I7(t,r){return t=Object.assign({availableIncomingBitrate:0,availableOutgoingBitrate:0,bytesReceived:0,bytesSent:0,consentRequestsSent:0,currentRoundTripTime:0,lastPacketReceivedTimestamp:0,lastPacketSentTimestamp:0,nominated:!1,peerConnectionId:r,priority:0,readable:!1,requestsReceived:0,requestsSent:0,responsesReceived:0,responsesSent:0,retransmissionsReceived:0,retransmissionsSent:0,state:"failed",totalRoundTripTime:0,transportId:"",writable:!1},Rm(t||{},null)),t.localCandidate=Object.assign({candidateType:"host",deleted:!1,ip:"",port:0,priority:0,protocol:"udp",url:""},Rm(t.localCandidate||{},null)),t.remoteCandidate=Object.assign({candidateType:"host",ip:"",port:0,priority:0,protocol:"udp",url:""},Rm(t.remoteCandidate||{},null)),t}var O7=T7,N7=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),A7=Ns,j2=Xk,P7=jS,x7=fr.reconnectBackoffConfig,D7=No,Om=fr,L7=Om.SDK_NAME,U7=Om.SDK_VERSION,j7=Om.SDP_FORMAT,$s=at,V7=$s.createBandwidthProfilePayload,F7=$s.createMediaSignalingPayload,$7=$s.createMediaWarningsPayload,z7=$s.createSubscribePayload,W7=$s.getUserAgent,B7=$s.isNonArrayObject,ad=lt,Z7=ad.createTwilioError,Nm=ad.RoomCompletedError,q7=ad.SignalingConnectionError,Q7=ad.SignalingServerBusyError,Y7=1,Am=2,G7={connecting:["connected","disconnected"],connected:["disconnected","syncing"],syncing:["connected","disconnected"],disconnected:[]},H7=function(t){N7(r,t);function r(e,n,i,a,o,s){var u=this;return s=Object.assign({Backoff:P7,TwilioConnection:j2,iceServers:null,trackPriority:!0,trackSwitchOff:!0,renderHints:!0,userAgent:W7()},s),u=t.call(this,"connecting",G7)||this,Object.defineProperties(u,{_accessToken:{value:n},_automaticSubscription:{value:s.automaticSubscription},_bandwidthProfile:{value:s.bandwidthProfile},_dominantSpeaker:{value:s.dominantSpeaker},_adaptiveSimulcast:{value:s.adaptiveSimulcast},_eventObserver:{value:s.eventObserver,writable:!1},_renderHints:{value:s.renderHints},_iceServersStatus:{value:Array.isArray(s.iceServers)?"overrode":"acquire"},_localParticipant:{value:i},_name:{value:e},_networkQuality:{value:B7(s.networkQuality)||s.networkQuality},_notifyWarnings:{value:s.notifyWarnings},_options:{value:s},_peerConnectionManager:{value:a},_sessionTimer:{value:null,writable:!0},_sessionTimeoutMS:{value:0,writable:!0},_reconnectBackoff:{value:new s.Backoff(x7)},_session:{value:null,writable:!0},_trackPriority:{value:s.trackPriority},_trackSwitchOff:{value:s.trackSwitchOff},_twilioConnection:{value:null,writable:!0},_updatesReceived:{value:[]},_updatesToSend:{value:[]},_userAgent:{value:s.userAgent},_wsServer:{value:o}}),X7(u),u}return r.prototype._createConnectOrSyncOrDisconnectMessage=function(){if(this.state==="connected")return null;if(this.state==="disconnected")return{session:this._session,type:"disconnect",version:Am};var e={connecting:"connect",syncing:"sync"}[this.state],n={name:this._name,participant:this._localParticipant.getState(),peer_connections:this._peerConnectionManager.getStates(),type:e,version:Am};return n.type==="connect"?(n.ice_servers=this._iceServersStatus,n.publisher={name:L7,sdk_version:U7,user_agent:this._userAgent},this._bandwidthProfile&&(n.bandwidth_profile=V7(this._bandwidthProfile)),this._notifyWarnings&&(n.participant.media_warnings=$7(this._notifyWarnings)),n.media_signaling=F7(this._dominantSpeaker,this._networkQuality,this._trackPriority,this._trackSwitchOff,this._adaptiveSimulcast,this._renderHints),n.subscribe=z7(this._automaticSubscription),n.format=j7,n.token=this._accessToken):n.type==="sync"?(n.session=this._session,n.token=this._accessToken):n.type==="update"&&(n.session=this._session),n},r.prototype._createIceMessage=function(){return{edge:"roaming",token:this._accessToken,type:"ice",version:Y7}},r.prototype._sendConnectOrSyncOrDisconnectMessage=function(){var e=this._createConnectOrSyncOrDisconnectMessage();e&&this._twilioConnection.sendMessage(e)},r.prototype.disconnect=function(e){return this.state!=="disconnected"?(this.preempt("disconnected",null,[e]),this._sendConnectOrSyncOrDisconnectMessage(),this._twilioConnection.close(),!0):!1},r.prototype.publish=function(e){switch(this.state){case"connected":return this._twilioConnection.sendMessage(Object.assign({session:this._session,type:"update",version:Am},e)),!0;case"connecting":case"syncing":return this._updatesToSend.push(e),!0;case"disconnected":default:return!1}},r.prototype.publishEvent=function(e,n,i,a){this._eventObserver.emit("event",{group:e,name:n,level:i,payload:a})},r.prototype.sync=function(){return this.state==="connected"?(this.preempt("syncing"),this._sendConnectOrSyncOrDisconnectMessage(),!0):!1},r.prototype._setSession=function(e,n){this._session=e,this._sessionTimeoutMS=n*1e3},r.prototype._getReconnectTimer=function(){var e=this;return this._sessionTimeoutMS===0?null:(this._sessionTimer||(this._sessionTimer=new D7(function(){e._sessionTimer&&(e._sessionTimeoutMS=0)},this._sessionTimeoutMS)),new Promise(function(n){e._reconnectBackoff.backoff(n)}))},r.prototype._clearReconnectTimer=function(){this._reconnectBackoff.reset(),this._sessionTimer&&(this._sessionTimer.clear(),this._sessionTimer=null)},r}(A7);function V2(t){return Array.from(t.reduce(function(r,e){var n=r.get(e.id)||e;return(!n.description&&e.description||n.description&&e.description&&e.description.revision>n.description.revision)&&(n.description=e.description),(!n.ice&&e.ice||n.ice&&e.ice&&e.ice.revision>n.ice.revision)&&(n.ice=e.ice),r.set(n.id,n),r},new Map).values())}function J7(t){return t.reduce(function(r,e){return(!r.participant&&e.participant||r.participant&&e.participant&&e.participant.revision>r.participant.revision)&&(r.participant=e.participant),!r.peer_connections&&e.peer_connections?r.peer_connections=V2(e.peer_connections):r.peer_connections&&e.peer_connections&&(r.peer_connections=V2(r.peer_connections.concat(e.peer_connections))),r},{})}function X7(t){function r(){if(t.state!=="disconnected"){t._twilioConnection&&t._twilioConnection.removeListener("message",n);var u=t._iceServersStatus,l=t._options,c=t._wsServer,f=t.state,d=l.TwilioConnection,v=new d(c,Object.assign({helloBody:f==="connecting"&&u==="acquire"?t._createIceMessage():t._createConnectOrSyncOrDisconnectMessage()},l));v.once("close",function(p){p===d.CloseReason.LOCAL?e():e(new Error(p))}),v.on("message",n),t._twilioConnection=v}}function e(u){if(t.state!=="disconnected"){if(!u){t.disconnect();return}var l=t._getReconnectTimer();if(!l){var c=u.message===j2.CloseReason.BUSY?new Q7:new q7;t.disconnect(c);return}t.state==="connected"&&t.preempt("syncing"),l.then(r)}}function n(u){if(t.state!=="disconnected"){if(u.type==="error"){t.disconnect(Z7(u.code,u.message));return}switch(t.state){case"connected":switch(u.type){case"connected":case"synced":case"update":case"warning":t.emit("message",u);return;case"disconnected":t.disconnect(u.status==="completed"?new Nm:null);return;default:return}case"connecting":switch(u.type){case"iced":t._options.onIced(u.ice_servers).then(function(){t._sendConnectOrSyncOrDisconnectMessage()});return;case"connected":t._setSession(u.session,u.options.session_timeout),t.emit("connected",u),t.preempt("connected");return;case"synced":case"update":t._updatesReceived.push(u);return;case"disconnected":t.disconnect(u.status==="completed"?new Nm:null);return;default:return}case"syncing":switch(u.type){case"connected":case"update":t._updatesReceived.push(u);return;case"synced":t._clearReconnectTimer(),t.emit("message",u),t.preempt("connected");return;case"disconnected":t.disconnect(u.status==="completed"?new Nm:null);return;default:return}default:return}}}t.on("stateChanged",function u(l){switch(l){case"connected":{var c=t._updatesToSend.splice(0);c.length&&t.publish(J7(c)),t._updatesReceived.splice(0).forEach(function(f){return t.emit("message",f)});return}case"disconnected":t._twilioConnection.removeListener("message",n),t.removeListener("stateChanged",u);return;case"syncing":return;default:return}});var i=t._options,a=t._iceServersStatus,o=i.iceServers,s=i.onIced;a==="overrode"?s(o).then(r):r()}var K7=H7,eQ=tm,tQ=iZ,rQ=O7,nQ=K7,F2=lt,iQ=F2.SignalingConnectionDisconnectedError,aQ=F2.SignalingIncomingMessageInvalidError,$2=at,oQ=$2.flatMap,sQ=$2.createRoomConnectEventPayload;function uQ(t,r,e,n,i,a){a=Object.assign({PeerConnectionManager:tQ,RoomV2:rQ,Transport:nQ},a);var o=i.video[0]&&i.video[0].adaptiveSimulcast===!0,s=a.PeerConnectionManager,u=a.RoomV2,l=a.Transport,c=a.iceServers,f=a.log,d=new s(n,i,a),v=oQ(e.tracks,function(I){return[I.trackTransceiver]});d.setTrackSenders(v);var p=new Error("Canceled"),y,k=new eQ(function(I,C,L){var R=function(et){return L()?(C(p),Promise.reject(p)):(f.debug("Got ICE servers:",et),a.iceServers=et,d.setConfiguration(a),d.createAndOffer().then(function(){if(L())throw C(p),p;f.debug("createAndOffer() succeeded."),d.dequeue("description")}).catch(function(dt){throw f.error("createAndOffer() failed:",dt),C(dt),dt}))},q=a.automaticSubscription,z=a.bandwidthProfile,F=a.dominantSpeaker,D=a.environment,W=a.eventObserver,X=a.loggerName,me=a.logLevel,de=a.name,H=a.networkMonitor,ee=a.networkQuality,Z=a.notifyWarnings,te=a.realm,re=a.sdpSemantics,K=!!z,fe=!!z,Te=!!z&&(a.clientTrackSwitchOffControl!=="disabled"||a.contentPreferencesMode!=="disabled"),$=Object.assign({adaptiveSimulcast:o,automaticSubscription:q,dominantSpeaker:F,environment:D,eventObserver:W,loggerName:X,logLevel:me,networkMonitor:H,networkQuality:ee,notifyWarnings:Z,iceServers:c,onIced:R,realm:te,renderHints:Te,sdpSemantics:re,trackPriority:K,trackSwitchOff:fe},z?{bandwidthProfile:z}:{});y=new l(de,t,e,d,r,$);var We=sQ(a);W.emit("event",We),y.once("connected",function(et){if(f.debug("Transport connected:",et),L()){C(p);return}var dt=et.participant;if(!dt){C(new aQ);return}I(new u(e,et,y,d,a))}),y.once("stateChanged",function(et,dt){et==="disconnected"?(y=null,C(dt||new iQ)):f.debug("Transport state changed:",et)})},function(){y&&(y.disconnect(),y=null)});return k.catch(function(){y&&(y.disconnect(),y=null),d.close()}),k}var lQ=uQ,cQ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),fQ=Cm,dQ=function(t){cQ(r,t);function r(){var e=t.call(this)||this;return Object.defineProperties(e,{_publicationsToTrackSenders:{value:new Map},_trackSendersToPublications:{value:new Map}}),e}return r.prototype.addTrack=function(e,n,i,a){a===void 0&&(a=null);var o=this._createLocalTrackPublicationSignaling(e,n,i,a);return this._trackSendersToPublications.set(e,o),this._publicationsToTrackSenders.set(o,e),t.prototype.addTrack.call(this,o),this},r.prototype.getPublication=function(e){return this._trackSendersToPublications.get(e)||null},r.prototype.getSender=function(e){return this._publicationsToTrackSenders.get(e)||null},r.prototype.removeTrack=function(e){var n=this._trackSendersToPublications.get(e);if(!n)return null;this._trackSendersToPublications.delete(e),this._publicationsToTrackSenders.delete(n);var i=t.prototype.removeTrack.call(this,n);return i&&n.stop(),n},r}(fQ),pQ=dQ,vQ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),hQ=I2,mQ=function(t){vQ(r,t);function r(e,n,i){var a=this;e=e.clone();var o=e.kind==="data"?!0:e.track.enabled;return a=t.call(this,n,e.kind,o,i)||this,a.setTrackTransceiver(e),Object.defineProperties(a,{_updatedPriority:{value:i,writable:!0},id:{enumerable:!0,value:e.id}}),a}return Object.defineProperty(r.prototype,"updatedPriority",{get:function(){return this._updatedPriority},enumerable:!1,configurable:!0}),r.prototype.enable=function(e){return e=typeof e=="boolean"?e:!0,this.trackTransceiver.track.enabled=e,t.prototype.enable.call(this,e)},r.prototype.publishFailed=function(e){return gQ(this,e)&&this.emit("updated"),this},r.prototype.setPriority=function(e){return this._updatedPriority!==e&&(this._updatedPriority=e,this.emit("updated")),this},r.prototype.setSid=function(e){return this._error?this:t.prototype.setSid.call(this,e)},r.prototype.stop=function(){this.trackTransceiver.stop()},r}(hQ);function gQ(t,r){return t._sid!==null||t._error?!1:(t._error=r,!0)}var yQ=mQ,bQ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),_Q=yQ,wQ=uw,kQ=lt.createTwilioError,TQ=function(t){bQ(r,t);function r(e,n,i,a,o){var s=t.call(this,e,n,i)||this;return Object.defineProperties(s,{_log:{value:o.log.createLog("default",s)},_mediaStates:{value:{recordings:null},writable:!0},_noiseCancellationVendor:{value:a}}),s}return r.prototype.getState=function(){var e={enabled:this.isEnabled,id:this.id,kind:this.kind,name:this.name,priority:this.updatedPriority};return this._noiseCancellationVendor&&(e.audio_processor=this._noiseCancellationVendor),e},r.prototype.toString=function(){return"[LocalTrackPublicationV2: "+this.sid+"]"},r.prototype.update=function(e){switch(e.state){case"ready":this.setSid(e.sid);break;case"failed":{var n=e.error;this.publishFailed(kQ(n.code,n.message));break}}return this},r.prototype.updateMediaStates=function(e){if(!e||!e.recordings||this._mediaStates.recordings===e.recordings)return this;switch(this._mediaStates.recordings=e.recordings,this._mediaStates.recordings){case"OK":this._log.info("Warnings have cleared."),this.emit("warningsCleared");break;case"NO_MEDIA":this._log.warn("Recording media lost."),this.emit("warning",wQ.recordingMediaLost);break;default:this._log.warn("Unknown media state detected: "+this._mediaStates.recordings);break}return this},r}(_Q),SQ=TQ,EQ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),MQ=pQ,CQ=SQ,RQ=fr.DEFAULT_LOG_LEVEL,IQ=na,z2=at,OQ=z2.buildLogLevels,NQ=z2.isDeepEqual,AQ=function(t){EQ(r,t);function r(e,n,i){var a=this;i=Object.assign({logLevel:RQ,LocalTrackPublicationV2:CQ},i),a=t.call(this)||this;var o=OQ(i.logLevel);return Object.defineProperties(a,{_bandwidthProfile:{value:null,writable:!0},_bandwidthProfileRevision:{value:0,writable:!0},_encodingParameters:{value:e},_removeListeners:{value:new Map},_LocalTrackPublicationV2:{value:i.LocalTrackPublicationV2},_log:{value:i.log?i.log.createLog("default",a):new IQ("default",a,o,i.loggerName)},_publishedRevision:{writable:!0,value:0},_revision:{writable:!0,value:1},_signalingRegion:{value:null,writable:!0},audioProcessors:{value:[],writable:!0},bandwidthProfile:{enumerable:!0,get:function(){return this._bandwidthProfile}},bandwidthProfileRevision:{enumerable:!0,get:function(){return this._bandwidthProfileRevision}},networkQualityConfiguration:{enumerable:!0,value:n},revision:{enumerable:!0,get:function(){return this._revision}},signalingRegion:{enumerable:!0,get:function(){return this._signalingRegion}}}),a}return r.prototype.toString=function(){return"[LocalParticipantSignaling: "+this.sid+"]"},r.prototype.setSignalingRegion=function(e){this._signalingRegion||(this._signalingRegion=e)},r.prototype.setBandwidthProfile=function(e){NQ(this._bandwidthProfile,e)||(this._bandwidthProfile=JSON.parse(JSON.stringify(e)),this._bandwidthProfileRevision++,this.didUpdate())},r.prototype.setAudioProcessors=function(e){this.audioProcessors=e},r.prototype.getParameters=function(){return this._encodingParameters},r.prototype.setParameters=function(e){return this._encodingParameters.update(e),this},r.prototype.update=function(e){return this._publishedRevision>=e.revision?this:(this._publishedRevision=e.revision,e.tracks.forEach(function(n){var i=this.tracks.get(n.id);i&&i.update(n)},this),this)},r.prototype.updateMediaStates=function(e){return!e||!e.tracks?this:(Array.from(this.tracks.values()).forEach(function(n){var i=e.tracks[n.sid];i&&n.updateMediaStates(i)}),this)},r.prototype._createLocalTrackPublicationSignaling=function(e,n,i,a){return new this._LocalTrackPublicationV2(e,n,i,a,{log:this._log})},r.prototype.addTrack=function(e,n,i,a){var o=this;t.prototype.addTrack.call(this,e,n,i,a);var s=this.getPublication(e),u=s.isEnabled,l=s.updatedPriority,c=function(){(u!==s.isEnabled||l!==s.updatedPriority)&&(o.didUpdate(),u=s.isEnabled,l=s.updatedPriority)};return s.on("updated",c),this._removeListener(s),this._removeListeners.set(s,function(){return s.removeListener("updated",c)}),this.didUpdate(),this},r.prototype._removeListener=function(e){var n=this._removeListeners.get(e);n&&n()},r.prototype.getState=function(){return{revision:this.revision,tracks:Array.from(this.tracks.values()).map(function(e){return e.getState()})}},r.prototype.didUpdate=function(){this._revision++,this.emit("updated")},r.prototype.removeTrack=function(e){var n=t.prototype.removeTrack.call(this,e);return n&&(e.removeClone(n.trackTransceiver),this._removeListener(n),this.didUpdate()),n},r.prototype.setNetworkQualityConfiguration=function(e){this.networkQualityConfiguration.update(e)},r.prototype.setPublisherHint=function(e,n){var i=Array.from(this.tracks.values()).find(function(a){return a.sid===e});return i?i.trackTransceiver.setPublisherHint(n):(this._log.warn("track:"+e+" not found"),Promise.resolve("UNKNOWN_TRACK"))},r}(MQ),PQ=AQ,xQ=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),DQ=Cm,LQ=M2,UQ=Ns,jQ={closed:["opening"],opening:["closed","open"],open:["closed","closing"],closing:["closed","open"]},VQ=function(t){xQ(r,t);function r(){return t.call(this,"closed",jQ)||this}return r.prototype._close=function(e){return this.transition("closing",e),this.transition("closed",e),Promise.resolve(this)},r.prototype._connect=function(e,n,i,a,o){e.connect("PA00000000000000000000000000000000","test");var s="RM00000000000000000000000000000000",u=Promise.resolve(new LQ(e,s,o));return u.cancel=function(){},u},r.prototype._open=function(e){return this.transition("opening",e),this.transition("open",e),Promise.resolve(this)},r.prototype.close=function(){var e=this;return this.bracket("close",function(n){switch(e.state){case"closed":return e;case"open":return e._close(n);default:throw new Error('Unexpected Signaling state "'+e.state+'"')}})},r.prototype.connect=function(e,n,i,a,o){var s=this;return this.bracket("connect",function u(l){switch(s.state){case"closed":return s._open(l).then(u.bind(null,l));case"open":return s.releaseLockCompletely(l),s._connect(e,n,i,a,o);default:throw new Error('Unexpected Signaling state "'+s.state+'"')}})},r.prototype.createLocalParticipantSignaling=function(){return new DQ},r.prototype.open=function(){var e=this;return this.bracket("open",function(n){switch(e.state){case"closed":return e._open(n);case"open":return e;default:throw new Error('Unexpected Signaling state "'+e.state+'"')}})},r}(UQ),FQ=VQ,$Q=V&&V.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),zQ=lQ,WQ=PQ,BQ=FQ,ZQ=function(t){$Q(r,t);function r(e,n){var i=this;return n=Object.assign({createCancelableRoomSignalingPromise:zQ},n),i=t.call(this)||this,Object.defineProperties(i,{_createCancelableRoomSignalingPromise:{value:n.createCancelableRoomSignalingPromise},_options:{value:n},_wsServer:{value:e}}),i}return r.prototype._connect=function(e,n,i,a,o){return o=Object.assign({},this._options,o),this._createCancelableRoomSignalingPromise.bind(null,n,this._wsServer,e,i,a,o)},r.prototype.createLocalParticipantSignaling=function(e,n){return new WQ(e,n)},r}(BQ),qQ=ZQ,QQ=Io.MediaStreamTrack,Pm=hr,YQ=Pm.guessBrowser,GQ=Pm.guessBrowserVersion,HQ=Pm.isCodecSupported,JQ=x$,XQ=j$,KQ=z6,eY=uS,tY=B6,xm=Rs,rY=xm.LocalAudioTrack,nY=xm.LocalDataTrack,iY=xm.LocalVideoTrack,aY=G6,oY=$W,sY=qQ,od=at,uY=od.asLocalTrack,lY=od.buildLogLevels,cY=od.filterObject,W2=od.isNonArrayObject,oa=fr,fY=oa.DEFAULT_ENVIRONMENT,dY=oa.DEFAULT_LOG_LEVEL,pY=oa.DEFAULT_LOGGER_NAME,vY=oa.DEFAULT_REALM,hY=oa.DEFAULT_REGION,mY=oa.WS_SERVER,gY=oa.SDK_NAME,yY=oa.SDK_VERSION,sd=oa.typeErrors,Lo=tm,bY=iS,_Y=na,wY=ul.validateBandwidthProfile,Dm=YQ()==="safari"&&GQ(),kY=0,B2=!1,Z2=!1;if(Dm){var q2=Dm.major,TY=Dm.minor;Z2=q2<12||q2===12&&TY<1}var SY=new Set([{didWarn:!1,shouldDelete:!0,name:"abortOnIceServersTimeout"},{didWarn:!1,shouldDelete:!0,name:"dscpTagging",newName:"enableDscp"},{didWarn:!1,shouldDelete:!0,name:"iceServersTimeout"},{didWarn:!1,shouldDelete:!1,name:"eventListener",newName:"Video.Logger"},{didWarn:!1,shouldDelete:!1,name:"logLevel",newName:"Video.Logger"}]),EY=new Set([{didWarn:!1,shouldDelete:!1,name:"maxTracks",newName:"bandwidthProfile.video.clientTrackSwitchOffControl"},{didWarn:!1,shouldDelete:!1,name:"renderDimensions",newName:"bandwidthProfile.video.contentPreferencesMode"}]);function MY(t,r){if(typeof r>"u"&&(r={}),!W2(r))return Lo.reject(sd.INVALID_TYPE("options","object"));var e=r.Log||_Y,n=r.loggerName||pY,i=r.logLevel||dY,a=lY(i),o="[connect #"+ ++kY+"]",s;try{s=new e("default",o,a,n)}catch(z){return Lo.reject(z)}Q2(r,s,SY);var u=r.preferredVideoCodecs==="auto";if(u&&(r.preferredVideoCodecs=[{codec:"VP8",simulcast:!0,adaptiveSimulcast:!0}]),r.maxVideoBitrate&&u)return s.error('ConnectOptions "maxVideoBitrate" is not compatible with "preferredVideoCodecs=auto"'),Lo.reject(sd.ILLEGAL_INVOKE("connect",'ConnectOptions "maxVideoBitrate" is not compatible with "preferredVideoCodecs=auto"'));r=Object.assign({automaticSubscription:!0,dominantSpeaker:!1,enableDscp:!1,environment:fY,eventListener:null,insights:!0,LocalAudioTrack:rY,LocalDataTrack:nY,LocalParticipant:KQ,LocalVideoTrack:iY,Log:e,MediaStreamTrack:QQ,loggerName:n,logLevel:i,maxAudioBitrate:null,maxVideoBitrate:null,name:null,networkMonitor:!0,networkQuality:!1,preferredAudioCodecs:[],preferredVideoCodecs:[],realm:vY,region:hY,signaling:sY},cY(r));var l={};typeof r.wsServerInsights=="string"&&(l.gateway=r.wsServerInsights);var c=r.insights?eY:tY,f=new c(t,gY,yY,r.environment,r.realm,l),d=mY(r.environment,r.region),v=new bY(f,Date.now(),s,r.eventListener);if(r=Object.assign({eventObserver:v,wsServer:d},r),r.log=s,Z2&&!B2&&s.logLevel!=="error"&&s.logLevel!=="off"&&(B2=!0,s.warn(["Support for Safari 12.0 and below is limited because it does not support VP8.","This means you may experience codec issues in Group Rooms. You may also","experience codec issues in Peer-to-Peer (P2P) Rooms containing Android- or","iOS-based Participants who do not support H.264. However, P2P Rooms","with browser-based Participants should work. For more information, please","refer to this guide: https://www.twilio.com/docs/video/javascript-v2-developing-safari-11"].join(" "))),typeof t!="string")return Lo.reject(sd.INVALID_TYPE("token","string"));var p=Object.assign({},r);if(delete p.name,"tracks"in r){if(!Array.isArray(r.tracks))return Lo.reject(sd.INVALID_TYPE("options.tracks","Array of LocalAudioTrack, LocalVideoTrack or MediaStreamTrack"));try{r.tracks=r.tracks.map(function(z){return uY(z,p)})}catch(z){return Lo.reject(z)}}var y=wY(r.bandwidthProfile);if(y)return Lo.reject(y);r.clientTrackSwitchOffControl="disabled",r.contentPreferencesMode="disabled",r.bandwidthProfile&&(r.clientTrackSwitchOffControl="auto",r.contentPreferencesMode="auto",r.bandwidthProfile.video&&(Q2(r.bandwidthProfile.video,s,EY),"maxTracks"in r.bandwidthProfile.video?r.clientTrackSwitchOffControl="disabled":r.bandwidthProfile.video.clientTrackSwitchOffControl==="manual"?r.clientTrackSwitchOffControl="manual":r.clientTrackSwitchOffControl="auto","renderDimensions"in r.bandwidthProfile.video?r.contentPreferencesMode="disabled":r.bandwidthProfile.video.contentPreferencesMode==="manual"?r.contentPreferencesMode="manual":r.contentPreferencesMode="auto"));var k=r.signaling,I=new k(r.wsServer,r);s.info("Connecting to a Room"),s.debug("Options:",r);var C=new XQ({maxAudioBitrate:r.maxAudioBitrate,maxVideoBitrate:r.maxVideoBitrate},u),L={audio:r.preferredAudioCodecs.map(Y2),video:r.preferredVideoCodecs.map(Y2)},R=new aY(W2(r.networkQuality)?r.networkQuality:{});["audio","video"].forEach(function(z){return L[z].forEach(function(F){var D=F.codec;return HQ(D,z).then(function(W){return!W&&s.warn("The preferred "+z+' codec "'+D+'" will be ignored as it is not supported by the browser.')})})});var q=JQ(OY.bind(null,r),CY.bind(null,I,s,C,R,r),IY.bind(null,t,r,I,C,L),RY.bind(null,r));return q.then(function(z){return f.connect(z.sid,z.localParticipant.sid),s.info("Connected to Room:",z.toString()),s.info("Room name:",z.name),s.debug("Room:",z),z.once("disconnected",function(){return f.disconnect()}),z},function(z){f.disconnect(),q._isCanceled?s.info("Attempt to connect to a Room was canceled"):s.info("Error while connecting to a Room:",z)}),q}function Q2(t,r,e){e.forEach(function(n){var i=n.didWarn,a=n.name,o=n.newName,s=n.shouldDelete;a in t&&typeof t[a]<"u"&&(o&&s&&(t[o]=t[a]),s&&delete t[a],!i&&!["error","off"].includes(r.level)&&(r.warn('The ConnectOptions "'+a+'" is '+(o?'deprecated and scheduled for removal. Please use "'+o+'" instead.':"no longer applicable and will be ignored.")),n.didWarn=!0))})}function CY(t,r,e,n,i,a){var o=t.createLocalParticipantSignaling(e,n);return r.debug("Creating a new LocalParticipant:",o),new i.LocalParticipant(o,a,i)}function RY(t,r,e){var n=new oY(r,e,t),i=t.log;return i.debug("Creating a new Room:",n),e.on("stateChanged",function a(o){o==="disconnected"&&(i.info("Disconnected from Room:",n.toString()),e.removeListener("stateChanged",a))}),n}function IY(t,r,e,n,i,a){return r.log.debug("Creating a new RoomSignaling"),e.connect(a._signaling,t,n,i,r)}function OY(t,r){var e=t.log;return t.shouldStopLocalTracks=!t.tracks,t.shouldStopLocalTracks?e.info("LocalTracks were not provided, so they will be acquired automatically before connecting to the Room. LocalTracks will be released if connecting to the Room fails or if the Room is disconnected"):(e.info("Getting LocalTracks"),e.debug("Options:",t)),t.createLocalTracks(t).then(function(i){var a=r(i);return a.catch(function(){t.shouldStopLocalTracks&&(e.info("The automatically acquired LocalTracks will now be stopped"),i.forEach(function(s){s.stop()}))}),a})}function Y2(t){var r=typeof t=="string"?{codec:t}:t;switch(r.codec.toLowerCase()){case"opus":return Object.assign({dtx:!0},r);case"vp8":return Object.assign({simulcast:!1},r);default:return r}}var NY=MY,G2=fr,AY=G2.DEFAULT_LOG_LEVEL,PY=G2.DEFAULT_LOGGER_NAME;function H2(t,r){r=Object.assign({loggerName:PY,logLevel:AY},r);var e={};e.loggerName=r.loggerName,e.logLevel=r.logLevel,delete r.loggerName,delete r.logLevel;var n=r.createLocalTracks;return delete r.createLocalTracks,e[t]=Object.keys(r).length>0?r:!0,n(e).then(function(i){return i[0]})}function xY(t){return H2("audio",t)}function DY(t){return H2("video",t)}var J2={audio:xY,video:DY},X2=hr,LY=X2.guessBrowser,UY=X2.support,jY=yn.getSdpFormat,bl=Oo,VY=bl.isAndroid,FY=bl.isMobile,$Y=bl.isNonChromiumEdge,zY=bl.rebrandedChromeBrowser,WY=bl.mobileWebKitBrowser,BY=["crios","edg","edge","electron","headlesschrome"],ZY=["chrome","firefox"],qY=["chrome","safari"],QY=[];function YY(){var t=LY();if(!t)return!1;var r=zY(t),e=WY(t),n=VY()?ZY:qY;return!!t&&UY()&&jY()==="unified"&&(!r||BY.includes(r))&&!$Y(t)&&(!e||QY.includes(e))&&(!FY()||n.includes(t))}var GY=YY,_l=V&&V.__assign||function(){return _l=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++){r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},_l.apply(this,arguments)};Object.defineProperty(Ss,"__esModule",{value:!0});var ud=_f,HY=Is,sa={connect:NY,createLocalAudioTrack:J2.audio,createLocalVideoTrack:J2.video,isSupported:GY(),version:Y1.version,Logger:Q1,LocalAudioTrack:Rs.LocalAudioTrack,LocalDataTrack:Rs.LocalDataTrack,LocalVideoTrack:Rs.LocalVideoTrack};function JY(t,r){var e=_l({createLocalTracks:ud.createLocalTracks},r);return sa.connect(t,e)}function XY(t){var r=_l({createLocalTracks:ud.createLocalTracks},t);return sa.createLocalAudioTrack(r)}function KY(t){var r=_l({createLocalTracks:ud.createLocalTracks},t);return sa.createLocalVideoTrack(r)}var eG=sa.isSupported,tG=sa.version,rG=sa.Logger,nG=sa.LocalAudioTrack,iG=sa.LocalVideoTrack,aG=sa.LocalDataTrack;aL.exports={connect:JY,createLocalAudioTrack:XY,createLocalVideoTrack:KY,createLocalTracks:ud.createLocalTracks,runPreflight:HY.runPreflight,isSupported:eG,version:tG,Logger:rG,LocalAudioTrack:nG,LocalVideoTrack:iG,LocalDataTrack:aG};const oG=()=>`rgb(${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)}, 0.5)`,K2=(t,r)=>`<svg width="100%" height="100%" viewBox="0 0 100 100">${r?`<image href="${r}" width="100" height="100" clip-path="circle(49px at 50% 50%)" />`:`<circle cx="50" cy="50" r="50" fill="${oG()}" />
       <text x="50" y="50" fill="white" text-anchor="middle" dominant-baseline="central" font-weight="900" 
       font-size="50">${t}</text>`}</svg>`;var eE={},ld=function(t){return t&&t.Math==Math&&t},zt=ld(typeof globalThis=="object"&&globalThis)||ld(typeof window=="object"&&window)||ld(typeof self=="object"&&self)||ld(typeof V=="object"&&V)||function(){return this}()||V||Function("return this")(),Ni={},Ot=function(t){try{return!!t()}catch{return!0}},sG=Ot,wr=!sG(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),uG=Ot,wl=!uG(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),lG=wl,cd=Function.prototype.call,dr=lG?cd.bind(cd):function(){return cd.apply(cd,arguments)},kl={},tE={}.propertyIsEnumerable,rE=Object.getOwnPropertyDescriptor,cG=rE&&!tE.call({1:2},1);kl.f=cG?function(r){var e=rE(this,r);return!!e&&e.enumerable}:tE;var Uo=function(t,r){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:r}},nE=wl,iE=Function.prototype,Lm=iE.call,fG=nE&&iE.bind.bind(Lm,Lm),Dt=nE?fG:function(t){return function(){return Lm.apply(t,arguments)}},aE=Dt,dG=aE({}.toString),pG=aE("".slice),Ai=function(t){return pG(dG(t),8,-1)},vG=Dt,hG=Ot,mG=Ai,Um=Object,gG=vG("".split),Tl=hG(function(){return!Um("z").propertyIsEnumerable(0)})?function(t){return mG(t)=="String"?gG(t,""):Um(t)}:Um,Pi=function(t){return t==null},yG=Pi,bG=TypeError,xi=function(t){if(yG(t))throw bG("Can't call method on "+t);return t},_G=Tl,wG=xi,Rn=function(t){return _G(wG(t))},jm=typeof document=="object"&&document.all,kG=typeof jm>"u"&&jm!==void 0,oE={all:jm,IS_HTMLDDA:kG},sE=oE,TG=sE.all,sr=sE.IS_HTMLDDA?function(t){return typeof t=="function"||t===TG}:function(t){return typeof t=="function"},uE=sr,lE=oE,SG=lE.all,Sr=lE.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:uE(t)||t===SG}:function(t){return typeof t=="object"?t!==null:uE(t)},Vm=zt,EG=sr,MG=function(t){return EG(t)?t:void 0},fi=function(t,r){return arguments.length<2?MG(Vm[t]):Vm[t]&&Vm[t][r]},CG=Dt,ua=CG({}.isPrototypeOf),jo=typeof navigator<"u"&&String(navigator.userAgent)||"",cE=zt,Fm=jo,fE=cE.process,dE=cE.Deno,pE=fE&&fE.versions||dE&&dE.version,vE=pE&&pE.v8,di,fd;vE&&(di=vE.split("."),fd=di[0]>0&&di[0]<4?1:+(di[0]+di[1])),!fd&&Fm&&(di=Fm.match(/Edge\/(\d+)/),(!di||di[1]>=74)&&(di=Fm.match(/Chrome\/(\d+)/),di&&(fd=+di[1])));var zs=fd,hE=zs,RG=Ot,IG=zt,OG=IG.String,Ws=!!Object.getOwnPropertySymbols&&!RG(function(){var t=Symbol();return!OG(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&hE&&hE<41}),NG=Ws,mE=NG&&!Symbol.sham&&typeof Symbol.iterator=="symbol",AG=fi,PG=sr,xG=ua,DG=mE,LG=Object,Bs=DG?function(t){return typeof t=="symbol"}:function(t){var r=AG("Symbol");return PG(r)&&xG(r.prototype,LG(t))},UG=String,Vo=function(t){try{return UG(t)}catch{return"Object"}},jG=sr,VG=Vo,FG=TypeError,$n=function(t){if(jG(t))return t;throw FG(VG(t)+" is not a function")},$G=$n,zG=Pi,Fo=function(t,r){var e=t[r];return zG(e)?void 0:$G(e)},$m=dr,zm=sr,Wm=Sr,WG=TypeError,BG=function(t,r){var e,n;if(r==="string"&&zm(e=t.toString)&&!Wm(n=$m(e,t))||zm(e=t.valueOf)&&!Wm(n=$m(e,t))||r!=="string"&&zm(e=t.toString)&&!Wm(n=$m(e,t)))return n;throw WG("Can't convert object to primitive value")},Qa={},ZG={get exports(){return Qa},set exports(t){Qa=t}},gE=!1,yE=zt,qG=Object.defineProperty,Bm=function(t,r){try{qG(yE,t,{value:r,configurable:!0,writable:!0})}catch{yE[t]=r}return r},QG=zt,YG=Bm,bE="__core-js_shared__",GG=QG[bE]||YG(bE,{}),Zm=GG,_E=Zm;(ZG.exports=function(t,r){return _E[t]||(_E[t]=r!==void 0?r:{})})("versions",[]).push({version:"3.31.0",mode:"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.0/LICENSE",source:"https://github.com/zloirock/core-js"});var HG=xi,JG=Object,en=function(t){return JG(HG(t))},XG=Dt,KG=en,eH=XG({}.hasOwnProperty),Er=Object.hasOwn||function(r,e){return eH(KG(r),e)},tH=Dt,rH=0,nH=Math.random(),iH=tH(1 .toString),Sl=function(t){return"Symbol("+(t===void 0?"":t)+")_"+iH(++rH+nH,36)},aH=zt,oH=Qa,wE=Er,sH=Sl,uH=Ws,lH=mE,Zs=aH.Symbol,qm=oH("wks"),cH=lH?Zs.for||Zs:Zs&&Zs.withoutSetter||sH,pr=function(t){return wE(qm,t)||(qm[t]=uH&&wE(Zs,t)?Zs[t]:cH("Symbol."+t)),qm[t]},fH=dr,kE=Sr,TE=Bs,dH=Fo,pH=BG,vH=pr,hH=TypeError,mH=vH("toPrimitive"),Qm=function(t,r){if(!kE(t)||TE(t))return t;var e=dH(t,mH),n;if(e){if(r===void 0&&(r="default"),n=fH(e,t,r),!kE(n)||TE(n))return n;throw hH("Can't convert object to primitive value")}return r===void 0&&(r="number"),pH(t,r)},gH=Qm,yH=Bs,El=function(t){var r=gH(t,"string");return yH(r)?r:r+""},bH=zt,SE=Sr,Ym=bH.document,_H=SE(Ym)&&SE(Ym.createElement),dd=function(t){return _H?Ym.createElement(t):{}},wH=wr,kH=Ot,TH=dd,EE=!wH&&!kH(function(){return Object.defineProperty(TH("div"),"a",{get:function(){return 7}}).a!=7}),SH=wr,EH=dr,MH=kl,CH=Uo,RH=Rn,IH=El,OH=Er,NH=EE,ME=Object.getOwnPropertyDescriptor;Ni.f=SH?ME:function(r,e){if(r=RH(r),e=IH(e),NH)try{return ME(r,e)}catch{}if(OH(r,e))return CH(!EH(MH.f,r,e),r[e])};var sn={},AH=wr,PH=Ot,CE=AH&&PH(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),xH=Sr,DH=String,LH=TypeError,Or=function(t){if(xH(t))return t;throw LH(DH(t)+" is not an object")},UH=wr,jH=EE,VH=CE,pd=Or,RE=El,FH=TypeError,Gm=Object.defineProperty,$H=Object.getOwnPropertyDescriptor,Hm="enumerable",Jm="configurable",Xm="writable";sn.f=UH?VH?function(r,e,n){if(pd(r),e=RE(e),pd(n),typeof r=="function"&&e==="prototype"&&"value"in n&&Xm in n&&!n[Xm]){var i=$H(r,e);i&&i[Xm]&&(r[e]=n.value,n={configurable:Jm in n?n[Jm]:i[Jm],enumerable:Hm in n?n[Hm]:i[Hm],writable:!1})}return Gm(r,e,n)}:Gm:function(r,e,n){if(pd(r),e=RE(e),pd(n),jH)try{return Gm(r,e,n)}catch{}if("get"in n||"set"in n)throw FH("Accessors not supported");return"value"in n&&(r[e]=n.value),r};var zH=wr,WH=sn,BH=Uo,la=zH?function(t,r,e){return WH.f(t,r,BH(1,e))}:function(t,r,e){return t[r]=e,t},vd={},ZH={get exports(){return vd},set exports(t){vd=t}},Km=wr,qH=Er,IE=Function.prototype,QH=Km&&Object.getOwnPropertyDescriptor,eg=qH(IE,"name"),YH=eg&&function(){}.name==="something",GH=eg&&(!Km||Km&&QH(IE,"name").configurable),Ml={EXISTS:eg,PROPER:YH,CONFIGURABLE:GH},HH=Dt,JH=sr,tg=Zm,XH=HH(Function.toString);JH(tg.inspectSource)||(tg.inspectSource=function(t){return XH(t)});var rg=tg.inspectSource,KH=zt,eJ=sr,OE=KH.WeakMap,tJ=eJ(OE)&&/native code/.test(String(OE)),rJ=Qa,nJ=Sl,NE=rJ("keys"),hd=function(t){return NE[t]||(NE[t]=nJ(t))},Cl={},iJ=tJ,AE=zt,aJ=Sr,oJ=la,ng=Er,ig=Zm,sJ=hd,uJ=Cl,PE="Object already initialized",ag=AE.TypeError,lJ=AE.WeakMap,md,Rl,gd,cJ=function(t){return gd(t)?Rl(t):md(t,{})},fJ=function(t){return function(r){var e;if(!aJ(r)||(e=Rl(r)).type!==t)throw ag("Incompatible receiver, "+t+" required");return e}};if(iJ||ig.state){var Di=ig.state||(ig.state=new lJ);Di.get=Di.get,Di.has=Di.has,Di.set=Di.set,md=function(t,r){if(Di.has(t))throw ag(PE);return r.facade=t,Di.set(t,r),r},Rl=function(t){return Di.get(t)||{}},gd=function(t){return Di.has(t)}}else{var qs=sJ("state");uJ[qs]=!0,md=function(t,r){if(ng(t,qs))throw ag(PE);return r.facade=t,oJ(t,qs,r),r},Rl=function(t){return ng(t,qs)?t[qs]:{}},gd=function(t){return ng(t,qs)}}var zn={set:md,get:Rl,has:gd,enforce:cJ,getterFor:fJ},og=Dt,dJ=Ot,pJ=sr,yd=Er,sg=wr,vJ=Ml.CONFIGURABLE,hJ=rg,xE=zn,mJ=xE.enforce,gJ=xE.get,DE=String,bd=Object.defineProperty,yJ=og("".slice),bJ=og("".replace),_J=og([].join),wJ=sg&&!dJ(function(){return bd(function(){},"length",{value:8}).length!==8}),kJ=String(String).split("String"),TJ=ZH.exports=function(t,r,e){yJ(DE(r),0,7)==="Symbol("&&(r="["+bJ(DE(r),/^Symbol\(([^)]*)\)/,"$1")+"]"),e&&e.getter&&(r="get "+r),e&&e.setter&&(r="set "+r),(!yd(t,"name")||vJ&&t.name!==r)&&(sg?bd(t,"name",{value:r,configurable:!0}):t.name=r),wJ&&e&&yd(e,"arity")&&t.length!==e.arity&&bd(t,"length",{value:e.arity});try{e&&yd(e,"constructor")&&e.constructor?sg&&bd(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=mJ(t);return yd(n,"source")||(n.source=_J(kJ,typeof r=="string"?r:"")),t};Function.prototype.toString=TJ(function(){return pJ(this)&&gJ(this).source||hJ(this)},"toString");var SJ=sr,EJ=sn,MJ=vd,CJ=Bm,un=function(t,r,e,n){n||(n={});var i=n.enumerable,a=n.name!==void 0?n.name:r;if(SJ(e)&&MJ(e,a,n),n.global)i?t[r]=e:CJ(r,e);else{try{n.unsafe?t[r]&&(i=!0):delete t[r]}catch{}i?t[r]=e:EJ.f(t,r,{value:e,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},Ya={},RJ=Math.ceil,IJ=Math.floor,OJ=Math.trunc||function(r){var e=+r;return(e>0?IJ:RJ)(e)},NJ=OJ,Li=function(t){var r=+t;return r!==r||r===0?0:NJ(r)},AJ=Li,PJ=Math.max,xJ=Math.min,$o=function(t,r){var e=AJ(t);return e<0?PJ(e+r,0):xJ(e,r)},DJ=Li,LJ=Math.min,ca=function(t){return t>0?LJ(DJ(t),9007199254740991):0},UJ=ca,Jr=function(t){return UJ(t.length)},jJ=Rn,VJ=$o,FJ=Jr,LE=function(t){return function(r,e,n){var i=jJ(r),a=FJ(i),o=VJ(n,a),s;if(t&&e!=e){for(;a>o;)if(s=i[o++],s!=s)return!0}else for(;a>o;o++)if((t||o in i)&&i[o]===e)return t||o||0;return!t&&-1}},_d={includes:LE(!0),indexOf:LE(!1)},$J=Dt,ug=Er,zJ=Rn,WJ=_d.indexOf,BJ=Cl,UE=$J([].push),jE=function(t,r){var e=zJ(t),n=0,i=[],a;for(a in e)!ug(BJ,a)&&ug(e,a)&&UE(i,a);for(;r.length>n;)ug(e,a=r[n++])&&(~WJ(i,a)||UE(i,a));return i},lg=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ZJ=jE,qJ=lg,QJ=qJ.concat("length","prototype");Ya.f=Object.getOwnPropertyNames||function(r){return ZJ(r,QJ)};var Il={};Il.f=Object.getOwnPropertySymbols;var YJ=fi,GJ=Dt,HJ=Ya,JJ=Il,XJ=Or,KJ=GJ([].concat),VE=YJ("Reflect","ownKeys")||function(r){var e=HJ.f(XJ(r)),n=JJ.f;return n?KJ(e,n(r)):e},FE=Er,eX=VE,tX=Ni,rX=sn,$E=function(t,r,e){for(var n=eX(r),i=rX.f,a=tX.f,o=0;o<n.length;o++){var s=n[o];!FE(t,s)&&!(e&&FE(e,s))&&i(t,s,a(r,s))}},nX=Ot,iX=sr,aX=/#|\.prototype\./,Ol=function(t,r){var e=sX[oX(t)];return e==lX?!0:e==uX?!1:iX(r)?nX(r):!!r},oX=Ol.normalize=function(t){return String(t).replace(aX,".").toLowerCase()},sX=Ol.data={},uX=Ol.NATIVE="N",lX=Ol.POLYFILL="P",wd=Ol,cg=zt,cX=Ni.f,fX=la,dX=un,pX=Bm,vX=$E,hX=wd,Lt=function(t,r){var e=t.target,n=t.global,i=t.stat,a,o,s,u,l,c;if(n?o=cg:i?o=cg[e]||pX(e,{}):o=(cg[e]||{}).prototype,o)for(s in r){if(l=r[s],t.dontCallGetSet?(c=cX(o,s),u=c&&c.value):u=o[s],a=hX(n?s:e+(i?".":"#")+s,t.forced),!a&&u!==void 0){if(typeof l==typeof u)continue;vX(l,u)}(t.sham||u&&u.sham)&&fX(l,"sham",!0),dX(o,s,l,t)}},mX=sn.f,gX=Er,yX=pr,zE=yX("toStringTag"),fa=function(t,r,e){t&&!e&&(t=t.prototype),t&&!gX(t,zE)&&mX(t,zE,{configurable:!0,value:r})},bX=Lt,_X=zt,wX=fa;bX({global:!0},{Reflect:{}}),wX(_X.Reflect,"Reflect",!0);var kX=wl,WE=Function.prototype,BE=WE.apply,ZE=WE.call,Ga=typeof Reflect=="object"&&Reflect.apply||(kX?ZE.bind(BE):function(){return ZE.apply(BE,arguments)}),TX=Dt,Qs=TX([].slice),qE=Dt,SX=$n,EX=Sr,MX=Er,QE=Qs,CX=wl,YE=Function,RX=qE([].concat),IX=qE([].join),fg={},OX=function(t,r,e){if(!MX(fg,r)){for(var n=[],i=0;i<r;i++)n[i]="a["+i+"]";fg[r]=YE("C,a","return new C("+IX(n,",")+")")}return fg[r](t,e)},NX=CX?YE.bind:function(r){var e=SX(this),n=e.prototype,i=QE(arguments,1),a=function(){var s=RX(i,QE(arguments));return this instanceof a?OX(e,s.length,s):e.apply(r,s)};return EX(n)&&(a.prototype=n),a},AX=pr,PX=AX("toStringTag"),GE={};GE[PX]="z";var dg=String(GE)==="[object z]",xX=dg,DX=sr,kd=Ai,LX=pr,UX=LX("toStringTag"),jX=Object,VX=kd(function(){return arguments}())=="Arguments",FX=function(t,r){try{return t[r]}catch{}},da=xX?kd:function(t){var r,e,n;return t===void 0?"Undefined":t===null?"Null":typeof(e=FX(r=jX(t),UX))=="string"?e:VX?kd(r):(n=kd(r))=="Object"&&DX(r.callee)?"Arguments":n},$X=Dt,zX=Ot,HE=sr,WX=da,BX=fi,ZX=rg,JE=function(){},qX=[],XE=BX("Reflect","construct"),pg=/^\s*(?:class|function)\b/,QX=$X(pg.exec),YX=!pg.exec(JE),Nl=function(r){if(!HE(r))return!1;try{return XE(JE,qX,r),!0}catch{return!1}},KE=function(r){if(!HE(r))return!1;switch(WX(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return YX||!!QX(pg,ZX(r))}catch{return!0}};KE.sham=!0;var Td=!XE||zX(function(){var t;return Nl(Nl.call)||!Nl(Object)||!Nl(function(){t=!0})||t})?KE:Nl,GX=Td,HX=Vo,JX=TypeError,vg=function(t){if(GX(t))return t;throw JX(HX(t)+" is not a constructor")},hg={},XX=jE,KX=lg,Al=Object.keys||function(r){return XX(r,KX)},eK=wr,tK=CE,rK=sn,nK=Or,iK=Rn,aK=Al;hg.f=eK&&!tK?Object.defineProperties:function(r,e){nK(r);for(var n=iK(e),i=aK(e),a=i.length,o=0,s;a>o;)rK.f(r,s=i[o++],n[s]);return r};var oK=fi,eM=oK("document","documentElement"),sK=Or,uK=hg,tM=lg,lK=Cl,cK=eM,fK=dd,dK=hd,rM=">",nM="<",mg="prototype",gg="script",iM=dK("IE_PROTO"),yg=function(){},aM=function(t){return nM+gg+rM+t+nM+"/"+gg+rM},oM=function(t){t.write(aM("")),t.close();var r=t.parentWindow.Object;return t=null,r},pK=function(){var t=fK("iframe"),r="java"+gg+":",e;return t.style.display="none",cK.appendChild(t),t.src=String(r),e=t.contentWindow.document,e.open(),e.write(aM("document.F=Object")),e.close(),e.F},Sd,Ed=function(){try{Sd=new ActiveXObject("htmlfile")}catch{}Ed=typeof document<"u"?document.domain&&Sd?oM(Sd):pK():oM(Sd);for(var t=tM.length;t--;)delete Ed[mg][tM[t]];return Ed()};lK[iM]=!0;var Ha=Object.create||function(r,e){var n;return r!==null?(yg[mg]=sK(r),n=new yg,yg[mg]=null,n[iM]=r):n=Ed(),e===void 0?n:uK.f(n,e)},vK=Lt,hK=fi,bg=Ga,mK=NX,sM=vg,gK=Or,uM=Sr,yK=Ha,lM=Ot,_g=hK("Reflect","construct"),bK=Object.prototype,_K=[].push,cM=lM(function(){function t(){}return!(_g(function(){},[],t)instanceof t)}),fM=!lM(function(){_g(function(){})}),dM=cM||fM;vK({target:"Reflect",stat:!0,forced:dM,sham:dM},{construct:function(r,e){sM(r),gK(e);var n=arguments.length<3?r:sM(arguments[2]);if(fM&&!cM)return _g(r,e,n);if(r==n){switch(e.length){case 0:return new r;case 1:return new r(e[0]);case 2:return new r(e[0],e[1]);case 3:return new r(e[0],e[1],e[2]);case 4:return new r(e[0],e[1],e[2],e[3])}var i=[null];return bg(_K,i,e),new(bg(mK,r,i))}var a=n.prototype,o=yK(uM(a)?a:bK),s=bg(r,o,e);return uM(s)?s:o}});var wK=Lt,kK=en,pM=Al,TK=Ot,SK=TK(function(){pM(1)});wK({target:"Object",stat:!0,forced:SK},{keys:function(r){return pM(kK(r))}});var EK=da,MK=String,Fr=function(t){if(EK(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return MK(t)},wg={},CK=El,RK=sn,IK=Uo,Ys=function(t,r,e){var n=CK(r);n in t?RK.f(t,n,IK(0,e)):t[n]=e},vM=$o,OK=Jr,NK=Ys,AK=Array,PK=Math.max,Pl=function(t,r,e){for(var n=OK(t),i=vM(r,n),a=vM(e===void 0?n:e,n),o=AK(PK(a-i,0)),s=0;i<a;i++,s++)NK(o,s,t[i]);return o.length=s,o},xK=Ai,DK=Rn,hM=Ya.f,LK=Pl,mM=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],UK=function(t){try{return hM(t)}catch{return LK(mM)}};wg.f=function(r){return mM&&xK(r)=="Window"?UK(r):hM(DK(r))};var gM=vd,jK=sn,Ui=function(t,r,e){return e.get&&gM(e.get,r,{getter:!0}),e.set&&gM(e.set,r,{setter:!0}),jK.f(t,r,e)},kg={},VK=pr;kg.f=VK;var FK=zt,yM=FK,bM=yM,$K=Er,zK=kg,WK=sn.f,_M=function(t){var r=bM.Symbol||(bM.Symbol={});$K(r,t)||WK(r,t,{value:zK.f(t)})},BK=dr,ZK=fi,qK=pr,QK=un,YK=function(){var t=ZK("Symbol"),r=t&&t.prototype,e=r&&r.valueOf,n=qK("toPrimitive");r&&!r[n]&&QK(r,n,function(i){return BK(e,this)},{arity:1})},GK=Ai,HK=Dt,Md=function(t){if(GK(t)==="Function")return HK(t)},wM=Md,JK=$n,XK=wl,KK=wM(wM.bind),pa=function(t,r){return JK(t),r===void 0?t:XK?KK(t,r):function(){return t.apply(r,arguments)}},eee=Ai,xl=Array.isArray||function(r){return eee(r)=="Array"},kM=xl,tee=Td,ree=Sr,nee=pr,iee=nee("species"),TM=Array,aee=function(t){var r;return kM(t)&&(r=t.constructor,tee(r)&&(r===TM||kM(r.prototype))?r=void 0:ree(r)&&(r=r[iee],r===null&&(r=void 0))),r===void 0?TM:r},oee=aee,Tg=function(t,r){return new(oee(t))(r===0?0:r)},see=pa,uee=Dt,lee=Tl,cee=en,fee=Jr,dee=Tg,SM=uee([].push),Ja=function(t){var r=t==1,e=t==2,n=t==3,i=t==4,a=t==6,o=t==7,s=t==5||a;return function(u,l,c,f){for(var d=cee(u),v=lee(d),p=see(l,c),y=fee(v),k=0,I=f||dee,C=r?I(u,y):e||o?I(u,0):void 0,L,R;y>k;k++)if((s||k in v)&&(L=v[k],R=p(L,k,d),t))if(r)C[k]=R;else if(R)switch(t){case 3:return!0;case 5:return L;case 6:return k;case 2:SM(C,L)}else switch(t){case 4:return!1;case 7:SM(C,L)}return a?-1:n||i?i:C}},In={forEach:Ja(0),map:Ja(1),filter:Ja(2),some:Ja(3),every:Ja(4),find:Ja(5),findIndex:Ja(6),filterReject:Ja(7)},Cd=Lt,Sg=zt,Eg=dr,pee=Dt,Gs=wr,Hs=Ws,vee=Ot,Br=Er,hee=ua,Mg=Or,Rd=Rn,Cg=El,mee=Fr,Rg=Uo,Dl=Ha,EM=Al,gee=Ya,MM=wg,yee=Il,CM=Ni,RM=sn,bee=hg,IM=kl,Ig=un,_ee=Ui,Og=Qa,wee=hd,OM=Cl,NM=Sl,kee=pr,Tee=kg,See=_M,Eee=YK,Mee=fa,AM=zn,Id=In.forEach,bn=wee("hidden"),Od="Symbol",Ll="prototype",Cee=AM.set,PM=AM.getterFor(Od),Wn=Object[Ll],zo=Sg.Symbol,Ul=zo&&zo[Ll],Ree=Sg.TypeError,Ng=Sg.QObject,xM=CM.f,Wo=RM.f,DM=MM.f,Iee=IM.f,LM=pee([].push),va=Og("symbols"),jl=Og("op-symbols"),Oee=Og("wks"),Ag=!Ng||!Ng[Ll]||!Ng[Ll].findChild,Pg=Gs&&vee(function(){return Dl(Wo({},"a",{get:function(){return Wo(this,"a",{value:7}).a}})).a!=7})?function(t,r,e){var n=xM(Wn,r);n&&delete Wn[r],Wo(t,r,e),n&&t!==Wn&&Wo(Wn,r,n)}:Wo,xg=function(t,r){var e=va[t]=Dl(Ul);return Cee(e,{type:Od,tag:t,description:r}),Gs||(e.description=r),e},Nd=function(r,e,n){r===Wn&&Nd(jl,e,n),Mg(r);var i=Cg(e);return Mg(n),Br(va,i)?(n.enumerable?(Br(r,bn)&&r[bn][i]&&(r[bn][i]=!1),n=Dl(n,{enumerable:Rg(0,!1)})):(Br(r,bn)||Wo(r,bn,Rg(1,{})),r[bn][i]=!0),Pg(r,i,n)):Wo(r,i,n)},Dg=function(r,e){Mg(r);var n=Rd(e),i=EM(n).concat(VM(n));return Id(i,function(a){(!Gs||Eg(Lg,n,a))&&Nd(r,a,n[a])}),r},Nee=function(r,e){return e===void 0?Dl(r):Dg(Dl(r),e)},Lg=function(r){var e=Cg(r),n=Eg(Iee,this,e);return this===Wn&&Br(va,e)&&!Br(jl,e)?!1:n||!Br(this,e)||!Br(va,e)||Br(this,bn)&&this[bn][e]?n:!0},UM=function(r,e){var n=Rd(r),i=Cg(e);if(!(n===Wn&&Br(va,i)&&!Br(jl,i))){var a=xM(n,i);return a&&Br(va,i)&&!(Br(n,bn)&&n[bn][i])&&(a.enumerable=!0),a}},jM=function(r){var e=DM(Rd(r)),n=[];return Id(e,function(i){!Br(va,i)&&!Br(OM,i)&&LM(n,i)}),n},VM=function(t){var r=t===Wn,e=DM(r?jl:Rd(t)),n=[];return Id(e,function(i){Br(va,i)&&(!r||Br(Wn,i))&&LM(n,va[i])}),n};Hs||(zo=function(){if(hee(Ul,this))throw Ree("Symbol is not a constructor");var r=!arguments.length||arguments[0]===void 0?void 0:mee(arguments[0]),e=NM(r),n=function(i){this===Wn&&Eg(n,jl,i),Br(this,bn)&&Br(this[bn],e)&&(this[bn][e]=!1),Pg(this,e,Rg(1,i))};return Gs&&Ag&&Pg(Wn,e,{configurable:!0,set:n}),xg(e,r)},Ul=zo[Ll],Ig(Ul,"toString",function(){return PM(this).tag}),Ig(zo,"withoutSetter",function(t){return xg(NM(t),t)}),IM.f=Lg,RM.f=Nd,bee.f=Dg,CM.f=UM,gee.f=MM.f=jM,yee.f=VM,Tee.f=function(t){return xg(kee(t),t)},Gs&&(_ee(Ul,"description",{configurable:!0,get:function(){return PM(this).description}}),Ig(Wn,"propertyIsEnumerable",Lg,{unsafe:!0}))),Cd({global:!0,constructor:!0,wrap:!0,forced:!Hs,sham:!Hs},{Symbol:zo}),Id(EM(Oee),function(t){See(t)}),Cd({target:Od,stat:!0,forced:!Hs},{useSetter:function(){Ag=!0},useSimple:function(){Ag=!1}}),Cd({target:"Object",stat:!0,forced:!Hs,sham:!Gs},{create:Nee,defineProperty:Nd,defineProperties:Dg,getOwnPropertyDescriptor:UM}),Cd({target:"Object",stat:!0,forced:!Hs},{getOwnPropertyNames:jM}),Eee(),Mee(zo,Od),OM[bn]=!0;var Aee=Ws,FM=Aee&&!!Symbol.for&&!!Symbol.keyFor,Pee=Lt,xee=fi,Dee=Er,Lee=Fr,$M=Qa,Uee=FM,Ug=$M("string-to-symbol-registry"),jee=$M("symbol-to-string-registry");Pee({target:"Symbol",stat:!0,forced:!Uee},{for:function(t){var r=Lee(t);if(Dee(Ug,r))return Ug[r];var e=xee("Symbol")(r);return Ug[r]=e,jee[e]=r,e}});var Vee=Lt,Fee=Er,$ee=Bs,zee=Vo,Wee=Qa,Bee=FM,zM=Wee("symbol-to-string-registry");Vee({target:"Symbol",stat:!0,forced:!Bee},{keyFor:function(r){if(!$ee(r))throw TypeError(zee(r)+" is not a symbol");if(Fee(zM,r))return zM[r]}});var Zee=Dt,WM=xl,qee=sr,BM=Ai,Qee=Fr,ZM=Zee([].push),Yee=function(t){if(qee(t))return t;if(WM(t)){for(var r=t.length,e=[],n=0;n<r;n++){var i=t[n];typeof i=="string"?ZM(e,i):(typeof i=="number"||BM(i)=="Number"||BM(i)=="String")&&ZM(e,Qee(i))}var a=e.length,o=!0;return function(s,u){if(o)return o=!1,u;if(WM(this))return u;for(var l=0;l<a;l++)if(e[l]===s)return u}}},Gee=Lt,qM=fi,QM=Ga,Hee=dr,Vl=Dt,YM=Ot,GM=sr,HM=Bs,JM=Qs,Jee=Yee,Xee=Ws,Kee=String,Xa=qM("JSON","stringify"),Ad=Vl(/./.exec),XM=Vl("".charAt),ete=Vl("".charCodeAt),tte=Vl("".replace),rte=Vl(1 .toString),nte=/[\uD800-\uDFFF]/g,KM=/^[\uD800-\uDBFF]$/,eC=/^[\uDC00-\uDFFF]$/,tC=!Xee||YM(function(){var t=qM("Symbol")();return Xa([t])!="[null]"||Xa({a:t})!="{}"||Xa(Object(t))!="{}"}),rC=YM(function(){return Xa("\uDF06\uD834")!=='"\\udf06\\ud834"'||Xa("\uDEAD")!=='"\\udead"'}),ite=function(t,r){var e=JM(arguments),n=Jee(r);if(!(!GM(n)&&(t===void 0||HM(t))))return e[1]=function(i,a){if(GM(n)&&(a=Hee(n,this,Kee(i),a)),!HM(a))return a},QM(Xa,null,e)},ate=function(t,r,e){var n=XM(e,r-1),i=XM(e,r+1);return Ad(KM,t)&&!Ad(eC,i)||Ad(eC,t)&&!Ad(KM,n)?"\\u"+rte(ete(t,0),16):t};Xa&&Gee({target:"JSON",stat:!0,arity:3,forced:tC||rC},{stringify:function(r,e,n){var i=JM(arguments),a=QM(tC?ite:Xa,null,i);return rC&&typeof a=="string"?tte(a,nte,ate):a}});var ote=Lt,ste=Ws,ute=Ot,nC=Il,lte=en,cte=!ste||ute(function(){nC.f(1)});ote({target:"Object",stat:!0,forced:cte},{getOwnPropertySymbols:function(r){var e=nC.f;return e?e(lte(r)):[]}});var fte=Ot,dte=pr,pte=zs,vte=dte("species"),Fl=function(t){return pte>=51||!fte(function(){var r=[],e=r.constructor={};return e[vte]=function(){return{foo:1}},r[t](Boolean).foo!==1})},hte=Lt,mte=In.filter,gte=Fl,yte=gte("filter");hte({target:"Array",proto:!0,forced:!yte},{filter:function(r){return mte(this,r,arguments.length>1?arguments[1]:void 0)}});var bte=Lt,_te=Ot,wte=Rn,iC=Ni.f,aC=wr,kte=!aC||_te(function(){iC(1)});bte({target:"Object",stat:!0,forced:kte,sham:!aC},{getOwnPropertyDescriptor:function(r,e){return iC(wte(r),e)}});var Tte=Lt,Ste=wr,Ete=VE,Mte=Rn,Cte=Ni,Rte=Ys;Tte({target:"Object",stat:!0,sham:!Ste},{getOwnPropertyDescriptors:function(r){for(var e=Mte(r),n=Cte.f,i=Ete(e),a={},o=0,s,u;i.length>o;)u=n(e,s=i[o++]),u!==void 0&&Rte(a,s,u);return a}});var Bo={},Ite={get exports(){return Bo},set exports(t){Bo=t}};(function(t){function r(n,i,a,o,s,u,l){try{var c=n[u](l),f=c.value}catch(d){a(d);return}c.done?i(f):Promise.resolve(f).then(o,s)}function e(n){return function(){var i=this,a=arguments;return new Promise(function(o,s){var u=n.apply(i,a);function l(f){r(u,o,s,l,c,"next",f)}function c(f){r(u,o,s,l,c,"throw",f)}l(void 0)})}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Ite);var ha={},Ote={get exports(){return ha},set exports(t){ha=t}};(function(t){function r(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Ote);var Bn={},Nte={get exports(){return Bn},set exports(t){Bn=t}},$l={},Ate={get exports(){return $l},set exports(t){$l=t}};(function(t){function r(e,n){return t.exports=r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,o){return a.__proto__=o,a},t.exports.__esModule=!0,t.exports.default=t.exports,r(e,n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Ate),function(t){var r=$l;function e(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),i&&r(n,i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Nte);var Zn={},Pte={get exports(){return Zn},set exports(t){Zn=t}},_n={},xte={get exports(){return _n},set exports(t){_n=t}};(function(t){function r(e){return t.exports=r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(xte),function(t){var r=_n.default,e=ha;function n(i,a){if(a&&(r(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e(i)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(Pte);var wn={},Dte={get exports(){return wn},set exports(t){wn=t}};(function(t){function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Dte);var ma={},Lte={get exports(){return ma},set exports(t){ma=t}},Pd={},Ute={get exports(){return Pd},set exports(t){Pd=t}},jg={},jte={get exports(){return jg},set exports(t){jg=t}};(function(t){var r=_n.default;function e(n,i){if(r(n)!=="object"||n===null)return n;var a=n[Symbol.toPrimitive];if(a!==void 0){var o=a.call(n,i||"default");if(r(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(jte),function(t){var r=_n.default,e=jg;function n(i){var a=e(i,"string");return r(a)==="symbol"?a:String(a)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(Ute),function(t){var r=Pd;function e(n,i,a){return i=r(i),i in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Lte);var ji={},Vte={get exports(){return ji},set exports(t){ji=t}};(function(t){var r=Pd;function e(i,a){for(var o=0;o<a.length;o++){var s=a[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,r(s.key),s)}}function n(i,a,o){return a&&e(i.prototype,a),o&&e(i,o),Object.defineProperty(i,"prototype",{writable:!1}),i}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Vte);var qn={},Fte={get exports(){return qn},set exports(t){qn=t}};(function(t){function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Fte);var $te=dg,zte=da,Wte=$te?{}.toString:function(){return"[object "+zte(this)+"]"},Bte=dg,Zte=un,qte=Wte;Bte||Zte(Object.prototype,"toString",qte,{unsafe:!0});var Qte=Ai,xd=typeof process<"u"&&Qte(process)=="process",Yte=Dt,Gte=$n,Hte=function(t,r,e){try{return Yte(Gte(Object.getOwnPropertyDescriptor(t,r)[e]))}catch{}},Jte=sr,Xte=String,Kte=TypeError,ere=function(t){if(typeof t=="object"||Jte(t))return t;throw Kte("Can't set "+Xte(t)+" as a prototype")},tre=Hte,rre=Or,nre=ere,Js=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,r={},e;try{e=tre(Object.prototype,"__proto__","set"),e(r,[]),t=r instanceof Array}catch{}return function(i,a){return rre(i),nre(a),t?e(i,a):i.__proto__=a,i}}():void 0),ire=fi,are=Ui,ore=pr,sre=wr,oC=ore("species"),Dd=function(t){var r=ire(t);sre&&r&&!r[oC]&&are(r,oC,{configurable:!0,get:function(){return this}})},ure=ua,lre=TypeError,Zo=function(t,r){if(ure(r,t))return t;throw lre("Incorrect invocation")},sC=Or,cre=vg,fre=Pi,dre=pr,pre=dre("species"),Vg=function(t,r){var e=sC(t).constructor,n;return e===void 0||fre(n=sC(e)[pre])?r:cre(n)},vre=TypeError,Fg=function(t,r){if(t<r)throw vre("Not enough arguments");return t},hre=jo,uC=/(?:ipad|iphone|ipod).*applewebkit/i.test(hre),On=zt,mre=Ga,gre=pa,lC=sr,yre=Er,cC=Ot,fC=eM,bre=Qs,dC=dd,_re=Fg,wre=uC,kre=xd,$g=On.setImmediate,zg=On.clearImmediate,Tre=On.process,Wg=On.Dispatch,Sre=On.Function,pC=On.MessageChannel,Ere=On.String,Bg=0,zl={},vC="onreadystatechange",Wl,qo,Zg,qg;cC(function(){Wl=On.location});var Qg=function(t){if(yre(zl,t)){var r=zl[t];delete zl[t],r()}},Yg=function(t){return function(){Qg(t)}},hC=function(t){Qg(t.data)},mC=function(t){On.postMessage(Ere(t),Wl.protocol+"//"+Wl.host)};(!$g||!zg)&&($g=function(r){_re(arguments.length,1);var e=lC(r)?r:Sre(r),n=bre(arguments,1);return zl[++Bg]=function(){mre(e,void 0,n)},qo(Bg),Bg},zg=function(r){delete zl[r]},kre?qo=function(t){Tre.nextTick(Yg(t))}:Wg&&Wg.now?qo=function(t){Wg.now(Yg(t))}:pC&&!wre?(Zg=new pC,qg=Zg.port2,Zg.port1.onmessage=hC,qo=gre(qg.postMessage,qg)):On.addEventListener&&lC(On.postMessage)&&!On.importScripts&&Wl&&Wl.protocol!=="file:"&&!cC(mC)?(qo=mC,On.addEventListener("message",hC,!1)):vC in dC("script")?qo=function(t){fC.appendChild(dC("script"))[vC]=function(){fC.removeChild(this),Qg(t)}}:qo=function(t){setTimeout(Yg(t),0)});var gC={set:$g,clear:zg},yC=function(){this.head=null,this.tail=null};yC.prototype={add:function(t){var r={item:t,next:null},e=this.tail;e?e.next=r:this.head=r,this.tail=r},get:function(){var t=this.head;if(t){var r=this.head=t.next;return r===null&&(this.tail=null),t.item}}};var bC=yC,Mre=jo,Cre=/ipad|iphone|ipod/i.test(Mre)&&typeof Pebble<"u",Rre=jo,Ire=/web0s(?!.*chrome)/i.test(Rre),Qo=zt,_C=pa,Ore=Ni.f,Gg=gC.set,Nre=bC,Are=uC,Pre=Cre,xre=Ire,Hg=xd,wC=Qo.MutationObserver||Qo.WebKitMutationObserver,kC=Qo.document,TC=Qo.process,Ld=Qo.Promise,SC=Ore(Qo,"queueMicrotask"),Jg=SC&&SC.value,Xs,Xg,Kg,Ud,EC;if(!Jg){var jd=new Nre,Vd=function(){var t,r;for(Hg&&(t=TC.domain)&&t.exit();r=jd.get();)try{r()}catch(e){throw jd.head&&Xs(),e}t&&t.enter()};!Are&&!Hg&&!xre&&wC&&kC?(Xg=!0,Kg=kC.createTextNode(""),new wC(Vd).observe(Kg,{characterData:!0}),Xs=function(){Kg.data=Xg=!Xg}):!Pre&&Ld&&Ld.resolve?(Ud=Ld.resolve(void 0),Ud.constructor=Ld,EC=_C(Ud.then,Ud),Xs=function(){EC(Vd)}):Hg?Xs=function(){TC.nextTick(Vd)}:(Gg=_C(Gg,Qo),Xs=function(){Gg(Vd)}),Jg=function(t){jd.head||Xs(),jd.add(t)}}var Dre=Jg,Lre=function(t,r){try{arguments.length==1?console.error(t):console.error(t,r)}catch{}},ey=function(t){try{return{error:!1,value:t()}}catch(r){return{error:!0,value:r}}},Ure=zt,Fd=Ure.Promise,MC=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",jre=MC,Vre=xd,Fre=!jre&&!Vre&&typeof window=="object"&&typeof document=="object",$re=zt,Bl=Fd,zre=sr,Wre=wd,Bre=rg,Zre=pr,qre=Fre,Qre=MC,ty=zs;Bl&&Bl.prototype;var Yre=Zre("species"),ry=!1,CC=zre($re.PromiseRejectionEvent),Gre=Wre("Promise",function(){var t=Bre(Bl),r=t!==String(Bl);if(!r&&ty===66)return!0;if(!ty||ty<51||!/native code/.test(t)){var e=new Bl(function(a){a(1)}),n=function(a){a(function(){},function(){})},i=e.constructor={};if(i[Yre]=n,ry=e.then(function(){})instanceof n,!ry)return!0}return!r&&(qre||Qre)&&!CC}),Zl={CONSTRUCTOR:Gre,REJECTION_EVENT:CC,SUBCLASSING:ry},Ks={},RC=$n,Hre=TypeError,Jre=function(t){var r,e;this.promise=new t(function(n,i){if(r!==void 0||e!==void 0)throw Hre("Bad Promise constructor");r=n,e=i}),this.resolve=RC(r),this.reject=RC(e)};Ks.f=function(t){return new Jre(t)};var Xre=Lt,$d=xd,Ka=zt,eu=dr,IC=un,OC=Js,Kre=fa,ene=Dd,tne=$n,zd=sr,rne=Sr,nne=Zo,ine=Vg,NC=gC.set,ny=Dre,ane=Lre,one=ey,sne=bC,AC=zn,Wd=Fd,iy=Zl,PC=Ks,Bd="Promise",xC=iy.CONSTRUCTOR,une=iy.REJECTION_EVENT,lne=iy.SUBCLASSING,ay=AC.getterFor(Bd),cne=AC.set,tu=Wd&&Wd.prototype,Yo=Wd,Zd=tu,DC=Ka.TypeError,oy=Ka.document,sy=Ka.process,uy=PC.f,fne=uy,dne=!!(oy&&oy.createEvent&&Ka.dispatchEvent),LC="unhandledrejection",pne="rejectionhandled",UC=0,jC=1,vne=2,ly=1,VC=2,qd,FC,hne,$C,zC=function(t){var r;return rne(t)&&zd(r=t.then)?r:!1},WC=function(t,r){var e=r.value,n=r.state==jC,i=n?t.ok:t.fail,a=t.resolve,o=t.reject,s=t.domain,u,l,c;try{i?(n||(r.rejection===VC&&gne(r),r.rejection=ly),i===!0?u=e:(s&&s.enter(),u=i(e),s&&(s.exit(),c=!0)),u===t.promise?o(DC("Promise-chain cycle")):(l=zC(u))?eu(l,u,a,o):a(u)):o(e)}catch(f){s&&!c&&s.exit(),o(f)}},BC=function(t,r){t.notified||(t.notified=!0,ny(function(){for(var e=t.reactions,n;n=e.get();)WC(n,t);t.notified=!1,r&&!t.rejection&&mne(t)}))},ZC=function(t,r,e){var n,i;dne?(n=oy.createEvent("Event"),n.promise=r,n.reason=e,n.initEvent(t,!1,!0),Ka.dispatchEvent(n)):n={promise:r,reason:e},!une&&(i=Ka["on"+t])?i(n):t===LC&&ane("Unhandled promise rejection",e)},mne=function(t){eu(NC,Ka,function(){var r=t.facade,e=t.value,n=qC(t),i;if(n&&(i=one(function(){$d?sy.emit("unhandledRejection",e,r):ZC(LC,r,e)}),t.rejection=$d||qC(t)?VC:ly,i.error))throw i.value})},qC=function(t){return t.rejection!==ly&&!t.parent},gne=function(t){eu(NC,Ka,function(){var r=t.facade;$d?sy.emit("rejectionHandled",r):ZC(pne,r,t.value)})},ru=function(t,r,e){return function(n){t(r,n,e)}},nu=function(t,r,e){t.done||(t.done=!0,e&&(t=e),t.value=r,t.state=vne,BC(t,!0))},cy=function(t,r,e){if(!t.done){t.done=!0,e&&(t=e);try{if(t.facade===r)throw DC("Promise can't be resolved itself");var n=zC(r);n?ny(function(){var i={done:!1};try{eu(n,r,ru(cy,i,t),ru(nu,i,t))}catch(a){nu(i,a,t)}}):(t.value=r,t.state=jC,BC(t,!1))}catch(i){nu({done:!1},i,t)}}};if(xC&&(Yo=function(r){nne(this,Zd),tne(r),eu(qd,this);var e=ay(this);try{r(ru(cy,e),ru(nu,e))}catch(n){nu(e,n)}},Zd=Yo.prototype,qd=function(r){cne(this,{type:Bd,done:!1,notified:!1,parent:!1,reactions:new sne,rejection:!1,state:UC,value:void 0})},qd.prototype=IC(Zd,"then",function(r,e){var n=ay(this),i=uy(ine(this,Yo));return n.parent=!0,i.ok=zd(r)?r:!0,i.fail=zd(e)&&e,i.domain=$d?sy.domain:void 0,n.state==UC?n.reactions.add(i):ny(function(){WC(i,n)}),i.promise}),FC=function(){var t=new qd,r=ay(t);this.promise=t,this.resolve=ru(cy,r),this.reject=ru(nu,r)},PC.f=uy=function(t){return t===Yo||t===hne?new FC(t):fne(t)},zd(Wd)&&tu!==Object.prototype)){$C=tu.then,lne||IC(tu,"then",function(r,e){var n=this;return new Yo(function(i,a){eu($C,n,i,a)}).then(r,e)},{unsafe:!0});try{delete tu.constructor}catch{}OC&&OC(tu,Zd)}Xre({global:!0,constructor:!0,wrap:!0,forced:xC},{Promise:Yo}),Kre(Yo,Bd,!1),ene(Bd);var ql={},yne=pr,bne=ql,_ne=yne("iterator"),wne=Array.prototype,fy=function(t){return t!==void 0&&(bne.Array===t||wne[_ne]===t)},kne=da,QC=Fo,Tne=Pi,Sne=ql,Ene=pr,Mne=Ene("iterator"),Ql=function(t){if(!Tne(t))return QC(t,Mne)||QC(t,"@@iterator")||Sne[kne(t)]},Cne=dr,Rne=$n,Ine=Or,One=Vo,Nne=Ql,Ane=TypeError,Qd=function(t,r){var e=arguments.length<2?Nne(t):r;if(Rne(e))return Ine(Cne(e,t));throw Ane(One(t)+" is not iterable")},Pne=dr,YC=Or,xne=Fo,GC=function(t,r,e){var n,i;YC(t);try{if(n=xne(t,"return"),!n){if(r==="throw")throw e;return e}n=Pne(n,t)}catch(a){i=!0,n=a}if(r==="throw")throw e;if(i)throw n;return YC(n),e},Dne=pa,Lne=dr,Une=Or,jne=Vo,Vne=fy,Fne=Jr,HC=ua,$ne=Qd,zne=Ql,JC=GC,Wne=TypeError,Yd=function(t,r){this.stopped=t,this.result=r},XC=Yd.prototype,Gd=function(t,r,e){var n=e&&e.that,i=!!(e&&e.AS_ENTRIES),a=!!(e&&e.IS_RECORD),o=!!(e&&e.IS_ITERATOR),s=!!(e&&e.INTERRUPTED),u=Dne(r,n),l,c,f,d,v,p,y,k=function(C){return l&&JC(l,"normal",C),new Yd(!0,C)},I=function(C){return i?(Une(C),s?u(C[0],C[1],k):u(C[0],C[1])):s?u(C,k):u(C)};if(a)l=t.iterator;else if(o)l=t;else{if(c=zne(t),!c)throw Wne(jne(t)+" is not iterable");if(Vne(c)){for(f=0,d=Fne(t);d>f;f++)if(v=I(t[f]),v&&HC(XC,v))return v;return new Yd(!1)}l=$ne(t,c)}for(p=a?t.next:l.next;!(y=Lne(p,l)).done;){try{v=I(y.value)}catch(C){JC(l,"throw",C)}if(typeof v=="object"&&v&&HC(XC,v))return v}return new Yd(!1)},Bne=pr,KC=Bne("iterator"),eR=!1;try{var Zne=0,tR={next:function(){return{done:!!Zne++}},return:function(){eR=!0}};tR[KC]=function(){return this},Array.from(tR,function(){throw 2})}catch{}var Hd=function(t,r){if(!r&&!eR)return!1;var e=!1;try{var n={};n[KC]=function(){return{next:function(){return{done:e=!0}}}},t(n)}catch{}return e},qne=Fd,Qne=Hd,Yne=Zl.CONSTRUCTOR,rR=Yne||!Qne(function(t){qne.all(t).then(void 0,function(){})}),Gne=Lt,Hne=dr,Jne=$n,Xne=Ks,Kne=ey,eie=Gd,tie=rR;Gne({target:"Promise",stat:!0,forced:tie},{all:function(r){var e=this,n=Xne.f(e),i=n.resolve,a=n.reject,o=Kne(function(){var s=Jne(e.resolve),u=[],l=0,c=1;eie(r,function(f){var d=l++,v=!1;c++,Hne(s,e,f).then(function(p){v||(v=!0,u[d]=p,--c||i(u))},a)}),--c||i(u)});return o.error&&a(o.value),n.promise}});var rie=Lt,nie=Zl.CONSTRUCTOR,dy=Fd,iie=fi,aie=sr,oie=un,nR=dy&&dy.prototype;if(rie({target:"Promise",proto:!0,forced:nie,real:!0},{catch:function(t){return this.then(void 0,t)}}),aie(dy)){var iR=iie("Promise").prototype.catch;nR.catch!==iR&&oie(nR,"catch",iR,{unsafe:!0})}var sie=Lt,uie=dr,lie=$n,cie=Ks,fie=ey,die=Gd,pie=rR;sie({target:"Promise",stat:!0,forced:pie},{race:function(r){var e=this,n=cie.f(e),i=n.reject,a=fie(function(){var o=lie(e.resolve);die(r,function(s){uie(o,e,s).then(n.resolve,i)})});return a.error&&i(a.value),n.promise}});var vie=Lt,hie=dr,mie=Ks,gie=Zl.CONSTRUCTOR;vie({target:"Promise",stat:!0,forced:gie},{reject:function(r){var e=mie.f(this);return hie(e.reject,void 0,r),e.promise}});var yie=Or,bie=Sr,_ie=Ks,wie=function(t,r){if(yie(t),bie(r)&&r.constructor===t)return r;var e=_ie.f(t),n=e.resolve;return n(r),e.promise},kie=Lt,Tie=fi,Sie=Zl.CONSTRUCTOR,Eie=wie;Tie("Promise"),kie({target:"Promise",stat:!0,forced:Sie},{resolve:function(r){return Eie(this,r)}});var Mie=Lt,Cie=In.map,Rie=Fl,Iie=Rie("map");Mie({target:"Array",proto:!0,forced:!Iie},{map:function(r){return Cie(this,r,arguments.length>1?arguments[1]:void 0)}});var aR={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Oie=dd,py=Oie("span").classList,oR=py&&py.constructor&&py.constructor.prototype,sR=oR===Object.prototype?void 0:oR,Nie=Ot,Jd=function(t,r){var e=[][t];return!!e&&Nie(function(){e.call(null,r||function(){return 1},1)})},Aie=In.forEach,Pie=Jd,xie=Pie("forEach"),Die=xie?[].forEach:function(r){return Aie(this,r,arguments.length>1?arguments[1]:void 0)},uR=zt,lR=aR,Lie=sR,vy=Die,Uie=la,cR=function(t){if(t&&t.forEach!==vy)try{Uie(t,"forEach",vy)}catch{t.forEach=vy}};for(var hy in lR)lR[hy]&&cR(uR[hy]&&uR[hy].prototype);cR(Lie);var my={},jie={get exports(){return my},set exports(t){my=t}};(function(t){var r=_n.default;function e(){t.exports=e=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var n={},i=Object.prototype,a=i.hasOwnProperty,o=Object.defineProperty||function(Z,te,re){Z[te]=re.value},s=typeof Symbol=="function"?Symbol:{},u=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function f(Z,te,re){return Object.defineProperty(Z,te,{value:re,enumerable:!0,configurable:!0,writable:!0}),Z[te]}try{f({},"")}catch{f=function(re,K,fe){return re[K]=fe}}function d(Z,te,re,K){var fe=te&&te.prototype instanceof y?te:y,Te=Object.create(fe.prototype),$=new de(K||[]);return o(Te,"_invoke",{value:D(Z,re,$)}),Te}function v(Z,te,re){try{return{type:"normal",arg:Z.call(te,re)}}catch(K){return{type:"throw",arg:K}}}n.wrap=d;var p={};function y(){}function k(){}function I(){}var C={};f(C,u,function(){return this});var L=Object.getPrototypeOf,R=L&&L(L(H([])));R&&R!==i&&a.call(R,u)&&(C=R);var q=I.prototype=y.prototype=Object.create(C);function z(Z){["next","throw","return"].forEach(function(te){f(Z,te,function(re){return this._invoke(te,re)})})}function F(Z,te){function re(fe,Te,$,We){var et=v(Z[fe],Z,Te);if(et.type!=="throw"){var dt=et.arg,$e=dt.value;return $e&&r($e)=="object"&&a.call($e,"__await")?te.resolve($e.__await).then(function(ue){re("next",ue,$,We)},function(ue){re("throw",ue,$,We)}):te.resolve($e).then(function(ue){dt.value=ue,$(dt)},function(ue){return re("throw",ue,$,We)})}We(et.arg)}var K;o(this,"_invoke",{value:function(Te,$){function We(){return new te(function(et,dt){re(Te,$,et,dt)})}return K=K?K.then(We,We):We()}})}function D(Z,te,re){var K="suspendedStart";return function(fe,Te){if(K==="executing")throw new Error("Generator is already running");if(K==="completed"){if(fe==="throw")throw Te;return ee()}for(re.method=fe,re.arg=Te;;){var $=re.delegate;if($){var We=W($,re);if(We){if(We===p)continue;return We}}if(re.method==="next")re.sent=re._sent=re.arg;else if(re.method==="throw"){if(K==="suspendedStart")throw K="completed",re.arg;re.dispatchException(re.arg)}else re.method==="return"&&re.abrupt("return",re.arg);K="executing";var et=v(Z,te,re);if(et.type==="normal"){if(K=re.done?"completed":"suspendedYield",et.arg===p)continue;return{value:et.arg,done:re.done}}et.type==="throw"&&(K="completed",re.method="throw",re.arg=et.arg)}}}function W(Z,te){var re=te.method,K=Z.iterator[re];if(K===void 0)return te.delegate=null,re==="throw"&&Z.iterator.return&&(te.method="return",te.arg=void 0,W(Z,te),te.method==="throw")||re!=="return"&&(te.method="throw",te.arg=new TypeError("The iterator does not provide a '"+re+"' method")),p;var fe=v(K,Z.iterator,te.arg);if(fe.type==="throw")return te.method="throw",te.arg=fe.arg,te.delegate=null,p;var Te=fe.arg;return Te?Te.done?(te[Z.resultName]=Te.value,te.next=Z.nextLoc,te.method!=="return"&&(te.method="next",te.arg=void 0),te.delegate=null,p):Te:(te.method="throw",te.arg=new TypeError("iterator result is not an object"),te.delegate=null,p)}function X(Z){var te={tryLoc:Z[0]};1 in Z&&(te.catchLoc=Z[1]),2 in Z&&(te.finallyLoc=Z[2],te.afterLoc=Z[3]),this.tryEntries.push(te)}function me(Z){var te=Z.completion||{};te.type="normal",delete te.arg,Z.completion=te}function de(Z){this.tryEntries=[{tryLoc:"root"}],Z.forEach(X,this),this.reset(!0)}function H(Z){if(Z){var te=Z[u];if(te)return te.call(Z);if(typeof Z.next=="function")return Z;if(!isNaN(Z.length)){var re=-1,K=function fe(){for(;++re<Z.length;)if(a.call(Z,re))return fe.value=Z[re],fe.done=!1,fe;return fe.value=void 0,fe.done=!0,fe};return K.next=K}}return{next:ee}}function ee(){return{value:void 0,done:!0}}return k.prototype=I,o(q,"constructor",{value:I,configurable:!0}),o(I,"constructor",{value:k,configurable:!0}),k.displayName=f(I,c,"GeneratorFunction"),n.isGeneratorFunction=function(Z){var te=typeof Z=="function"&&Z.constructor;return!!te&&(te===k||(te.displayName||te.name)==="GeneratorFunction")},n.mark=function(Z){return Object.setPrototypeOf?Object.setPrototypeOf(Z,I):(Z.__proto__=I,f(Z,c,"GeneratorFunction")),Z.prototype=Object.create(q),Z},n.awrap=function(Z){return{__await:Z}},z(F.prototype),f(F.prototype,l,function(){return this}),n.AsyncIterator=F,n.async=function(Z,te,re,K,fe){fe===void 0&&(fe=Promise);var Te=new F(d(Z,te,re,K),fe);return n.isGeneratorFunction(te)?Te:Te.next().then(function($){return $.done?$.value:Te.next()})},z(q),f(q,c,"Generator"),f(q,u,function(){return this}),f(q,"toString",function(){return"[object Generator]"}),n.keys=function(Z){var te=Object(Z),re=[];for(var K in te)re.push(K);return re.reverse(),function fe(){for(;re.length;){var Te=re.pop();if(Te in te)return fe.value=Te,fe.done=!1,fe}return fe.done=!0,fe}},n.values=H,de.prototype={constructor:de,reset:function(te){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(me),!te)for(var re in this)re.charAt(0)==="t"&&a.call(this,re)&&!isNaN(+re.slice(1))&&(this[re]=void 0)},stop:function(){this.done=!0;var te=this.tryEntries[0].completion;if(te.type==="throw")throw te.arg;return this.rval},dispatchException:function(te){if(this.done)throw te;var re=this;function K(dt,$e){return $.type="throw",$.arg=te,re.next=dt,$e&&(re.method="next",re.arg=void 0),!!$e}for(var fe=this.tryEntries.length-1;fe>=0;--fe){var Te=this.tryEntries[fe],$=Te.completion;if(Te.tryLoc==="root")return K("end");if(Te.tryLoc<=this.prev){var We=a.call(Te,"catchLoc"),et=a.call(Te,"finallyLoc");if(We&&et){if(this.prev<Te.catchLoc)return K(Te.catchLoc,!0);if(this.prev<Te.finallyLoc)return K(Te.finallyLoc)}else if(We){if(this.prev<Te.catchLoc)return K(Te.catchLoc,!0)}else{if(!et)throw new Error("try statement without catch or finally");if(this.prev<Te.finallyLoc)return K(Te.finallyLoc)}}}},abrupt:function(te,re){for(var K=this.tryEntries.length-1;K>=0;--K){var fe=this.tryEntries[K];if(fe.tryLoc<=this.prev&&a.call(fe,"finallyLoc")&&this.prev<fe.finallyLoc){var Te=fe;break}}Te&&(te==="break"||te==="continue")&&Te.tryLoc<=re&&re<=Te.finallyLoc&&(Te=null);var $=Te?Te.completion:{};return $.type=te,$.arg=re,Te?(this.method="next",this.next=Te.finallyLoc,p):this.complete($)},complete:function(te,re){if(te.type==="throw")throw te.arg;return te.type==="break"||te.type==="continue"?this.next=te.arg:te.type==="return"?(this.rval=this.arg=te.arg,this.method="return",this.next="end"):te.type==="normal"&&re&&(this.next=re),p},finish:function(te){for(var re=this.tryEntries.length-1;re>=0;--re){var K=this.tryEntries[re];if(K.finallyLoc===te)return this.complete(K.completion,K.afterLoc),me(K),p}},catch:function(te){for(var re=this.tryEntries.length-1;re>=0;--re){var K=this.tryEntries[re];if(K.tryLoc===te){var fe=K.completion;if(fe.type==="throw"){var Te=fe.arg;me(K)}return Te}}throw new Error("illegal catch attempt")},delegateYield:function(te,re,K){return this.delegate={iterator:H(te),resultName:re,nextLoc:K},this.method==="next"&&(this.arg=void 0),p}},n}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(jie);var Xd=my(),Yl=Xd;try{regeneratorRuntime=Xd}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Xd:Function("r","regeneratorRuntime = r")(Xd)}var Vie=TypeError,Fie=9007199254740991,fR=function(t){if(t>Fie)throw Vie("Maximum allowed index exceeded");return t},$ie=Lt,zie=Ot,Wie=xl,Bie=Sr,Zie=en,qie=Jr,dR=fR,pR=Ys,Qie=Tg,Yie=Fl,Gie=pr,Hie=zs,vR=Gie("isConcatSpreadable"),Jie=Hie>=51||!zie(function(){var t=[];return t[vR]=!1,t.concat()[0]!==t}),Xie=function(t){if(!Bie(t))return!1;var r=t[vR];return r!==void 0?!!r:Wie(t)},Kie=!Jie||!Yie("concat");$ie({target:"Array",proto:!0,arity:1,forced:Kie},{concat:function(r){var e=Zie(this),n=Qie(e,0),i=0,a,o,s,u,l;for(a=-1,s=arguments.length;a<s;a++)if(l=a===-1?e:arguments[a],Xie(l))for(u=qie(l),dR(i+u),o=0;o<u;o++,i++)o in l&&pR(n,i,l[o]);else dR(i+1),pR(n,i++,l);return n.length=i,n}});var eae=Or,tae=GC,rae=function(t,r,e,n){try{return n?r(eae(e)[0],e[1]):r(e)}catch(i){tae(t,"throw",i)}},nae=pa,iae=dr,aae=en,oae=rae,sae=fy,uae=Td,lae=Jr,hR=Ys,cae=Qd,fae=Ql,mR=Array,gR=function(r){var e=aae(r),n=uae(this),i=arguments.length,a=i>1?arguments[1]:void 0,o=a!==void 0;o&&(a=nae(a,i>2?arguments[2]:void 0));var s=fae(e),u=0,l,c,f,d,v,p;if(s&&!(this===mR&&sae(s)))for(d=cae(e,s),v=d.next,c=n?new this:[];!(f=iae(v,d)).done;u++)p=o?oae(d,a,[f.value,u],!0):f.value,hR(c,u,p);else for(l=lae(e),c=n?new this(l):mR(l);l>u;u++)p=o?a(e[u],u):e[u],hR(c,u,p);return c.length=u,c},dae=Lt,pae=gR,vae=Hd,hae=!vae(function(t){Array.from(t)});dae({target:"Array",stat:!0,forced:hae},{from:pae});var gy=Dt,mae=Li,gae=Fr,yae=xi,bae=gy("".charAt),yR=gy("".charCodeAt),_ae=gy("".slice),bR=function(t){return function(r,e){var n=gae(yae(r)),i=mae(e),a=n.length,o,s;return i<0||i>=a?t?"":void 0:(o=yR(n,i),o<55296||o>56319||i+1===a||(s=yR(n,i+1))<56320||s>57343?t?bae(n,i):o:t?_ae(n,i,i+2):(o-55296<<10)+(s-56320)+65536)}},yy={codeAt:bR(!1),charAt:bR(!0)},wae=Ot,kae=!wae(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Tae=Er,Sae=sr,Eae=en,Mae=hd,Cae=kae,_R=Mae("IE_PROTO"),by=Object,Rae=by.prototype,Gl=Cae?by.getPrototypeOf:function(t){var r=Eae(t);if(Tae(r,_R))return r[_R];var e=r.constructor;return Sae(e)&&r instanceof e?e.prototype:r instanceof by?Rae:null},Iae=Ot,Oae=sr,Nae=Sr,wR=Gl,Aae=un,Pae=pr,_y=Pae("iterator"),kR=!1,Go,wy,ky;[].keys&&(ky=[].keys(),"next"in ky?(wy=wR(wR(ky)),wy!==Object.prototype&&(Go=wy)):kR=!0);var xae=!Nae(Go)||Iae(function(){var t={};return Go[_y].call(t)!==t});xae&&(Go={}),Oae(Go[_y])||Aae(Go,_y,function(){return this});var TR={IteratorPrototype:Go,BUGGY_SAFARI_ITERATORS:kR},Dae=TR.IteratorPrototype,Lae=Ha,Uae=Uo,jae=fa,Vae=ql,Fae=function(){return this},SR=function(t,r,e,n){var i=r+" Iterator";return t.prototype=Lae(Dae,{next:Uae(+!n,e)}),jae(t,i,!1),Vae[i]=Fae,t},$ae=Lt,zae=dr,ER=Ml,Wae=sr,Bae=SR,MR=Gl,CR=Js,Zae=fa,qae=la,Ty=un,Qae=pr,Yae=ql,RR=TR,Gae=ER.PROPER,Hae=ER.CONFIGURABLE,IR=RR.IteratorPrototype,Kd=RR.BUGGY_SAFARI_ITERATORS,Hl=Qae("iterator"),OR="keys",Jl="values",NR="entries",Jae=function(){return this},Sy=function(t,r,e,n,i,a,o){Bae(e,r,n);var s=function(I){if(I===i&&d)return d;if(!Kd&&I in c)return c[I];switch(I){case OR:return function(){return new e(this,I)};case Jl:return function(){return new e(this,I)};case NR:return function(){return new e(this,I)}}return function(){return new e(this)}},u=r+" Iterator",l=!1,c=t.prototype,f=c[Hl]||c["@@iterator"]||i&&c[i],d=!Kd&&f||s(i),v=r=="Array"&&c.entries||f,p,y,k;if(v&&(p=MR(v.call(new t)),p!==Object.prototype&&p.next&&(MR(p)!==IR&&(CR?CR(p,IR):Wae(p[Hl])||Ty(p,Hl,Jae)),Zae(p,u,!0))),Gae&&i==Jl&&f&&f.name!==Jl&&(Hae?qae(c,"name",Jl):(l=!0,d=function(){return zae(f,this)})),i)if(y={values:s(Jl),keys:a?d:s(OR),entries:s(NR)},o)for(k in y)(Kd||l||!(k in c))&&Ty(c,k,y[k]);else $ae({target:r,proto:!0,forced:Kd||l},y);return c[Hl]!==d&&Ty(c,Hl,d,{name:i}),Yae[r]=d,y},Ey=function(t,r){return{value:t,done:r}},Xae=yy.charAt,Kae=Fr,AR=zn,eoe=Sy,PR=Ey,xR="String Iterator",toe=AR.set,roe=AR.getterFor(xR);eoe(String,"String",function(t){toe(this,{type:xR,string:Kae(t),index:0})},function(){var r=roe(this),e=r.string,n=r.index,i;return n>=e.length?PR(void 0,!0):(i=Xae(e,n),r.index+=i.length,PR(i,!1))});var Ho={},noe={get exports(){return Ho},set exports(t){Ho=t}};(function(t){(function(r,e){t.exports?t.exports=e():r.log=e()})(V,function(){var r=function(){},e="undefined",n=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function a(y,k){var I=y[k];if(typeof I.bind=="function")return I.bind(y);try{return Function.prototype.bind.call(I,y)}catch{return function(){return Function.prototype.apply.apply(I,[y,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(y){return y==="debug"&&(y="log"),typeof console===e?!1:y==="trace"&&n?o:console[y]!==void 0?a(console,y):console.log!==void 0?a(console,"log"):r}function u(y,k){for(var I=0;I<i.length;I++){var C=i[I];this[C]=I<y?r:this.methodFactory(C,y,k)}this.log=this.debug}function l(y,k,I){return function(){typeof console!==e&&(u.call(this,k,I),this[y].apply(this,arguments))}}function c(y,k,I){return s(y)||l.apply(this,arguments)}function f(y,k,I){var C=this,L;k=k??"WARN";var R="loglevel";typeof y=="string"?R+=":"+y:typeof y=="symbol"&&(R=void 0);function q(W){var X=(i[W]||"silent").toUpperCase();if(!(typeof window===e||!R)){try{window.localStorage[R]=X;return}catch{}try{window.document.cookie=encodeURIComponent(R)+"="+X+";"}catch{}}}function z(){var W;if(!(typeof window===e||!R)){try{W=window.localStorage[R]}catch{}if(typeof W===e)try{var X=window.document.cookie,me=X.indexOf(encodeURIComponent(R)+"=");me!==-1&&(W=/^([^;]+)/.exec(X.slice(me))[1])}catch{}return C.levels[W]===void 0&&(W=void 0),W}}function F(){if(!(typeof window===e||!R)){try{window.localStorage.removeItem(R);return}catch{}try{window.document.cookie=encodeURIComponent(R)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}C.name=y,C.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},C.methodFactory=I||c,C.getLevel=function(){return L},C.setLevel=function(W,X){if(typeof W=="string"&&C.levels[W.toUpperCase()]!==void 0&&(W=C.levels[W.toUpperCase()]),typeof W=="number"&&W>=0&&W<=C.levels.SILENT){if(L=W,X!==!1&&q(W),u.call(C,W,y),typeof console===e&&W<C.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+W},C.setDefaultLevel=function(W){k=W,z()||C.setLevel(W,!1)},C.resetLevel=function(){C.setLevel(k,!1),F()},C.enableAll=function(W){C.setLevel(C.levels.TRACE,W)},C.disableAll=function(W){C.setLevel(C.levels.SILENT,W)};var D=z();D==null&&(D=k),C.setLevel(D,!1)}var d=new f,v={};d.getLogger=function(k){if(typeof k!="symbol"&&typeof k!="string"||k==="")throw new TypeError("You must supply a name when creating a logger.");var I=v[k];return I||(I=v[k]=new f(k,d.getLevel(),d.methodFactory)),I};var p=typeof window!==e?window.log:void 0;return d.noConflict=function(){return typeof window!==e&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return v},d.default=d,d})})(noe);const Jo="\\d+(?:[\\.,]\\d+)?",ioe=`(${Jo}W)`,aoe=`(${Jo}Y)?(${Jo}M)?(${Jo}D)?`,ooe=`T(${Jo}H)?(${Jo}M)?(${Jo}S)?`,soe=`P(?:${ioe}|${aoe}(?:${ooe})?)`,uoe=["weeks","years","months","days","hours","minutes","seconds"],My=new RegExp(soe),DR=t=>t.match(My).slice(1).reduce((r,e,n)=>(r[uoe[n]]=parseFloat(e)||0,r),{}),Cy=(t,r)=>{const e=r?r.getTime():Date.now(),n=new Date(e);return n.setFullYear(n.getFullYear()+t.years),n.setMonth(n.getMonth()+t.months),n.setDate(n.getDate()+t.days),n.setHours(n.getHours()+t.hours),n.setMinutes(n.getMinutes()+t.minutes),n.setMilliseconds(n.getMilliseconds()+t.seconds*1e3),n.setDate(n.getDate()+t.weeks*7),n},LR=(t,r)=>{const e=r?r.getTime():Date.now(),n=new Date(e);return(Cy(t,n).getTime()-n.getTime())/1e3},loe=J4(Object.freeze(Object.defineProperty({__proto__:null,pattern:My,parse:DR,end:Cy,toSeconds:LR,default:{end:Cy,toSeconds:LR,pattern:My,parse:DR}},Symbol.toStringTag,{value:"Module"})));var coe=pr,foe=Ha,doe=sn.f,Ry=coe("unscopables"),Iy=Array.prototype;Iy[Ry]==null&&doe(Iy,Ry,{configurable:!0,value:foe(null)});var Oy=function(t){Iy[Ry][t]=!0},poe=Rn,Ny=Oy,UR=ql,jR=zn,voe=sn.f,hoe=Sy,ep=Ey,moe=wr,VR="Array Iterator",goe=jR.set,yoe=jR.getterFor(VR),FR=hoe(Array,"Array",function(t,r){goe(this,{type:VR,target:poe(t),index:0,kind:r})},function(){var t=yoe(this),r=t.target,e=t.kind,n=t.index++;return!r||n>=r.length?(t.target=void 0,ep(void 0,!0)):e=="keys"?ep(n,!1):e=="values"?ep(r[n],!1):ep([n,r[n]],!1)},"values"),$R=UR.Arguments=UR.Array;if(Ny("keys"),Ny("values"),Ny("entries"),moe&&$R.name!=="values")try{voe($R,"name",{value:"values"})}catch{}var zR=zt,WR=aR,boe=sR,Xl=FR,Ay=la,BR=pr,Py=BR("iterator"),ZR=BR("toStringTag"),xy=Xl.values,qR=function(t,r){if(t){if(t[Py]!==xy)try{Ay(t,Py,xy)}catch{t[Py]=xy}if(t[ZR]||Ay(t,ZR,r),WR[r]){for(var e in Xl)if(t[e]!==Xl[e])try{Ay(t,e,Xl[e])}catch{t[e]=Xl[e]}}}};for(var Dy in WR)qR(zR[Dy]&&zR[Dy].prototype,Dy);qR(boe,"DOMTokenList");var _oe=sr,woe=Sr,QR=Js,Ly=function(t,r,e){var n,i;return QR&&_oe(n=r.constructor)&&n!==e&&woe(i=n.prototype)&&i!==e.prototype&&QR(t,i),t},koe=Dt,Toe=koe(1 .valueOf),Soe=`	
\v\f\r \u2028\u2029\uFEFF`,Eoe=Dt,Moe=xi,Coe=Fr,Uy=Soe,YR=Eoe("".replace),Roe=RegExp("^["+Uy+"]+"),Ioe=RegExp("(^|[^"+Uy+"])["+Uy+"]+$"),jy=function(t){return function(r){var e=Coe(Moe(r));return t&1&&(e=YR(e,Roe,"")),t&2&&(e=YR(e,Ioe,"$1")),e}},Ooe={start:jy(1),end:jy(2),trim:jy(3)},Noe=Lt,GR=gE,Aoe=wr,HR=zt,JR=yM,XR=Dt,Poe=wd,KR=Er,xoe=Ly,Doe=ua,Loe=Bs,eI=Qm,Uoe=Ot,joe=Ya.f,Voe=Ni.f,Foe=sn.f,$oe=Toe,zoe=Ooe.trim,tp="Number",iu=HR[tp];JR[tp];var Vy=iu.prototype,Woe=HR.TypeError,Boe=XR("".slice),rp=XR("".charCodeAt),Zoe=function(t){var r=eI(t,"number");return typeof r=="bigint"?r:qoe(r)},qoe=function(t){var r=eI(t,"number"),e,n,i,a,o,s,u,l;if(Loe(r))throw Woe("Cannot convert a Symbol value to a number");if(typeof r=="string"&&r.length>2){if(r=zoe(r),e=rp(r,0),e===43||e===45){if(n=rp(r,2),n===88||n===120)return NaN}else if(e===48){switch(rp(r,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+r}for(o=Boe(r,2),s=o.length,u=0;u<s;u++)if(l=rp(o,u),l<48||l>a)return NaN;return parseInt(o,i)}}return+r},Fy=Poe(tp,!iu(" 0o1")||!iu("0b1")||iu("+0x1")),Qoe=function(t){return Doe(Vy,t)&&Uoe(function(){$oe(t)})},np=function(r){var e=arguments.length<1?0:iu(Zoe(r));return Qoe(this)?xoe(Object(e),this,np):e};np.prototype=Vy,Fy&&!GR&&(Vy.constructor=np),Noe({global:!0,constructor:!0,wrap:!0,forced:Fy},{Number:np});var Yoe=function(t,r){for(var e=Aoe?joe(r):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;e.length>n;n++)KR(r,i=e[n])&&!KR(t,i)&&Foe(t,i,Voe(r,i))};(Fy||GR)&&Yoe(JR[tp],iu);var Goe=Or,tI=function(){var t=Goe(this),r="";return t.hasIndices&&(r+="d"),t.global&&(r+="g"),t.ignoreCase&&(r+="i"),t.multiline&&(r+="m"),t.dotAll&&(r+="s"),t.unicode&&(r+="u"),t.unicodeSets&&(r+="v"),t.sticky&&(r+="y"),r},$y=Ot,Hoe=zt,zy=Hoe.RegExp,Wy=$y(function(){var t=zy("a","y");return t.lastIndex=2,t.exec("abcd")!=null}),Joe=Wy||$y(function(){return!zy("a","y").sticky}),Xoe=Wy||$y(function(){var t=zy("^r","gy");return t.lastIndex=2,t.exec("str")!=null}),rI={BROKEN_CARET:Xoe,MISSED_STICKY:Joe,UNSUPPORTED_Y:Wy},Koe=Ot,ese=zt,tse=ese.RegExp,rse=Koe(function(){var t=tse(".","s");return!(t.dotAll&&t.exec(`
`)&&t.flags==="s")}),nse=Ot,ise=zt,ase=ise.RegExp,ose=nse(function(){var t=ase("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),au=dr,ip=Dt,sse=Fr,use=tI,lse=rI,cse=Qa,fse=Ha,dse=zn.get,pse=rse,vse=ose,hse=cse("native-string-replace",String.prototype.replace),ap=RegExp.prototype.exec,By=ap,mse=ip("".charAt),gse=ip("".indexOf),yse=ip("".replace),Zy=ip("".slice),qy=function(){var t=/a/,r=/b*/g;return au(ap,t,"a"),au(ap,r,"a"),t.lastIndex!==0||r.lastIndex!==0}(),nI=lse.BROKEN_CARET,Qy=/()??/.exec("")[1]!==void 0,bse=qy||Qy||nI||pse||vse;bse&&(By=function(r){var e=this,n=dse(e),i=sse(r),a=n.raw,o,s,u,l,c,f,d;if(a)return a.lastIndex=e.lastIndex,o=au(By,a,i),e.lastIndex=a.lastIndex,o;var v=n.groups,p=nI&&e.sticky,y=au(use,e),k=e.source,I=0,C=i;if(p&&(y=yse(y,"y",""),gse(y,"g")===-1&&(y+="g"),C=Zy(i,e.lastIndex),e.lastIndex>0&&(!e.multiline||e.multiline&&mse(i,e.lastIndex-1)!==`
`)&&(k="(?: "+k+")",C=" "+C,I++),s=new RegExp("^(?:"+k+")",y)),Qy&&(s=new RegExp("^"+k+"$(?!\\s)",y)),qy&&(u=e.lastIndex),l=au(ap,p?s:e,C),p?l?(l.input=Zy(l.input,I),l[0]=Zy(l[0],I),l.index=e.lastIndex,e.lastIndex+=l[0].length):e.lastIndex=0:qy&&l&&(e.lastIndex=e.global?l.index+l[0].length:u),Qy&&l&&l.length>1&&au(hse,l[0],s,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(l[c]=void 0)}),l&&v)for(l.groups=f=fse(null),c=0;c<v.length;c++)d=v[c],f[d[0]]=l[d[1]];return l});var op=By,_se=Lt,iI=op;_se({target:"RegExp",proto:!0,forced:/./.exec!==iI},{exec:iI});var aI=Md,oI=un,wse=op,sI=Ot,uI=pr,kse=la,Tse=uI("species"),Yy=RegExp.prototype,sp=function(t,r,e,n){var i=uI(t),a=!sI(function(){var l={};return l[i]=function(){return 7},""[t](l)!=7}),o=a&&!sI(function(){var l=!1,c=/a/;return t==="split"&&(c={},c.constructor={},c.constructor[Tse]=function(){return c},c.flags="",c[i]=/./[i]),c.exec=function(){return l=!0,null},c[i](""),!l});if(!a||!o||e){var s=aI(/./[i]),u=r(i,""[t],function(l,c,f,d,v){var p=aI(l),y=c.exec;return y===wse||y===Yy.exec?a&&!v?{done:!0,value:s(c,f,d)}:{done:!0,value:p(f,c,d)}:{done:!1}});oI(String.prototype,t,u[0]),oI(Yy,i,u[1])}n&&kse(Yy[i],"sham",!0)},Sse=yy.charAt,Gy=function(t,r,e){return r+(e?Sse(t,r).length:1)},Hy=Dt,Ese=en,Mse=Math.floor,Jy=Hy("".charAt),Cse=Hy("".replace),Xy=Hy("".slice),Rse=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Ise=/\$([$&'`]|\d{1,2})/g,Ose=function(t,r,e,n,i,a){var o=e+t.length,s=n.length,u=Ise;return i!==void 0&&(i=Ese(i),u=Rse),Cse(a,u,function(l,c){var f;switch(Jy(c,0)){case"$":return"$";case"&":return t;case"`":return Xy(r,0,e);case"'":return Xy(r,o);case"<":f=i[Xy(c,1,-1)];break;default:var d=+c;if(d===0)return l;if(d>s){var v=Mse(d/10);return v===0?l:v<=s?n[v-1]===void 0?Jy(c,1):n[v-1]+Jy(c,1):l}f=n[d-1]}return f===void 0?"":f})},lI=dr,Nse=Or,Ase=sr,Pse=Ai,xse=op,Dse=TypeError,up=function(t,r){var e=t.exec;if(Ase(e)){var n=lI(e,t,r);return n!==null&&Nse(n),n}if(Pse(t)==="RegExp")return lI(xse,t,r);throw Dse("RegExp#exec called on incompatible receiver")},Lse=Ga,cI=dr,lp=Dt,Use=sp,jse=Ot,Vse=Or,Fse=sr,$se=Pi,zse=Li,Wse=ca,ou=Fr,Bse=xi,Zse=Gy,qse=Fo,Qse=Ose,Yse=up,Gse=pr,Ky=Gse("replace"),Hse=Math.max,Jse=Math.min,Xse=lp([].concat),eb=lp([].push),fI=lp("".indexOf),dI=lp("".slice),Kse=function(t){return t===void 0?t:String(t)},eue=function(){return"a".replace(/./,"$0")==="$0"}(),pI=function(){return/./[Ky]?/./[Ky]("a","$0")==="":!1}(),tue=!jse(function(){var t=/./;return t.exec=function(){var r=[];return r.groups={a:"7"},r},"".replace(t,"$<a>")!=="7"});Use("replace",function(t,r,e){var n=pI?"$":"$0";return[function(a,o){var s=Bse(this),u=$se(a)?void 0:qse(a,Ky);return u?cI(u,a,s,o):cI(r,ou(s),a,o)},function(i,a){var o=Vse(this),s=ou(i);if(typeof a=="string"&&fI(a,n)===-1&&fI(a,"$<")===-1){var u=e(r,o,s,a);if(u.done)return u.value}var l=Fse(a);l||(a=ou(a));var c=o.global;if(c){var f=o.unicode;o.lastIndex=0}for(var d=[];;){var v=Yse(o,s);if(v===null||(eb(d,v),!c))break;var p=ou(v[0]);p===""&&(o.lastIndex=Zse(s,Wse(o.lastIndex),f))}for(var y="",k=0,I=0;I<d.length;I++){v=d[I];for(var C=ou(v[0]),L=Hse(Jse(zse(v.index),s.length),0),R=[],q=1;q<v.length;q++)eb(R,Kse(v[q]));var z=v.groups;if(l){var F=Xse([C],R,L,s);z!==void 0&&eb(F,z);var D=ou(Lse(a,void 0,F))}else D=Qse(C,s,L,R,z,a);L>=k&&(y+=dI(s,k,L)+D,k=L+C.length)}return y+dI(s,k)}]},!tue||!eue||pI);var rue=Lt,nue=Dt,iue=Tl,aue=Rn,oue=Jd,sue=nue([].join),uue=iue!=Object,lue=uue||!oue("join",",");rue({target:"Array",proto:!0,forced:lue},{join:function(r){return sue(aue(this),r===void 0?",":r)}});var Zr={},cue=Lt,vI=xl,fue=Td,due=Sr,hI=$o,pue=Jr,vue=Rn,hue=Ys,mue=pr,gue=Fl,yue=Qs,bue=gue("slice"),_ue=mue("species"),tb=Array,wue=Math.max;cue({target:"Array",proto:!0,forced:!bue},{slice:function(r,e){var n=vue(this),i=pue(n),a=hI(r,i),o=hI(e===void 0?i:e,i),s,u,l;if(vI(n)&&(s=n.constructor,fue(s)&&(s===tb||vI(s.prototype))?s=void 0:due(s)&&(s=s[_ue],s===null&&(s=void 0)),s===tb||s===void 0))return yue(n,a,o);for(u=new(s===void 0?tb:s)(wue(o-a,0)),l=0;a<o;a++,l++)a in n&&hue(u,l,n[a]);return u.length=l,u}});var kue=Lt,mI=dr,Tue=sr,gI=Or,Sue=Fr,Eue=function(){var t=!1,r=/[ac]/;return r.exec=function(){return t=!0,/./.exec.apply(this,arguments)},r.test("abc")===!0&&t}(),Mue=/./.test;kue({target:"RegExp",proto:!0,forced:!Eue},{test:function(t){var r=gI(this),e=Sue(t),n=r.exec;if(!Tue(n))return mI(Mue,r,e);var i=mI(n,r,e);return i===null?!1:(gI(i),!0)}});var Cue=Lt,Rue=wr,Iue=zt,cp=Dt,Oue=Er,Nue=sr,Aue=ua,Pue=Fr,xue=Ui,Due=$E,ga=Iue.Symbol,Xo=ga&&ga.prototype;if(Rue&&Nue(ga)&&(!("description"in Xo)||ga().description!==void 0)){var yI={},fp=function(){var r=arguments.length<1||arguments[0]===void 0?void 0:Pue(arguments[0]),e=Aue(Xo,this)?new ga(r):r===void 0?ga():ga(r);return r===""&&(yI[e]=!0),e};Due(fp,ga),fp.prototype=Xo,Xo.constructor=fp;var Lue=String(ga("test"))=="Symbol(test)",Uue=cp(Xo.valueOf),jue=cp(Xo.toString),Vue=/^Symbol\((.*)\)[^)]+$/,Fue=cp("".replace),$ue=cp("".slice);xue(Xo,"description",{configurable:!0,get:function(){var r=Uue(this);if(Oue(yI,r))return"";var e=jue(r),n=Lue?$ue(e,7,-1):Fue(e,Vue,"$1");return n===""?void 0:n}}),Cue({global:!0,constructor:!0,forced:!0},{Symbol:fp})}var zue=_M;zue("iterator");var Wue=wr,Bue=Ml.EXISTS,bI=Dt,Zue=Ui,_I=Function.prototype,que=bI(_I.toString),wI=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Que=bI(wI.exec),Yue="name";Wue&&!Bue&&Zue(_I,Yue,{configurable:!0,get:function(){try{return Que(wI,que(this))[1]}catch{return""}}});var eo={},Gue={get exports(){return eo},set exports(t){eo=t}},rb={},Hue={get exports(){return rb},set exports(t){rb=t}};(function(t){function r(e){if(Array.isArray(e))return e}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Hue);var nb={},Jue={get exports(){return nb},set exports(t){nb=t}};(function(t){function r(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,o,s,u,l=[],c=!0,f=!1;try{if(s=(i=i.call(e)).next,n===0){if(Object(i)!==i)return;c=!1}else for(;!(c=(a=s.call(i)).done)&&(l.push(a.value),l.length!==n);c=!0);}catch(d){f=!0,o=d}finally{try{if(!c&&i.return!=null&&(u=i.return(),Object(u)!==u))return}finally{if(f)throw o}}return l}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Jue);var dp={},Xue={get exports(){return dp},set exports(t){dp=t}},pp={},Kue={get exports(){return pp},set exports(t){pp=t}};(function(t){function r(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,a=new Array(n);i<n;i++)a[i]=e[i];return a}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Kue),function(t){var r=pp;function e(n,i){if(n){if(typeof n=="string")return r(n,i);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return r(n,i)}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Xue);var ib={},ele={get exports(){return ib},set exports(t){ib=t}};(function(t){function r(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(ele),function(t){var r=rb,e=nb,n=dp,i=ib;function a(o,s){return r(o)||e(o,s)||n(o,s)||i()}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports}(Gue);var to={},tle={get exports(){return to},set exports(t){to=t}},ab={},rle={get exports(){return ab},set exports(t){ab=t}};(function(t){var r=pp;function e(n){if(Array.isArray(n))return r(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(rle);var ob={},nle={get exports(){return ob},set exports(t){ob=t}};(function(t){function r(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(nle);var sb={},ile={get exports(){return sb},set exports(t){sb=t}};(function(t){function r(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(ile),function(t){var r=ab,e=ob,n=dp,i=sb;function a(o){return r(o)||e(o)||n(o)||i()}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports}(tle);var ale=Lt,ole=_d.includes,sle=Ot,ule=Oy,lle=sle(function(){return!Array(1).includes()});ale({target:"Array",proto:!0,forced:lle},{includes:function(r){return ole(this,r,arguments.length>1?arguments[1]:void 0)}}),ule("includes");var cle=Sr,fle=Math.floor,kI=Number.isInteger||function(r){return!cle(r)&&isFinite(r)&&fle(r)===r},dle=Lt,ple=kI;dle({target:"Number",stat:!0},{isInteger:ple});var TI=wr,vle=Ot,SI=Dt,hle=Gl,mle=Al,gle=Rn,yle=kl.f,EI=SI(yle),ble=SI([].push),_le=TI&&vle(function(){var t=Object.create(null);return t[2]=2,!EI(t,2)}),MI=function(t){return function(r){for(var e=gle(r),n=mle(e),i=_le&&hle(e)===null,a=n.length,o=0,s=[],u;a>o;)u=n[o++],(!TI||(i?u in e:EI(e,u)))&&ble(s,t?[u,e[u]]:e[u]);return s}},wle={entries:MI(!0),values:MI(!1)},kle=Lt,Tle=wle.entries;kle({target:"Object",stat:!0},{entries:function(r){return Tle(r)}});/*
  @license
  Copyright (c) 2021 Twilio Inc.

  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


  */Object.defineProperty(Zr,"__esModule",{value:!0});var Sle=_n,Ele=eo,Mle=to,Cle=ji,Rle=qn,Ile=Bn,Ole=Zn,Nle=wn;function ro(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var su=ro(Sle),ya=ro(Ele),ub=ro(Mle),Ale=ro(Cle),Ple=ro(Rle),xle=ro(Ile),Dle=ro(Ole),CI=ro(Nle),ba=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return{checks:e}};function Lle(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Ule(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Ule(t,r){if(t){if(typeof t=="string")return RI(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return RI(t,r)}}function RI(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var II=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return ba(function(i){var a=!1,o=[],s=Lle(e),u;try{for(s.s();!(u=s.n()).done;){var l=u.value;if(typeof l=="string"){a=a||su.default(i)===l,o.push("of type ".concat(l));continue}a=a||i instanceof l,o.push("an instance of ".concat(l.name))}}catch(c){s.e(c)}finally{s.f()}return[a,o]})};function jle(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Vle(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Vle(t,r){if(t){if(typeof t=="string")return OI(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return OI(t,r)}}function OI(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Fle=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return ba(function(i){var a=!1,o=[],s=jle(e),u;try{for(s.s();!(u=s.n()).done;){var l=u.value;a=a||i===l,o.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){s.e(c)}finally{s.f()}return[a,o]})};function $le(t){var r=zle();return function(){var n=CI.default(t),i;if(r){var a=CI.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Dle.default(this,i)}}function zle(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kl(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Wle(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Wle(t,r){if(t){if(typeof t=="string")return NI(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return NI(t,r)}}function NI(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var vp=function(r,e){if(e.length>r.length)throw new Error("Expected at most ".concat(r.length," argument(s), but got ").concat(e.length));for(;e.length<r.length;)e.push(void 0);var n=Kl(e.entries()),i;try{for(n.s();!(i=n.n()).done;){var a=ya.default(i.value,2),o=a[0],s=a[1],u=mp(r[o],s),l=ya.default(u,4),c=l[0],f=l[1],d=l[2],v=l[3];if(!c){var p=o+1;throw new Error("Argument ".concat(p," is expected to be ").concat(d).concat(v," but got ").concat(f))}}}catch(y){n.e(y)}finally{n.f()}},AI=function(r){var e,n,i=["undefined","boolean","number","bigint","string"];if(i.includes(su.default(r))&&(n=typeof r=="string"?'"'.concat(r,'"'):"".concat(r)),su.default(r)==="object"&&(r==null||(e=r.constructor)===null||e===void 0?void 0:e.name)!=="Object"){var a;n=r===null?"null":"instance of ".concat(r==null||(a=r.constructor)===null||a===void 0?void 0:a.name)}return n||(n=su.default(r)),n},Ble=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var i=lb(e);return function(a){return function(o){xle.default(u,o);var s=$le(u);function u(){Ple.default(this,u);for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return vp(i,c),s.call.apply(s,[this].concat(c))}return Ale.default(u)}(a)}},Zle=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var i=lb(e);return function(a,o,s){if(typeof s.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=s.value;s.value=function(){for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return vp(i,c),u.apply(this,c)}}},qle=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var i=lb(e);return function(a,o,s){if(typeof s.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=s.value;s.value=function(){for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];try{vp(i,c)}catch(d){return Promise.reject(d)}return u.apply(this,c)}}},lb=function(r){var e=[],n=Kl(r),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;e.push(hp(a))}}catch(o){n.e(o)}finally{n.f()}return e},hp=function(r){var e=[],n=Array.isArray(r)?r:[r],i=Kl(n),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;if(typeof o=="string"||typeof o=="function"){e.push(II(o));continue}e.push(o)}}catch(s){i.e(s)}finally{i.f()}return e},mp=function(r,e){var n=[],i,a=!1,o=Kl(r),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,l=Kl(u.checks),c;try{for(l.s();!(c=l.n()).done;){var f=c.value,d=f(e),v=ya.default(d,3),p=v[0],y=v[1],k=v[2];a=a||p,!i&&k&&(i=k),y&&(n=typeof y=="string"?[].concat(ub.default(n),[y]):[].concat(ub.default(n),ub.default(y)))}}catch(R){l.e(R)}finally{l.f()}}}catch(R){o.e(R)}finally{o.f()}if(a)return[!0];var I=i||AI(e),C=n.length-1,L=C>0?"".concat(n.slice(0,C).join(", ")," or ").concat(n[C]):n.join(", ");return[!1,I,L,C>1?";":","]};function Qle(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Yle(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Yle(t,r){if(t){if(typeof t=="string")return PI(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return PI(t,r)}}function PI(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Gle=function(r,e){return ba(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(r)];var i=Qle(n.entries()),a;try{for(i.s();!(a=i.n()).done;){var o=ya.default(a.value,2),s=o[0],u=o[1],l=mp(hp(e),u),c=ya.default(l,3),f=c[0],d=c[1],v=c[2];if(!f)return[!1,"a valid non-empty array of ".concat(r," (index ").concat(s," should be ").concat(v,")"),"malformed array of ".concat(r," (index ").concat(s," is ").concat(d,")")]}}catch(p){i.e(p)}finally{i.f()}return[!0]})},Hle=ba(function(t){return[typeof t=="string"&&t.length>0,"a non-empty string"]}),Jle=ba(function(t){return[typeof t=="number"&&Number.isInteger(t)&&t>=0,"a non-negative integer"]}),Xle=ba(function(t){return[su.default(t)==="object"&&t!==null&&!Array.isArray(t),"a pure object (non-null and non-array)"]}),Kle=function(r,e){return ba(function(n){if(su.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(r," (should be a pure object)")];for(var i=0,a=Object.entries(e);i<a.length;i++){var o=ya.default(a[i],2),s=o[0],u=o[1],l=mp(hp(u),n[s]),c=ya.default(l,3),f=c[0],d=c[1],v=c[2];if(!f)return[!1,"valid ".concat(r,' (key "').concat(s,'" should be ').concat(v,")"),"malformed ".concat(r,' (key "').concat(s,'" is ').concat(d,")")]}return[!0]})};function ece(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=tce(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function tce(t,r){if(t){if(typeof t=="string")return xI(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return xI(t,r)}}function xI(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var rce=function(r,e){return ba(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(r)];var i=ece(n.entries()),a;try{for(i.s();!(a=i.n()).done;){var o=ya.default(a.value,2),s=o[0],u=o[1],l=mp(hp(e),u),c=ya.default(l,3),f=c[0],d=c[1],v=c[2];if(!f)return[!1,"a valid array of ".concat(r," (index ").concat(s," should be ").concat(v,")"),"malformed array of ".concat(r," (index ").concat(s," is ").concat(d,")")]}}catch(p){i.e(p)}finally{i.f()}return[!0]})};Zr.array=rce,Zr.custom=ba,Zr.literal=Fle,Zr.nonEmptyArray=Gle,Zr.nonEmptyString=Hle,Zr.nonNegativeInteger=Jle,Zr.objectSchema=Kle,Zr.pureObject=Xle,Zr.runtimeTypeValidation=vp,Zr.stringifyReceivedType=AI,Zr.type=II,Zr.validateConstructorTypes=Ble,Zr.validateTypes=Zle,Zr.validateTypesAsync=qle;var cb={},ec={},nce={get exports(){return ec},set exports(t){ec=t}},fb={},ice={get exports(){return fb},set exports(t){fb=t}};(function(t){var r=wn;function e(n,i){for(;!Object.prototype.hasOwnProperty.call(n,i)&&(n=r(n),n!==null););return n}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ice),function(t){var r=fb;function e(){return typeof Reflect<"u"&&Reflect.get?(t.exports=e=Reflect.get.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=e=function(i,a,o){var s=r(i,a);if(s){var u=Object.getOwnPropertyDescriptor(s,a);return u.get?u.get.call(arguments.length<3?i:o):u.value}},t.exports.__esModule=!0,t.exports.default=t.exports),e.apply(this,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(nce);/*
  @license
  Copyright (c) 2021 Twilio Inc.

  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  */Object.defineProperty(cb,"__esModule",{value:!0});var ace=to,oce=qn,sce=ji,uce=ha,lce=ec,cce=Bn,fce=Zn,dce=wn,pce=ma;function _a(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var DI=_a(ace),vce=_a(oce),hce=_a(sce),mce=_a(uce),Ko=_a(lce),gce=_a(cce),yce=_a(fce),wa=_a(dce),bce=_a(pce),_ce;function no(){}no.prototype=Object.create(null);function gr(){gr.init.call(this)}gr.EventEmitter=gr,gr.usingDomains=!1,gr.prototype.domain=void 0,gr.prototype._events=void 0,gr.prototype._maxListeners=void 0,gr.defaultMaxListeners=10,gr.init=function(){this.domain=null,gr.usingDomains&&_ce.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new no,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},gr.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||isNaN(r))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=r,this};function LI(t){return t._maxListeners===void 0?gr.defaultMaxListeners:t._maxListeners}gr.prototype.getMaxListeners=function(){return LI(this)};function wce(t,r,e){if(r)t.call(e);else for(var n=t.length,i=tc(t,n),a=0;a<n;++a)i[a].call(e)}function kce(t,r,e,n){if(r)t.call(e,n);else for(var i=t.length,a=tc(t,i),o=0;o<i;++o)a[o].call(e,n)}function Tce(t,r,e,n,i){if(r)t.call(e,n,i);else for(var a=t.length,o=tc(t,a),s=0;s<a;++s)o[s].call(e,n,i)}function Sce(t,r,e,n,i,a){if(r)t.call(e,n,i,a);else for(var o=t.length,s=tc(t,o),u=0;u<o;++u)s[u].call(e,n,i,a)}function Ece(t,r,e,n){if(r)t.apply(e,n);else for(var i=t.length,a=tc(t,i),o=0;o<i;++o)a[o].apply(e,n)}gr.prototype.emit=function(r){var e,n,i,a,o,s,u,l=r==="error";if(s=this._events,s)l=l&&s.error==null;else if(!l)return!1;if(u=this.domain,l){if(e=arguments[1],u)e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=u,e.domainThrown=!1,u.emit("error",e);else{if(e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}return!1}if(n=s[r],!n)return!1;var f=typeof n=="function";switch(i=arguments.length,i){case 1:wce(n,f,this);break;case 2:kce(n,f,this,arguments[1]);break;case 3:Tce(n,f,this,arguments[1],arguments[2]);break;case 4:Sce(n,f,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),o=1;o<i;o++)a[o-1]=arguments[o];Ece(n,f,this,a)}return!0};function UI(t,r,e,n){var i,a,o;if(typeof e!="function")throw new TypeError('"listener" argument must be a function');if(a=t._events,a?(a.newListener&&(t.emit("newListener",r,e.listener?e.listener:e),a=t._events),o=a[r]):(a=t._events=new no,t._eventsCount=0),!o)o=a[r]=e,++t._eventsCount;else if(typeof o=="function"?o=a[r]=n?[e,o]:[o,e]:n?o.unshift(e):o.push(e),!o.warned&&(i=LI(t),i&&i>0&&o.length>i)){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+r+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=r,s.count=o.length,Mce(s)}return t}function Mce(t){typeof console.warn=="function"?console.warn(t):console.log(t)}gr.prototype.addListener=function(r,e){return UI(this,r,e,!1)},gr.prototype.on=gr.prototype.addListener,gr.prototype.prependListener=function(r,e){return UI(this,r,e,!0)};function jI(t,r,e){var n=!1;function i(){t.removeListener(r,i),n||(n=!0,e.apply(t,arguments))}return i.listener=e,i}gr.prototype.once=function(r,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.on(r,jI(this,r,e)),this},gr.prototype.prependOnceListener=function(r,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(r,jI(this,r,e)),this},gr.prototype.removeListener=function(r,e){var n,i,a,o,s;if(typeof e!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[r],!n)return this;if(n===e||n.listener&&n.listener===e)--this._eventsCount===0?this._events=new no:(delete i[r],i.removeListener&&this.emit("removeListener",r,n.listener||e));else if(typeof n!="function"){for(a=-1,o=n.length;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){s=n[o].listener,a=o;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new no,this;delete i[r]}else Cce(n,a);i.removeListener&&this.emit("removeListener",r,s||e)}return this},gr.prototype.off=function(t,r){return this.removeListener(t,r)},gr.prototype.removeAllListeners=function(r){var e,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new no,this._eventsCount=0):n[r]&&(--this._eventsCount===0?this._events=new no:delete n[r]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,o;a<i.length;++a)o=i[a],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new no,this._eventsCount=0,this}if(e=n[r],typeof e=="function")this.removeListener(r,e);else if(e)do this.removeListener(r,e[e.length-1]);while(e[0]);return this},gr.prototype.listeners=function(r){var e,n,i=this._events;return i?(e=i[r],e?typeof e=="function"?n=[e.listener||e]:n=Rce(e):n=[]):n=[],n},gr.listenerCount=function(t,r){return typeof t.listenerCount=="function"?t.listenerCount(r):VI.call(t,r)},gr.prototype.listenerCount=VI;function VI(t){var r=this._events;if(r){var e=r[t];if(typeof e=="function")return 1;if(e)return e.length}return 0}gr.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Cce(t,r){for(var e=r,n=e+1,i=t.length;n<i;e+=1,n+=1)t[e]=t[n];t.pop()}function tc(t,r){for(var e=new Array(r);r--;)e[r]=t[r];return e}function Rce(t){for(var r=new Array(t.length),e=0;e<r.length;++e)r[e]=t[e].listener||t[e];return r}function Ice(t){var r=Oce();return function(){var n=wa.default(t),i;if(r){var a=wa.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return yce.default(this,i)}}function Oce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Nce=function(t){gce.default(e,t);var r=Ice(e);function e(){var n;return vce.default(this,e),n=r.call(this),bce.default(mce.default(n),"eventHistory",new Map),n}return hce.default(e,[{key:"on",value:function(i,a){return Ko.default(wa.default(e.prototype),"on",this).call(this,i,a)}},{key:"once",value:function(i,a){return Ko.default(wa.default(e.prototype),"once",this).call(this,i,a)}},{key:"off",value:function(i,a){return Ko.default(wa.default(e.prototype),"off",this).call(this,i,a)}},{key:"emit",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];return this.eventHistory.set(i,s),(a=Ko.default(wa.default(e.prototype),"emit",this)).call.apply(a,[this,i].concat(s))}},{key:"addListener",value:function(i,a){return Ko.default(wa.default(e.prototype),"addListener",this).call(this,i,a)}},{key:"removeListener",value:function(i,a){return Ko.default(wa.default(e.prototype),"removeListener",this).call(this,i,a)}},{key:"addListenerWithReplay",value:function(i,a){var o=this.eventHistory.get(i);return o!==void 0&&a.apply(void 0,DI.default(o)),this.addListener(i,a)}},{key:"onWithReplay",value:function(i,a){return this.addListenerWithReplay(i,a)}},{key:"onceWithReplay",value:function(i,a){var o=this.eventHistory.get(i);return o!==void 0?(a.apply(void 0,DI.default(o)),this):Ko.default(wa.default(e.prototype),"once",this).call(this,i,a)}}]),e}(gr);cb.ReplayEventEmitter=Nce;var gp={},Ace={get exports(){return gp},set exports(t){gp=t}};(function(t,r){var e=200,n="__lodash_hash_undefined__",i=1,a=2,o=9007199254740991,s="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",f="[object Date]",d="[object Error]",v="[object Function]",p="[object GeneratorFunction]",y="[object Map]",k="[object Number]",I="[object Null]",C="[object Object]",L="[object Promise]",R="[object Proxy]",q="[object RegExp]",z="[object Set]",F="[object String]",D="[object Symbol]",W="[object Undefined]",X="[object WeakMap]",me="[object ArrayBuffer]",de="[object DataView]",H="[object Float32Array]",ee="[object Float64Array]",Z="[object Int8Array]",te="[object Int16Array]",re="[object Int32Array]",K="[object Uint8Array]",fe="[object Uint8ClampedArray]",Te="[object Uint16Array]",$="[object Uint32Array]",We=/[\\^$.*+?()[\]{}|]/g,et=/^\[object .+?Constructor\]$/,dt=/^(?:0|[1-9]\d*)$/,$e={};$e[H]=$e[ee]=$e[Z]=$e[te]=$e[re]=$e[K]=$e[fe]=$e[Te]=$e[$]=!0,$e[s]=$e[u]=$e[me]=$e[c]=$e[de]=$e[f]=$e[d]=$e[v]=$e[y]=$e[k]=$e[C]=$e[q]=$e[z]=$e[F]=$e[X]=!1;var ue=typeof V=="object"&&V&&V.Object===Object&&V,Rr=typeof self=="object"&&self&&self.Object===Object&&self,Ue=ue||Rr||Function("return this")(),ke=r&&!r.nodeType&&r,Gt=ke&&!0&&t&&!t.nodeType&&t,Qe=Gt&&Gt.exports===ke,vr=Qe&&ue.process,At=function(){try{return vr&&vr.binding&&vr.binding("util")}catch{}}(),Oe=At&&At.isTypedArray;function _t(Y,M){for(var O=-1,T=Y==null?0:Y.length,g=0,m=[];++O<T;){var S=Y[O];M(S,O,Y)&&(m[g++]=S)}return m}function Bt(Y,M){for(var O=-1,T=M.length,g=Y.length;++O<T;)Y[g+O]=M[O];return Y}function Fe(Y,M){for(var O=-1,T=Y==null?0:Y.length;++O<T;)if(M(Y[O],O,Y))return!0;return!1}function rr(Y,M){for(var O=-1,T=Array(Y);++O<Y;)T[O]=M(O);return T}function Pt(Y){return function(M){return Y(M)}}function ot(Y,M){return Y.has(M)}function Tt(Y,M){return Y==null?void 0:Y[M]}function Be(Y){var M=-1,O=Array(Y.size);return Y.forEach(function(T,g){O[++M]=[g,T]}),O}function Dn(Y,M){return function(O){return Y(M(O))}}function _i(Y){var M=-1,O=Array(Y.size);return Y.forEach(function(T){O[++M]=T}),O}var Qt=Array.prototype,er=Function.prototype,jt=Object.prototype,kt=Ue["__core-js_shared__"],br=er.toString,Nr=jt.hasOwnProperty,Xr=function(){var Y=/[^.]+$/.exec(kt&&kt.keys&&kt.keys.IE_PROTO||"");return Y?"Symbol(src)_1."+Y:""}(),Yi=jt.toString,La=RegExp("^"+br.call(Nr).replace(We,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hn=Qe?Ue.Buffer:void 0,qr=Ue.Symbol,Ln=Ue.Uint8Array,Re=jt.propertyIsEnumerable,Ie=Qt.splice,he=qr?qr.toStringTag:void 0,ye=Object.getOwnPropertySymbols,ge=hn?hn.isBuffer:void 0,Ae=Dn(Object.keys,Object),De=jr(Ue,"DataView"),se=jr(Ue,"Map"),be=jr(Ue,"Promise"),oe=jr(Ue,"Set"),pe=jr(Ue,"WeakMap"),ae=jr(Object,"create"),Ze=P(De),Pe=P(se),ct=P(be),tt=P(oe),it=P(pe),pt=qr?qr.prototype:void 0,vt=pt?pt.valueOf:void 0;function st(Y){var M=-1,O=Y==null?0:Y.length;for(this.clear();++M<O;){var T=Y[M];this.set(T[0],T[1])}}function ft(){this.__data__=ae?ae(null):{},this.size=0}function ht(Y){var M=this.has(Y)&&delete this.__data__[Y];return this.size-=M?1:0,M}function Mt(Y){var M=this.__data__;if(ae){var O=M[Y];return O===n?void 0:O}return Nr.call(M,Y)?M[Y]:void 0}function tn(Y){var M=this.__data__;return ae?M[Y]!==void 0:Nr.call(M,Y)}function Un(Y,M){var O=this.__data__;return this.size+=this.has(Y)?0:1,O[Y]=ae&&M===void 0?n:M,this}st.prototype.clear=ft,st.prototype.delete=ht,st.prototype.get=Mt,st.prototype.has=tn,st.prototype.set=Un;function St(Y){var M=-1,O=Y==null?0:Y.length;for(this.clear();++M<O;){var T=Y[M];this.set(T[0],T[1])}}function ri(){this.__data__=[],this.size=0}function Qr(Y){var M=this.__data__,O=_o(M,Y);if(O<0)return!1;var T=M.length-1;return O==T?M.pop():Ie.call(M,O,1),--this.size,!0}function bo(Y){var M=this.__data__,O=_o(M,Y);return O<0?void 0:M[O][1]}function Du(Y){return _o(this.__data__,Y)>-1}function Fc(Y,M){var O=this.__data__,T=_o(O,Y);return T<0?(++this.size,O.push([Y,M])):O[T][1]=M,this}St.prototype.clear=ri,St.prototype.delete=Qr,St.prototype.get=bo,St.prototype.has=Du,St.prototype.set=Fc;function wi(Y){var M=-1,O=Y==null?0:Y.length;for(this.clear();++M<O;){var T=Y[M];this.set(T[0],T[1])}}function Lu(){this.size=0,this.__data__={hash:new st,map:new(se||St),string:new st}}function $c(Y){var M=ja(this,Y).delete(Y);return this.size-=M?1:0,M}function zc(Y){return ja(this,Y).get(Y)}function mn(Y){return ja(this,Y).has(Y)}function Wc(Y,M){var O=ja(this,Y),T=O.size;return O.set(Y,M),this.size+=O.size==T?0:1,this}wi.prototype.clear=Lu,wi.prototype.delete=$c,wi.prototype.get=zc,wi.prototype.has=mn,wi.prototype.set=Wc;function Ua(Y){var M=-1,O=Y==null?0:Y.length;for(this.__data__=new wi;++M<O;)this.add(Y[M])}function Ur(Y){return this.__data__.set(Y,n),this}function Bc(Y){return this.__data__.has(Y)}Ua.prototype.add=Ua.prototype.push=Ur,Ua.prototype.has=Bc;function ni(Y){var M=this.__data__=new St(Y);this.size=M.size}function Uu(){this.__data__=new St,this.size=0}function Zc(Y){var M=this.__data__,O=M.delete(Y);return this.size=M.size,O}function qc(Y){return this.__data__.get(Y)}function ki(Y){return this.__data__.has(Y)}function ir(Y,M){var O=this.__data__;if(O instanceof St){var T=O.__data__;if(!se||T.length<e-1)return T.push([Y,M]),this.size=++O.size,this;O=this.__data__=new wi(T)}return O.set(Y,M),this.size=O.size,this}ni.prototype.clear=Uu,ni.prototype.delete=Zc,ni.prototype.get=qc,ni.prototype.has=ki,ni.prototype.set=ir;function Qc(Y,M){var O=j(Y),T=!O&&Q(Y),g=!O&&!T&&we(Y),m=!O&&!T&&!g&&Yr(Y),S=O||T||g||m,b=S?rr(Y.length,String):[],_=b.length;for(var w in Y)(M||Nr.call(Y,w))&&!(S&&(w=="length"||g&&(w=="offset"||w=="parent")||m&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||Ti(w,_)))&&b.push(w);return b}function _o(Y,M){for(var O=Y.length;O--;)if(A(Y[O][0],M))return O;return-1}function Yc(Y,M,O){var T=M(Y);return j(Y)?T:Bt(T,O(Y))}function ii(Y){return Y==null?Y===void 0?W:I:he&&he in Object(Y)?wo(Y):x(Y)}function vs(Y){return oi(Y)&&ii(Y)==s}function ju(Y,M,O,T,g){return Y===M?!0:Y==null||M==null||!oi(Y)&&!oi(M)?Y!==Y&&M!==M:Gc(Y,M,O,T,ju,g)}function Gc(Y,M,O,T,g,m){var S=j(Y),b=j(M),_=S?u:ai(Y),w=b?u:ai(M);_=_==s?C:_,w=w==s?C:w;var E=_==C,N=w==C,J=_==w;if(J&&we(Y)){if(!we(M))return!1;S=!0,E=!1}if(J&&!E)return m||(m=new ni),S||Yr(Y)?Vu(Y,M,O,T,g,m):Xc(Y,M,_,O,T,g,m);if(!(O&i)){var ne=E&&Nr.call(Y,"__wrapped__"),ce=N&&Nr.call(M,"__wrapped__");if(ne||ce){var ve=ne?Y.value():Y,ut=ce?M.value():M;return m||(m=new ni),g(ve,ut,O,T,m)}}return J?(m||(m=new ni),Kc(Y,M,O,T,g,m)):!1}function Hc(Y){if(!xt(Y)||B(Y))return!1;var M=Ye(Y)?La:et;return M.test(P(Y))}function rn(Y){return oi(Y)&&gt(Y.length)&&!!$e[ii(Y)]}function Jc(Y){if(!G(Y))return Ae(Y);var M=[];for(var O in Object(Y))Nr.call(Y,O)&&O!="constructor"&&M.push(O);return M}function Vu(Y,M,O,T,g,m){var S=O&i,b=Y.length,_=M.length;if(b!=_&&!(S&&_>b))return!1;var w=m.get(Y);if(w&&m.get(M))return w==M;var E=-1,N=!0,J=O&a?new Ua:void 0;for(m.set(Y,M),m.set(M,Y);++E<b;){var ne=Y[E],ce=M[E];if(T)var ve=S?T(ce,ne,E,M,Y,m):T(ne,ce,E,Y,M,m);if(ve!==void 0){if(ve)continue;N=!1;break}if(J){if(!Fe(M,function(ut,Ct){if(!ot(J,Ct)&&(ne===ut||g(ne,ut,O,T,m)))return J.push(Ct)})){N=!1;break}}else if(!(ne===ce||g(ne,ce,O,T,m))){N=!1;break}}return m.delete(Y),m.delete(M),N}function Xc(Y,M,O,T,g,m,S){switch(O){case de:if(Y.byteLength!=M.byteLength||Y.byteOffset!=M.byteOffset)return!1;Y=Y.buffer,M=M.buffer;case me:return!(Y.byteLength!=M.byteLength||!m(new Ln(Y),new Ln(M)));case c:case f:case k:return A(+Y,+M);case d:return Y.name==M.name&&Y.message==M.message;case q:case F:return Y==M+"";case y:var b=Be;case z:var _=T&i;if(b||(b=_i),Y.size!=M.size&&!_)return!1;var w=S.get(Y);if(w)return w==M;T|=a,S.set(Y,M);var E=Vu(b(Y),b(M),T,g,m,S);return S.delete(Y),E;case D:if(vt)return vt.call(Y)==vt.call(M)}return!1}function Kc(Y,M,O,T,g,m){var S=O&i,b=Gi(Y),_=b.length,w=Gi(M),E=w.length;if(_!=E&&!S)return!1;for(var N=_;N--;){var J=b[N];if(!(S?J in M:Nr.call(M,J)))return!1}var ne=m.get(Y);if(ne&&m.get(M))return ne==M;var ce=!0;m.set(Y,M),m.set(M,Y);for(var ve=S;++N<_;){J=b[N];var ut=Y[J],Ct=M[J];if(T)var Vt=S?T(Ct,ut,J,M,Y,m):T(ut,Ct,J,Y,M,m);if(!(Vt===void 0?ut===Ct||g(ut,Ct,O,T,m):Vt)){ce=!1;break}ve||(ve=J=="constructor")}if(ce&&!ve){var Ft=Y.constructor,En=M.constructor;Ft!=En&&"constructor"in Y&&"constructor"in M&&!(typeof Ft=="function"&&Ft instanceof Ft&&typeof En=="function"&&En instanceof En)&&(ce=!1)}return m.delete(Y),m.delete(M),ce}function Gi(Y){return Yc(Y,Si,Fu)}function ja(Y,M){var O=Y.__data__;return ef(M)?O[typeof M=="string"?"string":"hash"]:O.map}function jr(Y,M){var O=Tt(Y,M);return Hc(O)?O:void 0}function wo(Y){var M=Nr.call(Y,he),O=Y[he];try{Y[he]=void 0;var T=!0}catch{}var g=Yi.call(Y);return T&&(M?Y[he]=O:delete Y[he]),g}var Fu=ye?function(Y){return Y==null?[]:(Y=Object(Y),_t(ye(Y),function(M){return Re.call(Y,M)}))}:K0,ai=ii;(De&&ai(new De(new ArrayBuffer(1)))!=de||se&&ai(new se)!=y||be&&ai(be.resolve())!=L||oe&&ai(new oe)!=z||pe&&ai(new pe)!=X)&&(ai=function(Y){var M=ii(Y),O=M==C?Y.constructor:void 0,T=O?P(O):"";if(T)switch(T){case Ze:return de;case Pe:return y;case ct:return L;case tt:return z;case it:return X}return M});function Ti(Y,M){return M=M??o,!!M&&(typeof Y=="number"||dt.test(Y))&&Y>-1&&Y%1==0&&Y<M}function ef(Y){var M=typeof Y;return M=="string"||M=="number"||M=="symbol"||M=="boolean"?Y!=="__proto__":Y===null}function B(Y){return!!Xr&&Xr in Y}function G(Y){var M=Y&&Y.constructor,O=typeof M=="function"&&M.prototype||jt;return Y===O}function x(Y){return Yi.call(Y)}function P(Y){if(Y!=null){try{return br.call(Y)}catch{}try{return Y+""}catch{}}return""}function A(Y,M){return Y===M||Y!==Y&&M!==M}var Q=vs(function(){return arguments}())?vs:function(Y){return oi(Y)&&Nr.call(Y,"callee")&&!Re.call(Y,"callee")},j=Array.isArray;function Se(Y){return Y!=null&&gt(Y.length)&&!Ye(Y)}var we=ge||Ir;function Ve(Y,M){return ju(Y,M)}function Ye(Y){if(!xt(Y))return!1;var M=ii(Y);return M==v||M==p||M==l||M==R}function gt(Y){return typeof Y=="number"&&Y>-1&&Y%1==0&&Y<=o}function xt(Y){var M=typeof Y;return Y!=null&&(M=="object"||M=="function")}function oi(Y){return Y!=null&&typeof Y=="object"}var Yr=Oe?Pt(Oe):rn;function Si(Y){return Se(Y)?Qc(Y):Jc(Y)}function K0(){return[]}function Ir(){return!1}t.exports=Ve})(Ace,gp);var rc={},Pce={get exports(){return rc},set exports(t){rc=t}},xce=Ot,Dce=xce(function(){if(typeof ArrayBuffer=="function"){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),Lce=Ot,Uce=Sr,jce=Ai,FI=Dce,yp=Object.isExtensible,Vce=Lce(function(){yp(1)}),Fce=Vce||FI?function(r){return!Uce(r)||FI&&jce(r)=="ArrayBuffer"?!1:yp?yp(r):!0}:yp,$ce=Ot,$I=!$ce(function(){return Object.isExtensible(Object.preventExtensions({}))}),zce=Lt,Wce=Dt,Bce=Cl,Zce=Sr,db=Er,qce=sn.f,zI=Ya,Qce=wg,pb=Fce,Yce=Sl,Gce=$I,WI=!1,ka=Yce("meta"),Hce=0,vb=function(t){qce(t,ka,{value:{objectID:"O"+Hce++,weakData:{}}})},Jce=function(t,r){if(!Zce(t))return typeof t=="symbol"?t:(typeof t=="string"?"S":"P")+t;if(!db(t,ka)){if(!pb(t))return"F";if(!r)return"E";vb(t)}return t[ka].objectID},Xce=function(t,r){if(!db(t,ka)){if(!pb(t))return!0;if(!r)return!1;vb(t)}return t[ka].weakData},Kce=function(t){return Gce&&WI&&pb(t)&&!db(t,ka)&&vb(t),t},efe=function(){tfe.enable=function(){},WI=!0;var t=zI.f,r=Wce([].splice),e={};e[ka]=1,t(e).length&&(zI.f=function(n){for(var i=t(n),a=0,o=i.length;a<o;a++)if(i[a]===ka){r(i,a,1);break}return i},zce({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Qce.f}))},tfe=Pce.exports={enable:efe,fastKey:Jce,getWeakData:Xce,onFreeze:Kce};Bce[ka]=!0;var rfe=Lt,nfe=zt,ife=Dt,BI=wd,afe=un,ofe=rc,sfe=Gd,ufe=Zo,lfe=sr,cfe=Pi,hb=Sr,mb=Ot,ffe=Hd,dfe=fa,pfe=Ly,ZI=function(t,r,e){var n=t.indexOf("Map")!==-1,i=t.indexOf("Weak")!==-1,a=n?"set":"add",o=nfe[t],s=o&&o.prototype,u=o,l={},c=function(I){var C=ife(s[I]);afe(s,I,I=="add"?function(R){return C(this,R===0?0:R),this}:I=="delete"?function(L){return i&&!hb(L)?!1:C(this,L===0?0:L)}:I=="get"?function(R){return i&&!hb(R)?void 0:C(this,R===0?0:R)}:I=="has"?function(R){return i&&!hb(R)?!1:C(this,R===0?0:R)}:function(R,q){return C(this,R===0?0:R,q),this})},f=BI(t,!lfe(o)||!(i||s.forEach&&!mb(function(){new o().entries().next()})));if(f)u=e.getConstructor(r,t,n,a),ofe.enable();else if(BI(t,!0)){var d=new u,v=d[a](i?{}:-0,1)!=d,p=mb(function(){d.has(1)}),y=ffe(function(I){new o(I)}),k=!i&&mb(function(){for(var I=new o,C=5;C--;)I[a](C,C);return!I.has(-0)});y||(u=r(function(I,C){ufe(I,s);var L=pfe(new o,I,u);return cfe(C)||sfe(C,L[a],{that:L,AS_ENTRIES:n}),L}),u.prototype=s,s.constructor=u),(p||k)&&(c("delete"),c("has"),n&&c("get")),(k||v)&&c(a),i&&s.clear&&delete s.clear}return l[t]=u,rfe({global:!0,constructor:!0,forced:u!=o},l),dfe(u,t),i||e.setStrong(u,t,n),u},vfe=un,gb=function(t,r,e){for(var n in r)vfe(t,n,r[n],e);return t},hfe=Ha,mfe=Ui,qI=gb,gfe=pa,yfe=Zo,bfe=Pi,_fe=Gd,wfe=Sy,bp=Ey,kfe=Dd,nc=wr,QI=rc.fastKey,YI=zn,GI=YI.set,yb=YI.getterFor,HI={getConstructor:function(t,r,e,n){var i=t(function(l,c){yfe(l,a),GI(l,{type:r,index:hfe(null),first:void 0,last:void 0,size:0}),nc||(l.size=0),bfe(c)||_fe(c,l[n],{that:l,AS_ENTRIES:e})}),a=i.prototype,o=yb(r),s=function(l,c,f){var d=o(l),v=u(l,c),p,y;return v?v.value=f:(d.last=v={index:y=QI(c,!0),key:c,value:f,previous:p=d.last,next:void 0,removed:!1},d.first||(d.first=v),p&&(p.next=v),nc?d.size++:l.size++,y!=="F"&&(d.index[y]=v)),l},u=function(l,c){var f=o(l),d=QI(c),v;if(d!=="F")return f.index[d];for(v=f.first;v;v=v.next)if(v.key==c)return v};return qI(a,{clear:function(){for(var c=this,f=o(c),d=f.index,v=f.first;v;)v.removed=!0,v.previous&&(v.previous=v.previous.next=void 0),delete d[v.index],v=v.next;f.first=f.last=void 0,nc?f.size=0:c.size=0},delete:function(l){var c=this,f=o(c),d=u(c,l);if(d){var v=d.next,p=d.previous;delete f.index[d.index],d.removed=!0,p&&(p.next=v),v&&(v.previous=p),f.first==d&&(f.first=v),f.last==d&&(f.last=p),nc?f.size--:c.size--}return!!d},forEach:function(c){for(var f=o(this),d=gfe(c,arguments.length>1?arguments[1]:void 0),v;v=v?v.next:f.first;)for(d(v.value,v.key,this);v&&v.removed;)v=v.previous},has:function(c){return!!u(this,c)}}),qI(a,e?{get:function(c){var f=u(this,c);return f&&f.value},set:function(c,f){return s(this,c===0?0:c,f)}}:{add:function(c){return s(this,c=c===0?0:c,c)}}),nc&&mfe(a,"size",{configurable:!0,get:function(){return o(this).size}}),i},setStrong:function(t,r,e){var n=r+" Iterator",i=yb(r),a=yb(n);wfe(t,r,function(o,s){GI(this,{type:n,target:o,state:i(o),kind:s,last:void 0})},function(){for(var o=a(this),s=o.kind,u=o.last;u&&u.removed;)u=u.previous;return!o.target||!(o.last=u=u?u.next:o.state.first)?(o.target=void 0,bp(void 0,!0)):s=="keys"?bp(u.key,!1):s=="values"?bp(u.value,!1):bp([u.key,u.value],!1)},e?"entries":"values",!e,!0),kfe(r)}},Tfe=ZI,Sfe=HI;Tfe("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Sfe);var Ta={};/*
  @license
  Copyright (c) 2016, Twilio, Inc.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted, provided that the above
  copyright notice and this permission notice appear in all copies.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
  WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
  MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
  SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
  WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
  OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
  CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

  */Object.defineProperty(Ta,"__esModule",{value:!0});var Efe=qn,Mfe=ji,Cfe=ha,Rfe=Bn,Ife=Zn,Ofe=wn,Nfe=ma;function es(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var bb=es(Efe),_b=es(Mfe),Sa=es(Cfe),wb=es(Rfe),JI=es(Ife),_p=es(Ofe),Ea=es(Nfe),Afe;function io(){}io.prototype=Object.create(null);function ur(){ur.init.call(this)}ur.EventEmitter=ur,ur.usingDomains=!1,ur.prototype.domain=void 0,ur.prototype._events=void 0,ur.prototype._maxListeners=void 0,ur.defaultMaxListeners=10,ur.init=function(){this.domain=null,ur.usingDomains&&Afe.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new io,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ur.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||isNaN(r))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=r,this};function XI(t){return t._maxListeners===void 0?ur.defaultMaxListeners:t._maxListeners}ur.prototype.getMaxListeners=function(){return XI(this)};function Pfe(t,r,e){if(r)t.call(e);else for(var n=t.length,i=ic(t,n),a=0;a<n;++a)i[a].call(e)}function xfe(t,r,e,n){if(r)t.call(e,n);else for(var i=t.length,a=ic(t,i),o=0;o<i;++o)a[o].call(e,n)}function Dfe(t,r,e,n,i){if(r)t.call(e,n,i);else for(var a=t.length,o=ic(t,a),s=0;s<a;++s)o[s].call(e,n,i)}function Lfe(t,r,e,n,i,a){if(r)t.call(e,n,i,a);else for(var o=t.length,s=ic(t,o),u=0;u<o;++u)s[u].call(e,n,i,a)}function Ufe(t,r,e,n){if(r)t.apply(e,n);else for(var i=t.length,a=ic(t,i),o=0;o<i;++o)a[o].apply(e,n)}ur.prototype.emit=function(r){var e,n,i,a,o,s,u,l=r==="error";if(s=this._events,s)l=l&&s.error==null;else if(!l)return!1;if(u=this.domain,l){if(e=arguments[1],u)e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=u,e.domainThrown=!1,u.emit("error",e);else{if(e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}return!1}if(n=s[r],!n)return!1;var f=typeof n=="function";switch(i=arguments.length,i){case 1:Pfe(n,f,this);break;case 2:xfe(n,f,this,arguments[1]);break;case 3:Dfe(n,f,this,arguments[1],arguments[2]);break;case 4:Lfe(n,f,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),o=1;o<i;o++)a[o-1]=arguments[o];Ufe(n,f,this,a)}return!0};function KI(t,r,e,n){var i,a,o;if(typeof e!="function")throw new TypeError('"listener" argument must be a function');if(a=t._events,a?(a.newListener&&(t.emit("newListener",r,e.listener?e.listener:e),a=t._events),o=a[r]):(a=t._events=new io,t._eventsCount=0),!o)o=a[r]=e,++t._eventsCount;else if(typeof o=="function"?o=a[r]=n?[e,o]:[o,e]:n?o.unshift(e):o.push(e),!o.warned&&(i=XI(t),i&&i>0&&o.length>i)){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+r+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=r,s.count=o.length,jfe(s)}return t}function jfe(t){typeof console.warn=="function"?console.warn(t):console.log(t)}ur.prototype.addListener=function(r,e){return KI(this,r,e,!1)},ur.prototype.on=ur.prototype.addListener,ur.prototype.prependListener=function(r,e){return KI(this,r,e,!0)};function eO(t,r,e){var n=!1;function i(){t.removeListener(r,i),n||(n=!0,e.apply(t,arguments))}return i.listener=e,i}ur.prototype.once=function(r,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.on(r,eO(this,r,e)),this},ur.prototype.prependOnceListener=function(r,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(r,eO(this,r,e)),this},ur.prototype.removeListener=function(r,e){var n,i,a,o,s;if(typeof e!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[r],!n)return this;if(n===e||n.listener&&n.listener===e)--this._eventsCount===0?this._events=new io:(delete i[r],i.removeListener&&this.emit("removeListener",r,n.listener||e));else if(typeof n!="function"){for(a=-1,o=n.length;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){s=n[o].listener,a=o;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new io,this;delete i[r]}else Vfe(n,a);i.removeListener&&this.emit("removeListener",r,s||e)}return this},ur.prototype.off=function(t,r){return this.removeListener(t,r)},ur.prototype.removeAllListeners=function(r){var e,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new io,this._eventsCount=0):n[r]&&(--this._eventsCount===0?this._events=new io:delete n[r]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,o;a<i.length;++a)o=i[a],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new io,this._eventsCount=0,this}if(e=n[r],typeof e=="function")this.removeListener(r,e);else if(e)do this.removeListener(r,e[e.length-1]);while(e[0]);return this},ur.prototype.listeners=function(r){var e,n,i=this._events;return i?(e=i[r],e?typeof e=="function"?n=[e.listener||e]:n=Ffe(e):n=[]):n=[],n},ur.listenerCount=function(t,r){return typeof t.listenerCount=="function"?t.listenerCount(r):tO.call(t,r)},ur.prototype.listenerCount=tO;function tO(t){var r=this._events;if(r){var e=r[t];if(typeof e=="function")return 1;if(e)return e.length}return 0}ur.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Vfe(t,r){for(var e=r,n=e+1,i=t.length;n<i;e+=1,n+=1)t[e]=t[n];t.pop()}function ic(t,r){for(var e=new Array(r);r--;)e[r]=t[r];return e}function Ffe(t){for(var r=new Array(t.length),e=0;e<r.length;++e)r[e]=t[e].listener||t[e];return r}function rO(t){var r=$fe();return function(){var n=_p.default(t),i;if(r){var a=_p.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return JI.default(this,i)}}function $fe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var nO=function(t){wb.default(e,t);var r=rO(e);function e(n){var i;return bb.default(this,e),i=r.call(this),Ea.default(Sa.default(i),"timeout",null),Ea.default(Sa.default(i),"startTimestamp",-1),i.minDelay=n.min,i.maxDelay=n.max,i.initialDelay=n.initial||0,i.maxAttemptsCount=n.maxAttemptsCount||0,i.maxAttemptsTime=n.maxAttemptsTime||0,i.randomness=n.randomness||0,i.inProgress=!1,i.attemptNum=0,i.prevDelay=0,i.currDelay=0,i}return _b.default(e,[{key:"attempt",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.attemptNum++,this.emit("attempt",this)}},{key:"nextDelay",value:function(i){if(typeof i=="number")return this.prevDelay=0,this.currDelay=i,i;if(this.attemptNum==0)return this.initialDelay;if(this.attemptNum==1)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var a=this.currDelay+this.prevDelay;return this.maxDelay&&a>this.maxDelay&&(this.currDelay=this.maxDelay,a=this.maxDelay),this.currDelay=a,a}},{key:"randomize",value:function(i){var a=i*this.randomness,o=Math.round(Math.random()*a*2-a);return Math.max(0,i+o)}},{key:"scheduleAttempt",value:function(i){var a=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount){this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached"));return}var o=this.nextDelay(i);if(o=this.randomize(o),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+o){this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached"));return}this.timeout=setTimeout(function(){return a.attempt()},o)}},{key:"cleanup",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){if(this.inProgress)throw new Error("Retrier is already in progress");this.inProgress=!0,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"))}},{key:"succeeded",value:function(i){this.emit("succeeded",i)}},{key:"failed",value:function(i,a){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(a)}}]),e}(ur),zfe=function(t){wb.default(e,t);var r=rO(e);function e(n){var i;return bb.default(this,e),i=r.call(this),Ea.default(Sa.default(i),"resolve",function(){}),Ea.default(Sa.default(i),"reject",function(){}),i.retrier=new nO(n),i}return _b.default(e,[{key:"run",value:function(i){var a=this;return this.retrier.on("attempt",function(){i().then(function(o){return a.retrier.succeeded(o)}).catch(function(o){return a.retrier.failed(o)})}),this.retrier.on("succeeded",function(o){return a.resolve(o)}),this.retrier.on("cancelled",function(){return a.reject(new Error("Cancelled"))}),this.retrier.on("failed",function(o){return a.reject(o)}),new Promise(function(o,s){a.resolve=o,a.reject=s,a.retrier.start()})}},{key:"cancel",value:function(){this.retrier.cancel()}}]),e}(ur);function Wfe(t){var r=Bfe();return function(){var n=_p.default(t),i;if(r){var a=_p.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return JI.default(this,i)}}function Bfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wp(t){return t!=null}var Zfe=function(t){wb.default(e,t);var r=Wfe(e);function e(n){var i;bb.default(this,e),i=r.call(this),Ea.default(Sa.default(i),"backoffDelay",0),Ea.default(Sa.default(i),"nextBackoffDelay",0),Ea.default(Sa.default(i),"backoffNumber",0),Ea.default(Sa.default(i),"timeoutID",null),Ea.default(Sa.default(i),"maxNumberOfRetry",-1),n=n||{};var a=n,o=a.initialDelay,s=a.maxDelay,u=a.randomisationFactor,l=a.factor;if(wp(o)&&o<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(wp(s)&&s<=1)throw new Error("The maximal timeout must be greater than 1.");if(wp(u)&&(u<0||u>1))throw new Error("The randomisation factor must be between 0 and 1.");if(wp(l)&&l<=1)throw new Error("Exponential factor should be greater than 1.");if(i.initialDelay=o||100,i.maxDelay=s||1e4,i.maxDelay<=i.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return i.randomisationFactor=u||0,i.factor=l||2,i.reset(),i}return _b.default(e,[{key:"backoff",value:function(i){this.timeoutID==null&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",i),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,i)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(i){if(i<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(i));this.maxNumberOfRetry=i}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var i=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*i))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(i){return new e(i)}}]),e}(ur);Ta.AsyncRetrier=zfe,Ta.Backoff=Zfe,Ta.Retrier=nO;var kp={},qfe=dr,Qfe=Er,Yfe=ua,Gfe=tI,iO=RegExp.prototype,Hfe=function(t){var r=t.flags;return r===void 0&&!("flags"in iO)&&!Qfe(t,"flags")&&Yfe(iO,t)?qfe(Gfe,t):r},Jfe=Ml.PROPER,Xfe=un,Kfe=Or,aO=Fr,ede=Ot,tde=Hfe,kb="toString",rde=RegExp.prototype,oO=rde[kb],nde=ede(function(){return oO.call({source:"a",flags:"b"})!="/a/b"}),ide=Jfe&&oO.name!=kb;(nde||ide)&&Xfe(RegExp.prototype,kb,function(){var r=Kfe(this),e=aO(r.source),n=aO(tde(r));return"/"+e+"/"+n},{unsafe:!0});var ln={};/*
  @license
  Copyright (c) 2021 Twilio Inc.

  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


  */Object.defineProperty(ln,"__esModule",{value:!0});var ade=_n,ode=eo,sde=to,ude=qn,lde=Bn,cde=Zn,fde=wn;function ts(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var uu=ts(ade),rs=ts(ode),Tb=ts(sde),dde=ts(ude),pde=ts(lde),vde=ts(cde),sO=ts(fde),ao=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return{checks:e}};function hde(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=mde(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function mde(t,r){if(t){if(typeof t=="string")return uO(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return uO(t,r)}}function uO(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var lO=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return ao(function(i){var a=!1,o=[],s=hde(e),u;try{for(s.s();!(u=s.n()).done;){var l=u.value;if(typeof l=="string"){a=a||uu.default(i)===l,o.push("of type ".concat(l));continue}a=a||i instanceof l,o.push("an instance of ".concat(l.name))}}catch(c){s.e(c)}finally{s.f()}return[a,o]})};function gde(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=yde(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function yde(t,r){if(t){if(typeof t=="string")return cO(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return cO(t,r)}}function cO(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var bde=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return ao(function(i){var a=!1,o=[],s=gde(e),u;try{for(s.s();!(u=s.n()).done;){var l=u.value;a=a||i===l,o.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){s.e(c)}finally{s.f()}return[a,o]})},_de=ao(function(t){return[typeof t=="string"&&t.length>0,"a non-empty string"]}),wde=ao(function(t){return[typeof t=="number"&&Number.isInteger(t)&&t>=0,"a non-negative integer"]}),kde=ao(function(t){return[uu.default(t)==="object"&&t!==null&&!Array.isArray(t),"a pure object (non-null and non-array)"]});function Tde(t){var r=Sde();return function(){var n=sO.default(t),i;if(r){var a=sO.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return vde.default(this,i)}}function Sde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ac(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Ede(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Ede(t,r){if(t){if(typeof t=="string")return fO(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return fO(t,r)}}function fO(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Tp=function(r,e){if(e.length>r.length)throw new Error("Expected at most ".concat(r.length," argument(s), but got ").concat(e.length));for(;e.length<r.length;)e.push(void 0);var n=ac(e.entries()),i;try{for(n.s();!(i=n.n()).done;){var a=rs.default(i.value,2),o=a[0],s=a[1],u=Mb(r[o],s),l=rs.default(u,4),c=l[0],f=l[1],d=l[2],v=l[3];if(!c){var p=o+1;throw new Error("Argument ".concat(p," is expected to be ").concat(d).concat(v," but got ").concat(f))}}}catch(y){n.e(y)}finally{n.f()}},dO=function(r){var e,n,i=["undefined","boolean","number","bigint","string"];if(i.includes(uu.default(r))&&(n=typeof r=="string"?'"'.concat(r,'"'):"".concat(r)),uu.default(r)==="object"&&(r==null||(e=r.constructor)===null||e===void 0?void 0:e.name)!=="Object"){var a;n=r===null?"null":"instance of ".concat(r==null||(a=r.constructor)===null||a===void 0?void 0:a.name)}return n||(n=uu.default(r)),n},Mde=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var i=Sb(e);return function(a){return function(o){pde.default(u,o);var s=Tde(u);function u(){dde.default(this,u);for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return Tp(i,c),s.call.apply(s,[this].concat(c))}return u}(a)}},Cde=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var i=Sb(e);return function(a,o,s){if(typeof s.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=s.value;s.value=function(){for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return Tp(i,c),u.apply(this,c)}}},Rde=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var i=Sb(e);return function(a,o,s){if(typeof s.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=s.value;s.value=function(){for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];try{Tp(i,c)}catch(d){return Promise.reject(d)}return u.apply(this,c)}}},Sb=function(r){var e=[],n=ac(r),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;e.push(Eb(a))}}catch(o){n.e(o)}finally{n.f()}return e},Eb=function(r){var e=[],n=Array.isArray(r)?r:[r],i=ac(n),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;if(typeof o=="string"||typeof o=="function"){e.push(lO(o));continue}e.push(o)}}catch(s){i.e(s)}finally{i.f()}return e},Mb=function(r,e){var n=[],i,a=!1,o=ac(r),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,l=ac(u.checks),c;try{for(l.s();!(c=l.n()).done;){var f=c.value,d=f(e),v=rs.default(d,3),p=v[0],y=v[1],k=v[2];a=a||p,!i&&k&&(i=k),y&&(n=typeof y=="string"?[].concat(Tb.default(n),[y]):[].concat(Tb.default(n),Tb.default(y)))}}catch(R){l.e(R)}finally{l.f()}}}catch(R){o.e(R)}finally{o.f()}if(a)return[!0];var I=i||dO(e),C=n.length-1,L=C>0?"".concat(n.slice(0,C).join(", ")," or ").concat(n[C]):n.join(", ");return[!1,I,L,C>1?";":","]},Ide=function(r,e){return ao(function(n){if(uu.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(r," (should be a pure object)")];for(var i=0,a=Object.entries(e);i<a.length;i++){var o=rs.default(a[i],2),s=o[0],u=o[1],l=Mb(Eb(u),n[s]),c=rs.default(l,3),f=c[0],d=c[1],v=c[2];if(!f)return[!1,"valid ".concat(r,' (key "').concat(s,'" should be ').concat(v,")"),"malformed ".concat(r,' (key "').concat(s,'" is ').concat(d,")")]}return[!0]})};function Ode(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Nde(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Nde(t,r){if(t){if(typeof t=="string")return pO(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return pO(t,r)}}function pO(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Ade=function(r,e){return ao(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(r)];var i=Ode(n.entries()),a;try{for(i.s();!(a=i.n()).done;){var o=rs.default(a.value,2),s=o[0],u=o[1],l=Mb(Eb(e),u),c=rs.default(l,3),f=c[0],d=c[1],v=c[2];if(!f)return[!1,"a valid array of ".concat(r," (index ").concat(s," should be ").concat(v,")"),"malformed array of ".concat(r," (index ").concat(s," is ").concat(d,")")]}}catch(p){i.e(p)}finally{i.f()}return[!0]})};ln.array=Ade,ln.custom=ao,ln.literal=bde,ln.nonEmptyString=_de,ln.nonNegativeInteger=wde,ln.objectSchema=Ide,ln.pureObject=kde,ln.runtimeTypeValidation=Tp,ln.stringifyReceivedType=dO,ln.type=lO,ln.validateConstructorTypes=Mde,ln.validateTypes=Cde,ln.validateTypesAsync=Rde;var Pde=ZI,xde=HI;Pde("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},xde);var Cb={},Dde={get exports(){return Cb},set exports(t){Cb=t}};(function(t,r){(function(n,i){t.exports=i()})(V,function(){return function(e){var n={};function i(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=n,i.i=function(a){return a},i.d=function(a,o,s){i.o(a,o)||Object.defineProperty(a,o,{configurable:!1,enumerable:!0,get:s})},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s=5)}([function(e,n,i){e.exports=function(a,o){var s,u,l;for(s=1;s<arguments.length;s++){u=arguments[s];for(l in u)u.hasOwnProperty(l)&&(a[l]=u[l])}return a}},function(e,n,i){var a=i(0);e.exports={build:function(o,s){var u,l,c,f=s.plugins;for(u=0,l=f.length;u<l;u++)c=f[u],c.methods&&a(o,c.methods),c.properties&&Object.defineProperties(o,c.properties)},hook:function(o,s,u){var l,c,f,d,v=o.config.plugins,p=[o.context];for(u&&(p=p.concat(u)),l=0,c=v.length;l<c;l++)d=v[l],f=v[l][s],f&&f.apply(d,p)}}},function(e,n,i){function a(o){if(o.length===0)return o;var s,u,l=o.split(/[_-]/);if(l.length===1&&l[0][0].toLowerCase()===l[0][0])return o;for(u=l[0].toLowerCase(),s=1;s<l.length;s++)u=u+l[s].charAt(0).toUpperCase()+l[s].substring(1).toLowerCase();return u}a.prepended=function(o,s){return s=a(s),o+s[0].toUpperCase()+s.substring(1)},e.exports=a},function(e,n,i){var a=i(0),o=i(2);function s(u,l){u=u||{},this.options=u,this.defaults=l.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(u.init),this.data=this.configureData(u.data),this.methods=this.configureMethods(u.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(u.transitions||[]),this.plugins=this.configurePlugins(u.plugins,l.plugin)}a(s.prototype,{addState:function(u){this.map[u]||(this.states.push(u),this.addStateLifecycleNames(u),this.map[u]={})},addStateLifecycleNames:function(u){this.lifecycle.onEnter[u]=o.prepended("onEnter",u),this.lifecycle.onLeave[u]=o.prepended("onLeave",u),this.lifecycle.on[u]=o.prepended("on",u)},addTransition:function(u){this.transitions.indexOf(u)<0&&(this.transitions.push(u),this.addTransitionLifecycleNames(u))},addTransitionLifecycleNames:function(u){this.lifecycle.onBefore[u]=o.prepended("onBefore",u),this.lifecycle.onAfter[u]=o.prepended("onAfter",u),this.lifecycle.on[u]=o.prepended("on",u)},mapTransition:function(u){var l=u.name,c=u.from,f=u.to;return this.addState(c),typeof f!="function"&&this.addState(f),this.addTransition(l),this.map[c][l]=u,u},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(u){return typeof u=="string"?this.mapTransition(a({},this.defaults.init,{to:u,active:!0})):typeof u=="object"?this.mapTransition(a({},this.defaults.init,u,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(u){return typeof u=="function"?u:typeof u=="object"?function(){return u}:function(){return{}}},configureMethods:function(u){return u||{}},configurePlugins:function(u,l){u=u||[];var c,f,d;for(c=0,f=u.length;c<f;c++)d=u[c],typeof d=="function"&&(u[c]=d=d()),d.configure&&d.configure(this);return u},configureTransitions:function(u){var l,c,f,d,v,p=this.defaults.wildcard;for(c=0;c<u.length;c++)for(f=u[c],d=Array.isArray(f.from)?f.from:[f.from||p],v=f.to||p,l=0;l<d.length;l++)this.mapTransition({name:f.name,from:d[l],to:v})},transitionFor:function(u,l){var c=this.defaults.wildcard;return this.map[u][l]||this.map[c][l]},transitionsFor:function(u){var l=this.defaults.wildcard;return Object.keys(this.map[u]).concat(Object.keys(this.map[l]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=s},function(e,n,i){var a=i(0),o=i(6),s=i(1),u=[null,[]];function l(c,f){this.context=c,this.config=f,this.state=f.init.from,this.observers=[c]}a(l.prototype,{init:function(c){if(a(this.context,this.config.data.apply(this.context,c)),s.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(c){return Array.isArray(c)?c.indexOf(this.state)>=0:this.state===c},isPending:function(){return this.pending},can:function(c){return!this.isPending()&&!!this.seek(c)},cannot:function(c){return!this.can(c)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(c,f){var d=this.config.defaults.wildcard,v=this.config.transitionFor(this.state,c),p=v&&v.to;return typeof p=="function"?p.apply(this.context,f):p===d?this.state:p},fire:function(c,f){return this.transit(c,this.state,this.seek(c,f),f)},transit:function(c,f,d,v){var p=this.config.lifecycle,y=this.config.options.observeUnchangedState||f!==d;return d?this.isPending()?this.context.onPendingTransition(c,f,d):(this.config.addState(d),this.beginTransit(),v.unshift({transition:c,from:f,to:d,fsm:this.context}),this.observeEvents([this.observersForEvent(p.onBefore.transition),this.observersForEvent(p.onBefore[c]),y?this.observersForEvent(p.onLeave.state):u,y?this.observersForEvent(p.onLeave[f]):u,this.observersForEvent(p.on.transition),y?["doTransit",[this]]:u,y?this.observersForEvent(p.onEnter.state):u,y?this.observersForEvent(p.onEnter[d]):u,y?this.observersForEvent(p.on[d]):u,this.observersForEvent(p.onAfter.transition),this.observersForEvent(p.onAfter[c]),this.observersForEvent(p.on[c])],v)):this.context.onInvalidTransition(c,f,d)},beginTransit:function(){this.pending=!0},endTransit:function(c){return this.pending=!1,c},failTransit:function(c){throw this.pending=!1,c},doTransit:function(c){this.state=c.to},observe:function(c){if(c.length===2){var f={};f[c[0]]=c[1],this.observers.push(f)}else this.observers.push(c[0])},observersForEvent:function(c){for(var f=0,d=this.observers.length,v,p=[];f<d;f++)v=this.observers[f],v[c]&&p.push(v);return[c,p,!0]},observeEvents:function(c,f,d,v){if(c.length===0)return this.endTransit(v===void 0?!0:v);var p=c[0][0],y=c[0][1],k=c[0][2];if(f[0].event=p,p&&k&&p!==d&&s.hook(this,"lifecycle",f),y.length===0)return c.shift(),this.observeEvents(c,f,p,v);var I=y.shift(),C=I[p].apply(I,f);return C&&typeof C.then=="function"?C.then(this.observeEvents.bind(this,c,f,p)).catch(this.failTransit.bind(this)):C===!1?this.endTransit(!1):this.observeEvents(c,f,p,C)},onInvalidTransition:function(c,f,d){throw new o("transition is invalid in current state",c,f,d,this.state)},onPendingTransition:function(c,f,d){throw new o("transition is invalid while previous transition is still in progress",c,f,d,this.state)}}),e.exports=l},function(e,n,i){var a=i(0),o=i(2),s=i(1),u=i(3),l=i(4),c={is:function(k){return this._fsm.is(k)},can:function(k){return this._fsm.can(k)},cannot:function(k){return this._fsm.cannot(k)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(k,I,C){return this._fsm.onInvalidTransition(k,I,C)},onPendingTransition:function(k,I,C){return this._fsm.onPendingTransition(k,I,C)}},f={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(k){throw Error("use transitions to change state")}}};function d(k){return p(this||{},k)}function v(){var k,I;typeof arguments[0]=="function"?(k=arguments[0],I=arguments[1]||{}):(k=function(){this._fsm.apply(this,arguments)},I=arguments[0]||{});var C=new u(I,d);return y(k.prototype,C),k.prototype._fsm.config=C,k}function p(k,I){var C=new u(I,d);return y(k,C),k._fsm(),k}function y(k,I){if(typeof k!="object"||Array.isArray(k))throw Error("StateMachine can only be applied to objects");s.build(k,I),Object.defineProperties(k,f),a(k,c),a(k,I.methods),I.allTransitions().forEach(function(C){k[o(C)]=function(){return this._fsm.fire(C,[].slice.call(arguments))}}),k._fsm=function(){this._fsm=new l(this,I),this._fsm.init(arguments)}}d.version="3.0.1",d.factory=v,d.apply=p,d.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=d},function(e,n,i){e.exports=function(a,o,s,u,l){this.message=a,this.transition=o,this.from=s,this.to=u,this.current=l}}])})})(Dde);var Sp={},vO={get exports(){return Sp},set exports(t){Sp=t}},hO=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(hO){var mO=new Uint8Array(16);vO.exports=function(){return hO(mO),mO}}else{var gO=new Array(16);vO.exports=function(){for(var r=0,e;r<16;r++)r&3||(e=Math.random()*4294967296),gO[r]=e>>>((r&3)<<3)&255;return gO}}for(var yO=[],Ep=0;Ep<256;++Ep)yO[Ep]=(Ep+256).toString(16).substr(1);function Lde(t,r){var e=r||0,n=yO;return[n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]]].join("")}var bO=Lde,Ude=Sp,jde=bO,_O,Rb,Ib=0,Ob=0;function Vde(t,r,e){var n=r&&e||0,i=r||[];t=t||{};var a=t.node||_O,o=t.clockseq!==void 0?t.clockseq:Rb;if(a==null||o==null){var s=Ude();a==null&&(a=_O=[s[0]|1,s[1],s[2],s[3],s[4],s[5]]),o==null&&(o=Rb=(s[6]<<8|s[7])&16383)}var u=t.msecs!==void 0?t.msecs:new Date().getTime(),l=t.nsecs!==void 0?t.nsecs:Ob+1,c=u-Ib+(l-Ob)/1e4;if(c<0&&t.clockseq===void 0&&(o=o+1&16383),(c<0||u>Ib)&&t.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ib=u,Ob=l,Rb=o,u+=122192928e5;var f=((u&268435455)*1e4+l)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=f&255;var d=u/4294967296*1e4&268435455;i[n++]=d>>>8&255,i[n++]=d&255,i[n++]=d>>>24&15|16,i[n++]=d>>>16&255,i[n++]=o>>>8|128,i[n++]=o&255;for(var v=0;v<6;++v)i[n+v]=a[v];return r||jde(i)}var Fde=Vde,$de=Sp,zde=bO;function Wde(t,r,e){var n=r&&e||0;typeof t=="string"&&(r=t==="binary"?new Array(16):null,t=null),t=t||{};var i=t.random||(t.rng||$de)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,r)for(var a=0;a<16;++a)r[n+a]=i[a];return r||zde(i)}var Bde=Wde,Zde=Fde,wO=Bde,Nb=wO;Nb.v1=Zde,Nb.v4=wO;var qde=Nb,Ab={},kO={get exports(){return Ab},set exports(t){Ab=t}},TO=typeof ArrayBuffer<"u"&&typeof DataView<"u",Qde=TO,Pb=wr,cn=zt,SO=sr,Mp=Sr,oo=Er,xb=da,Yde=Vo,Gde=la,Db=un,Hde=Ui,Jde=ua,Cp=Gl,lu=Js,Xde=pr,Kde=Sl,EO=zn,MO=EO.enforce,epe=EO.get,Rp=cn.Int8Array,Lb=Rp&&Rp.prototype,CO=cn.Uint8ClampedArray,RO=CO&&CO.prototype,Vi=Rp&&Cp(Rp),pi=Lb&&Cp(Lb),tpe=Object.prototype,Ub=cn.TypeError,IO=Xde("toStringTag"),jb=Kde("TYPED_ARRAY_TAG"),Ip="TypedArrayConstructor",Ma=Qde&&!!lu&&xb(cn.opera)!=="Opera",OO=!1,kn,so,cu,Ca={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Vb={BigInt64Array:8,BigUint64Array:8},rpe=function(r){if(!Mp(r))return!1;var e=xb(r);return e==="DataView"||oo(Ca,e)||oo(Vb,e)},NO=function(t){var r=Cp(t);if(Mp(r)){var e=epe(r);return e&&oo(e,Ip)?e[Ip]:NO(r)}},AO=function(t){if(!Mp(t))return!1;var r=xb(t);return oo(Ca,r)||oo(Vb,r)},npe=function(t){if(AO(t))return t;throw Ub("Target is not a typed array")},ipe=function(t){if(SO(t)&&(!lu||Jde(Vi,t)))return t;throw Ub(Yde(t)+" is not a typed array constructor")},ape=function(t,r,e,n){if(Pb){if(e)for(var i in Ca){var a=cn[i];if(a&&oo(a.prototype,t))try{delete a.prototype[t]}catch{try{a.prototype[t]=r}catch{}}}(!pi[t]||e)&&Db(pi,t,e?r:Ma&&Lb[t]||r,n)}},ope=function(t,r,e){var n,i;if(Pb){if(lu){if(e){for(n in Ca)if(i=cn[n],i&&oo(i,t))try{delete i[t]}catch{}}if(!Vi[t]||e)try{return Db(Vi,t,e?r:Ma&&Vi[t]||r)}catch{}else return}for(n in Ca)i=cn[n],i&&(!i[t]||e)&&Db(i,t,r)}};for(kn in Ca)so=cn[kn],cu=so&&so.prototype,cu?MO(cu)[Ip]=so:Ma=!1;for(kn in Vb)so=cn[kn],cu=so&&so.prototype,cu&&(MO(cu)[Ip]=so);if((!Ma||!SO(Vi)||Vi===Function.prototype)&&(Vi=function(){throw Ub("Incorrect invocation")},Ma))for(kn in Ca)cn[kn]&&lu(cn[kn],Vi);if((!Ma||!pi||pi===tpe)&&(pi=Vi.prototype,Ma))for(kn in Ca)cn[kn]&&lu(cn[kn].prototype,pi);if(Ma&&Cp(RO)!==pi&&lu(RO,pi),Pb&&!oo(pi,IO)){OO=!0,Hde(pi,IO,{configurable:!0,get:function(){return Mp(this)?this[jb]:void 0}});for(kn in Ca)cn[kn]&&Gde(cn[kn],jb,kn)}var yr={NATIVE_ARRAY_BUFFER_VIEWS:Ma,TYPED_ARRAY_TAG:OO&&jb,aTypedArray:npe,aTypedArrayConstructor:ipe,exportTypedArrayMethod:ape,exportTypedArrayStaticMethod:ope,getTypedArrayConstructor:NO,isView:rpe,isTypedArray:AO,TypedArray:Vi,TypedArrayPrototype:pi},PO=zt,Fb=Ot,spe=Hd,upe=yr.NATIVE_ARRAY_BUFFER_VIEWS,lpe=PO.ArrayBuffer,ns=PO.Int8Array,cpe=!upe||!Fb(function(){ns(1)})||!Fb(function(){new ns(-1)})||!spe(function(t){new ns,new ns(null),new ns(1.5),new ns(t)},!0)||Fb(function(){return new ns(new lpe(2),1,void 0).length!==1}),fpe=Li,dpe=ca,ppe=RangeError,xO=function(t){if(t===void 0)return 0;var r=fpe(t),e=dpe(r);if(r!==e)throw ppe("Wrong length or index");return e},vpe=Array,hpe=Math.abs,Ra=Math.pow,mpe=Math.floor,gpe=Math.log,ype=Math.LN2,bpe=function(t,r,e){var n=vpe(e),i=e*8-r-1,a=(1<<i)-1,o=a>>1,s=r===23?Ra(2,-24)-Ra(2,-77):0,u=t<0||t===0&&1/t<0?1:0,l=0,c,f,d;for(t=hpe(t),t!=t||t===1/0?(f=t!=t?1:0,c=a):(c=mpe(gpe(t)/ype),d=Ra(2,-c),t*d<1&&(c--,d*=2),c+o>=1?t+=s/d:t+=s*Ra(2,1-o),t*d>=2&&(c++,d/=2),c+o>=a?(f=0,c=a):c+o>=1?(f=(t*d-1)*Ra(2,r),c=c+o):(f=t*Ra(2,o-1)*Ra(2,r),c=0));r>=8;)n[l++]=f&255,f/=256,r-=8;for(c=c<<r|f,i+=r;i>0;)n[l++]=c&255,c/=256,i-=8;return n[--l]|=u*128,n},_pe=function(t,r){var e=t.length,n=e*8-r-1,i=(1<<n)-1,a=i>>1,o=n-7,s=e-1,u=t[s--],l=u&127,c;for(u>>=7;o>0;)l=l*256+t[s--],o-=8;for(c=l&(1<<-o)-1,l>>=-o,o+=r;o>0;)c=c*256+t[s--],o-=8;if(l===0)l=1-a;else{if(l===i)return c?NaN:u?-1/0:1/0;c=c+Ra(2,r),l=l-a}return(u?-1:1)*c*Ra(2,l-r)},wpe={pack:bpe,unpack:_pe},kpe=en,DO=$o,Tpe=Jr,LO=function(r){for(var e=kpe(this),n=Tpe(e),i=arguments.length,a=DO(i>1?arguments[1]:void 0,n),o=i>2?arguments[2]:void 0,s=o===void 0?n:DO(o,n);s>a;)e[a++]=r;return e},Op=zt,$b=Dt,zb=wr,Spe=TO,UO=Ml,jO=la,Epe=Ui,VO=gb,Wb=Ot,Np=Zo,Mpe=Li,Cpe=ca,Ap=xO,FO=wpe,Rpe=Gl,$O=Js,Ipe=Ya.f,Ope=LO,Npe=Pl,zO=fa,Bb=zn,Ape=UO.PROPER,WO=UO.CONFIGURABLE,fu="ArrayBuffer",Pp="DataView",du="prototype",Ppe="Wrong length",BO="Wrong index",ZO=Bb.getterFor(fu),oc=Bb.getterFor(Pp),qO=Bb.set,Qn=Op[fu],Nn=Qn,pu=Nn&&Nn[du],Fi=Op[Pp],is=Fi&&Fi[du],QO=Object.prototype,xpe=Op.Array,xp=Op.RangeError,Dpe=$b(Ope),Lpe=$b([].reverse),YO=FO.pack,GO=FO.unpack,HO=function(t){return[t&255]},JO=function(t){return[t&255,t>>8&255]},XO=function(t){return[t&255,t>>8&255,t>>16&255,t>>24&255]},KO=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Upe=function(t){return YO(t,23,4)},jpe=function(t){return YO(t,52,8)},Dp=function(t,r,e){Epe(t[du],r,{configurable:!0,get:function(){return e(this)[r]}})},uo=function(t,r,e,n){var i=Ap(e),a=oc(t);if(i+r>a.byteLength)throw xp(BO);var o=a.bytes,s=i+a.byteOffset,u=Npe(o,s,s+r);return n?u:Lpe(u)},lo=function(t,r,e,n,i,a){var o=Ap(e),s=oc(t);if(o+r>s.byteLength)throw xp(BO);for(var u=s.bytes,l=o+s.byteOffset,c=n(+i),f=0;f<r;f++)u[l+f]=c[a?f:r-f-1]};if(!Spe)Nn=function(r){Np(this,pu);var e=Ap(r);qO(this,{type:fu,bytes:Dpe(xpe(e),0),byteLength:e}),zb||(this.byteLength=e,this.detached=!1)},pu=Nn[du],Fi=function(r,e,n){Np(this,is),Np(r,pu);var i=ZO(r),a=i.byteLength,o=Mpe(e);if(o<0||o>a)throw xp("Wrong offset");if(n=n===void 0?a-o:Cpe(n),o+n>a)throw xp(Ppe);qO(this,{type:Pp,buffer:r,byteLength:n,byteOffset:o,bytes:i.bytes}),zb||(this.buffer=r,this.byteLength=n,this.byteOffset=o)},is=Fi[du],zb&&(Dp(Nn,"byteLength",ZO),Dp(Fi,"buffer",oc),Dp(Fi,"byteLength",oc),Dp(Fi,"byteOffset",oc)),VO(is,{getInt8:function(r){return uo(this,1,r)[0]<<24>>24},getUint8:function(r){return uo(this,1,r)[0]},getInt16:function(r){var e=uo(this,2,r,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(r){var e=uo(this,2,r,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(r){return KO(uo(this,4,r,arguments.length>1?arguments[1]:void 0))},getUint32:function(r){return KO(uo(this,4,r,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(r){return GO(uo(this,4,r,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(r){return GO(uo(this,8,r,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(r,e){lo(this,1,r,HO,e)},setUint8:function(r,e){lo(this,1,r,HO,e)},setInt16:function(r,e){lo(this,2,r,JO,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(r,e){lo(this,2,r,JO,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(r,e){lo(this,4,r,XO,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(r,e){lo(this,4,r,XO,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(r,e){lo(this,4,r,Upe,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(r,e){lo(this,8,r,jpe,e,arguments.length>2?arguments[2]:void 0)}});else{var eN=Ape&&Qn.name!==fu;if(!Wb(function(){Qn(1)})||!Wb(function(){new Qn(-1)})||Wb(function(){return new Qn,new Qn(1.5),new Qn(NaN),Qn.length!=1||eN&&!WO})){Nn=function(r){return Np(this,pu),new Qn(Ap(r))},Nn[du]=pu;for(var tN=Ipe(Qn),rN=0,Zb;tN.length>rN;)(Zb=tN[rN++])in Nn||jO(Nn,Zb,Qn[Zb]);pu.constructor=Nn}else eN&&WO&&jO(Qn,"name",fu);$O&&Rpe(is)!==QO&&$O(is,QO);var Lp=new Fi(new Nn(2)),nN=$b(is.setInt8);Lp.setInt8(0,2147483648),Lp.setInt8(1,2147483649),(Lp.getInt8(0)||!Lp.getInt8(1))&&VO(is,{setInt8:function(r,e){nN(this,r,e<<24>>24)},setUint8:function(r,e){nN(this,r,e<<24>>24)}},{unsafe:!0})}zO(Nn,fu),zO(Fi,Pp);var iN={ArrayBuffer:Nn,DataView:Fi},Vpe=Li,Fpe=RangeError,$pe=function(t){var r=Vpe(t);if(r<0)throw Fpe("The argument can't be less than 0");return r},zpe=$pe,Wpe=RangeError,aN=function(t,r){var e=zpe(t);if(e%r)throw Wpe("Wrong offset");return e},Bpe=da,Zpe=function(t){var r=Bpe(t);return r=="BigInt64Array"||r=="BigUint64Array"},qpe=Qm,Qpe=TypeError,oN=function(t){var r=qpe(t,"number");if(typeof r=="number")throw Qpe("Can't convert number to bigint");return BigInt(r)},Ype=pa,Gpe=dr,Hpe=vg,Jpe=en,Xpe=Jr,Kpe=Qd,eve=Ql,tve=fy,rve=Zpe,nve=yr.aTypedArrayConstructor,ive=oN,ave=function(r){var e=Hpe(this),n=Jpe(r),i=arguments.length,a=i>1?arguments[1]:void 0,o=a!==void 0,s=eve(n),u,l,c,f,d,v,p,y;if(s&&!tve(s))for(p=Kpe(n,s),y=p.next,n=[];!(v=Gpe(y,p)).done;)n.push(v.value);for(o&&i>2&&(a=Ype(a,arguments[2])),l=Xpe(n),c=new(nve(e))(l),f=rve(c),u=0;l>u;u++)d=o?a(n[u],u):n[u],c[u]=f?ive(d):+d;return c},sN=Lt,uN=zt,lN=dr,ove=wr,sve=cpe,vu=yr,cN=iN,fN=Zo,uve=Uo,sc=la,lve=kI,cve=ca,dN=xO,qb=aN,pN=El,uc=Er,fve=da,Qb=Sr,dve=Bs,pve=Ha,vve=ua,Up=Js,hve=Ya.f,vN=ave,mve=In.forEach,gve=Dd,yve=Ui,hN=sn,mN=Ni,Yb=zn,bve=Ly,Gb=Yb.get,_ve=Yb.set,wve=Yb.enforce,gN=hN.f,kve=mN.f,Tve=Math.round,Hb=uN.RangeError,yN=cN.ArrayBuffer,Sve=yN.prototype,Eve=cN.DataView,jp=vu.NATIVE_ARRAY_BUFFER_VIEWS,bN=vu.TYPED_ARRAY_TAG,_N=vu.TypedArray,lc=vu.TypedArrayPrototype,Mve=vu.aTypedArrayConstructor,Jb=vu.isTypedArray,Vp="BYTES_PER_ELEMENT",Xb="Wrong length",wN=function(t,r){Mve(t);for(var e=0,n=r.length,i=new t(n);n>e;)i[e]=r[e++];return i},Fp=function(t,r){yve(t,r,{configurable:!0,get:function(){return Gb(this)[r]}})},kN=function(t){var r;return vve(Sve,t)||(r=fve(t))=="ArrayBuffer"||r=="SharedArrayBuffer"},TN=function(t,r){return Jb(t)&&!dve(r)&&r in t&&lve(+r)&&r>=0},SN=function(r,e){return e=pN(e),TN(r,e)?uve(2,r[e]):kve(r,e)},EN=function(r,e,n){return e=pN(e),TN(r,e)&&Qb(n)&&uc(n,"value")&&!uc(n,"get")&&!uc(n,"set")&&!n.configurable&&(!uc(n,"writable")||n.writable)&&(!uc(n,"enumerable")||n.enumerable)?(r[e]=n.value,r):gN(r,e,n)};ove?(jp||(mN.f=SN,hN.f=EN,Fp(lc,"buffer"),Fp(lc,"byteOffset"),Fp(lc,"byteLength"),Fp(lc,"length")),sN({target:"Object",stat:!0,forced:!jp},{getOwnPropertyDescriptor:SN,defineProperty:EN}),kO.exports=function(t,r,e){var n=t.match(/\d+/)[0]/8,i=t+(e?"Clamped":"")+"Array",a="get"+t,o="set"+t,s=uN[i],u=s,l=u&&u.prototype,c={},f=function(y,k){var I=Gb(y);return I.view[a](k*n+I.byteOffset,!0)},d=function(y,k,I){var C=Gb(y);e&&(I=(I=Tve(I))<0?0:I>255?255:I&255),C.view[o](k*n+C.byteOffset,I,!0)},v=function(y,k){gN(y,k,{get:function(){return f(this,k)},set:function(I){return d(this,k,I)},enumerable:!0})};jp?sve&&(u=r(function(y,k,I,C){return fN(y,l),bve(function(){return Qb(k)?kN(k)?C!==void 0?new s(k,qb(I,n),C):I!==void 0?new s(k,qb(I,n)):new s(k):Jb(k)?wN(u,k):lN(vN,u,k):new s(dN(k))}(),y,u)}),Up&&Up(u,_N),mve(hve(s),function(y){y in u||sc(u,y,s[y])}),u.prototype=l):(u=r(function(y,k,I,C){fN(y,l);var L=0,R=0,q,z,F;if(!Qb(k))F=dN(k),z=F*n,q=new yN(z);else if(kN(k)){q=k,R=qb(I,n);var D=k.byteLength;if(C===void 0){if(D%n||(z=D-R,z<0))throw Hb(Xb)}else if(z=cve(C)*n,z+R>D)throw Hb(Xb);F=z/n}else return Jb(k)?wN(u,k):lN(vN,u,k);for(_ve(y,{buffer:q,byteOffset:R,byteLength:z,length:F,view:new Eve(q)});L<F;)v(y,L++)}),Up&&Up(u,_N),l=u.prototype=pve(lc)),l.constructor!==u&&sc(l,"constructor",u),wve(l).TypedArrayConstructor=u,bN&&sc(l,bN,i);var p=u!=s;c[i]=u,sN({global:!0,constructor:!0,forced:p,sham:!jp},c),Vp in u||sc(u,Vp,n),Vp in l||sc(l,Vp,n),gve(i)}):kO.exports=function(){};var Cve=Ab;Cve("Uint8",function(t){return function(e,n,i){return t(this,e,n,i)}});var MN=Vo,Rve=TypeError,Kb=function(t,r){if(!delete t[r])throw Rve("Cannot delete property "+MN(r)+" of "+MN(t))},Ive=en,e_=$o,Ove=Jr,Nve=Kb,Ave=Math.min,Pve=[].copyWithin||function(r,e){var n=Ive(this),i=Ove(n),a=e_(r,i),o=e_(e,i),s=arguments.length>2?arguments[2]:void 0,u=Ave((s===void 0?i:e_(s,i))-o,i-a),l=1;for(o<a&&a<o+u&&(l=-1,o+=u-1,a+=u-1);u-- >0;)o in n?n[a]=n[o]:Nve(n,a),a+=l,o+=l;return n},xve=Dt,CN=yr,Dve=Pve,Lve=xve(Dve),Uve=CN.aTypedArray,jve=CN.exportTypedArrayMethod;jve("copyWithin",function(r,e){return Lve(Uve(this),r,e,arguments.length>2?arguments[2]:void 0)});var RN=yr,Vve=In.every,Fve=RN.aTypedArray,$ve=RN.exportTypedArrayMethod;$ve("every",function(r){return Vve(Fve(this),r,arguments.length>1?arguments[1]:void 0)});var IN=yr,zve=LO,Wve=oN,Bve=da,Zve=dr,qve=Dt,Qve=Ot,Yve=IN.aTypedArray,Gve=IN.exportTypedArrayMethod,Hve=qve("".slice),Jve=Qve(function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),t!==1});Gve("fill",function(r){var e=arguments.length;Yve(this);var n=Hve(Bve(this),0,3)==="Big"?Wve(r):+r;return Zve(zve,this,n,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)},Jve);var Xve=Jr,Kve=function(t,r){for(var e=0,n=Xve(r),i=new t(n);n>e;)i[e]=r[e++];return i},ON=yr,ehe=Vg,the=ON.aTypedArrayConstructor,rhe=ON.getTypedArrayConstructor,$p=function(t){return the(ehe(t,rhe(t)))},nhe=Kve,ihe=$p,ahe=function(t,r){return nhe(ihe(t),r)},NN=yr,ohe=In.filter,she=ahe,uhe=NN.aTypedArray,lhe=NN.exportTypedArrayMethod;lhe("filter",function(r){var e=ohe(uhe(this),r,arguments.length>1?arguments[1]:void 0);return she(this,e)});var AN=yr,che=In.find,fhe=AN.aTypedArray,dhe=AN.exportTypedArrayMethod;dhe("find",function(r){return che(fhe(this),r,arguments.length>1?arguments[1]:void 0)});var PN=yr,phe=In.findIndex,vhe=PN.aTypedArray,hhe=PN.exportTypedArrayMethod;hhe("findIndex",function(r){return phe(vhe(this),r,arguments.length>1?arguments[1]:void 0)});var xN=yr,mhe=In.forEach,ghe=xN.aTypedArray,yhe=xN.exportTypedArrayMethod;yhe("forEach",function(r){mhe(ghe(this),r,arguments.length>1?arguments[1]:void 0)});var DN=yr,bhe=_d.includes,_he=DN.aTypedArray,whe=DN.exportTypedArrayMethod;whe("includes",function(r){return bhe(_he(this),r,arguments.length>1?arguments[1]:void 0)});var LN=yr,khe=_d.indexOf,The=LN.aTypedArray,She=LN.exportTypedArrayMethod;She("indexOf",function(r){return khe(The(this),r,arguments.length>1?arguments[1]:void 0)});var Ehe=zt,Mhe=Ot,t_=Dt,UN=yr,r_=FR,Che=pr,n_=Che("iterator"),jN=Ehe.Uint8Array,Rhe=t_(r_.values),Ihe=t_(r_.keys),Ohe=t_(r_.entries),i_=UN.aTypedArray,zp=UN.exportTypedArrayMethod,hu=jN&&jN.prototype,Wp=!Mhe(function(){hu[n_].call([1])}),VN=!!hu&&hu.values&&hu[n_]===hu.values&&hu.values.name==="values",FN=function(){return Rhe(i_(this))};zp("entries",function(){return Ohe(i_(this))},Wp),zp("keys",function(){return Ihe(i_(this))},Wp),zp("values",FN,Wp||!VN,{name:"values"}),zp(n_,FN,Wp||!VN,{name:"values"});var $N=yr,Nhe=Dt,Ahe=$N.aTypedArray,Phe=$N.exportTypedArrayMethod,xhe=Nhe([].join);Phe("join",function(r){return xhe(Ahe(this),r)});var Dhe=Ga,Lhe=Rn,Uhe=Li,jhe=Jr,Vhe=Jd,Fhe=Math.min,a_=[].lastIndexOf,zN=!!a_&&1/[1].lastIndexOf(1,-0)<0,$he=Vhe("lastIndexOf"),zhe=zN||!$he,Whe=zhe?function(r){if(zN)return Dhe(a_,this,arguments)||0;var e=Lhe(this),n=jhe(e),i=n-1;for(arguments.length>1&&(i=Fhe(i,Uhe(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in e&&e[i]===r)return i||0;return-1}:a_,WN=yr,Bhe=Ga,Zhe=Whe,qhe=WN.aTypedArray,Qhe=WN.exportTypedArrayMethod;Qhe("lastIndexOf",function(r){var e=arguments.length;return Bhe(Zhe,qhe(this),e>1?[r,arguments[1]]:[r])});var BN=yr,Yhe=In.map,Ghe=$p,Hhe=BN.aTypedArray,Jhe=BN.exportTypedArrayMethod;Jhe("map",function(r){return Yhe(Hhe(this),r,arguments.length>1?arguments[1]:void 0,function(e,n){return new(Ghe(e))(n)})});var Xhe=$n,Khe=en,eme=Tl,tme=Jr,rme=TypeError,ZN=function(t){return function(r,e,n,i){Xhe(e);var a=Khe(r),o=eme(a),s=tme(a),u=t?s-1:0,l=t?-1:1;if(n<2)for(;;){if(u in o){i=o[u],u+=l;break}if(u+=l,t?u<0:s<=u)throw rme("Reduce of empty array with no initial value")}for(;t?u>=0:s>u;u+=l)u in o&&(i=e(i,o[u],u,a));return i}},qN={left:ZN(!1),right:ZN(!0)},QN=yr,nme=qN.left,ime=QN.aTypedArray,ame=QN.exportTypedArrayMethod;ame("reduce",function(r){var e=arguments.length;return nme(ime(this),r,e,e>1?arguments[1]:void 0)});var YN=yr,ome=qN.right,sme=YN.aTypedArray,ume=YN.exportTypedArrayMethod;ume("reduceRight",function(r){var e=arguments.length;return ome(sme(this),r,e,e>1?arguments[1]:void 0)});var GN=yr,lme=GN.aTypedArray,cme=GN.exportTypedArrayMethod,fme=Math.floor;cme("reverse",function(){for(var r=this,e=lme(r).length,n=fme(e/2),i=0,a;i<n;)a=r[i],r[i++]=r[--e],r[e]=a;return r});var HN=zt,JN=dr,o_=yr,dme=Jr,pme=aN,vme=en,XN=Ot,hme=HN.RangeError,s_=HN.Int8Array,KN=s_&&s_.prototype,e3=KN&&KN.set,mme=o_.aTypedArray,gme=o_.exportTypedArrayMethod,u_=!XN(function(){var t=new Uint8ClampedArray(2);return JN(e3,t,{length:1,0:3},1),t[1]!==3}),yme=u_&&o_.NATIVE_ARRAY_BUFFER_VIEWS&&XN(function(){var t=new s_(2);return t.set(1),t.set("2",1),t[0]!==0||t[1]!==2});gme("set",function(r){mme(this);var e=pme(arguments.length>1?arguments[1]:void 0,1),n=vme(r);if(u_)return JN(e3,this,n,e);var i=this.length,a=dme(n),o=0;if(a+e>i)throw hme("Wrong length");for(;o<a;)this[e+o]=n[o++]},!u_||yme);var t3=yr,bme=$p,_me=Ot,wme=Qs,kme=t3.aTypedArray,Tme=t3.exportTypedArrayMethod,Sme=_me(function(){new Int8Array(1).slice()});Tme("slice",function(r,e){for(var n=wme(kme(this),r,e),i=bme(this),a=0,o=n.length,s=new i(o);o>a;)s[a]=n[a++];return s},Sme);var r3=yr,Eme=In.some,Mme=r3.aTypedArray,Cme=r3.exportTypedArrayMethod;Cme("some",function(r){return Eme(Mme(this),r,arguments.length>1?arguments[1]:void 0)});var n3=Pl,Rme=Math.floor,l_=function(t,r){var e=t.length,n=Rme(e/2);return e<8?Ime(t,r):Ome(t,l_(n3(t,0,n),r),l_(n3(t,n),r),r)},Ime=function(t,r){for(var e=t.length,n=1,i,a;n<e;){for(a=n,i=t[n];a&&r(t[a-1],i)>0;)t[a]=t[--a];a!==n++&&(t[a]=i)}return t},Ome=function(t,r,e,n){for(var i=r.length,a=e.length,o=0,s=0;o<i||s<a;)t[o+s]=o<i&&s<a?n(r[o],e[s])<=0?r[o++]:e[s++]:o<i?r[o++]:e[s++];return t},c_=l_,Nme=jo,i3=Nme.match(/firefox\/(\d+)/i),a3=!!i3&&+i3[1],Ame=jo,o3=/MSIE|Trident/.test(Ame),Pme=jo,s3=Pme.match(/AppleWebKit\/(\d+)\./),u3=!!s3&&+s3[1],xme=zt,Dme=Md,f_=Ot,Lme=$n,Ume=c_,l3=yr,c3=a3,jme=o3,f3=zs,d3=u3,Vme=l3.aTypedArray,Fme=l3.exportTypedArrayMethod,cc=xme.Uint16Array,mu=cc&&Dme(cc.prototype.sort),$me=!!mu&&!(f_(function(){mu(new cc(2),null)})&&f_(function(){mu(new cc(2),{})})),p3=!!mu&&!f_(function(){if(f3)return f3<74;if(c3)return c3<67;if(jme)return!0;if(d3)return d3<602;var t=new cc(516),r=Array(516),e,n;for(e=0;e<516;e++)n=e%4,t[e]=515-e,r[e]=e-2*n+3;for(mu(t,function(i,a){return(i/4|0)-(a/4|0)}),e=0;e<516;e++)if(t[e]!==r[e])return!0}),zme=function(t){return function(r,e){return t!==void 0?+t(r,e)||0:e!==e?-1:r!==r?1:r===0&&e===0?1/r>0&&1/e<0?1:-1:r>e}};Fme("sort",function(r){return r!==void 0&&Lme(r),p3?mu(this,r):Ume(Vme(this),zme(r))},!p3||$me);var v3=yr,Wme=ca,h3=$o,Bme=$p,Zme=v3.aTypedArray,qme=v3.exportTypedArrayMethod;qme("subarray",function(r,e){var n=Zme(this),i=n.length,a=h3(r,i),o=Bme(n);return new o(n.buffer,n.byteOffset+a*n.BYTES_PER_ELEMENT,Wme((e===void 0?i:h3(e,i))-a))});var Qme=zt,Yme=Ga,m3=yr,d_=Ot,g3=Qs,Bp=Qme.Int8Array,y3=m3.aTypedArray,Gme=m3.exportTypedArrayMethod,b3=[].toLocaleString,Hme=!!Bp&&d_(function(){b3.call(new Bp(1))}),Jme=d_(function(){return[1,2].toLocaleString()!=new Bp([1,2]).toLocaleString()})||!d_(function(){Bp.prototype.toLocaleString.call([1,2])});Gme("toLocaleString",function(){return Yme(b3,Hme?g3(y3(this)):y3(this),g3(arguments))},Jme);var Xme=yr.exportTypedArrayMethod,Kme=Ot,ege=zt,tge=Dt,_3=ege.Uint8Array,rge=_3&&_3.prototype||{},Zp=[].toString,nge=tge([].join);Kme(function(){Zp.call({})})&&(Zp=function(){return nge(this)});var ige=rge.toString!=Zp;Xme("toString",Zp,ige);var age=Sr,oge=Ai,sge=pr,uge=sge("match"),w3=function(t){var r;return age(t)&&((r=t[uge])!==void 0?!!r:oge(t)=="RegExp")},lge=Ga,fc=dr,p_=Dt,cge=sp,fge=Or,dge=Pi,pge=w3,k3=xi,vge=Vg,hge=Gy,mge=ca,v_=Fr,gge=Fo,T3=Pl,S3=up,yge=op,bge=rI,_ge=Ot,gu=bge.UNSUPPORTED_Y,E3=4294967295,wge=Math.min,M3=[].push,kge=p_(/./.exec),yu=p_(M3),dc=p_("".slice),Tge=!_ge(function(){var t=/(?:)/,r=t.exec;t.exec=function(){return r.apply(this,arguments)};var e="ab".split(t);return e.length!==2||e[0]!=="a"||e[1]!=="b"});cge("split",function(t,r,e){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,a){var o=v_(k3(this)),s=a===void 0?E3:a>>>0;if(s===0)return[];if(i===void 0)return[o];if(!pge(i))return fc(r,o,i,s);for(var u=[],l=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),c=0,f=new RegExp(i.source,l+"g"),d,v,p;(d=fc(yge,f,o))&&(v=f.lastIndex,!(v>c&&(yu(u,dc(o,c,d.index)),d.length>1&&d.index<o.length&&lge(M3,u,T3(d,1)),p=d[0].length,c=v,u.length>=s)));)f.lastIndex===d.index&&f.lastIndex++;return c===o.length?(p||!kge(f,""))&&yu(u,""):yu(u,dc(o,c)),u.length>s?T3(u,0,s):u}:"0".split(void 0,0).length?n=function(i,a){return i===void 0&&a===0?[]:fc(r,this,i,a)}:n=r,[function(a,o){var s=k3(this),u=dge(a)?void 0:gge(a,t);return u?fc(u,a,s,o):fc(n,v_(s),a,o)},function(i,a){var o=fge(this),s=v_(i),u=e(n,o,s,a,n!==r);if(u.done)return u.value;var l=vge(o,RegExp),c=o.unicode,f=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(gu?"g":"y"),d=new l(gu?"^(?:"+o.source+")":o,f),v=a===void 0?E3:a>>>0;if(v===0)return[];if(s.length===0)return S3(d,s)===null?[s]:[];for(var p=0,y=0,k=[];y<s.length;){d.lastIndex=gu?0:y;var I=S3(d,gu?dc(s,y):s),C;if(I===null||(C=wge(mge(d.lastIndex+(gu?y:0)),s.length))===p)y=hge(s,y,c);else{if(yu(k,dc(s,p,y)),k.length===v)return k;for(var L=1;L<=I.length-1;L++)if(yu(k,I[L]),k.length===v)return k;y=p=C}}return yu(k,dc(s,p)),k}]},!Tge,gu);var bu={},Sge={get exports(){return bu},set exports(t){bu=t}},h_={},Ege={get exports(){return h_},set exports(t){h_=t}};(function(t){function r(e){return Function.toString.call(e).indexOf("[native code]")!==-1}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Ege);var m_={},Mge={get exports(){return m_},set exports(t){m_=t}},g_={},Cge={get exports(){return g_},set exports(t){g_=t}};(function(t){function r(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Cge),function(t){var r=$l,e=g_;function n(i,a,o){return e()?(t.exports=n=Reflect.construct.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=n=function(u,l,c){var f=[null];f.push.apply(f,l);var d=Function.bind.apply(u,f),v=new d;return c&&r(v,c.prototype),v},t.exports.__esModule=!0,t.exports.default=t.exports),n.apply(null,arguments)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(Mge),function(t){var r=wn,e=$l,n=h_,i=m_;function a(o){var s=typeof Map=="function"?new Map:void 0;return t.exports=a=function(l){if(l===null||!n(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof s<"u"){if(s.has(l))return s.get(l);s.set(l,c)}function c(){return i(l,arguments,r(this).constructor)}return c.prototype=Object.create(l.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),e(c,l)},t.exports.__esModule=!0,t.exports.default=t.exports,a(o)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports}(Sge);var pc={},Rge={get exports(){return pc},set exports(t){pc=t}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */(function(t,r){(function(){var e={function:!0,object:!0},n=e[typeof window]&&window||this,i=r,a=t&&!t.nodeType&&t,o=i&&a&&typeof V=="object"&&V;o&&(o.global===o||o.window===o||o.self===o)&&(n=o);var s=Math.pow(2,53)-1,u=/\bOpera/,l=Object.prototype,c=l.hasOwnProperty,f=l.toString;function d(D){return D=String(D),D.charAt(0).toUpperCase()+D.slice(1)}function v(D,W,X){var me={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return W&&X&&/^Win/i.test(D)&&!/^Windows Phone /i.test(D)&&(me=me[/[\d.]+$/.exec(D)])&&(D="Windows "+me),D=String(D),W&&X&&(D=D.replace(RegExp(W,"i"),X)),D=y(D.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),D}function p(D,W){var X=-1,me=D?D.length:0;if(typeof me=="number"&&me>-1&&me<=s)for(;++X<me;)W(D[X],X,D);else k(D,W)}function y(D){return D=q(D),/^(?:webOS|i(?:OS|P))/.test(D)?D:d(D)}function k(D,W){for(var X in D)c.call(D,X)&&W(D[X],X,D)}function I(D){return D==null?d(D):f.call(D).slice(8,-1)}function C(D,W){var X=D!=null?typeof D[W]:"number";return!/^(?:boolean|number|string|undefined)$/.test(X)&&(X=="object"?!!D[W]:!0)}function L(D){return String(D).replace(/([ -])(?!$)/g,"$1?")}function R(D,W){var X=null;return p(D,function(me,de){X=W(X,me,de,D)}),X}function q(D){return String(D).replace(/^ +| +$/g,"")}function z(D){var W=n,X=D&&typeof D=="object"&&I(D)!="String";X&&(W=D,D=null);var me=W.navigator||{},de=me.userAgent||"";D||(D=de);var H=X?!!me.likeChrome:/\bChrome\b/.test(D)&&!/internal|\n/i.test(f.toString()),ee="Object",Z=X?ee:"ScriptBridgingProxyObject",te=X?ee:"Environment",re=X&&W.java?"JavaPackage":I(W.java),K=X?ee:"RuntimeObject",fe=/\bJava/.test(re)&&W.java,Te=fe&&I(W.environment)==te,$=fe?"a":"",We=fe?"b":"",et=W.document||{},dt=W.operamini||W.opera,$e=u.test($e=X&&dt?dt["[[Class]]"]:I(dt))?$e:dt=null,ue,Rr=D,Ue=[],ke=null,Gt=D==de,Qe=Gt&&dt&&typeof dt.version=="function"&&dt.version(),vr,At=rr([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Oe=ot(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),_t=Be([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Bt=Pt({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),Fe=Tt(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function rr(er){return R(er,function(jt,kt){return jt||RegExp("\\b"+(kt.pattern||L(kt))+"\\b","i").exec(D)&&(kt.label||kt)})}function Pt(er){return R(er,function(jt,kt,br){return jt||(kt[_t]||kt[/^[a-z]+(?: +[a-z]+\b)*/i.exec(_t)]||RegExp("\\b"+L(br)+"(?:\\b|\\w*\\d)","i").exec(D))&&br})}function ot(er){return R(er,function(jt,kt){return jt||RegExp("\\b"+(kt.pattern||L(kt))+"\\b","i").exec(D)&&(kt.label||kt)})}function Tt(er){return R(er,function(jt,kt){var br=kt.pattern||L(kt);return!jt&&(jt=RegExp("\\b"+br+"(?:/[\\d.]+|[ \\w.]*)","i").exec(D))&&(jt=v(jt,br,kt.label||kt)),jt})}function Be(er){return R(er,function(jt,kt){var br=kt.pattern||L(kt);return!jt&&(jt=RegExp("\\b"+br+" *\\d+[.\\w_]*","i").exec(D)||RegExp("\\b"+br+" *\\w+-[\\w]*","i").exec(D)||RegExp("\\b"+br+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(D))&&((jt=String(kt.label&&!RegExp(br,"i").test(kt.label)?kt.label:jt).split("/"))[1]&&!/[\d.]+/.test(jt[0])&&(jt[0]+=" "+jt[1]),kt=kt.label||kt,jt=y(jt[0].replace(RegExp(br,"i"),kt).replace(RegExp("; *(?:"+kt+"[_-])?","i")," ").replace(RegExp("("+kt+")[-_.]?(\\w)","i"),"$1 $2"))),jt})}function Dn(er){return R(er,function(jt,kt){return jt||(RegExp(kt+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(D)||0)[1]||null})}function _i(){return this.description||""}if(At&&(At=[At]),/\bAndroid\b/.test(Fe)&&!_t&&(ue=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(D))&&(_t=q(ue[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),Bt&&!_t?_t=Be([Bt]):Bt&&_t&&(_t=_t.replace(RegExp("^("+L(Bt)+")[-_.\\s]","i"),Bt+" ").replace(RegExp("^("+L(Bt)+")[-_.]?(\\w)","i"),Bt+" $2")),(ue=/\bGoogle TV\b/.exec(_t))&&(_t=ue[0]),/\bSimulator\b/i.test(D)&&(_t=(_t?_t+" ":"")+"Simulator"),Oe=="Opera Mini"&&/\bOPiOS\b/.test(D)&&Ue.push("running in Turbo/Uncompressed mode"),Oe=="IE"&&/\blike iPhone OS\b/.test(D)?(ue=z(D.replace(/like iPhone OS/,"")),Bt=ue.manufacturer,_t=ue.product):/^iP/.test(_t)?(Oe||(Oe="Safari"),Fe="iOS"+((ue=/ OS ([\d_]+)/i.exec(D))?" "+ue[1].replace(/_/g,"."):"")):Oe=="Konqueror"&&/^Linux\b/i.test(Fe)?Fe="Kubuntu":Bt&&Bt!="Google"&&(/Chrome/.test(Oe)&&!/\bMobile Safari\b/i.test(D)||/\bVita\b/.test(_t))||/\bAndroid\b/.test(Fe)&&/^Chrome/.test(Oe)&&/\bVersion\//i.test(D)?(Oe="Android Browser",Fe=/\bAndroid\b/.test(Fe)?Fe:"Android"):Oe=="Silk"?(/\bMobi/i.test(D)||(Fe="Android",Ue.unshift("desktop mode")),/Accelerated *= *true/i.test(D)&&Ue.unshift("accelerated")):Oe=="UC Browser"&&/\bUCWEB\b/.test(D)?Ue.push("speed mode"):Oe=="PaleMoon"&&(ue=/\bFirefox\/([\d.]+)\b/.exec(D))?Ue.push("identifying as Firefox "+ue[1]):Oe=="Firefox"&&(ue=/\b(Mobile|Tablet|TV)\b/i.exec(D))?(Fe||(Fe="Firefox OS"),_t||(_t=ue[1])):!Oe||(ue=!/\bMinefield\b/i.test(D)&&/\b(?:Firefox|Safari)\b/.exec(Oe))?(Oe&&!_t&&/[\/,]|^[^(]+?\)/.test(D.slice(D.indexOf(ue+"/")+8))&&(Oe=null),(ue=_t||Bt||Fe)&&(_t||Bt||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Fe))&&(Oe=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Fe)?Fe:ue)+" Browser")):Oe=="Electron"&&(ue=(/\bChrome\/([\d.]+)\b/.exec(D)||0)[1])&&Ue.push("Chromium "+ue),Qe||(Qe=Dn(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",L(Oe),"(?:Firefox|Minefield|NetFront)"])),(ue=At=="iCab"&&parseFloat(Qe)>3&&"WebKit"||/\bOpera\b/.test(Oe)&&(/\bOPR\b/.test(D)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(D)&&!/^(?:Trident|EdgeHTML)$/.test(At)&&"WebKit"||!At&&/\bMSIE\b/i.test(D)&&(Fe=="Mac OS"?"Tasman":"Trident")||At=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Oe)&&"NetFront")&&(At=[ue]),Oe=="IE"&&(ue=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(D)||0)[1])?(Oe+=" Mobile",Fe="Windows Phone "+(/\+$/.test(ue)?ue:ue+".x"),Ue.unshift("desktop mode")):/\bWPDesktop\b/i.test(D)?(Oe="IE Mobile",Fe="Windows Phone 8.x",Ue.unshift("desktop mode"),Qe||(Qe=(/\brv:([\d.]+)/.exec(D)||0)[1])):Oe!="IE"&&At=="Trident"&&(ue=/\brv:([\d.]+)/.exec(D))&&(Oe&&Ue.push("identifying as "+Oe+(Qe?" "+Qe:"")),Oe="IE",Qe=ue[1]),Gt){if(C(W,"global"))if(fe&&(ue=fe.lang.System,Rr=ue.getProperty("os.arch"),Fe=Fe||ue.getProperty("os.name")+" "+ue.getProperty("os.version")),Te){try{Qe=W.require("ringo/engine").version.join("."),Oe="RingoJS"}catch{(ue=W.system)&&ue.global.system==W.system&&(Oe="Narwhal",Fe||(Fe=ue[0].os||null))}Oe||(Oe="Rhino")}else typeof W.process=="object"&&!W.process.browser&&(ue=W.process)&&(typeof ue.versions=="object"&&(typeof ue.versions.electron=="string"?(Ue.push("Node "+ue.versions.node),Oe="Electron",Qe=ue.versions.electron):typeof ue.versions.nw=="string"&&(Ue.push("Chromium "+Qe,"Node "+ue.versions.node),Oe="NW.js",Qe=ue.versions.nw)),Oe||(Oe="Node.js",Rr=ue.arch,Fe=ue.platform,Qe=/[\d.]+/.exec(ue.version),Qe=Qe?Qe[0]:null));else I(ue=W.runtime)==Z?(Oe="Adobe AIR",Fe=ue.flash.system.Capabilities.os):I(ue=W.phantom)==K?(Oe="PhantomJS",Qe=(ue=ue.version||null)&&ue.major+"."+ue.minor+"."+ue.patch):typeof et.documentMode=="number"&&(ue=/\bTrident\/(\d+)/i.exec(D))?(Qe=[Qe,et.documentMode],(ue=+ue[1]+4)!=Qe[1]&&(Ue.push("IE "+Qe[1]+" mode"),At&&(At[1]=""),Qe[1]=ue),Qe=Oe=="IE"?String(Qe[1].toFixed(1)):Qe[0]):typeof et.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Oe)&&(Ue.push("masking as "+Oe+" "+Qe),Oe="IE",Qe="11.0",At=["Trident"],Fe="Windows");Fe=Fe&&y(Fe)}if(Qe&&(ue=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Qe)||/(?:alpha|beta)(?: ?\d)?/i.exec(D+";"+(Gt&&me.appMinorVersion))||/\bMinefield\b/i.test(D)&&"a")&&(ke=/b/i.test(ue)?"beta":"alpha",Qe=Qe.replace(RegExp(ue+"\\+?$"),"")+(ke=="beta"?We:$)+(/\d+\+?/.exec(ue)||"")),Oe=="Fennec"||Oe=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(Fe))Oe="Firefox Mobile";else if(Oe=="Maxthon"&&Qe)Qe=Qe.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(_t))_t=="Xbox 360"&&(Fe=null),_t=="Xbox 360"&&/\bIEMobile\b/.test(D)&&Ue.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(Oe)||Oe&&!_t&&!/Browser|Mobi/.test(Oe))&&(Fe=="Windows CE"||/Mobi/i.test(D)))Oe+=" Mobile";else if(Oe=="IE"&&Gt)try{W.external===null&&Ue.unshift("platform preview")}catch{Ue.unshift("embedded")}else(/\bBlackBerry\b/.test(_t)||/\bBB10\b/.test(D))&&(ue=(RegExp(_t.replace(/ +/g," *")+"/([.\\d]+)","i").exec(D)||0)[1]||Qe)?(ue=[ue,/BB10/.test(D)],Fe=(ue[1]?(_t=null,Bt="BlackBerry"):"Device Software")+" "+ue[0],Qe=null):this!=k&&_t!="Wii"&&(Gt&&dt||/Opera/.test(Oe)&&/\b(?:MSIE|Firefox)\b/i.test(D)||Oe=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Fe)||Oe=="IE"&&(Fe&&!/^Win/.test(Fe)&&Qe>5.5||/\bWindows XP\b/.test(Fe)&&Qe>8||Qe==8&&!/\bTrident\b/.test(D)))&&!u.test(ue=z.call(k,D.replace(u,"")+";"))&&ue.name&&(ue="ing as "+ue.name+((ue=ue.version)?" "+ue:""),u.test(Oe)?(/\bIE\b/.test(ue)&&Fe=="Mac OS"&&(Fe=null),ue="identify"+ue):(ue="mask"+ue,$e?Oe=y($e.replace(/([a-z])([A-Z])/g,"$1 $2")):Oe="Opera",/\bIE\b/.test(ue)&&(Fe=null),Gt||(Qe=null)),At=["Presto"],Ue.push(ue));(ue=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(D)||0)[1])&&(ue=[parseFloat(ue.replace(/\.(\d)$/,".0$1")),ue],Oe=="Safari"&&ue[1].slice(-1)=="+"?(Oe="WebKit Nightly",ke="alpha",Qe=ue[1].slice(0,-1)):(Qe==ue[1]||Qe==(ue[2]=(/\bSafari\/([\d.]+\+?)/i.exec(D)||0)[1]))&&(Qe=null),ue[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(D)||0)[1],ue[0]==537.36&&ue[2]==537.36&&parseFloat(ue[1])>=28&&At=="WebKit"&&(At=["Blink"]),!Gt||!H&&!ue[1]?(At&&(At[1]="like Safari"),ue=(ue=ue[0],ue<400?1:ue<500?2:ue<526?3:ue<533?4:ue<534?"4+":ue<535?5:ue<537?6:ue<538?7:ue<601?8:ue<602?9:ue<604?10:ue<606?11:ue<608?12:"12")):(At&&(At[1]="like Chrome"),ue=ue[1]||(ue=ue[0],ue<530?1:ue<532?2:ue<532.05?3:ue<533?4:ue<534.03?5:ue<534.07?6:ue<534.1?7:ue<534.13?8:ue<534.16?9:ue<534.24?10:ue<534.3?11:ue<535.01?12:ue<535.02?"13+":ue<535.07?15:ue<535.11?16:ue<535.19?17:ue<536.05?18:ue<536.1?19:ue<537.01?20:ue<537.11?"21+":ue<537.13?23:ue<537.18?24:ue<537.24?25:ue<537.36?26:At!="Blink"?"27":"28")),At&&(At[1]+=" "+(ue+=typeof ue=="number"?".x":/[.+]/.test(ue)?"":"+")),Oe=="Safari"&&(!Qe||parseInt(Qe)>45)?Qe=ue:Oe=="Chrome"&&/\bHeadlessChrome/i.test(D)&&Ue.unshift("headless")),Oe=="Opera"&&(ue=/\bzbov|zvav$/.exec(Fe))?(Oe+=" ",Ue.unshift("desktop mode"),ue=="zvav"?(Oe+="Mini",Qe=null):Oe+="Mobile",Fe=Fe.replace(RegExp(" *"+ue+"$"),"")):Oe=="Safari"&&/\bChrome\b/.exec(At&&At[1])?(Ue.unshift("desktop mode"),Oe="Chrome Mobile",Qe=null,/\bOS X\b/.test(Fe)?(Bt="Apple",Fe="iOS 4.3+"):Fe=null):/\bSRWare Iron\b/.test(Oe)&&!Qe&&(Qe=Dn("Chrome")),Qe&&Qe.indexOf(ue=/[\d.]+$/.exec(Fe))==0&&D.indexOf("/"+ue+"-")>-1&&(Fe=q(Fe.replace(ue,""))),Fe&&Fe.indexOf(Oe)!=-1&&!RegExp(Oe+" OS").test(Fe)&&(Fe=Fe.replace(RegExp(" *"+L(Oe)+" *"),"")),At&&!/\b(?:Avant|Nook)\b/.test(Oe)&&(/Browser|Lunascape|Maxthon/.test(Oe)||Oe!="Safari"&&/^iOS/.test(Fe)&&/\bSafari\b/.test(At[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Oe)&&At[1])&&(ue=At[At.length-1])&&Ue.push(ue),Ue.length&&(Ue=["("+Ue.join("; ")+")"]),Bt&&_t&&_t.indexOf(Bt)<0&&Ue.push("on "+Bt),_t&&Ue.push((/^on /.test(Ue[Ue.length-1])?"":"on ")+_t),Fe&&(ue=/ ([\d.+]+)$/.exec(Fe),vr=ue&&Fe.charAt(Fe.length-ue[0].length-1)=="/",Fe={architecture:32,family:ue&&!vr?Fe.replace(ue[0],""):Fe,version:ue?ue[1]:null,toString:function(){var er=this.version;return this.family+(er&&!vr?" "+er:"")+(this.architecture==64?" 64-bit":"")}}),(ue=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Rr))&&!/\bi686\b/i.test(Rr)?(Fe&&(Fe.architecture=64,Fe.family=Fe.family.replace(RegExp(" *"+ue),"")),Oe&&(/\bWOW64\b/i.test(D)||Gt&&/\w(?:86|32)$/.test(me.cpuClass||me.platform)&&!/\bWin64; x64\b/i.test(D))&&Ue.unshift("32-bit")):Fe&&/^OS X/.test(Fe.family)&&Oe=="Chrome"&&parseFloat(Qe)>=39&&(Fe.architecture=64),D||(D=null);var Qt={};return Qt.description=D,Qt.layout=At&&At[0],Qt.manufacturer=Bt,Qt.name=Oe,Qt.prerelease=ke,Qt.product=_t,Qt.ua=D,Qt.version=Oe&&Qe,Qt.os=Fe||{architecture:null,family:null,version:null,toString:function(){return"null"}},Qt.parse=z,Qt.toString=_i,Qt.version&&Ue.unshift(Qe),Qt.name&&Ue.unshift(Oe),Fe&&Oe&&!(Fe==String(Fe).split(" ")[0]&&(Fe==Oe.split(" ")[0]||_t))&&Ue.push(_t?"("+Fe+")":"on "+Fe),Ue.length&&(Qt.description=Ue.join(" ")),Qt}var F=z();i&&a?k(F,function(D,W){i[W]=D}):n.platform=F}).call(V)})(Rge,pc);var Ige=dr,Oge=sp,Nge=Or,Age=Pi,Pge=ca,y_=Fr,xge=xi,Dge=Fo,Lge=Gy,C3=up;Oge("match",function(t,r,e){return[function(i){var a=xge(this),o=Age(i)?void 0:Dge(i,t);return o?Ige(o,i,a):new RegExp(i)[t](y_(a))},function(n){var i=Nge(this),a=y_(n),o=e(r,i,a);if(o.done)return o.value;if(!i.global)return C3(i,a);var s=i.unicode;i.lastIndex=0;for(var u=[],l=0,c;(c=C3(i,a))!==null;){var f=y_(c[0]);u[l]=f,f===""&&(i.lastIndex=Lge(a,Pge(i.lastIndex),s)),l++}return l===0?null:u}]});var Uge=Object.is||function(r,e){return r===e?r!==0||1/r===1/e:r!=r&&e!=e},jge=dr,Vge=sp,Fge=Or,$ge=Pi,zge=xi,R3=Uge,I3=Fr,Wge=Fo,Bge=up;Vge("search",function(t,r,e){return[function(i){var a=zge(this),o=$ge(i)?void 0:Wge(i,t);return o?jge(o,i,a):new RegExp(i)[t](I3(a))},function(n){var i=Fge(this),a=I3(n),o=e(r,i,a);if(o.done)return o.value;var s=i.lastIndex;R3(s,0)||(i.lastIndex=0);var u=Bge(i,a);return R3(i.lastIndex,s)||(i.lastIndex=s),u===null?-1:u.index}]});var Zge=wr,qge=xl,Qge=TypeError,Yge=Object.getOwnPropertyDescriptor,Gge=Zge&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),Hge=Gge?function(t,r){if(qge(t)&&!Yge(t,"length").writable)throw Qge("Cannot set read only .length");return t.length=r}:function(t,r){return t.length=r},Jge=Lt,Xge=en,Kge=$o,eye=Li,tye=Jr,rye=Hge,nye=fR,iye=Tg,aye=Ys,b_=Kb,oye=Fl,sye=oye("splice"),uye=Math.max,lye=Math.min;Jge({target:"Array",proto:!0,forced:!sye},{splice:function(r,e){var n=Xge(this),i=tye(n),a=Kge(r,i),o=arguments.length,s,u,l,c,f,d;for(o===0?s=u=0:o===1?(s=0,u=i-a):(s=o-2,u=lye(uye(eye(e),0),i-a)),nye(i+s-u),l=iye(n,u),c=0;c<u;c++)f=a+c,f in n&&aye(l,c,n[f]);if(l.length=u,s<u){for(c=a;c<i-u;c++)f=c+u,d=c+s,f in n?n[d]=n[f]:b_(n,d);for(c=i;c>i-u+s;c--)b_(n,c-1)}else if(s>u)for(c=i-u;c>a;c--)f=c+u-1,d=c+s-1,f in n?n[d]=n[f]:b_(n,d);for(c=0;c<s;c++)n[c+a]=arguments[c+2];return rye(n,i-u+s),l}});/*
  @license
  The following license applies to all parts of this software except as
  documented below.

      Copyright (c) 2016, Twilio, inc.
      All rights reserved.

      Redistribution and use in source and binary forms, with or without
      modification, are permitted provided that the following conditions are
      met:

        1. Redistributions of source code must retain the above copyright
           notice, this list of conditions and the following disclaimer.

        2. Redistributions in binary form must reproduce the above copyright
           notice, this list of conditions and the following disclaimer in
           the documentation and/or other materials provided with the
           distribution.

        3. Neither the name of Twilio nor the names of its contributors may
           be used to endorse or promote products derived from this software
           without specific prior written permission.

      THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
      "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
      LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
      A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
      HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
      SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
      LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
      DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
      THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
      (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
      OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

  This software includes javascript-state-machine under the following license.

      Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

      Permission is hereby granted, free of charge, to any person obtaining a copy
      of this software and associated documentation files (the "Software"), to deal
      in the Software without restriction, including without limitation the rights
      to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
      copies of the Software, and to permit persons to whom the Software is
      furnished to do so, subject to the following conditions:

      The above copyright notice and this permission notice shall be included in all
      copies or substantial portions of the Software.

      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
      IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
      FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
      AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
      LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
      OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

  This software includes loglevel under the following license.

      Copyright (c) 2013 Tim Perry

      Permission is hereby granted, free of charge, to any person
      obtaining a copy of this software and associated documentation
      files (the "Software"), to deal in the Software without
      restriction, including without limitation the rights to use,
      copy, modify, merge, publish, distribute, sublicense, and/or sell
      copies of the Software, and to permit persons to whom the
      Software is furnished to do so, subject to the following
      conditions:

      The above copyright notice and this permission notice shall be
      included in all copies or substantial portions of the Software.

      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
      EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
      OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
      NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
      HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
      WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
      FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
      OTHER DEALINGS IN THE SOFTWARE.


  */(function(t){var r=typeof r<"u"?r:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(t,"__esModule",{value:!0});var e=Bo,n=ji,i=ha,a=ec,o=Bn,s=Zn,u=wn,l=qn,c=ma,f=Yl,d=_n,v=ln,p=Ho,y=Cb,k=qde,I=bu,C=Ta,L=pc;function R(B){return B&&typeof B=="object"&&"default"in B?B:{default:B}}function q(B){if(B&&B.__esModule)return B;var G=Object.create(null);return B&&Object.keys(B).forEach(function(x){if(x!=="default"){var P=Object.getOwnPropertyDescriptor(B,x);Object.defineProperty(G,x,P.get?P:{enumerable:!0,get:function(){return B[x]}})}}),G.default=B,Object.freeze(G)}var z=R(e),F=R(n),D=R(i),W=R(a),X=R(o),me=R(s),de=R(u),H=R(l),ee=R(c),Z=R(f),te=R(d),re=q(p),K=q(y),fe=R(I),Te=q(L);function $(B,G,x,P){var A=arguments.length,Q=A<3?G:P===null?P=Object.getOwnPropertyDescriptor(G,x):P,j;if((typeof Reflect>"u"?"undefined":te.default(Reflect))==="object"&&typeof Reflect.decorate=="function")Q=Reflect.decorate(B,G,x,P);else for(var Se=B.length-1;Se>=0;Se--)(j=B[Se])&&(Q=(A<3?j(Q):A>3?j(G,x,Q):j(G,x))||Q);return A>3&&Q&&Object.defineProperty(G,x,Q),Q}function We(B,G){if((typeof Reflect>"u"?"undefined":te.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(B,G)}var et;function dt(){}dt.prototype=Object.create(null);function $e(){$e.init.call(this)}$e.EventEmitter=$e,$e.usingDomains=!1,$e.prototype.domain=void 0,$e.prototype._events=void 0,$e.prototype._maxListeners=void 0,$e.defaultMaxListeners=10,$e.init=function(){this.domain=null,$e.usingDomains&&et.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new dt,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$e.prototype.setMaxListeners=function(G){if(typeof G!="number"||G<0||isNaN(G))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=G,this};function ue(B){return B._maxListeners===void 0?$e.defaultMaxListeners:B._maxListeners}$e.prototype.getMaxListeners=function(){return ue(this)};function Rr(B,G,x){if(G)B.call(x);else for(var P=B.length,A=Fe(B,P),Q=0;Q<P;++Q)A[Q].call(x)}function Ue(B,G,x,P){if(G)B.call(x,P);else for(var A=B.length,Q=Fe(B,A),j=0;j<A;++j)Q[j].call(x,P)}function ke(B,G,x,P,A){if(G)B.call(x,P,A);else for(var Q=B.length,j=Fe(B,Q),Se=0;Se<Q;++Se)j[Se].call(x,P,A)}function Gt(B,G,x,P,A,Q){if(G)B.call(x,P,A,Q);else for(var j=B.length,Se=Fe(B,j),we=0;we<j;++we)Se[we].call(x,P,A,Q)}function Qe(B,G,x,P){if(G)B.apply(x,P);else for(var A=B.length,Q=Fe(B,A),j=0;j<A;++j)Q[j].apply(x,P)}$e.prototype.emit=function(G){var x,P,A,Q,j,Se,we,Ve=G==="error";if(Se=this._events,Se)Ve=Ve&&Se.error==null;else if(!Ve)return!1;if(we=this.domain,Ve){if(x=arguments[1],we)x||(x=new Error('Uncaught, unspecified "error" event')),x.domainEmitter=this,x.domain=we,x.domainThrown=!1,we.emit("error",x);else{if(x instanceof Error)throw x;var Ye=new Error('Uncaught, unspecified "error" event. ('+x+")");throw Ye.context=x,Ye}return!1}if(P=Se[G],!P)return!1;var gt=typeof P=="function";switch(A=arguments.length,A){case 1:Rr(P,gt,this);break;case 2:Ue(P,gt,this,arguments[1]);break;case 3:ke(P,gt,this,arguments[1],arguments[2]);break;case 4:Gt(P,gt,this,arguments[1],arguments[2],arguments[3]);break;default:for(Q=new Array(A-1),j=1;j<A;j++)Q[j-1]=arguments[j];Qe(P,gt,this,Q)}return!0};function vr(B,G,x,P){var A,Q,j;if(typeof x!="function")throw new TypeError('"listener" argument must be a function');if(Q=B._events,Q?(Q.newListener&&(B.emit("newListener",G,x.listener?x.listener:x),Q=B._events),j=Q[G]):(Q=B._events=new dt,B._eventsCount=0),!j)j=Q[G]=x,++B._eventsCount;else if(typeof j=="function"?j=Q[G]=P?[x,j]:[j,x]:P?j.unshift(x):j.push(x),!j.warned&&(A=ue(B),A&&A>0&&j.length>A)){j.warned=!0;var Se=new Error("Possible EventEmitter memory leak detected. "+j.length+" "+G+" listeners added. Use emitter.setMaxListeners() to increase limit");Se.name="MaxListenersExceededWarning",Se.emitter=B,Se.type=G,Se.count=j.length,At(Se)}return B}function At(B){typeof console.warn=="function"?console.warn(B):console.log(B)}$e.prototype.addListener=function(G,x){return vr(this,G,x,!1)},$e.prototype.on=$e.prototype.addListener,$e.prototype.prependListener=function(G,x){return vr(this,G,x,!0)};function Oe(B,G,x){var P=!1;function A(){B.removeListener(G,A),P||(P=!0,x.apply(B,arguments))}return A.listener=x,A}$e.prototype.once=function(G,x){if(typeof x!="function")throw new TypeError('"listener" argument must be a function');return this.on(G,Oe(this,G,x)),this},$e.prototype.prependOnceListener=function(G,x){if(typeof x!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(G,Oe(this,G,x)),this},$e.prototype.removeListener=function(G,x){var P,A,Q,j,Se;if(typeof x!="function")throw new TypeError('"listener" argument must be a function');if(A=this._events,!A)return this;if(P=A[G],!P)return this;if(P===x||P.listener&&P.listener===x)--this._eventsCount===0?this._events=new dt:(delete A[G],A.removeListener&&this.emit("removeListener",G,P.listener||x));else if(typeof P!="function"){for(Q=-1,j=P.length;j-- >0;)if(P[j]===x||P[j].listener&&P[j].listener===x){Se=P[j].listener,Q=j;break}if(Q<0)return this;if(P.length===1){if(P[0]=void 0,--this._eventsCount===0)return this._events=new dt,this;delete A[G]}else Bt(P,Q);A.removeListener&&this.emit("removeListener",G,Se||x)}return this},$e.prototype.off=function(B,G){return this.removeListener(B,G)},$e.prototype.removeAllListeners=function(G){var x,P;if(P=this._events,!P)return this;if(!P.removeListener)return arguments.length===0?(this._events=new dt,this._eventsCount=0):P[G]&&(--this._eventsCount===0?this._events=new dt:delete P[G]),this;if(arguments.length===0){for(var A=Object.keys(P),Q=0,j;Q<A.length;++Q)j=A[Q],j!=="removeListener"&&this.removeAllListeners(j);return this.removeAllListeners("removeListener"),this._events=new dt,this._eventsCount=0,this}if(x=P[G],typeof x=="function")this.removeListener(G,x);else if(x)do this.removeListener(G,x[x.length-1]);while(x[0]);return this},$e.prototype.listeners=function(G){var x,P,A=this._events;return A?(x=A[G],x?typeof x=="function"?P=[x.listener||x]:P=rr(x):P=[]):P=[],P},$e.listenerCount=function(B,G){return typeof B.listenerCount=="function"?B.listenerCount(G):_t.call(B,G)},$e.prototype.listenerCount=_t;function _t(B){var G=this._events;if(G){var x=G[B];if(typeof x=="function")return 1;if(x)return x.length}return 0}$e.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Bt(B,G){for(var x=G,P=x+1,A=B.length;P<A;x+=1,P+=1)B[x]=B[P];B.pop()}function Fe(B,G){for(var x=new Array(G);G--;)x[G]=B[G];return x}function rr(B){for(var G=new Array(B.length),x=0;x<G.length;++x)G[x]=B[x].listener||B[x];return G}var Pt=re.getLogger("twilsock");function ot(B,G){return["".concat(new Date().toISOString()," Twilsock ").concat(B,":")].concat(Array.from(G))}var Tt=function(){function B(G){H.default(this,B),ee.default(this,"prefix",""),this.prefix=G!=null&&G.length>0?" "+G+":":""}return F.default(B,[{key:"setLevel",value:function(x){Pt.setLevel(x)}},{key:"trace",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.trace.apply(null,ot("T",P))}},{key:"debug",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.debug.apply(null,ot("D",P))}},{key:"info",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.info.apply(null,ot("I",P))}},{key:"warn",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.warn.apply(null,ot("W",P))}},{key:"error",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.error.apply(null,ot("E",P))}}],[{key:"setLevel",value:function(x){Pt.setLevel(x)}},{key:"trace",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.trace.apply(null,ot("T",P))}},{key:"debug",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.debug.apply(null,ot("D",P))}},{key:"info",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.info.apply(null,ot("I",P))}},{key:"warn",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.warn.apply(null,ot("W",P))}},{key:"error",value:function(){for(var x=arguments.length,P=new Array(x),A=0;A<x;A++)P[A]=arguments[A];Pt.error.apply(null,ot("E",P))}}]),B}(),Be=new Tt(""),Dn="0.12.2",_i=function(){function B(G,x,P){H.default(this,B),ee.default(this,"confirmedCapabilities",new Set),this.activeGrant=x,this._token=G;var A=P.region||"us1",Q="wss://tsock.".concat(A,".twilio.com/v3/wsconnect"),j=P.twilsock||P.Twilsock||{};this.url=j.uri||Q,this._continuationToken=P.continuationToken?P.continuationToken:null,this.logLevel=P.logLevel?P.logLevel:"error",this.retryPolicy=P.retryPolicy?P.retryPolicy:{min:1*1e3,max:2*60*1e3,randomness:.2},this.clientMetadata=P.clientMetadata?P.clientMetadata:{},this.clientMetadata.ver=Dn,this.initRegistrations=P.initRegistrations?P.initRegistrations:null,this.tweaks=P.tweaks?P.tweaks:null}return F.default(B,[{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}},{key:"updateToken",value:function(x){this._token=x}},{key:"updateContinuationToken",value:function(x){this._continuationToken=x}}]),B}(),Qt=function B(G){H.default(this,B),this.id=G||"TM".concat(k.v4())};function er(B){var G=jt();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function jt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var kt=function(B){X.default(x,B);var G=er(x);function x(P,A,Q,j,Se){var we;return H.default(this,x),we=G.call(this),ee.default(D.default(we),"method","init"),we.token=P,we.continuation_token=A,we.metadata=Q,we.registrations=j,we.tweaks=Se,we.capabilities=["client_update","offline_storage","telemetry.v1"],we}return x}(Qt);function br(B){var G=Nr();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function Nr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Xr=function(B){X.default(x,B);var G=br(x);function x(P,A,Q,j,Se,we,Ve){var Ye;return H.default(this,x),Ye=G.call(this,P),Ye.continuationToken=A,Ye.continuationTokenStatus=j,Ye.offlineStorage=Se,Ye.initRegistrations=we,Ye.debugInfo=Ve,Ye.confirmedCapabilities=Q,Ye}return x}(Qt);function Yi(B){var G=La();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function La(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var hn=function(B){X.default(x,B);var G=Yi(x);function x(P){var A;return H.default(this,x),A=G.call(this),ee.default(D.default(A),"method","update"),A.token=P,A}return x}(Qt);function qr(B){var G=Ln();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function Ln(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Re=function(B){X.default(x,B);var G=qr(x);function x(P,A,Q){var j;return H.default(this,x),j=G.call(this),ee.default(D.default(j),"method","message"),j.active_grant=P,j.payload_type=A,j.http_request=Q,j}return x}(Qt);function Ie(B){var G=he();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function he(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ye=function(B){X.default(x,B);var G=Ie(x);function x(P){var A;return H.default(this,x),A=G.call(this,P),ee.default(D.default(A),"method","reply"),ee.default(D.default(A),"payload_type","application/json"),ee.default(D.default(A),"status",{code:200,status:"OK"}),A}return x}(Qt);function ge(B){var G=Ae();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function Ae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var De=function(B){X.default(x,B);var G=ge(x);function x(){var P;return H.default(this,x),P=G.call(this),ee.default(D.default(P),"method","close"),P}return x}(Qt);function se(B){var G=be();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function be(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var oe=function B(G,x,P,A,Q,j){H.default(this,B),this.start=G,this.end=x,this.title=P,this.details=A,this.id=Q,this.type=j},pe=function(B){X.default(x,B);var G=se(x);function x(P){var A;return H.default(this,x),A=G.call(this),ee.default(D.default(A),"method","telemetry.v1"),A.events=P,A}return x}(Qt);function ae(B){var G=encodeURIComponent(B),x=G.replace(/%([0-9A-F]{2})/g,function(P,A){return String.fromCharCode(Number("0x"+A))});return x.length}function Ze(B){var G=encodeURIComponent(B),x=G.replace(/%([0-9A-F]{2})/g,function(A,Q){return String.fromCharCode(Number("0x"+Q))}),P=new Uint8Array(x.length);return Array.prototype.forEach.call(x,function(A,Q){P[Q]=A.charCodeAt(0)}),P}function Pe(B){var G=Array.prototype.map.call(B,function(P){return String.fromCharCode(P)}).join(""),x=G.replace(/(.)/g,function(P,A){var Q=A.charCodeAt(0).toString(16).toUpperCase();return Q.length<2&&(Q="0"+Q),"%"+Q});return decodeURIComponent(x)}function ct(B){return JSON.parse(Pe(B))}function tt(B){for(var G="",x=0;x<B.length;++x){var P=String.fromCharCode(B[x]);if(G+=P,P==="\r"){x+=2;break}}var A=G.split(" ");return{size:x,protocol:A[0],version:A[1],headerSize:Number(A[2])}}var it=function(){function B(){H.default(this,B)}return F.default(B,null,[{key:"parse",value:function(x){var P=2,A=new Uint8Array(x),Q=tt(A);if(Q.protocol!=="TWILSOCK"||Q.version!=="V3.0")return Be.error("unsupported protocol: ".concat(Q.protocol," ver ").concat(Q.version)),null;var j;try{j=ct(A.subarray(Q.size,Q.size+Q.headerSize))}catch(Ye){return Be.error("failed to parse message header",Ye,x),null}Be.debug("message received: ",j.method),Be.trace("message received: ",j);var Se;if(j.payload_size>0){var we=P+Q.size+Q.headerSize,Ve=j.payload_size;if(!j.hasOwnProperty("payload_type")||j.payload_type.indexOf("application/json")===0)try{Se=ct(A.subarray(we,we+Ve))}catch(Ye){return Be.error("failed to parse message body",Ye,x),null}else j.payload_type.indexOf("text/plain")===0&&(Se=Pe(A.subarray(we,we+Ve)))}return{method:j.method,header:j,payload:Se}}},{key:"createPacket",value:function(x){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";x.payload_size=ae(P);var A=JSON.stringify(x),Q="TWILSOCK V3.0 "+ae(A);Be.debug("send request:",Q+A+P);var j=Ze(Q+`\r
`+A+`\r
`+P);return j.buffer}}]),B}();function pt(B){var G=vt();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function vt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var st=function(B){X.default(x,B);var G=pt(x);function x(P){return H.default(this,x),G.call(this,P)}return x}(fe.default(Error));function ft(B){var G=ht();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function ht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Mt=function(B){X.default(x,B);var G=ft(x);function x(P,A){var Q;return H.default(this,x),Q=G.call(this,P),Q.reply=A,Q}return x}(st);function tn(B,G){var x=Object.keys(B);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(B);G&&(P=P.filter(function(A){return Object.getOwnPropertyDescriptor(B,A).enumerable})),x.push.apply(x,P)}return x}function Un(B){for(var G=1;G<arguments.length;G++){var x=arguments[G]!=null?arguments[G]:{};G%2?tn(Object(x),!0).forEach(function(P){ee.default(B,P,x[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(x)):tn(Object(x)).forEach(function(P){Object.defineProperty(B,P,Object.getOwnPropertyDescriptor(x,P))})}return B}function St(B){var G=ri();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function ri(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Qr=function(B){X.default(x,B);var G=St(x);function x(P){var A;return H.default(this,x),A=G.call(this),ee.default(D.default(A),"newBackoff",null),ee.default(D.default(A),"usedBackoff",null),ee.default(D.default(A),"retrier",null),A.options=P?Un({},P):{},A}return F.default(x,[{key:"inProgress",get:function(){return!!this.retrier}},{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(A){this.newBackoff=A}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");if(this.newBackoff){var A=!this.usedBackoff||this.usedBackoff<this.newBackoff;if(A)this.createRetrier();else{var Q;(Q=this.retrier)===null||Q===void 0||Q.failed(new Error)}}else{var j;(j=this.retrier)===null||j===void 0||j.failed(new Error)}}},{key:"cancel",value:function(){var A;(A=this.retrier)===null||A===void 0||A.cancel()}},{key:"cleanRetrier",value:function(){var A,Q;(A=this.retrier)===null||A===void 0||A.removeAllListeners(),(Q=this.retrier)===null||Q===void 0||Q.cancel(),this.retrier=null}},{key:"getRetryPolicy",value:function(){var A=Un({},this.options);return this.newBackoff&&(A.min=this.newBackoff,A.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),A.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,A}},{key:"createRetrier",value:function(){var A=this;this.cleanRetrier();var Q=this.getRetryPolicy();this.retrier=new C.Retrier(Q),this.retrier.once("attempt",function(){var j,Se;(j=A.retrier)===null||j===void 0||j.on("attempt",function(){return A.emit("attempt")}),(Se=A.retrier)===null||Se===void 0||Se.failed(new Error("Skipping first attempt"))}),this.retrier.on("failed",function(j){return A.emit("failed",j)}),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start()}}]),x}($e);function bo(B){var G=Du();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function Du(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Fc=3e3;function wi(B){setTimeout(B,0)}var Lu=function(B){X.default(x,B);var G=bo(x);function x(P,A,Q){var j;H.default(this,x),j=G.call(this),ee.default(D.default(j),"disconnectingTimer",null),ee.default(D.default(j),"disconnectedPromiseResolve",null),ee.default(D.default(j),"terminalStates",["disconnected","rejected"]),ee.default(D.default(j),"tokenExpiredSasCode",20104),ee.default(D.default(j),"terminationReason","Connection is not initialized"),j.websocket=P,j.websocket.on("connected",function(){return j.fsm.socketConnected()}),j.websocket.on("disconnected",function(){return j.fsm.socketClosed()}),j.websocket.on("message",function(we){return j.onIncomingMessage(we)}),j.websocket.on("socketError",function(we){return j.emit("connectionError",{terminal:!1,message:"Socket error: ".concat(we.message),httpStatusCode:null,errorCode:null})}),j.transport=A,j.config=Q,j.retrier=new Qr(Q.retryPolicy),j.retrier.on("attempt",function(){return j.retry()}),j.retrier.on("failed",function(we){Be.warn("Retrying failed: ".concat(we.message)),j.disconnect()}),typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",function(){Be.debug("Browser reported connectivity state: online"),j.resetBackoff(),j.fsm.systemOnline()}),window.addEventListener("offline",function(){Be.debug("Browser reported connectivity state: offline"),j.websocket.close(),j.fsm.socketClosed()}));var Se=K.factory({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){j.setupSocket(),j.emit("connecting")},onEnterInitialising:function(){j.sendInit()},onLeaveInitialising:function(){j.cancelInit()},onEnterUpdating:function(){j.sendUpdate()},onLeaveUpdating:function(){j.cancelUpdate()},onEnterRetrying:function(){j.initRetry(),j.emit("connecting")},onEnterConnected:function(){j.resetBackoff(),j.onConnected()},onUserUpdateToken:function(){j.resetBackoff()},onTokenRejected:function(){j.resetBackoff(),j.closeSocket(!0),j.finalizeSocket()},onUserDisconnect:function(){j.closeSocket(!0)},onEnterDisconnecting:function(){j.startDisconnectTimer()},onLeaveDisconnecting:function(){j.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){j.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){j.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){j.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){j.cancelDisconnectTimer()},onDisconnected:function(){j.resetBackoff(),j.finalizeSocket()},onReceiveClose:function(){j.onCloseReceived()},onReceiveOffload:function(Ve,Ye){Be.debug("onreceiveoffload: ",Ye),j.modifyBackoff(Ye.body),j.onCloseReceived()},onUnsupported:function(){j.closeSocket(!0),j.finalizeSocket()},onError:function(Ve,Ye){j.closeSocket(Ye),j.finalizeSocket()},onEnterState:function(Ve){Ve.from!=="none"&&j.changeState(Ve)},onInvalidTransition:function(Ve,Ye,gt){Be.warn("FSM: unexpected transition",Ye,gt)}}});return j.fsm=new Se,j}return F.default(x,[{key:"changeState",value:function(A){Be.debug("FSM: ".concat(A.transition,": ").concat(A.from," --> ").concat(A.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){Be.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(A){Be.trace("modifyBackoff",A);var Q=A?A.backoff_policy:null;Q&&typeof Q.reconnect_min_ms=="number"&&this.retrier.modifyBackoff(Q.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var A=this;Be.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout(function(){Be.debug("disconnecting is timed out"),A.closeSocket(!0)},Fc)}},{key:"cancelDisconnectTimer",value:function(){Be.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"isConnected",get:function(){return this.state==="connected"&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"denied";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}},{key:"initRetry",value:function(){Be.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){this.fsm.state!="connecting"?(Be.trace("retry"),this.websocket.close(),this.fsm.userRetry()):Be.trace("can	 retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){Be.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){Be.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}},{key:"onIncomingMessage",value:function(A){var Q=it.parse(A);if(Q){var j=Q.method,Se=Q.header,we=Q.payload;if(j!=="reply"&&this.confirmReceiving(Se),j==="notification")this.emit("message",Se.message_type,we);else if(Se.method==="reply")this.transport.processReply({id:Se.id,status:Se.status,header:Se,body:we});else if(Se.method==="client_update")Se.client_update_type==="token_about_to_expire"&&this.emit("tokenAboutToExpire");else if(Se.method==="close")if(Se.status.code===308)Be.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:Se.status.status,body:we});else if(Se.status.code===406){var Ve="Server closed connection because can't parse protocol: ".concat(JSON.stringify(Se.status));this.emitReplyConnectionError(Ve,Se,!0),Be.error(Ve),this.fsm.receiveFatalClose()}else Se.status.code===417?(Be.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(Se.status))),this.fsm.receiveFatalClose(Se.status.status)):Se.status.code===410?(Be.warn("Server closed connection: ".concat(JSON.stringify(Se.status))),this.fsm.receiveClose(Se.status.status),this.emit("tokenExpired")):Se.status.code===401?(Be.error("Server closed connection: ".concat(JSON.stringify(Se.status))),this.fsm.receiveClose(Se.status.status)):(Be.warn("unexpected message: ",Se.status),this.fsm.receiveOffload({status:Se.status.status,body:null}))}}},{key:"sendInit",value:function(){var P=z.default(Z.default.mark(function Q(){var j,Se;return Z.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Be.trace("sendInit"),Ve.prev=1,this.emit("beforeSendInit"),Ve.next=5,this.transport.sendInit();case 5:j=Ve.sent,this.config.updateContinuationToken(j.continuationToken),this.config.confirmedCapabilities=j.confirmedCapabilities,this.fsm.initSuccess(j),this.emit("initialized",j),this.emit("tokenUpdated"),Ve.next=17;break;case 13:Ve.prev=13,Ve.t0=Ve.catch(1),Ve.t0 instanceof Mt?(Se=!1,Be.warn("Init rejected by server: ".concat(JSON.stringify(Ve.t0.reply.status))),this.emit("sendInitFailed"),Ve.t0.reply.status.code===401||Ve.t0.reply.status.code===403?(Se=!0,this.fsm.tokenRejected(Ve.t0.reply.status),Ve.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):Ve.t0.reply.status.code===429?(this.modifyBackoff(Ve.t0.reply.body),this.fsm.initError(!0)):Ve.t0.reply.status.code===500?this.fsm.initError(!1):this.fsm.initError(!0),this.emitReplyConnectionError(Ve.t0.message,Ve.t0.reply,Se)):(this.terminationReason=Ve.t0.message,this.emit("connectionError",{terminal:!0,message:"Unknown error during connection initialisation: ".concat(Ve.t0.message,`
`).concat(JSON.stringify(Ve.t0,null,2)),httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",Ve.t0);case 17:case"end":return Ve.stop()}},Q,this,[[1,13]])}));function A(){return P.apply(this,arguments)}return A}()},{key:"sendUpdate",value:function(){var P=z.default(Z.default.mark(function Q(){var j,Se,we;return Z.default.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:return Be.trace("sendUpdate"),j=new hn(this.config.token),Ye.prev=2,Ye.next=5,this.transport.sendWithReply(j);case 5:Se=Ye.sent,this.fsm.updateSuccess(Se.body),this.emit("tokenUpdated"),Ye.next=14;break;case 10:Ye.prev=10,Ye.t0=Ye.catch(2),Ye.t0 instanceof Mt?(we=!1,Be.warn("Token update rejected by server: ".concat(JSON.stringify(Ye.t0.reply.status))),Ye.t0.reply.status.code===401||Ye.t0.reply.status.code===403?(we=!0,this.fsm.tokenRejected(Ye.t0.reply.status),Ye.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):Ye.t0.reply.status.code===429?(this.modifyBackoff(Ye.t0.reply.body),this.fsm.updateError(Ye.t0.reply.status)):this.fsm.updateError(Ye.t0.reply.status),this.emitReplyConnectionError(Ye.t0.message,Ye.t0.reply,we)):(this.emit("error",!1,Ye.t0.message,null,null),this.fsm.updateError(Ye.t0)),this.emit("tokenUpdated",Ye.t0);case 14:case"end":return Ye.stop()}},Q,this,[[2,10]])}));function A(){return P.apply(this,arguments)}return A}()},{key:"emitReplyConnectionError",value:function(A,Q,j){var Se=Q.status&&Q.status.description?Q.status.description:A,we=Q.status.code,Ve=Q.status&&Q.status.errorCode?Q.status.errorCode:null;j&&(this.terminationReason=Se),this.emit("connectionError",{terminal:j,message:"Connection error: ".concat(Se),httpStatusCode:we,errorCode:Ve})}},{key:"cancelInit",value:function(){Be.trace("cancelInit")}},{key:"cancelUpdate",value:function(){Be.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(A){Be.trace("confirmReceiving");try{this.transport.send(new ye(A.id))}catch(Q){Be.debug("failed to confirm packet receiving",Q)}}},{key:"closeSocket",value:function(A){var Q=this;Be.trace("closeSocket (graceful: ".concat(A,")")),A&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),wi(function(){return Q.fsm.socketClosed()})}},{key:"connect",value:function(){Be.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var A=this;return Be.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise(function(Q){A.disconnectedPromiseResolve=Q,A.fsm.userDisconnect()})}},{key:"updateToken",value:function(A){var Q=this;return Be.trace("updateToken:",A),new Promise(function(j,Se){Q.once("tokenUpdated",function(we){we?Se(we):j()}),Q.fsm.userUpdateToken()})}},{key:"isTerminalState",get:function(){return this.terminalStates.indexOf(this.fsm.state)!==-1}},{key:"getTerminationReason",get:function(){return this.terminationReason}},{key:"onCloseReceived",value:function(){this.websocket.close()}}]),x}($e),$c=function(){function B(){H.default(this,B)}return F.default(B,null,[{key:"getMetadata",value:function(x){var P,A,Q,j,Se,we,Ve,Ye,gt=x&&x.clientMetadata?x.clientMetadata:{},xt=["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"],oi={env:(P=Te.name)!==null&&P!==void 0?P:"unknown",envv:(A=Te.version)!==null&&A!==void 0?A:"unknown",os:(Q=(j=Te.os)===null||j===void 0?void 0:j.family)!==null&&Q!==void 0?Q:"unknown",osv:(Se=(we=Te.os)===null||we===void 0?void 0:we.version)!==null&&Se!==void 0?Se:"unknown",osa:(Ve=(Ye=Te.os)===null||Ye===void 0?void 0:Ye.architecture)!==null&&Ve!==void 0?Ve:"unknown",sdk:"js-default"},Yr={};return xt.filter(function(Si){return Si in gt||Si in oi}).forEach(function(Si){return Yr[Si]=Si in gt?gt[Si]:oi[Si]}),Yr}}]),B}(),zc=3e4;function mn(B){return B>=200&&B<300}function Wc(B){switch(te.default(B)){case"undefined":return"";case"object":return JSON.stringify(B);default:return B}}var Ua=function(){function B(G,x){var P=this;H.default(this,B),this.config=x,this.activeRequests=new Map,this.channel=G,this.channel.on("reply",function(A){return P.processReply(A)}),this.channel.on("disconnected",function(){P.activeRequests.forEach(function(A){clearTimeout(A.timeout),A.reject(new st("disconnected"))}),P.activeRequests.clear()})}return F.default(B,[{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"processReply",value:function(x){var P=this.activeRequests.get(x.id);P&&(clearTimeout(P.timeout),this.activeRequests.delete(x.id),mn(x.status.code)?P.resolve(x):(P.reject(new Mt("Transport failure: "+x.status.status,x)),Be.trace("message rejected")))}},{key:"storeRequest",value:function(x,P,A){var Q={resolve:P,reject:A,timeout:setTimeout(function(){Be.trace("request",x,"is timed out"),A(new st("Twilsock: request timeout: "+x))},zc)};this.activeRequests.set(x,Q)}},{key:"shutdown",value:function(){this.activeRequests.forEach(function(x){clearTimeout(x.timeout),x.reject(new st("Twilsock: request cancelled by user"))}),this.activeRequests.clear()}},{key:"sendInit",value:function(){var G=z.default(Z.default.mark(function P(){var A,Q,j;return Z.default.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return Be.trace("sendInit"),A=$c.getMetadata(this.config),Q=new kt(this.config.token,this.config.continuationToken,A,this.config.initRegistrations,this.config.tweaks),we.next=5,this.sendWithReply(Q);case 5:return j=we.sent,we.abrupt("return",new Xr(j.id,j.header.continuation_token,new Set(j.header.capabilities),j.header.continuation_token_status,j.header.offline_storage,j.header.init_registrations,j.header.debug_info));case 7:case"end":return we.stop()}},P,this)}));function x(){return G.apply(this,arguments)}return x}()},{key:"sendClose",value:function(){var x=new De;this.send(x)}},{key:"sendWithReply",value:function(x,P){var A=this;return new Promise(function(Q,j){var Se=A.send(x,P);A.storeRequest(Se,Q,j)})}},{key:"send",value:function(x,P){x.id=x.id||"TM".concat(k.v4());var A=it.createPacket(x,Wc(P));try{return this.channel.send(A),x.id}catch(Q){throw Be.debug("failed to send ",x,Q),Be.trace(Q.stack),Q}}}]),B}();function Ur(B){var G=Bc();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function Bc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ni=function(B){X.default(x,B);var G=Ur(x);function x(P){var A;return H.default(this,x),A=G.call(this),ee.default(D.default(A),"socket",null),A.url=P,A.url=P,A.WebSocket=r.WebSocket||r.MozWebSocket||{},A}return F.default(x,[{key:"isConnected",get:function(){return!!this.socket&&this.socket.readyState===1}},{key:"connect",value:function(){var A=this;Be.trace("connecting to socket");var Q;try{Q=new this.WebSocket(this.url)}catch(j){Be.debug("Socket error: ".concat(this.url)),this.emit("socketError",j);return}Q.binaryType="arraybuffer",Q.onopen=function(){Be.debug("socket opened ".concat(A.url)),A.emit("connected")},Q.onclose=function(j){Be.debug("socket closed",j),A.emit("disconnected",j)},Q.onerror=function(j){Be.debug("Socket error:",j),A.emit("socketError",j)},Q.onmessage=function(j){A.emit("message",j.data)},this.socket=Q}},{key:"send",value:function(A){return this.socket&&this.socket.send(A)}},{key:"close",value:function(){if(Be.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}]),x}($e);function Uu(B){var G=Zc();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function Zc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qc=function(B){X.default(x,B);var G=Uu(x);function x(P){var A;return H.default(this,x),A=G.call(this),A.transport=P,A.registrations=new Map,A.registrationsInProgress=new Map,A}return F.default(x,[{key:"putNotificationContext",value:function(){var P=z.default(Z.default.mark(function Q(j,Se){var we;return Z.default.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:return we={method:"put_notification_ctx",notification_ctx_id:j},Ye.next=3,this.transport.sendWithReply(we,Se);case 3:case"end":return Ye.stop()}},Q,this)}));function A(Q,j){return P.apply(this,arguments)}return A}()},{key:"deleteNotificationContext",value:function(){var P=z.default(Z.default.mark(function Q(j){var Se;return Z.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Se={method:"delete_notification_ctx",notification_ctx_id:j},Ve.next=3,this.transport.sendWithReply(Se);case 3:case"end":return Ve.stop()}},Q,this)}));function A(Q){return P.apply(this,arguments)}return A}()},{key:"updateRegistration",value:function(){var P=z.default(Z.default.mark(function Q(j,Se){var we,Ve;return Z.default.wrap(function(gt){for(;;)switch(gt.prev=gt.next){case 0:return Be.debug("update registration for context",j),we=this.registrationsInProgress.get(j),we||(we=new Set,this.registrationsInProgress.set(j,we)),Ve=k.v4(),we.add(Ve),gt.prev=5,gt.next=8,this.putNotificationContext(j,Se);case 8:Be.debug("registration attempt succeeded for context",Se),we.delete(Ve),we.size===0&&(this.registrationsInProgress.delete(j),this.emit("registered",j)),gt.next=19;break;case 13:gt.prev=13,gt.t0=gt.catch(5),Be.warn("registration attempt failed for context",Se),Be.debug(gt.t0),we.delete(Ve),we.size===0&&(this.registrationsInProgress.delete(j),this.emit("registrationFailed",j,gt.t0));case 19:case"end":return gt.stop()}},Q,this,[[5,13]])}));function A(Q,j){return P.apply(this,arguments)}return A}()},{key:"updateRegistrations",value:function(){var P=z.default(Z.default.mark(function Q(){var j=this,Se;return Z.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Be.trace("refreshing ".concat(this.registrations.size," registrations")),Se=[],this.registrations.forEach(function(Ye,gt){Se.push(j.updateRegistration(gt,Ye))}),Ve.next=5,Promise.all(Se);case 5:case"end":return Ve.stop()}},Q,this)}));function A(){return P.apply(this,arguments)}return A}()},{key:"setNotificationsContext",value:function(){var P=z.default(Z.default.mark(function Q(j,Se){return Z.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:if(!(!j||!Se)){Ve.next=2;break}throw new st("Invalid arguments provided");case 2:return this.registrations.set(j,Se),Ve.next=5,this.updateRegistration(j,Se);case 5:return Ve.abrupt("return",Ve.sent);case 6:case"end":return Ve.stop()}},Q,this)}));function A(Q,j){return P.apply(this,arguments)}return A}()},{key:"removeNotificationsContext",value:function(){var P=z.default(Z.default.mark(function Q(j){return Z.default.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(this.registrations.has(j)){we.next=2;break}return we.abrupt("return");case 2:return we.next=4,this.deleteNotificationContext(j);case 4:this.transport.isConnected&&this.registrations.delete(j);case 5:case"end":return we.stop()}},Q,this)}));function A(Q){return P.apply(this,arguments)}return A}()}]),x}($e);function ki(B){var G=ir();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function ir(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Qc=function(B){X.default(x,B);var G=ki(x);function x(P,A,Q){var j;return H.default(this,x),j=G.call(this,A),j.status=P,j.description=A,j.body=Q,j}return x}(st);function _o(B){var G=Yc();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function Yc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ii=function(B){X.default(x,B);var G=_o(x);function x(P){return H.default(this,x),G.call(this,P)}return x}(st),vs=2e4;function ju(B){return B>=200&&B<300}function Gc(B){return B&&B.header&&B.header.http_status}function Hc(B){var G=B.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(G){var x={protocol:G[1],host:G[2],hostname:G[3],port:G[4],pathname:G[5],search:G[6],hash:G[7],params:{}};if(x.search.length>0){var P=x.search.substring(1);x.params=P.split("&").map(function(A){return A.split("=")}).reduce(function(A,Q){return A.hasOwnProperty(Q[0])?Array.isArray(A[Q[0]])?A[Q[0]].push(Q[1]):A[Q[0]]=[A[Q[0]],Q[1]]:A[Q[0]]=Q[1],A},{})}return x}throw new st("Incorrect URI: "+B)}function rn(B,G){var x=Hc(G),P={method:B,host:x.host,path:x.pathname};return x.params&&(P.params=x.params),P}function Jc(B,G,x,P,A){return{to:rn(B,G),headers:x,body:P,grant:A}}var Vu=function(){function B(G,x,P){H.default(this,B),this.config=P,this.transport=G,this.pendingMessages=[],this.twilsock=x}return F.default(B,[{key:"saveMessage",value:function(x){var P=this;return new Promise(function(A,Q){var j={message:x,resolve:A,reject:Q,alreadyRejected:!1,timeout:setTimeout(function(){Be.debug("request is timed out"),Q(new st("request '".concat(x.to.method,"' to '").concat(x.to.host,"' timed out"))),j.alreadyRejected=!0},vs)};P.pendingMessages.push(j)})}},{key:"sendPendingMessages",value:function(){for(var x=this,P=function(){var j=x.pendingMessages[0];if(!j.alreadyRejected)try{var Se=j.message;x.actualSend(Se).then(function(we){return j.resolve(we)}).catch(function(we){return j.reject(we)}),clearTimeout(j.timeout)}catch(we){return Be.debug("Failed to send pending message",we),"break"}x.pendingMessages.splice(0,1)};this.pendingMessages.length>0;){var A=P();if(A==="break")break}}},{key:"rejectPendingMessages",value:function(){var x=this;this.pendingMessages.forEach(function(P){P.reject(new ii("Unable to connect: "+x.twilsock.getTerminationReason)),P.alreadyRejected=!0,clearTimeout(P.timeout)}),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:function(){var G=z.default(Z.default.mark(function P(A){var Q,j,Se,we,Ve,Ye,gt,xt;return Z.default.wrap(function(Yr){for(;;)switch(Yr.prev=Yr.next){case 0:return j=A.to,Se=A.headers,we=A.body,Ve=(Q=A.grant)!==null&&Q!==void 0?Q:this.config.activeGrant,Ye={host:j.host,path:j.path,method:j.method,params:j.params,headers:Se},gt=new Re(Ve,Se["Content-Type"]||"application/json",Ye),Be.trace("Sending upstream message",gt),Yr.next=9,this.transport.sendWithReply(gt,we);case 9:if(xt=Yr.sent,Be.trace("Received upstream message response",xt),!(Gc(xt)&&!ju(xt.header.http_status.code))){Yr.next=13;break}throw new Qc(xt.header.http_status.code,xt.header.http_status.status,xt.body);case 13:return Yr.abrupt("return",{status:xt.header.http_status,headers:xt.header.http_headers,body:xt.body});case 14:case"end":return Yr.stop()}},P,this)}));function x(P){return G.apply(this,arguments)}return x}()},{key:"send",value:function(x,P){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Q=arguments.length>3?arguments[3]:void 0,j=arguments.length>4?arguments[4]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new ii("Unable to connect: "+this.twilsock.getTerminationReason));var Se=Jc(x,P,A,Q,j);return this.twilsock.isConnected?this.actualSend(Se):this.saveMessage(Se)}}]),B}(),Xc=function(){function B(){var G=this;H.default(this,B),this._promise=new Promise(function(x,P){G._resolve=x,G._reject=P})}return F.default(B,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(x){this._resolve(x)}},{key:"set",value:function(x){this._resolve(x)}},{key:"fail",value:function(x){this._reject(x)}}]),B}(),Kc=function(){function B(G){H.default(this,B),this.id=G}return F.default(B,null,[{key:"create",value:function(x){if(x instanceof Object&&"storage_id"in x)return new B(x.storage_id);throw new st('Field "storage_id" is missing')}}]),B}(),Gi=function(){function B(){return H.default(this,B),ee.default(this,"initializedFlag","twilio_twilsock_token_storage"),ee.default(this,"tokenStoragePrefix","twilio_continuation_token_"),B._instance||(this.initialize(),B._instance=this),B._instance}return F.default(B,[{key:"sessionStorage",value:function(){try{return r.sessionStorage}catch{return null}}},{key:"window",value:function(){try{return r.window}catch{return null}}},{key:"storeToken",value:function(x,P){this.canStore()&&this.sessionStorage.setItem(this.getKeyName(P),x)}},{key:"getStoredToken",value:function(x){return this.canStore()?this.sessionStorage.getItem(this.getKeyName(x)):null}},{key:"initialize",value:function(){var x=this;if(this.canStore()){var P=this.sessionStorage.getItem(this.initializedFlag);P&&this.clear(),this.sessionStorage.setItem(this.initializedFlag,"true");var A=this.sessionStorage.removeItem;this.window.addEventListener("unload",function(){A(x.initializedFlag)})}}},{key:"clear",value:function(){if(this.canStore()){for(var x=[],P=0;P<this.sessionStorage.length;P++){var A=this.sessionStorage.key(P);A&&A.indexOf(this.tokenStoragePrefix)===0&&x.push(A)}var Q=this.sessionStorage.removeItem;x.forEach(function(j){return Q(j)}),Q(this.initializedFlag)}}},{key:"getKeyName",value:function(x){return"".concat(this.tokenStoragePrefix).concat(x)}},{key:"canStore",value:function(){return!!(this.sessionStorage&&this.sessionStorage.length&&this.window)}}]),B}();ee.default(Gi,"_instance",null);var ja=new Gi,jr=function(){function B(G,x,P,A,Q,j){H.default(this,B),this.title=G,this.details=x,this.start=P,this.type=Q,this.id=j,this.end=A}return F.default(B,[{key:"toTelemetryEvent",value:function(){var x=new Date,P=this.start,A=this.end?this.end:x;if(A<P){var Q=A;A=P,P=Q}var j=P.getTime()-x.getTime(),Se=A.getTime()-x.getTime(),we=new oe(j,Se,this.title,this.details,this.id,this.type);return we}}]),B}();t.TelemetryPoint=void 0,function(B){B[B.Start=0]="Start",B[B.End=1]="End"}(t.TelemetryPoint||(t.TelemetryPoint={})),t.EventSendingLimitation=void 0,function(B){B[B.MinEventsPortion=0]="MinEventsPortion",B[B.AnyEvents=1]="AnyEvents",B[B.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished"}(t.EventSendingLimitation||(t.EventSendingLimitation={}));var wo=function(){function B(G,x){H.default(this,B),ee.default(this,"minEventsPortionToSend",50),ee.default(this,"maxEventsPortionToSend",100),ee.default(this,"pendingEvents",new Map),ee.default(this,"readyEvents",[]),ee.default(this,"hasInitializationFinished",!1),ee.default(this,"_canSendTelemetry",!1),this.config=G,this.packetInterface=x}return F.default(B,[{key:"isTelemetryEnabled",get:function(){return this.config.confirmedCapabilities.has("telemetry.v1")}},{key:"canSendTelemetry",get:function(){return this._canSendTelemetry&&this.isTelemetryEnabled},set:function(x){Be.debug("TelemetryTracker.canSendTelemetry: ".concat(x," TelemetryTracker.isTelemetryEnabled: ").concat(this.isTelemetryEnabled)),this._canSendTelemetry&&!x&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=x,x&&this.sendTelemetry(t.EventSendingLimitation.AnyEvents),x&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}},{key:"addTelemetryEvent",value:function(x){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(x)}},{key:"addPartialEvent",value:function(x,P,A){Be.debug("Adding ".concat(A===t.TelemetryPoint.Start?"starting":"ending"," timepoint for '").concat(P,"' event"));var Q=this.pendingEvents.has(P);if(A===t.TelemetryPoint.Start)Q&&Be.debug("Overwriting starting point for '".concat(P,"' event")),this.pendingEvents.set(P,x);else{if(!Q){Be.info("Could not find started event for '".concat(P,"' event"));return}this.addTelemetryEvent(this.merge(this.pendingEvents.get(P),x)),this.pendingEvents.delete(P)}}},{key:"getTelemetryToSend",value:function(x){return!this.canSendTelemetry||this.readyEvents.length==0?[]:x==t.EventSendingLimitation.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(x==t.EventSendingLimitation.AnyEventsIncludingUnfinished)}},{key:"getTelemetryPortion",value:function(x){var P=this,A=Math.min(this.readyEvents.length,this.maxEventsPortionToSend),Q=this.readyEvents.splice(0,A);return x&&Q.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach(function(j,Se){if(!(Q.length>=P.maxEventsPortionToSend)){var we=P.pendingEvents.get(Se);P.pendingEvents.delete(Se),Q.push(new jr("[UNFINISHED] ".concat(we.title),we.details,we.start,null,we.type,we.id))}}),Q}},{key:"merge",value:function(x,P){return new jr(P.title?P.title:x.title,P.details?P.details:x.details,x.start,P.end,P.type?P.type:x.type,P.id?P.id:x.id)}},{key:"sendTelemetryIfMinimalPortionCollected",value:function(){this.sendTelemetry(t.EventSendingLimitation.MinEventsPortion)}},{key:"sendTelemetry",value:function(x){var P=this.getTelemetryToSend(x);if(P.length!==0)try{this.packetInterface.send(new pe(P.map(function(A){return A.toTelemetryEvent()})))}catch(A){Be.debug("Error while sending ".concat(P.length," telemetry events due to ").concat(A,"; they will be resubmitted")),this.readyEvents=this.readyEvents.concat(P)}}}]),B}();function Fu(B){var G=ai();return function(){var P=de.default(B),A;if(G){var Q=de.default(this).constructor;A=Reflect.construct(P,arguments,Q)}else A=P.apply(this,arguments);return me.default(this,A)}}function ai(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ti=function B(){H.default(this,B)};ee.default(Ti,"TWILSOCK_CONNECT","twilsock.sdk.connect"),ee.default(Ti,"TWILSOCK_INIT","twilsock.sdk.init"),t.TwilsockClient=function(B){X.default(x,B);var G=Fu(x);function x(P,A,Q){var j;H.default(this,x),j=G.call(this),ee.default(D.default(j),"version",Dn),ee.default(D.default(j),"offlineStorageDeferred",new Xc),Q.continuationToken=Q.continuationToken?Q.continuationToken:ja.getStoredToken(A);var Se=j.config=new _i(P,A,Q);Be.setLevel(Se.logLevel);var we=new ni(Se.url),Ve=new Ua(we,Se);return j.channel=new Lu(we,Ve,Se),j.registrations=new qc(Ve),j.upstream=new Vu(Ve,j.channel,Se),j.telemetryTracker=new wo(Se,Ve),j.channel.on("initialized",function(){return j.telemetryTracker.canSendTelemetry=!0}),we.on("disconnected",function(){return j.telemetryTracker.canSendTelemetry=!1}),j.registrations.on("registered",function(Ye){return j.emit("registered",Ye)}),j.channel.on("message",function(Ye,gt){return setTimeout(function(){return j.emit("message",Ye,gt)},0)}),j.channel.on("stateChanged",function(Ye){return setTimeout(function(){return j.emit("stateChanged",Ye)},0)}),j.channel.on("connectionError",function(Ye){return setTimeout(function(){return j.emit("connectionError",Ye)},0)}),j.channel.on("tokenAboutToExpire",function(){return setTimeout(function(){return j.emit("tokenAboutToExpire")},0)}),j.channel.on("tokenExpired",function(){return setTimeout(function(){return j.emit("tokenExpired")},0)}),j.channel.on("connected",function(){return j.registrations.updateRegistrations()}),j.channel.on("connected",function(){return j.upstream.sendPendingMessages()}),j.channel.on("connected",function(){return setTimeout(function(){return j.emit("connected")},0)}),j.channel.on("beforeConnect",function(){return j.telemetryTracker.addPartialEvent(new jr("Establish WebSocket connection","",new Date),Ti.TWILSOCK_CONNECT,t.TelemetryPoint.Start)}),j.channel.on("connected",function(){return j.telemetryTracker.addPartialEvent(new jr("Establish WebSocket connection","",new Date,new Date),Ti.TWILSOCK_CONNECT,t.TelemetryPoint.End)}),j.channel.on("beforeSendInit",function(){return j.telemetryTracker.addPartialEvent(new jr("Send Twilsock init","",new Date),Ti.TWILSOCK_INIT,t.TelemetryPoint.Start)}),j.channel.on("initialized",function(){return j.telemetryTracker.addPartialEvent(new jr("Send Twilsock init","Succeeded",new Date,new Date),Ti.TWILSOCK_INIT,t.TelemetryPoint.End)}),j.channel.on("sendInitFailed",function(){return j.telemetryTracker.addPartialEvent(new jr("Send Twilsock init","Failed",new Date,new Date),Ti.TWILSOCK_INIT,t.TelemetryPoint.End)}),j.channel.on("initialized",function(Ye){j.handleStorageId(A,Ye),ja.storeToken(Ye.continuationToken,A),setTimeout(function(){return j.emit("initialized",Ye)},0)}),j.channel.on("disconnected",function(){return setTimeout(function(){return j.emit("disconnected")},0)}),j.channel.on("disconnected",function(){return j.upstream.rejectPendingMessages()}),j.channel.on("disconnected",function(){return j.offlineStorageDeferred.fail(new st("Client disconnected"))}),j.offlineStorageDeferred.promise.catch(function(){}),j}return F.default(x,[{key:"emit",value:function(A){for(var Q,j=arguments.length,Se=new Array(j>1?j-1:0),we=1;we<j;we++)Se[we-1]=arguments[we];return Be.debug("Emitting ".concat(A.toString(),"(").concat(Se.map(function(Ve){return JSON.stringify(Ve)}).join(", "),")")),(Q=W.default(de.default(x.prototype),"emit",this)).call.apply(Q,[this,A].concat(Se))}},{key:"handleStorageId",value:function(A,Q){if(!Q.offlineStorage)this.offlineStorageDeferred.fail(new st("No offline storage id"));else if(Q.offlineStorage.hasOwnProperty(A))try{this.offlineStorageDeferred.set(Kc.create(Q.offlineStorage[A])),Be.debug("Offline storage for '".concat(A,"' product: ").concat(JSON.stringify(Q.offlineStorage[A]),"."))}catch(j){this.offlineStorageDeferred.fail(new st("Failed to parse offline storage for ".concat(A," ").concat(JSON.stringify(Q.offlineStorage[A]),". ").concat(j,".")))}else this.offlineStorageDeferred.fail(new st("No offline storage id for '".concat(A,"' product: ").concat(JSON.stringify(Q.offlineStorage))))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}},{key:"updateToken",value:function(){var P=z.default(Z.default.mark(function Q(j){return Z.default.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(Be.trace("updating token '".concat(j,"'")),this.config.token!==j){we.next=3;break}return we.abrupt("return");case 3:return this.config.updateToken(j),we.next=6,this.channel.updateToken(j);case 6:return we.abrupt("return",we.sent);case 7:case"end":return we.stop()}},Q,this)}));function A(Q){return P.apply(this,arguments)}return A}()},{key:"setNotificationsContext",value:function(){var P=z.default(Z.default.mark(function Q(j,Se){return Z.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Ve.next=2,this.registrations.setNotificationsContext(j,Se);case 2:case"end":return Ve.stop()}},Q,this)}));function A(Q,j){return P.apply(this,arguments)}return A}()},{key:"removeNotificationsContext",value:function(){var P=z.default(Z.default.mark(function Q(j){return Z.default.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return we.next=2,this.registrations.removeNotificationsContext(j);case 2:case"end":return we.stop()}},Q,this)}));function A(Q){return P.apply(this,arguments)}return A}()},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:function(){var P=z.default(Z.default.mark(function Q(){return Z.default.wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEventsIncludingUnfinished),Se.next=3,this.channel.disconnect();case 3:return Se.abrupt("return",Se.sent);case 4:case"end":return Se.stop()}},Q,this)}));function A(){return P.apply(this,arguments)}return A}()},{key:"get",value:function(){var P=z.default(Z.default.mark(function Q(j,Se,we){return Z.default.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),Ye.next=3,this.upstream.send("GET",j,Se,void 0,we);case 3:return Ye.abrupt("return",Ye.sent);case 4:case"end":return Ye.stop()}},Q,this)}));function A(Q,j,Se){return P.apply(this,arguments)}return A}()},{key:"post",value:function(){var P=z.default(Z.default.mark(function Q(j,Se,we,Ve){return Z.default.wrap(function(gt){for(;;)switch(gt.prev=gt.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),gt.next=3,this.upstream.send("POST",j,Se,we,Ve);case 3:return gt.abrupt("return",gt.sent);case 4:case"end":return gt.stop()}},Q,this)}));function A(Q,j,Se,we){return P.apply(this,arguments)}return A}()},{key:"put",value:function(){var P=z.default(Z.default.mark(function Q(j,Se,we,Ve){return Z.default.wrap(function(gt){for(;;)switch(gt.prev=gt.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),gt.next=3,this.upstream.send("PUT",j,Se,we,Ve);case 3:return gt.abrupt("return",gt.sent);case 4:case"end":return gt.stop()}},Q,this)}));function A(Q,j,Se,we){return P.apply(this,arguments)}return A}()},{key:"delete",value:function(){var P=z.default(Z.default.mark(function Q(j,Se,we,Ve){return Z.default.wrap(function(gt){for(;;)switch(gt.prev=gt.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),gt.next=3,this.upstream.send("DELETE",j,Se,we,Ve);case 3:return gt.abrupt("return",gt.sent);case 4:case"end":return gt.stop()}},Q,this)}));function A(Q,j,Se,we){return P.apply(this,arguments)}return A}()},{key:"addTelemetryEvent",value:function(A){this.telemetryTracker.addTelemetryEvent(A),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}},{key:"addPartialTelemetryEvent",value:function(A,Q,j){this.telemetryTracker.addPartialEvent(A,Q,j),j===t.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}]),x}($e),t.TwilsockClient=$([v.validateConstructorTypes(v.nonEmptyString,v.nonEmptyString,[v.pureObject,"undefined",v.literal(null)]),We("design:paramtypes",[String,String,Object])],t.TwilsockClient);var ef=function(){function B(G){H.default(this,B),this.product=G,this.type="ers",this.notification_protocol_version=0,this.message_types=[]}return F.default(B,[{key:"populateInitRegistrations",value:function(x){var P=new Set(this.message_types);for(var A in x)P.add(x[A]);this.message_types=Array.from(P)}}]),B}();t.InitRegistration=ef,t.TelemetryEventDescription=jr,t.TelemetryTracker=wo,t.TransportUnavailableError=ii,t.Twilsock=t.TwilsockClient,t.TwilsockError=st})(kp);var O3={},N3=wr,cye=Dt,fye=dr,dye=Ot,__=Al,pye=Il,vye=kl,hye=en,mye=Tl,_u=Object.assign,A3=Object.defineProperty,gye=cye([].concat),P3=!_u||dye(function(){if(N3&&_u({b:1},_u(A3({},"a",{enumerable:!0,get:function(){A3(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var t={},r={},e=Symbol(),n="abcdefghijklmnopqrst";return t[e]=7,n.split("").forEach(function(i){r[i]=i}),_u({},t)[e]!=7||__(_u({},r)).join("")!=n})?function(r,e){for(var n=hye(r),i=arguments.length,a=1,o=pye.f,s=vye.f;i>a;)for(var u=mye(arguments[a++]),l=o?gye(__(u),o(u)):__(u),c=l.length,f=0,d;c>f;)d=l[f++],(!N3||fye(s,u,d))&&(n[d]=u[d]);return n}:_u,yye=Lt,x3=P3;yye({target:"Object",stat:!0,arity:2,forced:Object.assign!==x3},{assign:x3});var qp={},D3={get exports(){return qp},set exports(t){qp=t}},L3=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(L3){var U3=new Uint8Array(16);D3.exports=function(){return L3(U3),U3}}else{var j3=new Array(16);D3.exports=function(){for(var r=0,e;r<16;r++)r&3||(e=Math.random()*4294967296),j3[r]=e>>>((r&3)<<3)&255;return j3}}for(var V3=[],Qp=0;Qp<256;++Qp)V3[Qp]=(Qp+256).toString(16).substr(1);function bye(t,r){var e=r||0,n=V3;return[n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]]].join("")}var F3=bye,_ye=qp,wye=F3,$3,w_,k_=0,T_=0;function kye(t,r,e){var n=r&&e||0,i=r||[];t=t||{};var a=t.node||$3,o=t.clockseq!==void 0?t.clockseq:w_;if(a==null||o==null){var s=_ye();a==null&&(a=$3=[s[0]|1,s[1],s[2],s[3],s[4],s[5]]),o==null&&(o=w_=(s[6]<<8|s[7])&16383)}var u=t.msecs!==void 0?t.msecs:new Date().getTime(),l=t.nsecs!==void 0?t.nsecs:T_+1,c=u-k_+(l-T_)/1e4;if(c<0&&t.clockseq===void 0&&(o=o+1&16383),(c<0||u>k_)&&t.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");k_=u,T_=l,w_=o,u+=122192928e5;var f=((u&268435455)*1e4+l)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=f&255;var d=u/4294967296*1e4&268435455;i[n++]=d>>>8&255,i[n++]=d&255,i[n++]=d>>>24&15|16,i[n++]=d>>>16&255,i[n++]=o>>>8|128,i[n++]=o&255;for(var v=0;v<6;++v)i[n+v]=a[v];return r||wye(i)}var Tye=kye,Sye=qp,Eye=F3;function Mye(t,r,e){var n=r&&e||0;typeof t=="string"&&(r=t==="binary"?new Array(16):null,t=null),t=t||{};var i=t.random||(t.rng||Sye)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,r)for(var a=0;a<16;++a)r[n+a]=i[a];return r||Eye(i)}var Cye=Mye,Rye=Tye,z3=Cye,S_=z3;S_.v1=Rye,S_.v4=z3;var Iye=S_;/*
  @license
  The MIT License (MIT)

  Copyright (c) 2016 Twilio Inc.

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all
  copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.

  */(function(t){Object.defineProperty(t,"__esModule",{value:!0});var r=Bo,e=qn,n=ji,i=Bn,a=Zn,o=wn,s=Yl,u=_n,l=kp,c=ha,f=ma,d=Ta,v=eo,p=to,y=Ho,k=Iye,I=Zr;function C(Re){return Re&&typeof Re=="object"&&"default"in Re?Re:{default:Re}}function L(Re){if(Re&&Re.__esModule)return Re;var Ie=Object.create(null);return Re&&Object.keys(Re).forEach(function(he){if(he!=="default"){var ye=Object.getOwnPropertyDescriptor(Re,he);Object.defineProperty(Ie,he,ye.get?ye:{enumerable:!0,get:function(){return Re[he]}})}}),Ie.default=Re,Object.freeze(Ie)}var R=C(r),q=C(e),z=C(n),F=C(i),D=C(a),W=C(o),X=C(s),me=C(u),de=C(c),H=C(f),ee=C(v),Z=C(p),te=L(y),re=L(k);function K(Re,Ie,he,ye){var ge=arguments.length,Ae=ge<3?Ie:ye===null?ye=Object.getOwnPropertyDescriptor(Ie,he):ye,De;if((typeof Reflect>"u"?"undefined":me.default(Reflect))==="object"&&typeof Reflect.decorate=="function")Ae=Reflect.decorate(Re,Ie,he,ye);else for(var se=Re.length-1;se>=0;se--)(De=Re[se])&&(Ae=(ge<3?De(Ae):ge>3?De(Ie,he,Ae):De(Ie,he))||Ae);return ge>3&&Ae&&Object.defineProperty(Ie,he,Ae),Ae}function fe(Re,Ie){if((typeof Reflect>"u"?"undefined":me.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Re,Ie)}var Te;function $(){}$.prototype=Object.create(null);function We(){We.init.call(this)}We.EventEmitter=We,We.usingDomains=!1,We.prototype.domain=void 0,We.prototype._events=void 0,We.prototype._maxListeners=void 0,We.defaultMaxListeners=10,We.init=function(){this.domain=null,We.usingDomains&&Te.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new $,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},We.prototype.setMaxListeners=function(Ie){if(typeof Ie!="number"||Ie<0||isNaN(Ie))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=Ie,this};function et(Re){return Re._maxListeners===void 0?We.defaultMaxListeners:Re._maxListeners}We.prototype.getMaxListeners=function(){return et(this)};function dt(Re,Ie,he){if(Ie)Re.call(he);else for(var ye=Re.length,ge=Oe(Re,ye),Ae=0;Ae<ye;++Ae)ge[Ae].call(he)}function $e(Re,Ie,he,ye){if(Ie)Re.call(he,ye);else for(var ge=Re.length,Ae=Oe(Re,ge),De=0;De<ge;++De)Ae[De].call(he,ye)}function ue(Re,Ie,he,ye,ge){if(Ie)Re.call(he,ye,ge);else for(var Ae=Re.length,De=Oe(Re,Ae),se=0;se<Ae;++se)De[se].call(he,ye,ge)}function Rr(Re,Ie,he,ye,ge,Ae){if(Ie)Re.call(he,ye,ge,Ae);else for(var De=Re.length,se=Oe(Re,De),be=0;be<De;++be)se[be].call(he,ye,ge,Ae)}function Ue(Re,Ie,he,ye){if(Ie)Re.apply(he,ye);else for(var ge=Re.length,Ae=Oe(Re,ge),De=0;De<ge;++De)Ae[De].apply(he,ye)}We.prototype.emit=function(Ie){var he,ye,ge,Ae,De,se,be,oe=Ie==="error";if(se=this._events,se)oe=oe&&se.error==null;else if(!oe)return!1;if(be=this.domain,oe){if(he=arguments[1],be)he||(he=new Error('Uncaught, unspecified "error" event')),he.domainEmitter=this,he.domain=be,he.domainThrown=!1,be.emit("error",he);else{if(he instanceof Error)throw he;var pe=new Error('Uncaught, unspecified "error" event. ('+he+")");throw pe.context=he,pe}return!1}if(ye=se[Ie],!ye)return!1;var ae=typeof ye=="function";switch(ge=arguments.length,ge){case 1:dt(ye,ae,this);break;case 2:$e(ye,ae,this,arguments[1]);break;case 3:ue(ye,ae,this,arguments[1],arguments[2]);break;case 4:Rr(ye,ae,this,arguments[1],arguments[2],arguments[3]);break;default:for(Ae=new Array(ge-1),De=1;De<ge;De++)Ae[De-1]=arguments[De];Ue(ye,ae,this,Ae)}return!0};function ke(Re,Ie,he,ye){var ge,Ae,De;if(typeof he!="function")throw new TypeError('"listener" argument must be a function');if(Ae=Re._events,Ae?(Ae.newListener&&(Re.emit("newListener",Ie,he.listener?he.listener:he),Ae=Re._events),De=Ae[Ie]):(Ae=Re._events=new $,Re._eventsCount=0),!De)De=Ae[Ie]=he,++Re._eventsCount;else if(typeof De=="function"?De=Ae[Ie]=ye?[he,De]:[De,he]:ye?De.unshift(he):De.push(he),!De.warned&&(ge=et(Re),ge&&ge>0&&De.length>ge)){De.warned=!0;var se=new Error("Possible EventEmitter memory leak detected. "+De.length+" "+Ie+" listeners added. Use emitter.setMaxListeners() to increase limit");se.name="MaxListenersExceededWarning",se.emitter=Re,se.type=Ie,se.count=De.length,Gt(se)}return Re}function Gt(Re){typeof console.warn=="function"?console.warn(Re):console.log(Re)}We.prototype.addListener=function(Ie,he){return ke(this,Ie,he,!1)},We.prototype.on=We.prototype.addListener,We.prototype.prependListener=function(Ie,he){return ke(this,Ie,he,!0)};function Qe(Re,Ie,he){var ye=!1;function ge(){Re.removeListener(Ie,ge),ye||(ye=!0,he.apply(Re,arguments))}return ge.listener=he,ge}We.prototype.once=function(Ie,he){if(typeof he!="function")throw new TypeError('"listener" argument must be a function');return this.on(Ie,Qe(this,Ie,he)),this},We.prototype.prependOnceListener=function(Ie,he){if(typeof he!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(Ie,Qe(this,Ie,he)),this},We.prototype.removeListener=function(Ie,he){var ye,ge,Ae,De,se;if(typeof he!="function")throw new TypeError('"listener" argument must be a function');if(ge=this._events,!ge)return this;if(ye=ge[Ie],!ye)return this;if(ye===he||ye.listener&&ye.listener===he)--this._eventsCount===0?this._events=new $:(delete ge[Ie],ge.removeListener&&this.emit("removeListener",Ie,ye.listener||he));else if(typeof ye!="function"){for(Ae=-1,De=ye.length;De-- >0;)if(ye[De]===he||ye[De].listener&&ye[De].listener===he){se=ye[De].listener,Ae=De;break}if(Ae<0)return this;if(ye.length===1){if(ye[0]=void 0,--this._eventsCount===0)return this._events=new $,this;delete ge[Ie]}else At(ye,Ae);ge.removeListener&&this.emit("removeListener",Ie,se||he)}return this},We.prototype.off=function(Re,Ie){return this.removeListener(Re,Ie)},We.prototype.removeAllListeners=function(Ie){var he,ye;if(ye=this._events,!ye)return this;if(!ye.removeListener)return arguments.length===0?(this._events=new $,this._eventsCount=0):ye[Ie]&&(--this._eventsCount===0?this._events=new $:delete ye[Ie]),this;if(arguments.length===0){for(var ge=Object.keys(ye),Ae=0,De;Ae<ge.length;++Ae)De=ge[Ae],De!=="removeListener"&&this.removeAllListeners(De);return this.removeAllListeners("removeListener"),this._events=new $,this._eventsCount=0,this}if(he=ye[Ie],typeof he=="function")this.removeListener(Ie,he);else if(he)do this.removeListener(Ie,he[he.length-1]);while(he[0]);return this},We.prototype.listeners=function(Ie){var he,ye,ge=this._events;return ge?(he=ge[Ie],he?typeof he=="function"?ye=[he.listener||he]:ye=_t(he):ye=[]):ye=[],ye},We.listenerCount=function(Re,Ie){return typeof Re.listenerCount=="function"?Re.listenerCount(Ie):vr.call(Re,Ie)},We.prototype.listenerCount=vr;function vr(Re){var Ie=this._events;if(Ie){var he=Ie[Re];if(typeof he=="function")return 1;if(he)return he.length}return 0}We.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function At(Re,Ie){for(var he=Ie,ye=he+1,ge=Re.length;ye<ge;he+=1,ye+=1)Re[he]=Re[ye];Re.pop()}function Oe(Re,Ie){for(var he=new Array(Ie);Ie--;)he[Ie]=Re[Ie];return he}function _t(Re){for(var Ie=new Array(Re.length),he=0;he<Ie.length;++he)Ie[he]=Re[he].listener||Re[he];return Ie}var Bt=te.getLogger("twilio-notificatiions");function Fe(Re,Ie){return["".concat(new Date().toISOString()," Twilio.Notifications ").concat(Re,":")].concat(Array.from(Ie))}var rr=function(){function Re(){q.default(this,Re)}return z.default(Re,[{key:"setLevel",value:function(he){Bt.setLevel(he)}},{key:"trace",value:function(){for(var he=arguments.length,ye=new Array(he),ge=0;ge<he;ge++)ye[ge]=arguments[ge];Bt.trace.apply(null,Fe("T",ye))}},{key:"debug",value:function(){for(var he=arguments.length,ye=new Array(he),ge=0;ge<he;ge++)ye[ge]=arguments[ge];Bt.debug.apply(null,Fe("D",ye))}},{key:"info",value:function(){for(var he=arguments.length,ye=new Array(he),ge=0;ge<he;ge++)ye[ge]=arguments[ge];Bt.info.apply(null,Fe("I",ye))}},{key:"warn",value:function(){for(var he=arguments.length,ye=new Array(he),ge=0;ge<he;ge++)ye[ge]=arguments[ge];Bt.warn.apply(null,Fe("W",ye))}},{key:"error",value:function(){for(var he=arguments.length,ye=new Array(he),ge=0;ge<he;ge++)ye[ge]=arguments[ge];Bt.error.apply(null,Fe("E",ye))}}]),Re}(),Pt=new rr;function ot(Re){var Ie=Tt();return function(){var ye=W.default(Re),ge;if(Ie){var Ae=W.default(this).constructor;ge=Reflect.construct(ye,arguments,Ae)}else ge=ye.apply(this,arguments);return D.default(this,ge)}}function Tt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Be=z.default(function Re(){var Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;q.default(this,Re),this.token=Ie,this.notificationId=he,this.messageTypes=ye});function Dn(Re,Ie){return[].concat(Z.default(Z.default(Re).filter(function(he){return!Ie.has(he)})),Z.default(Z.default(Ie).filter(function(he){return!Re.has(he)})))}function _i(Re,Ie){var he=new Set;return Re.notificationId!==Ie.notificationId&&he.add("notificationId"),Re.token!==Ie.token&&he.add("token"),Dn(Re.messageTypes,Ie.messageTypes).length>0&&he.add("messageType"),[he.size>0,he]}var Qt=function(Re){F.default(he,Re);var Ie=ot(he);function he(ye){var ge;return q.default(this,he),ge=Ie.call(this),H.default(de.default(ge),"desiredState",new Be),H.default(de.default(ge),"currentState",new Be),H.default(de.default(ge),"_hasActiveAttempt",!1),ge.channelType=ye,ge}return z.default(he,[{key:"setNotificationId",value:function(ge){this.desiredState.notificationId=ge}},{key:"isActive",value:function(){return this.desiredState.notificationId!==""}},{key:"subscribe",value:function(ge){if(this.desiredState.messageTypes.has(ge)){Pt.debug("message type '".concat(ge,"' for channel ").concat(this.channelType," is already registered"));return}this.desiredState.messageTypes.add(ge)}},{key:"unsubscribe",value:function(ge){this.desiredState.messageTypes.has(ge)&&this.desiredState.messageTypes.delete(ge)}},{key:"updateToken",value:function(ge){this.desiredState.token=ge}},{key:"commitChanges",value:function(){var ye=R.default(X.default.mark(function Ae(){var De,se,be,oe,pe,ae;return X.default.wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:if(!this._hasActiveAttempt){Pe.next=3;break}throw Pt.error("One registration attempt is already in progress"),new Error("One registration attempt is already in progress");case 3:if(De=_i(this.desiredState,this.currentState),se=ee.default(De,2),be=se[0],oe=se[1],be){Pe.next=6;break}return Pe.abrupt("return");case 6:if(this.currentState.notificationId||oe.delete("notificationId"),Pt.trace("Persisting ".concat(this.channelType," registration"),oe,this.desiredState),Pe.prev=8,this._hasActiveAttempt=!0,pe=new Be,pe.token=this.desiredState.token,pe.notificationId=this.desiredState.notificationId,pe.messageTypes=new Set(this.desiredState.messageTypes),!(pe.messageTypes.size>0)){Pe.next=24;break}return Pe.next=17,this.updateRegistration(pe,oe);case 17:ae=Pe.sent,this.currentState.token=ae.token,this.currentState.notificationId=ae.notificationId,this.currentState.messageTypes=new Set(ae.messageTypes),this.emit("stateChanged",this.channelType,"registered",this.currentState),Pe.next=30;break;case 24:return Pe.next=26,this.removeRegistration();case 26:this.currentState.token=pe.token,this.currentState.notificationId=pe.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged",this.channelType,"unregistered",this.currentState);case 30:Pe.next=35;break;case 32:throw Pe.prev=32,Pe.t0=Pe.catch(8),Pe.t0;case 35:return Pe.prev=35,this._hasActiveAttempt=!1,Pe.finish(35);case 38:case"end":return Pe.stop()}},Ae,this,[[8,32,35,38]])}));function ge(){return ye.apply(this,arguments)}return ge}()}]),he}(We);function er(Re){var Ie=jt();return function(){var ye=W.default(Re),ge;if(Ie){var Ae=W.default(this).constructor;ge=Reflect.construct(ye,arguments,Ae)}else ge=ye.apply(this,arguments);return D.default(this,ge)}}function jt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var kt={min:2e3,max:12e4,randomness:.2},br=function(Re){F.default(he,Re);var Ie=er(he);function he(ye,ge,Ae,De){var se;return q.default(this,he),se=Ie.call(this,ye),H.default(de.default(se),"registrationId",null),se.context=ge,se.twilsock=Ae,se.registrarUrl=De,se}return z.default(he,[{key:"updateRegistration",value:function(){var ye=R.default(X.default.mark(function Ae(De,se){var be=this,oe,pe,ae,Ze,Pe;return X.default.wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:if(!se.has("notificationId")){tt.next=3;break}return tt.next=3,this.removeRegistration();case 3:if(!(!De.notificationId||!De.notificationId.length)){tt.next=6;break}throw Pt.error("No push notification ID for registration"),new Error("No push notification ID for registration");case 6:return Pt.trace("Registering",this.channelType,De),oe={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(De.messageTypes),data:{registration_id:De.notificationId}},pe=this.context.productId,ae="".concat(this.registrarUrl,"?productId=").concat(pe),Ze={"Content-Type":"application/json"},Pt.trace("Creating registration for channel ".concat(this.channelType)),tt.prev=12,tt.next=15,new d.AsyncRetrier(kt).run(function(){return be.twilsock.post(ae,Ze,oe,pe)});case 15:Pe=tt.sent,this.registrationId=Pe.body.id,Pt.debug("Registration created: ",Pe),tt.next=24;break;case 20:throw tt.prev=20,tt.t0=tt.catch(12),Pt.error("Registration failed: ",tt.t0),tt.t0;case 24:return tt.abrupt("return",De);case 25:case"end":return tt.stop()}},Ae,this,[[12,20]])}));function ge(Ae,De){return ye.apply(this,arguments)}return ge}()},{key:"removeRegistration",value:function(){var ye=R.default(X.default.mark(function Ae(){var De=this,se,be,oe;return X.default.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(this.registrationId){ae.next=2;break}return ae.abrupt("return");case 2:return se=this.context.productId,be="".concat(this.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(se),oe={"Content-Type":"application/json"},Pt.trace("Removing registration for ".concat(this.channelType)),ae.prev=6,ae.next=9,new d.AsyncRetrier(Object.assign(kt,{maxAttemptsCount:3})).run(function(){return De.twilsock.delete(be,oe,{},se)});case 9:this.registrationId=null,this.currentState.notificationId="",Pt.debug("Registration removed for ".concat(this.channelType)),ae.next=18;break;case 14:throw ae.prev=14,ae.t0=ae.catch(6),Pt.error("Failed to remove registration ",this.channelType,ae.t0),ae.t0;case 18:case"end":return ae.stop()}},Ae,this,[[6,14]])}));function ge(){return ye.apply(this,arguments)}return ge}()},{key:"sendDeviceRemoveRequest",value:function(){var ye=R.default(X.default.mark(function Ae(De){var se=this,be,oe,pe,ae;return X.default.wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:if(De!==""){Pe.next=2;break}throw new Error("Empty registration ID");case 2:return be=this.context.productId,oe="".concat(this.registrarUrl,"?productId=").concat(be),pe={"Content-Type":"application/json"},ae={binding_type:this.channelType,address:De},Pe.prev=6,Pt.trace("Removing old registrations for ".concat(this.channelType)),Pe.next=10,new d.AsyncRetrier(Object.assign(kt,{maxAttemptsCount:3})).run(function(){return se.twilsock.delete(oe,pe,ae,be)});case 10:this.registrationId=null,this.currentState.notificationId="",Pt.debug("Registration removed for ".concat(this.channelType)),Pe.next=19;break;case 15:throw Pe.prev=15,Pe.t0=Pe.catch(6),Pt.error("Failed to remove registration ",this.channelType,Pe.t0),Pe.t0;case 19:case"end":return Pe.stop()}},Ae,this,[[6,15]])}));function ge(Ae){return ye.apply(this,arguments)}return ge}()}]),he}(Qt);function Nr(Re){var Ie=Xr();return function(){var ye=W.default(Re),ge;if(Ie){var Ae=W.default(this).constructor;ge=Reflect.construct(ye,arguments,Ae)}else ge=ye.apply(this,arguments);return D.default(this,ge)}}function Xr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Yi=function(Re){F.default(he,Re);var Ie=Nr(he);function he(ye,ge,Ae){var De;return q.default(this,he),De=Ie.call(this,"twilsock"),H.default(de.default(De),"contextId",re.v4()),De.productId=ye,De.platform=ge,De.twilsock=Ae,De}return z.default(he,[{key:"updateRegistration",value:function(){var ye=R.default(X.default.mark(function Ae(De,se){var be,oe;return X.default.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(se.has("messageType")){ae.next=2;break}return ae.abrupt("return",De);case 2:return be=Array.from(De.messageTypes),oe={product_id:this.productId,notification_protocol_version:4,endpoint_platform:this.platform,message_types:be},ae.prev=4,ae.next=7,this.twilsock.setNotificationsContext(this.contextId,oe);case 7:ae.next=13;break;case 9:throw ae.prev=9,ae.t0=ae.catch(4),Pt.error("Failed to update twilsock notification context: ".concat(ae.t0)),ae.t0;case 13:return ae.abrupt("return",De);case 14:case"end":return ae.stop()}},Ae,this,[[4,9]])}));function ge(Ae,De){return ye.apply(this,arguments)}return ge}()},{key:"removeRegistration",value:function(){var ye=R.default(X.default.mark(function Ae(){return X.default.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.prev=0,se.next=3,this.twilsock.removeNotificationsContext(this.contextId);case 3:se.next=9;break;case 5:throw se.prev=5,se.t0=se.catch(0),Pt.error("Failed to remove twilsock notification context: ".concat(se.t0)),se.t0;case 9:case"end":return se.stop()}},Ae,this,[[0,5]])}));function ge(){return ye.apply(this,arguments)}return ge}()},{key:"sendDeviceRemoveRequest",value:function(){var ye=R.default(X.default.mark(function Ae(De){return X.default.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:case"end":return be.stop()}},Ae)}));function ge(Ae){return ye.apply(this,arguments)}return ge}()}]),he}(Qt);function La(Re){var Ie=hn();return function(){var ye=W.default(Re),ge;if(Ie){var Ae=W.default(this).constructor;ge=Reflect.construct(ye,arguments,Ae)}else ge=ye.apply(this,arguments);return D.default(this,ge)}}function hn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qr,Ln=I.literal("apn","fcm","twilsock");t.Notifications=qr=function(Re){F.default(he,Re);var Ie=La(he);function he(ye){var ge,Ae,De,se,be,oe,pe,ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};q.default(this,he),pe=Ie.call(this),ae.logLevel=(ge=ae.logLevel)!==null&&ge!==void 0?ge:"error",Pt.setLevel(ae.logLevel);var Ze=(Ae=ae.productId)!==null&&Ae!==void 0?Ae:"notifications",Pe=!ae.twilsockClient,ct=ae.twilsockClient=(De=ae.twilsockClient)!==null&&De!==void 0?De:new l.TwilsockClient(ye,Ze,ae),tt=(se=ae.notifications)!==null&&se!==void 0?se:{},it=(be=(oe=tt.region)!==null&&oe!==void 0?oe:ae.region)!==null&&be!==void 0?be:"us1",pt="https://ers.".concat(it,".twilio.com/v1/registrations"),vt=tt.ersUrl||pt;pe.connectors=new Map;var st=qr._detectPlatform();return pe.connectors.set("apn",new br("apn",{protocolVersion:4,productId:Ze,platform:st},ct,vt)),pe.connectors.set("fcm",new br("fcm",{protocolVersion:3,productId:Ze,platform:st},ct,vt)),pe.connectors.set("twilsock",new Yi(Ze,st,ct)),ct.on("stateChanged",function(ft){return pe.emit("transportState",ft)}),pe._connector("twilsock").on("stateChanged",function(ft,ht,Mt){return pe.emit("stateChanged",ft,ht,Mt)}),pe._connector("apn").on("stateChanged",function(ft,ht,Mt){return pe.emit("stateChanged",ft,ht,Mt)}),pe._connector("fcm").on("stateChanged",function(ft,ht,Mt){return pe.emit("stateChanged",ft,ht,Mt)}),ct.on("message",function(ft,ht){return pe._routeMessage(ft,ht)}),pe.updateToken(ye),Pe&&(ct.connect(),pe.twilsock=ct),pe}return z.default(he,[{key:"shutdown",value:function(){var ye=R.default(X.default.mark(function Ae(){return X.default.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(this.connectors.clear(),!this.twilsock){se.next=4;break}return se.next=4,this.twilsock.disconnect();case 4:case"end":return se.stop()}},Ae,this)}));function ge(){return ye.apply(this,arguments)}return ge}()},{key:"setPushRegistrationId",value:function(ge,Ae){Pt.debug("Set ".concat(ge," push registration id '").concat(Ae,"'")),this._connector(ge).setNotificationId(Ae)}},{key:"subscribe",value:function(ge,Ae){Pt.debug("Add ".concat(ge," subscriptions for message type ").concat(Ae)),this._connector(ge).subscribe(Ae)}},{key:"unsubscribe",value:function(ge,Ae){Pt.debug("Remove ".concat(ge," subscriptions for message type ").concat(Ae)),this._connector(ge).unsubscribe(Ae)}},{key:"updateToken",value:function(ge){this.connectors.forEach(function(Ae){return Ae.updateToken(ge)})}},{key:"commitChanges",value:function(){var ye=R.default(X.default.mark(function Ae(){var De;return X.default.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:return De=[],this.connectors.forEach(function(oe){oe.isActive()&&De.push(oe.commitChanges())}),be.next=4,Promise.all(De);case 4:case"end":return be.stop()}},Ae,this)}));function ge(){return ye.apply(this,arguments)}return ge}()},{key:"removeRegistrations",value:function(){var ye=R.default(X.default.mark(function Ae(De,se){return X.default.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.next=2,this._connector(De).sendDeviceRemoveRequest(se);case 2:case"end":return oe.stop()}},Ae,this)}));function ge(Ae,De){return ye.apply(this,arguments)}return ge}()},{key:"handlePushNotification",value:function(ge){return{messageType:ge.twi_message_type,payload:ge.payload}}},{key:"_routeMessage",value:function(ge,Ae){Pt.debug("Notification message arrived: ",ge,Ae),this.emit("message",ge,Ae)}},{key:"_connector",value:function(ge){var Ae=this.connectors.get(ge);if(!Ae)throw new Error("Unknown channel type: ".concat(ge));return Ae}}],[{key:"_detectPlatform",value:function(){var ge="";return typeof navigator<"u"?(ge="unknown",typeof navigator.product<"u"&&(ge=navigator.product),typeof navigator.userAgent<"u"&&(ge=navigator.userAgent)):ge="web",ge.substring(0,128)}}]),he}(We),K([I.validateTypes(Ln,I.nonEmptyString),fe("design:type",Function),fe("design:paramtypes",[String,String]),fe("design:returntype",void 0)],t.Notifications.prototype,"setPushRegistrationId",null),K([I.validateTypes(Ln,I.nonEmptyString),fe("design:type",Function),fe("design:paramtypes",[String,String]),fe("design:returntype",void 0)],t.Notifications.prototype,"subscribe",null),K([I.validateTypes(Ln,I.nonEmptyString),fe("design:type",Function),fe("design:paramtypes",[String,String]),fe("design:returntype",void 0)],t.Notifications.prototype,"unsubscribe",null),K([I.validateTypes(I.nonEmptyString),fe("design:type",Function),fe("design:paramtypes",[String]),fe("design:returntype",void 0)],t.Notifications.prototype,"updateToken",null),K([I.validateTypesAsync(Ln,I.nonEmptyString),fe("design:type",Function),fe("design:paramtypes",[String,String]),fe("design:returntype",Promise)],t.Notifications.prototype,"removeRegistrations",null),t.Notifications=qr=K([I.validateConstructorTypes(I.nonEmptyString,[I.pureObject,"undefined",I.literal(null)]),fe("design:paramtypes",[String,Object])],t.Notifications)})(O3);var Tn={},fn={};/*
  @license
  Copyright (c) 2021 Twilio Inc.

  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


  */Object.defineProperty(fn,"__esModule",{value:!0});var Oye=_n,Nye=eo,Aye=to,Pye=qn,xye=Bn,Dye=Zn,Lye=wn;function as(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var wu=as(Oye),os=as(Nye),E_=as(Aye),Uye=as(Pye),jye=as(xye),Vye=as(Dye),W3=as(Lye),co=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return{checks:e}};function Fye(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=$ye(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function $ye(t,r){if(t){if(typeof t=="string")return B3(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return B3(t,r)}}function B3(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Z3=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return co(function(i){var a=!1,o=[],s=Fye(e),u;try{for(s.s();!(u=s.n()).done;){var l=u.value;if(typeof l=="string"){a=a||wu.default(i)===l,o.push("of type ".concat(l));continue}a=a||i instanceof l,o.push("an instance of ".concat(l.name))}}catch(c){s.e(c)}finally{s.f()}return[a,o]})};function zye(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Wye(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Wye(t,r){if(t){if(typeof t=="string")return q3(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return q3(t,r)}}function q3(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Bye=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return co(function(i){var a=!1,o=[],s=zye(e),u;try{for(s.s();!(u=s.n()).done;){var l=u.value;a=a||i===l,o.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){s.e(c)}finally{s.f()}return[a,o]})},Zye=co(function(t){return[typeof t=="string"&&t.length>0,"a non-empty string"]}),qye=co(function(t){return[typeof t=="number"&&Number.isInteger(t)&&t>=0,"a non-negative integer"]}),Qye=co(function(t){return[wu.default(t)==="object"&&t!==null&&!Array.isArray(t),"a pure object (non-null and non-array)"]});function Yye(t){var r=Gye();return function(){var n=W3.default(t),i;if(r){var a=W3.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Vye.default(this,i)}}function Gye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vc(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Hye(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Hye(t,r){if(t){if(typeof t=="string")return Q3(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Q3(t,r)}}function Q3(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Yp=function(r,e){if(e.length>r.length)throw new Error("Expected at most ".concat(r.length," argument(s), but got ").concat(e.length));for(;e.length<r.length;)e.push(void 0);var n=vc(e.entries()),i;try{for(n.s();!(i=n.n()).done;){var a=os.default(i.value,2),o=a[0],s=a[1],u=R_(r[o],s),l=os.default(u,4),c=l[0],f=l[1],d=l[2],v=l[3];if(!c){var p=o+1;throw new Error("Argument ".concat(p," is expected to be ").concat(d).concat(v," but got ").concat(f))}}}catch(y){n.e(y)}finally{n.f()}},Y3=function(r){var e,n,i=["undefined","boolean","number","bigint","string"];if(i.includes(wu.default(r))&&(n=typeof r=="string"?'"'.concat(r,'"'):"".concat(r)),wu.default(r)==="object"&&(r==null||(e=r.constructor)===null||e===void 0?void 0:e.name)!=="Object"){var a;n=r===null?"null":"instance of ".concat(r==null||(a=r.constructor)===null||a===void 0?void 0:a.name)}return n||(n=wu.default(r)),n},Jye=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var i=M_(e);return function(a){return function(o){jye.default(u,o);var s=Yye(u);function u(){Uye.default(this,u);for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return Yp(i,c),s.call.apply(s,[this].concat(c))}return u}(a)}},Xye=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var i=M_(e);return function(a,o,s){if(typeof s.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=s.value;s.value=function(){for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return Yp(i,c),u.apply(this,c)}}},Kye=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var i=M_(e);return function(a,o,s){if(typeof s.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=s.value;s.value=function(){for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];try{Yp(i,c)}catch(d){return Promise.reject(d)}return u.apply(this,c)}}},M_=function(r){var e=[],n=vc(r),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;e.push(C_(a))}}catch(o){n.e(o)}finally{n.f()}return e},C_=function(r){var e=[],n=Array.isArray(r)?r:[r],i=vc(n),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;if(typeof o=="string"||typeof o=="function"){e.push(Z3(o));continue}e.push(o)}}catch(s){i.e(s)}finally{i.f()}return e},R_=function(r,e){var n=[],i,a=!1,o=vc(r),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,l=vc(u.checks),c;try{for(l.s();!(c=l.n()).done;){var f=c.value,d=f(e),v=os.default(d,3),p=v[0],y=v[1],k=v[2];a=a||p,!i&&k&&(i=k),y&&(n=typeof y=="string"?[].concat(E_.default(n),[y]):[].concat(E_.default(n),E_.default(y)))}}catch(R){l.e(R)}finally{l.f()}}}catch(R){o.e(R)}finally{o.f()}if(a)return[!0];var I=i||Y3(e),C=n.length-1,L=C>0?"".concat(n.slice(0,C).join(", ")," or ").concat(n[C]):n.join(", ");return[!1,I,L,C>1?";":","]},ebe=function(r,e){return co(function(n){if(wu.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(r," (should be a pure object)")];for(var i=0,a=Object.entries(e);i<a.length;i++){var o=os.default(a[i],2),s=o[0],u=o[1],l=R_(C_(u),n[s]),c=os.default(l,3),f=c[0],d=c[1],v=c[2];if(!f)return[!1,"valid ".concat(r,' (key "').concat(s,'" should be ').concat(v,")"),"malformed ".concat(r,' (key "').concat(s,'" is ').concat(d,")")]}return[!0]})};function tbe(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=rbe(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function rbe(t,r){if(t){if(typeof t=="string")return G3(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return G3(t,r)}}function G3(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var nbe=function(r,e){return co(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(r)];var i=tbe(n.entries()),a;try{for(i.s();!(a=i.n()).done;){var o=os.default(a.value,2),s=o[0],u=o[1],l=R_(C_(e),u),c=os.default(l,3),f=c[0],d=c[1],v=c[2];if(!f)return[!1,"a valid array of ".concat(r," (index ").concat(s," should be ").concat(v,")"),"malformed array of ".concat(r," (index ").concat(s," is ").concat(d,")")]}}catch(p){i.e(p)}finally{i.f()}return[!0]})};fn.array=nbe,fn.custom=co,fn.literal=Bye,fn.nonEmptyString=Zye,fn.nonNegativeInteger=qye,fn.objectSchema=ebe,fn.pureObject=Qye,fn.runtimeTypeValidation=Yp,fn.stringifyReceivedType=Y3,fn.type=Z3,fn.validateConstructorTypes=Jye,fn.validateTypes=Xye,fn.validateTypesAsync=Kye;var Gp={},H3={get exports(){return Gp},set exports(t){Gp=t}},J3=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(J3){var X3=new Uint8Array(16);H3.exports=function(){return J3(X3),X3}}else{var K3=new Array(16);H3.exports=function(){for(var r=0,e;r<16;r++)r&3||(e=Math.random()*4294967296),K3[r]=e>>>((r&3)<<3)&255;return K3}}for(var eA=[],Hp=0;Hp<256;++Hp)eA[Hp]=(Hp+256).toString(16).substr(1);function ibe(t,r){var e=r||0,n=eA;return[n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]]].join("")}var tA=ibe,abe=Gp,obe=tA,rA,I_,O_=0,N_=0;function sbe(t,r,e){var n=r&&e||0,i=r||[];t=t||{};var a=t.node||rA,o=t.clockseq!==void 0?t.clockseq:I_;if(a==null||o==null){var s=abe();a==null&&(a=rA=[s[0]|1,s[1],s[2],s[3],s[4],s[5]]),o==null&&(o=I_=(s[6]<<8|s[7])&16383)}var u=t.msecs!==void 0?t.msecs:new Date().getTime(),l=t.nsecs!==void 0?t.nsecs:N_+1,c=u-O_+(l-N_)/1e4;if(c<0&&t.clockseq===void 0&&(o=o+1&16383),(c<0||u>O_)&&t.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");O_=u,N_=l,I_=o,u+=122192928e5;var f=((u&268435455)*1e4+l)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=f&255;var d=u/4294967296*1e4&268435455;i[n++]=d>>>8&255,i[n++]=d&255,i[n++]=d>>>24&15|16,i[n++]=d>>>16&255,i[n++]=o>>>8|128,i[n++]=o&255;for(var v=0;v<6;++v)i[n+v]=a[v];return r||obe(i)}var ube=sbe,lbe=Gp,cbe=tA;function fbe(t,r,e){var n=r&&e||0;typeof t=="string"&&(r=t==="binary"?new Array(16):null,t=null),t=t||{};var i=t.random||(t.rng||lbe)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,r)for(var a=0;a<16;++a)r[n+a]=i[a];return r||cbe(i)}var dbe=fbe,pbe=ube,nA=dbe,A_=nA;A_.v1=pbe,A_.v4=nA;var vbe=A_;/*
  @license
  The following license applies to all parts of this software except as
  documented below.

      Copyright (c) 2016, Twilio, inc.
      All rights reserved.

      Redistribution and use in source and binary forms, with or without
      modification, are permitted provided that the following conditions are
      met:

        1. Redistributions of source code must retain the above copyright
           notice, this list of conditions and the following disclaimer.

        2. Redistributions in binary form must reproduce the above copyright
           notice, this list of conditions and the following disclaimer in
           the documentation and/or other materials provided with the
           distribution.

        3. Neither the name of Twilio nor the names of its contributors may
           be used to endorse or promote products derived from this software
           without specific prior written permission.

      THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
      "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
      LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
      A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
      HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
      SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
      LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
      DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
      THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
      (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
      OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

  This software includes loglevel under the following license.

      Copyright (c) 2013 Tim Perry

      Permission is hereby granted, free of charge, to any person
      obtaining a copy of this software and associated documentation
      files (the "Software"), to deal in the Software without
      restriction, including without limitation the rights to use,
      copy, modify, merge, publish, distribute, sublicense, and/or sell
      copies of the Software, and to permit persons to whom the
      Software is furnished to do so, subject to the following
      conditions:

      The above copyright notice and this permission notice shall be
      included in all copies or substantial portions of the Software.

      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
      EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
      OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
      NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
      HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
      WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
      FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
      OTHER DEALINGS IN THE SOFTWARE.

  This software includes Backoff library under the following license

      Copyright (C) 2012 Mathieu Turcotte

      Permission is hereby granted, free of charge, to any person obtaining a copy of
      this software and associated documentation files (the "Software"), to deal in
      the Software without restriction, including without limitation the rights to
      use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
      of the Software, and to permit persons to whom the Software is furnished to do
      so, subject to the following conditions:

      The above copyright notice and this permission notice shall be included in all
      copies or substantial portions of the Software.

      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
      IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
      FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
      AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
      LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
      OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
      SOFTWARE.

  This software includes Event-to-Promise library under the following license

      Copyright (c) 2014, Julien Fontanet <julien.fontanet@isonoe.net>.

      Permission to use, copy, modify, and/or distribute this software for any purpose
      with or without fee is hereby granted, provided that the above copyright notice
      and this permission notice appear in all copies.

      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
      FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
      OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
      TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
      THIS SOFTWARE.

  */Object.defineProperty(Tn,"__esModule",{value:!0});var hbe=Bo,mbe=qn,gbe=ji,ybe=ha,bbe=Bn,_be=Zn,wbe=wn,kbe=ma,Tbe=Yl,Sbe=_n,xe=fn,Jp=kp,Ebe=bu,Mbe=Ho,Cbe=eo,iA=Ta,aA=vbe,Rbe=ec,Ibe=pc;function An(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}function P_(t){if(t&&t.__esModule)return t;var r=Object.create(null);return t&&Object.keys(t).forEach(function(e){if(e!=="default"){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}}),r.default=t,Object.freeze(r)}var ze=An(hbe),qt=An(mbe),nr=An(gbe),$i=An(ybe),dn=An(bbe),fo=An(_be),Dr=An(wbe),lr=An(kbe),le=An(Tbe),oA=An(Sbe),Obe=An(Ebe),Nbe=P_(Mbe),sA=An(Cbe),Abe=P_(aA),hc=An(Rbe),Xp=P_(Ibe);function Yt(t,r,e,n){var i=arguments.length,a=i<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,e):n,o;if((typeof Reflect>"u"?"undefined":oA.default(Reflect))==="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,r,e,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(r,e,a):o(r,e))||a);return i>3&&a&&Object.defineProperty(r,e,a),a}function je(t,r){if((typeof Reflect>"u"?"undefined":oA.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,r)}var Pbe;function po(){}po.prototype=Object.create(null);function cr(){cr.init.call(this)}cr.EventEmitter=cr,cr.usingDomains=!1,cr.prototype.domain=void 0,cr.prototype._events=void 0,cr.prototype._maxListeners=void 0,cr.defaultMaxListeners=10,cr.init=function(){this.domain=null,cr.usingDomains&&Pbe.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new po,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},cr.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||isNaN(r))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=r,this};function uA(t){return t._maxListeners===void 0?cr.defaultMaxListeners:t._maxListeners}cr.prototype.getMaxListeners=function(){return uA(this)};function xbe(t,r,e){if(r)t.call(e);else for(var n=t.length,i=mc(t,n),a=0;a<n;++a)i[a].call(e)}function Dbe(t,r,e,n){if(r)t.call(e,n);else for(var i=t.length,a=mc(t,i),o=0;o<i;++o)a[o].call(e,n)}function Lbe(t,r,e,n,i){if(r)t.call(e,n,i);else for(var a=t.length,o=mc(t,a),s=0;s<a;++s)o[s].call(e,n,i)}function Ube(t,r,e,n,i,a){if(r)t.call(e,n,i,a);else for(var o=t.length,s=mc(t,o),u=0;u<o;++u)s[u].call(e,n,i,a)}function jbe(t,r,e,n){if(r)t.apply(e,n);else for(var i=t.length,a=mc(t,i),o=0;o<i;++o)a[o].apply(e,n)}cr.prototype.emit=function(r){var e,n,i,a,o,s,u,l=r==="error";if(s=this._events,s)l=l&&s.error==null;else if(!l)return!1;if(u=this.domain,l){if(e=arguments[1],u)e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=u,e.domainThrown=!1,u.emit("error",e);else{if(e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}return!1}if(n=s[r],!n)return!1;var f=typeof n=="function";switch(i=arguments.length,i){case 1:xbe(n,f,this);break;case 2:Dbe(n,f,this,arguments[1]);break;case 3:Lbe(n,f,this,arguments[1],arguments[2]);break;case 4:Ube(n,f,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),o=1;o<i;o++)a[o-1]=arguments[o];jbe(n,f,this,a)}return!0};function lA(t,r,e,n){var i,a,o;if(typeof e!="function")throw new TypeError('"listener" argument must be a function');if(a=t._events,a?(a.newListener&&(t.emit("newListener",r,e.listener?e.listener:e),a=t._events),o=a[r]):(a=t._events=new po,t._eventsCount=0),!o)o=a[r]=e,++t._eventsCount;else if(typeof o=="function"?o=a[r]=n?[e,o]:[o,e]:n?o.unshift(e):o.push(e),!o.warned&&(i=uA(t),i&&i>0&&o.length>i)){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+r+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=r,s.count=o.length,Vbe(s)}return t}function Vbe(t){typeof console.warn=="function"?console.warn(t):console.log(t)}cr.prototype.addListener=function(r,e){return lA(this,r,e,!1)},cr.prototype.on=cr.prototype.addListener,cr.prototype.prependListener=function(r,e){return lA(this,r,e,!0)};function cA(t,r,e){var n=!1;function i(){t.removeListener(r,i),n||(n=!0,e.apply(t,arguments))}return i.listener=e,i}cr.prototype.once=function(r,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.on(r,cA(this,r,e)),this},cr.prototype.prependOnceListener=function(r,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(r,cA(this,r,e)),this},cr.prototype.removeListener=function(r,e){var n,i,a,o,s;if(typeof e!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[r],!n)return this;if(n===e||n.listener&&n.listener===e)--this._eventsCount===0?this._events=new po:(delete i[r],i.removeListener&&this.emit("removeListener",r,n.listener||e));else if(typeof n!="function"){for(a=-1,o=n.length;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){s=n[o].listener,a=o;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new po,this;delete i[r]}else Fbe(n,a);i.removeListener&&this.emit("removeListener",r,s||e)}return this},cr.prototype.off=function(t,r){return this.removeListener(t,r)},cr.prototype.removeAllListeners=function(r){var e,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new po,this._eventsCount=0):n[r]&&(--this._eventsCount===0?this._events=new po:delete n[r]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,o;a<i.length;++a)o=i[a],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new po,this._eventsCount=0,this}if(e=n[r],typeof e=="function")this.removeListener(r,e);else if(e)do this.removeListener(r,e[e.length-1]);while(e[0]);return this},cr.prototype.listeners=function(r){var e,n,i=this._events;return i?(e=i[r],e?typeof e=="function"?n=[e.listener||e]:n=$be(e):n=[]):n=[],n},cr.listenerCount=function(t,r){return typeof t.listenerCount=="function"?t.listenerCount(r):fA.call(t,r)},cr.prototype.listenerCount=fA;function fA(t){var r=this._events;if(r){var e=r[t];if(typeof e=="function")return 1;if(e)return e.length}return 0}cr.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Fbe(t,r){for(var e=r,n=e+1,i=t.length;n<i;e+=1,n+=1)t[e]=t[n];t.pop()}function mc(t,r){for(var e=new Array(r);r--;)e[r]=t[r];return e}function $be(t){for(var r=new Array(t.length),e=0;e<r.length;++e)r[e]=t[e].listener||t[e];return r}var ku=function(){function t(r){qt.default(this,t),this.base=r,this.args=new Array,this.paths=new Array}return nr.default(t,[{key:"pathSegment",value:function(e){return this.paths.push(encodeURIComponent(e)),this}},{key:"queryParam",value:function(e,n){return typeof n<"u"&&this.args.push(encodeURIComponent(e)+"="+encodeURIComponent(n)),this}},{key:"build",value:function(){var e=this.base;return this.paths.length&&(e+="/"+this.paths.join("/")),this.args.length&&(e+="?"+this.args.join("&")),e}}]),t}();function dA(t){var r=zbe();return function(){var n=Dr.default(t),i;if(r){var a=Dr.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fo.default(this,i)}}function zbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Sn=function(t){dn.default(e,t);var r=dA(e);function e(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return qt.default(this,e),i=r.call(this),i.name=i.constructor.name,i.message="".concat(n," (status: ").concat(a,", code: ").concat(o,")"),i.status=a,i.code=o,i}return e}(Obe.default(Error)),Wbe=function(t){dn.default(e,t);var r=dA(e);function e(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0;return qt.default(this,e),i=r.call(this,n,a,o),i.body=s,i}return e}(Sn);function vi(t){return JSON.parse(JSON.stringify(t))}function pA(t){var r=t===void 0||x_(t);if(!r)throw new Sn("Invalid pageSize parameter. Expected a positive integer, was '".concat(t,"'."),400,20007)}function Bbe(t){return!isNaN(parseInt(t))&&isFinite(t)}function x_(t){return Bbe(t)&&t>0}var Tu=Nbe.getLogger("twilio-sync");function gc(t,r){return["".concat(new Date().toISOString()," Sync ").concat(t,":")].concat(Array.from(r))}var Kt={setLevel:function(r){Tu.setLevel(r)},trace:function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];Tu.trace.apply(null,gc("T",e))},debug:function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];Tu.debug.apply(null,gc("D",e))},info:function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];Tu.info.apply(null,gc("I",e))},warn:function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];Tu.warn.apply(null,gc("W",e))},error:function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];Tu.error.apply(null,gc("E",e))}},Zbe="/v4/Subscriptions",qbe="/v3/Maps",Qbe="/v3/Lists",Ybe="/v3/Documents",Gbe="/v3/Streams",Hbe="/v3/Insights";function Jbe(t,r,e){return t&&typeof t[r]<"u"?t[r]:e}var Xbe=function(){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};qt.default(this,t);var e=r.region||"us1",n="https://cds.".concat(e,".twilio.com"),i=r.cdsUri||n;this.settings={subscriptionsUri:i+Zbe,documentsUri:i+Ybe,listsUri:i+Qbe,mapsUri:i+qbe,streamsUri:i+Gbe,insightsUri:i+Hbe,sessionStorageEnabled:Jbe(r.Sync,"enableSessionStorage",!0),productId:r.productId}}return nr.default(t,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}},{key:"productId",get:function(){return this.settings.productId}}]),t}();function yc(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Kbe(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Kbe(t,r){if(t){if(typeof t=="string")return vA(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return vA(t,r)}}function vA(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var e_e=function(){function t(r){qt.default(this,t),this.localObject=r,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return nr.default(t,[{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}},{key:"update",value:function(e,n){this.localObject._update(e,n)}},{key:"updatePending",value:function(e,n){this.pendingAction=e,this.pendingCorrelationId=n}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(e){this.rejectedWithError=e.error,this.updatePending(null,null),this.localObject.reportFailure(new Sn("Failed to subscribe on service events: ".concat(e.error.message),e.error.status,e.error.code))}},{key:"complete",value:function(e){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(e)}},{key:"setSubscriptionState",value:function(e){this.localObject._setSubscriptionState(e)}}]),t}(),t_e=function(){function t(r){var e=this;qt.default(this,t),lr.default(this,"isConnected",!1),lr.default(this,"maxBatchSize",100),lr.default(this,"subscriptionTtlTimer",null),lr.default(this,"pendingPokeReason",null),this.services=r,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map;var n={randomisationFactor:.2,initialDelay:100,maxDelay:2*60*1e3};this.backoff=iA.Backoff.exponential(Object.assign(n,this.services.config.backoffConfig)),this.backoff.on("ready",function(){var i=e.getSubscriptionUpdateBatch(),a=i.action,o=i.subscriptions;a?e.applyNewSubscriptionUpdateBatch(a,o):(e.backoff.reset(),Kt.debug("All subscriptions resolved."))})}return nr.default(t,[{key:"getSubscriptionUpdateBatch",value:function(){function e(a,o,s,u){var l=[],c=yc(a),f;try{for(c.s();!(f=c.n()).done;){var d=sA.default(f.value,2),v=d[0],p=d[1],y=o.get(v);if(!y&&s!==p.pendingAction&&!p.rejectedWithError&&(l.push(p),u&&l.length>=u))break}}catch(k){c.e(k)}finally{c.f()}return l}var n=e(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(n.length>0)return{action:"establish",subscriptions:n};var i=e(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return i.length>0?{action:"cancel",subscriptions:i}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:function(){var r=ze.default(le.default.mark(function n(i,a){var o=this,s,u,l,c,f,d,v,p,y,k,I,C,L,R,q,z;return le.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(this.isConnected){D.next=4;break}return Kt.debug("Twilsock connection (required for subscription) not ready; waiting"),this.backoff.reset(),D.abrupt("return");case 4:a=this.processLocalActions(i,a),s=new Date().getTime(),u=yc(a);try{for(u.s();!(l=u.n()).done;)c=l.value,this.recordActionAttemptOn(c,i,s)}catch(W){u.e(W)}finally{u.f()}return f=this.pendingPokeReason,this.pendingPokeReason=null,D.prev=10,D.next=13,this.request(i,s,f,a);case 13:d=D.sent,v=d.body.max_batch_size,!isNaN(parseInt(v))&&isFinite(v)&&v>0&&(this.maxBatchSize=v),this.subscriptionTtlTimer||(p=d.body.ttl_in_s,y=!isNaN(parseFloat(p))&&isFinite(p),k=y&&p>0,k&&(this.subscriptionTtlTimer=setTimeout(function(){return o.onSubscriptionTtlElapsed()},p*1e3))),i==="establish"&&(I=d.body.estimated_delivery_in_ms,C=!isNaN(parseFloat(I))&&isFinite(I),L=C&&I>0,L?setTimeout(function(){return o.verifyPokeDelivery(s,I,a)},I):Kt.error("Invalid timeout: ".concat(I)),a.filter(function(W){return W.pendingCorrelationId===s}).forEach(function(W){return W.setSubscriptionState("response_in_flight")})),this.backoff.reset(),D.next=26;break;case 21:D.prev=21,D.t0=D.catch(10),R=yc(a);try{for(R.s();!(q=R.n()).done;)z=q.value,this.recordActionFailureOn(z,i)}catch(W){R.e(W)}finally{R.f()}D.t0 instanceof Jp.TransportUnavailableError?(Kt.debug("Twilsock connection (required for subscription) not ready (c:".concat(s,"); waiting")),this.backoff.reset()):(Kt.debug("Failed an attempt to ".concat(i," subscriptions (c:").concat(s,"); retrying"),D.t0),this.persist());case 26:case"end":return D.stop()}},n,this,[[10,21]])}));function e(n,i){return r.apply(this,arguments)}return e}()},{key:"verifyPokeDelivery",value:function(e,n,i){var a=this,o=this.latestPokeResponseArrivalTimestampByCorrelationId.get(e),s=o?new Date().getTime()-o:n;if(s>=n)i.filter(function(l){return l.pendingCorrelationId===e}).forEach(function(l){l.updatePending(null,null),l.retryCount++,a.persisted.delete(l.sid)}),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(e);else{var u=n-s;setTimeout(function(){return a.verifyPokeDelivery(e,n,i)},u)}}},{key:"processLocalActions",value:function(e,n){return e==="cancel"?n.filter(function(i){return!i.rejectedWithError}):n}},{key:"recordActionAttemptOn",value:function(e,n,i){if(e.setSubscriptionState("request_in_flight"),n==="establish")this.persisted.set(e.sid,e),e.updatePending(n,i);else{var a=this.persisted.get(e.sid);a&&a.updatePending(n,i)}}},{key:"recordActionFailureOn",value:function(e,n){e.setSubscriptionState("none"),e.updatePending(null,null),n==="establish"&&this.persisted.delete(e.sid)}},{key:"request",value:function(e,n,i,a){var o=a.map(function(l){return{object_sid:l.sid,object_type:l.type,last_event_id:e==="establish"?l.lastEventId:void 0,index_name:e==="establish"?l.indexName:void 0,query_string:e==="establish"?l.queryString:void 0}}),s=a.filter(function(l){return l.retryCount>0}).length;Kt.debug("Attempting '".concat(e,"' request (c:").concat(n,"):"),o);var u={event_protocol_version:4,action:e,correlation_id:n,retried_requests:s,ttl_in_s:-1,requests:o};return i==="ttl"&&(u.reason=i),this.services.network.post(this.services.config.subscriptionsUri,u)}},{key:"add",value:function(e,n){Kt.debug("Establishing intent to subscribe to ".concat(e));var i=this.subscriptions.get(e);i&&n&&i.lastEventId===n.lastEventId||(this.persisted.delete(e),this.subscriptions.set(e,new e_e(n)),this.persist())}},{key:"remove",value:function(e){Kt.debug("Establishing intent to unsubscribe from ".concat(e));var n=this.subscriptions.delete(e);n&&this.persist()}},{key:"acceptMessage",value:function(e,n){Kt.trace("Subscriptions received",e);var i=e.event_type,a=typeof e.events<"u"?e.events:[e.event],o=e.correlation_id;o&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(o,new Date().getTime());var s=yc(a),u;try{for(s.s();!(u=s.n()).done;){var l=u.value,c=void 0;switch(e.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(l,o);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(l,o);break;case"subscription_failed":this.applySubscriptionFailedMessage(l,o);break;case(c=i.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:{var f=void 0;switch(c[0]){case"map_":f=l.map_sid;break;case"list_":f=l.list_sid;break;case"document_":f=l.document_sid;break;case"stream_":f=l.stream_sid;break;case"live_query_":f=l.query_id,n=!1,e.strictly_ordered===!0&&(n=!0);break;default:f=void 0}this.applyEventToSubscribedEntity(f,l,i,n);break}default:Kt.debug("Dropping unknown message type ".concat(i));break}}}catch(d){s.e(d)}finally{s.f()}}},{key:"applySubscriptionEstablishedMessage",value:function(e,n){var i=e.object_sid,a=this.persisted.get(e.object_sid);a&&a.pendingCorrelationId===n?e.replay_status==="interrupted"?(Kt.debug("Event Replay for subscription to ".concat(i," (c:").concat(n,") interrupted; continuing eagerly.")),a.updatePending(null,null),this.persisted.delete(a.sid),this.backoff.reset()):e.replay_status==="completed"&&(Kt.debug("Event Replay for subscription to ".concat(i," (c:").concat(n,") completed. Subscription is ready.")),a.complete(e.last_event_id),this.persisted.set(e.object_sid,a),a.setSubscriptionState("established"),this.backoff.reset()):Kt.debug("Late message for ".concat(e.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(e,n){var i=this.persisted.get(e.object_sid);i&&i.pendingCorrelationId===n?(i.updatePending(null,null),i.setSubscriptionState("none"),this.persisted.delete(e.object_sid)):Kt.debug("Late message for ".concat(e.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(e,n){var i=e.object_sid,a=this.subscriptions.get(i),o=this.persisted.get(i);a&&o?o.pendingCorrelationId===n&&(Kt.error("Failed to subscribe on ".concat(o.sid),e.error),o.markAsFailed(e),o.setSubscriptionState("none")):!a&&o&&(this.persisted.delete(i),o.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(e,n,i,a){var o=this;if(e){a=a||function(){var u=o.persisted.get(e);return u&&u.isEstablished}();var s=this.subscriptions.get(e);s?(n.type=i,s.update(n,a)):Kt.debug("Message dropped for SID '".concat(e,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(e){this.isConnected=e,e&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(e){Kt.debug("Triggering event replay for all subscriptions, reason=".concat(e)),this.pendingPokeReason=e,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var n=[],i=yc(this.persisted.values()),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;o.reset(),o.rejectedWithError&&n.push(o)}}catch(c){i.e(c)}finally{i.f()}this.persisted.clear();for(var s=0,u=n;s<u.length;s++){var l=u[s];this.persisted.set(l.sid,l)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),t}(),r_e=4e3,n_e=6e4,i_e=9e4,a_e=.2;function hA(t){if(t.body&&t.body.message)return t.body.message;switch(t.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function mA(t){return t.body?t.body.code:0}function bc(t){return t.status===409?new Wbe(hA(t),t.status,mA(t),t.body):t.status?new Sn(hA(t),t.status,mA(t)):t instanceof Jp.TransportUnavailableError?t:new Sn(t.message,0,0)}var o_e=function(){function t(r,e,n){qt.default(this,t),this.clientInfo=r,this.config=e,this.transport=n}return nr.default(t,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+Abe.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:r_e,max:n_e,maxAttemptsTime:i_e,randomness:a_e},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new Promise(function(a,o){var s=[502,503,504];i&&s.push(429);var u=new iA.Retrier(n.backoffConfig());u.on("attempt",function(){e().then(function(l){return u.succeeded(l)}).catch(function(l){if(s.includes(l.status)){var c=parseInt(l.headers?l.headers["Retry-After"]:null);u.failed(bc(l),isNaN(c)?null:c*1e3)}else l.message==="Twilsock disconnected"?u.failed(bc(l)):(u.removeAllListeners(),u.cancel(),o(bc(l)))})}),u.on("succeeded",function(l){a(l)}),u.on("cancelled",function(l){return o(bc(l))}),u.on("failed",function(l){return o(bc(l))}),u.start()})}},{key:"get",value:function(e){var n=this,i=this.createHeaders();return Kt.debug("GET",e,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.get(e,i,n.config.productId)},!0)}},{key:"post",value:function(e,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.createHeaders();return typeof i<"u"&&i!==null&&(s["If-Match"]=i),Kt.debug("POST",e,"ID:",s["Twilio-Request-Id"]),this.executeWithRetry(function(){return a.transport.post(e,s,n,a.config.productId)},o)}},{key:"put",value:function(e,n,i){var a=this,o=this.createHeaders();return typeof i<"u"&&i!==null&&(o["If-Match"]=i),Kt.debug("PUT",e,"ID:",o["Twilio-Request-Id"]),this.executeWithRetry(function(){return a.transport.put(e,o,n,a.config.productId)},!1)}},{key:"delete",value:function(e){var n=this,i=this.createHeaders();return Kt.debug("DELETE",e,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.delete(e,i,n.config.productId)},!1)}}]),t}(),s_e=function(){function t(r,e){qt.default(this,t),this.config=r,this.storageId=null;try{this.storage=e||sessionStorage}catch{}}return nr.default(t,[{key:"storageKey",value:function(e,n){return"".concat(this.storageId,"::").concat(e,"::").concat(n)}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}},{key:"updateStorageId",value:function(e){this.storageId=e}},{key:"store",value:function(e,n,i){return this.isReady?this._store(this.storageKey(e,n),i):null}},{key:"read",value:function(e,n){return this.isReady?this._read(this.storageKey(e,n)):null}},{key:"remove",value:function(e,n,i){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(e,n)),i&&this.storage.removeItem(this.storageKey(e,i))}catch{}}},{key:"update",value:function(e,n,i,a){if(!this.isReady)return null;this._apply(this.storageKey(e,n),a),i&&this._apply(this.storageKey(e,i),a)}},{key:"_store",value:function(e,n){try{this.storage.setItem(e,JSON.stringify(n))}catch{}}},{key:"_read",value:function(e){try{var n=this.storage.getItem(e);if(n)return JSON.parse(n)}catch{}return null}},{key:"_apply",value:function(e,n){var i=this._read(e);if(!i)return!1;this._store(e,Object.assign(i,n))}}]),t}();function u_e(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=l_e(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function l_e(t,r){if(t){if(typeof t=="string")return gA(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return gA(t,r)}}function gA(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var _c=function(){function t(r,e){qt.default(this,t),this.services=r,this.removalHandler=e,this.subscriptionState="none",this._attachedListeners=new Map}return nr.default(t,[{key:"_advanceLastEventId",value:function(e,n){}},{key:"reportFailure",value:function(e){e.status===404?this.onRemoved(!1):this.broadcastEventToListeners("failure",e)}},{key:"_subscribe",value:function(){this.services.router._subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router._unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(e){this.subscriptionState=e,this.broadcastEventToListeners("_subscriptionStateChanged",e)}},{key:"close",value:function(){this._unsubscribe(),this.removalHandler!=null&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(e){var n=e.listenerUuid,i=this._attachedListeners.get(n);i||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(n,e))}},{key:"detach",value:function(e){this._attachedListeners.delete(e),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(e,n){var i=u_e(this._attachedListeners.values()),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;o.emit(e,n)}}catch(s){i.e(s)}finally{i.f()}}}]),t}(),yA=function(){function t(r){qt.default(this,t),lr.default(this,"queuedRequests",[]),lr.default(this,"isRequestInFlight",!1),this.inputMergingFunction=r}return nr.default(t,[{key:"add",value:function(e,n){var i=this,a=new Promise(function(o,s){return i.queuedRequests.push({input:e,requestFunction:n,resolve:o,reject:s})});return this.wakeupQueue(),a}},{key:"squashAndAdd",value:function(e,n){var i=this.queuedRequests;this.queuedRequests=[];var a;i.length>0?(a=i.map(function(s){return s.input}).reduce(this.inputMergingFunction),a=this.inputMergingFunction(a,e)):a=e;var o=this.add(a,n);return i.forEach(function(s){return o.then(s.resolve,s.reject)}),o}},{key:"isEmpty",value:function(){return this.queuedRequests.length===0&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var e=this;if(!(this.queuedRequests.length===0||this.isRequestInFlight)){var n=this.queuedRequests.shift();this.isRequestInFlight=!0,n.requestFunction(n.input).then(n.resolve,n.reject).then(function(i){e.isRequestInFlight=!1,e.wakeupQueue()})}}}]),t}(),bA=function(){function t(r){qt.default(this,t),lr.default(this,"queueByNamespaceKey",new Map),this.inputReducer=r}return nr.default(t,[{key:"add",value:function(){var r=ze.default(le.default.mark(function n(i,a,o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.invokeQueueMethod(i,function(l){return l.add(a,o)}));case 1:case"end":return u.stop()}},n,this)}));function e(n,i,a){return r.apply(this,arguments)}return e}()},{key:"squashAndAdd",value:function(){var r=ze.default(le.default.mark(function n(i,a,o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.invokeQueueMethod(i,function(l){return l.squashAndAdd(a,o)}));case 1:case"end":return u.stop()}},n,this)}));function e(n,i,a){return r.apply(this,arguments)}return e}()},{key:"invokeQueueMethod",value:function(){var r=ze.default(le.default.mark(function n(i,a){var o,s;return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.queueByNamespaceKey.has(i)||this.queueByNamespaceKey.set(i,new yA(this.inputReducer)),o=this.queueByNamespaceKey.get(i),s=a(o),this.queueByNamespaceKey.get(i).isEmpty()&&this.queueByNamespaceKey.delete(i),l.abrupt("return",s);case 5:case"end":return l.stop()}},n,this)}));function e(n,i){return r.apply(this,arguments)}return e}()}]),t}();function c_e(t){var r=f_e();return function(){var n=Dr.default(t),i;if(r){var a=Dr.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fo.default(this,i)}}function f_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var wc=function(t){dn.default(e,t);var r=c_e(e);function e(){var n;return qt.default(this,e),n=r.call(this),n.closed=!1,n.uuid=aA.v4(),n}return nr.default(e,[{key:"listenerUuid",get:function(){return this.uuid}},{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}}]),e}(cr);function _A(t){var r=d_e();return function(){var n=Dr.default(t),i;if(r){var a=Dr.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fo.default(this,i)}}function d_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var D_=function(t){dn.default(e,t);var r=_A(e);function e(n,i,a){var o;qt.default(this,e),o=r.call(this,n,a),lr.default($i.default(o),"isDeleted",!1);var s=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return o.updateMergingQueue=new yA(s),o.descriptor=i,o.descriptor.data=o.descriptor.data||{},o.descriptor.date_updated=new Date(o.descriptor.date_updated),o}return nr.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"_update",value:function(i){switch(i.date_created=new Date(i.date_created),i.type){case"document_updated":if(i.id<=this.lastEventId){Kt.trace("Document update skipped, current:",this.lastEventId,", remote:",i.id);break}var a=this.descriptor.data!==void 0?vi(this.descriptor.data):null;this.descriptor.last_event_id=i.id,this.descriptor.revision=i.document_revision,this.descriptor.date_updated=i.date_created,this.descriptor.data=i.document_data,this.broadcastEventToListeners("updated",{data:i.document_data,isLocal:!1,previousData:a}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:i.id,revision:i.document_revision,date_updated:i.date_created,data:i.document_data});break;case"document_removed":this.onRemoved(!1);break}}},{key:"set",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u=this,l;return le.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return l=s||{},f.abrupt("return",this.updateMergingQueue.squashAndAdd(l,function(d){return u._setUnconditionally(o,d.ttl)}));case 2:case"end":return f.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u=this,l;return le.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return l=s||{},f.abrupt("return",this.updateMergingQueue.add(l,function(d){return u._setWithIfMatch(o,d.ttl)}));case 2:case"end":return f.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=ze.default(le.default.mark(function a(o,s){return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.mutate(function(c){return Object.assign(c,o)},s));case 1:case"end":return l.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=ze.default(le.default.mark(function a(o){var s;return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._postUpdateToServer({ttl:o});case 2:s=l.sent,this.descriptor.date_expires=s.date_expires;case 4:case"end":return l.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_setUnconditionally",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u;return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._postUpdateToServer({data:o,revision:void 0,ttl:s});case 2:return u=c.sent,this._handleSuccessfulUpdateResult(u),c.abrupt("return",this.descriptor.data);case 5:case"end":return c.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"_setWithIfMatch",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u,l,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(u=o(vi(this.descriptor.data)),!u){d.next=22;break}return l=this.revision,d.prev=3,d.next=6,this._postUpdateToServer({data:u,revision:l,ttl:s});case 6:return c=d.sent,this._handleSuccessfulUpdateResult(c),d.abrupt("return",this.descriptor.data);case 11:if(d.prev=11,d.t0=d.catch(3),d.t0.status!==412){d.next=19;break}return d.next=16,this._softSync();case 16:return d.abrupt("return",this._setWithIfMatch(o));case 19:throw d.t0;case 20:d.next=23;break;case 22:return d.abrupt("return",this.descriptor.data);case 23:case"end":return d.stop()}},a,this,[[3,11]])}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"_handleSuccessfulUpdateResult",value:function(i){if(!(i.last_event_id<=this.descriptor.last_event_id)){var a=this.descriptor.data!==void 0?vi(this.descriptor.data):null;this.descriptor.revision=i.revision,this.descriptor.data=i.data,this.descriptor.last_event_id=i.last_event_id,this.descriptor.date_expires=i.date_expires,this.descriptor.date_updated=new Date(i.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:i.last_event_id,revision:i.revision,date_updated:i.date_updated,data:i.data}),this.broadcastEventToListeners("updated",{data:this.descriptor.data,isLocal:!0,previousData:a})}}},{key:"_postUpdateToServer",value:function(){var n=ze.default(le.default.mark(function a(o){var s,u,l;return le.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.isDeleted){f.next=17;break}return s={data:o.data},o.ttl!==void 0&&(s.ttl=o.ttl),u=o.revision,f.prev=4,f.next=7,this.services.network.post(this.uri,s,u);case 7:return l=f.sent,f.abrupt("return",{revision:l.body.revision,data:o.data,last_event_id:l.body.last_event_id,date_updated:l.body.date_updated,date_expires:l.body.date_expires});case 11:throw f.prev=11,f.t0=f.catch(4),f.t0.status===404&&this.onRemoved(!1),f.t0;case 15:f.next=18;break;case 17:return f.abrupt("return",Promise.reject(new Sn("The Document has been removed",404,54100)));case 18:case"end":return f.stop()}},a,this,[[4,11]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_softSync",value:function(){var n=ze.default(le.default.mark(function a(){var o=this;return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.services.network.get(this.uri).then(function(l){var c={type:"document_updated",id:l.body.last_event_id,document_revision:l.body.revision,document_data:l.body.data,date_created:l.body.date_updated};return o._update(c),o}).catch(function(l){l.status===404?o.onRemoved(!1):Kt.error("Can't get updates for ".concat(o.sid,":"),l)}));case 1:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"onRemoved",value:function(i){if(!this.isDeleted){var a=this.descriptor.data!==void 0?vi(this.descriptor.data):null;this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i,previousData:a})}}},{key:"removeDocument",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.isDeleted){s.next=6;break}return s.next=3,this.services.network.delete(this.uri);case 3:this.onRemoved(!0),s.next=7;break;case 6:return s.abrupt("return",Promise.reject(new Sn("The Document has been removed",404,54100)));case 7:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}],[{key:"type",get:function(){return"document"}}]),e}(_c),Yn=function(t){dn.default(e,t);var r=_A(e);function e(n){var i;return qt.default(this,e),i=r.call(this),i.syncDocumentImpl=n,i.syncDocumentImpl.attach($i.default(i)),i}return nr.default(e,[{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return D_.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"data",get:function(){return this.syncDocumentImpl.data}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}},{key:"set",value:function(){var n=ze.default(le.default.mark(function a(o,s){return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.set(o,s));case 2:case"end":return l.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=ze.default(le.default.mark(function a(o,s){return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.mutate(o,s));case 2:case"end":return l.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=ze.default(le.default.mark(function a(o,s){return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.update(o,s));case 2:case"end":return l.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncDocumentImpl.setTtl(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeDocument",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.ensureNotClosed(),s.abrupt("return",this.syncDocumentImpl.removeDocument());case 2:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){hc.default(Dr.default(e.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return D_.type}}]),e}(wc);lr.default(Yn,"removed","removed"),lr.default(Yn,"updated","updated"),Yt([xe.validateTypesAsync(xe.pureObject,["undefined",xe.objectSchema("document metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[Object,Object]),je("design:returntype",Promise)],Yn.prototype,"set",null),Yt([xe.validateTypesAsync("function",["undefined",xe.objectSchema("document metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[Function,Object]),je("design:returntype",Promise)],Yn.prototype,"mutate",null),Yt([xe.validateTypesAsync(xe.pureObject,["undefined",xe.objectSchema("document metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[Object,Object]),je("design:returntype",Promise)],Yn.prototype,"update",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger),je("design:type",Function),je("design:paramtypes",[Number]),je("design:returntype",Promise)],Yn.prototype,"setTtl",null);var L_=function(){function t(r){qt.default(this,t),this.descriptor=r}return nr.default(t,[{key:"uri",get:function(){return this.descriptor.uri}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.lastEventId}},{key:"dateUpdated",get:function(){return this.descriptor.dateUpdated}},{key:"dateExpires",get:function(){return this.descriptor.dateExpires}},{key:"index",get:function(){return this.descriptor.index}},{key:"data",get:function(){return this.descriptor.data}},{key:"update",value:function(e,n,i,a){return this.descriptor.lastEventId=e,this.descriptor.revision=n,this.descriptor.data=i,this.descriptor.dateUpdated=a,this}},{key:"updateDateExpires",value:function(e){this.descriptor.dateExpires=e}}]),t}(),U_=function(){function t(r,e,n,i){qt.default(this,t),this.prevToken=n,this.nextToken=i,this.items=r,this.source=e}return nr.default(t,[{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}},{key:"nextPage",value:function(){var r=ze.default(le.default.mark(function n(){return le.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.hasNextPage){a.next=2;break}throw new Error("No next page");case 2:return a.abrupt("return",this.source(this.nextToken));case 3:case"end":return a.stop()}},n,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"prevPage",value:function(){var r=ze.default(le.default.mark(function n(){return le.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.hasPrevPage){a.next=2;break}throw new Error("No previous page");case 2:return a.abrupt("return",this.source(this.prevToken));case 3:case"end":return a.stop()}},n,this)}));function e(){return r.apply(this,arguments)}return e}()}]),t}();function p_e(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=v_e(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function v_e(t,r){if(t){if(typeof t=="string")return wA(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return wA(t,r)}}function wA(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var h_e=function(){function t(r,e){qt.default(this,t),this.balanceFactor=0,this.key=r,this.value=e,this.parent=null,this.left=null,this.right=null}return nr.default(t,[{key:"isRoot",get:function(){return this.parent===null}},{key:"isLeaf",get:function(){return this.left===null&&this.right===null}},{key:"isLeftChild",get:function(){return this.parent.left===this}},{key:"update",value:function(e){this.value=e}},{key:"replace",value:function(e,n){e&&(this.left===n?this.left=n:this.right===n&&(this.right=n))}}]),t}(),m_e=function(){function t(r,e){qt.default(this,t),this.isLessThan=r||function(n,i){return n<i},this.isEqual=e||function(n,i){return n===i},this.root=null,this.count=null}return nr.default(t,[{key:"size",get:function(){return this.count}},{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(e,n){var i=this.getNode(e);i?i.update(n):this.insert(e,n)}},{key:"insert",value:function(e,n){var i=new h_e(e,n);if(this.count++,!this.root){this.root=i;return}for(var a=this.root;;)if(this.isLessThan(e,a.key))if(a.left)a=a.left;else{a.left=i;break}else if(a.right)a=a.right;else{a.right=i;break}for(i.parent=a,a=i;a.parent;){var o=a.parent,s=o.balanceFactor;if(a.isLeftChild?o.balanceFactor++:o.balanceFactor--,Math.abs(o.balanceFactor)<Math.abs(s))break;if(o.balanceFactor<-1||o.balanceFactor>1){this.rebalance(o);break}a=o}}},{key:"get",value:function(e){for(var n=this.root;n;){if(this.isEqual(e,n.key))return n.value;this.isLessThan(e,n.key)?n=n.left:n=n.right}return null}},{key:"delete",value:function(e){var n=this.getNode(e);if(!n||n.key!==e)return null;var i=n.parent,a=n.left,o=n.right;if(!!a!=!!o){var s=a||o;!i&&!s?this.root=null:i&&!s?this.root=s:(i.replace(n,null),this.rebalance(i))}else{for(var u=n.left;u.right;)u=u.right;if(n.left===u)n.isRoot?(this.root=u,u.parent=null):(n.isLeftChild?n.parent.left=u:n.parent.right=u,u.parent=n.parent),u.right=n.right,u.right.parent=u,u.balanceFactor=n.balanceFactor,n={parent:u,isLeftChild:!0};else{var l=u.parent,c=u.left;l.right=c,c&&(c.parent=l),n.isRoot?(this.root=u,u.parent=null):(n.isLeftChild?n.parent.left=u:n.parent.right=u,u.parent=n.parent),u.right=n.right,u.right.parent=u,u.left=n.left,u.left.parent=u,u.balanceFactor=n.balanceFactor,n={parent:l,isLeftChild:!1}}}for(this.count--;n.parent;){var f=n.parent,d=f.balanceFactor;if(n.isLeftChild?f.balanceFactor-=1:f.balanceFactor+=1,Math.abs(f.balanceFactor)>Math.abs(d))if(f.balanceFactor<-1||f.balanceFactor>1)if(this.rebalance(f),f.parent.balanceFactor===0)n=f.parent;else break;else break;else n=f}return null}},{key:"getNode",value:function(e){for(var n=this.root;n;){if(this.isEqual(e,n.key))return n;this.isLessThan(e,n.key)?n=n.left:n=n.right}return null}},{key:"rebalance",value:function(e){e.balanceFactor<0?e.right.balanceFactor>0?(this.rotateRight(e.right),this.rotateLeft(e)):this.rotateLeft(e):e.balanceFactor>0&&(e.left.balanceFactor<0?(this.rotateLeft(e.left),this.rotateRight(e)):this.rotateRight(e))}},{key:"rotateLeft",value:function(e){var n=e.right;e.right=n.left,n.left!==null&&(n.left.parent=e),n.parent=e.parent,n.parent===null?this.root=n:e.isLeftChild?n.parent.left=n:n.parent.right=n,n.left=e,e.parent=n,e.balanceFactor=e.balanceFactor+1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor+1-Math.max(e.balanceFactor,0)}},{key:"rotateRight",value:function(e){var n=e.left;e.left=n.right,n.right!==null&&(n.right.parent=e),n.parent=e.parent,n.parent===null?this.root=n:e.isLeftChild?n.parent.left=n:n.parent.right=n,n.right=e,e.parent=n,e.balanceFactor=e.balanceFactor-1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor-1-Math.max(e.balanceFactor,0)}},{key:Symbol.iterator,value:le.default.mark(function r(){var e,n,i;return le.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e=p_e(this.getIterator()),o.prev=1,e.s();case 3:if((n=e.n()).done){o.next=9;break}return i=n.value,o.next=7,i;case 7:o.next=3;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(1),e.e(o.t0);case 14:return o.prev=14,e.f(),o.finish(14);case 17:case"end":return o.stop()}},r,this,[[1,11,14,17]])})},{key:"getIterator",value:le.default.mark(function r(){var e,n,i,a=arguments;return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e=a.length>0&&a[0]!==void 0?a[0]:null,n=this.root;case 2:if(!n){s.next=8;break}if(!(this.isEqual(e,n.key)||e===null&&!n.left)){s.next=5;break}return s.abrupt("break",8);case 5:this.isLessThan(e,n.key)||e===null?n=n.left:n=n.right,s.next=2;break;case 8:if(n){s.next=10;break}return s.abrupt("return",null);case 10:i=!0;case 11:if(!i){s.next=29;break}return s.next=14,[n.key,n.value];case 14:if(i=!1,!n.right){s.next=21;break}for(n=n.right;n.left;)n=n.left;i=!0,s.next=27;break;case 21:if(!n.parent){s.next=26;break}i=n.parent.left===n,n=n.parent,s.next=27;break;case 26:return s.abrupt("break",37);case 27:s.next=35;break;case 29:if(!n.parent){s.next=34;break}i=n.parent.left===n,n=n.parent,s.next=35;break;case 34:return s.abrupt("break",37);case 35:s.next=11;break;case 37:return s.abrupt("return",null);case 38:case"end":return s.stop()}},r,this)})},{key:"getReverseIterator",value:le.default.mark(function r(){var e,n,i,a=arguments;return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e=a.length>0&&a[0]!==void 0?a[0]:null,n=this.root;case 2:if(!n){s.next=8;break}if(!(this.isEqual(e,n.key)||e===null&&!n.right)){s.next=5;break}return s.abrupt("break",8);case 5:!this.isLessThan(e,n.key)||e===null?n=n.right:n=n.left,s.next=2;break;case 8:if(n){s.next=10;break}return s.abrupt("return",null);case 10:i=!0;case 11:if(!i){s.next=29;break}return s.next=14,[n.key,n.value];case 14:if(i=!1,!n.left){s.next=21;break}for(n=n.left;n.right;)n=n.right;i=!0,s.next=27;break;case 21:if(!n.parent){s.next=26;break}i=n.parent.right===n,n=n.parent,s.next=27;break;case 26:return s.abrupt("break",37);case 27:s.next=35;break;case 29:if(!n.parent){s.next=34;break}i=n.parent.right===n,n=n.parent,s.next=35;break;case 34:return s.abrupt("break",37);case 35:s.next=11;break;case 37:return s.abrupt("return",null);case 38:case"end":return s.stop()}},r,this)})}]),t}();function g_e(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=y_e(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function y_e(t,r){if(t){if(typeof t=="string")return kA(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return kA(t,r)}}function kA(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var b_e=function(){function t(r,e){qt.default(this,t),this.value=r,this.revision=e||0}return nr.default(t,[{key:"isValid",get:function(){return!0}}]),t}(),__e=function(){function t(r){qt.default(this,t),this.revision=r}return nr.default(t,[{key:"isValid",get:function(){return!1}}]),t}(),j_=function(){function t(){qt.default(this,t),this.items=new m_e}return nr.default(t,[{key:"store",value:function(e,n,i){var a=this.items.get(e);return a&&a.revision>i?a.isValid?a.value:null:(this.items.set(e,new b_e(n,i)),n)}},{key:"delete",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.items.get(e);(!a||a.revision<n||a&&i===!0)&&this.items.set(e,new __e(n))}},{key:"isKnown",value:function(e,n){var i=this.items.get(e);return i&&i.revision>=n}},{key:"get",value:function(e){var n=this.items.get(e);return n&&n.isValid?n.value:null}},{key:"has",value:function(e){var n=this.items.get(e);return n&&n.isValid}},{key:"forEach",value:function(e){if(this.items){var n=g_e(this.items),i;try{for(n.s();!(i=n.n()).done;){var a=sA.default(i.value,2),o=a[0],s=a[1];s.isValid&&e(o,s.value)}}catch(u){n.e(u)}finally{n.f()}}}}]),t}();function TA(t){var r=w_e();return function(){var n=Dr.default(t),i;if(r){var a=Dr.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fo.default(this,i)}}function w_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var V_=function(t){dn.default(e,t);var r=TA(e);function e(n,i,a){var o;qt.default(this,e),o=r.call(this,n,a);var s=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return o.updateMergingQueue=new bA(s),o.cache=new j_,o.descriptor=i,o.descriptor.date_updated=new Date(o.descriptor.date_updated),o}return nr.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"_addOrUpdateItemOnServer",value:function(){var n=ze.default(le.default.mark(function a(o,s,u,l){var c,f;return le.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return c={data:s},l!==void 0&&(c.ttl=l),v.next=4,this.services.network.post(o,c,u);case 4:return f=v.sent,f.body.data=s,f.body.date_updated=new Date(f.body.date_updated),v.abrupt("return",f.body);case 8:case"end":return v.stop()}},a,this)}));function i(a,o,s,u){return n.apply(this,arguments)}return i}()},{key:"push",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u,l,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return u=(s||{}).ttl,d.next=3,this._addOrUpdateItemOnServer(this.links.items,o,void 0,u);case 3:return l=d.sent,c=Number(l.index),this._handleItemMutated(c,l.url,l.last_event_id,l.revision,o,l.date_updated,l.date_expires,!0,!1),d.abrupt("return",this.cache.get(c));case 7:case"end":return d.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"set",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){var l=this,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=u||{},d.abrupt("return",this.updateMergingQueue.squashAndAdd(o,c,function(v){return l._updateItemUnconditionally(o,s,v.ttl)}));case 2:case"end":return d.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"_updateItemUnconditionally",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){var l,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.get(o);case 2:return l=d.sent,d.next=5,this._addOrUpdateItemOnServer(l.uri,s,void 0,u);case 5:return c=d.sent,this._handleItemMutated(o,c.url,c.last_event_id,c.revision,c.data,c.date_updated,c.date_expires,!1,!1),d.abrupt("return",this.cache.get(o));case 8:case"end":return d.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"_updateItemWithIfMatch",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){var l,c,f,d;return le.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.get(o);case 2:if(l=p.sent,c=s(vi(l.data)),!c){p.next=25;break}return f=l.revision,p.prev=6,p.next=9,this._addOrUpdateItemOnServer(l.uri,c,f,u);case 9:return d=p.sent,this._handleItemMutated(o,d.url,d.last_event_id,d.revision,d.data,d.date_updated,d.date_expires,!1,!1),p.abrupt("return",this.cache.get(o));case 14:if(p.prev=14,p.t0=p.catch(6),p.t0.status!==412){p.next=22;break}return p.next=19,this._getItemFromServer(o);case 19:return p.abrupt("return",this._updateItemWithIfMatch(o,s,u));case 22:throw p.t0;case 23:p.next=26;break;case 25:return p.abrupt("return",l);case 26:case"end":return p.stop()}},a,this,[[6,14]])}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){var l=this,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=u||{},d.abrupt("return",this.updateMergingQueue.add(o,c,function(v){return l._updateItemWithIfMatch(o,s,v.ttl)}));case 2:case"end":return d.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(o,function(f){return Object.assign(f,s)},u));case 1:case"end":return c.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=ze.default(le.default.mark(function a(o){var s,u,l;return le.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.get(o);case 2:return s=f.sent,u=vi(s.data),f.next=6,this.services.network.delete(s.uri);case 6:l=f.sent,this._handleItemRemoved(o,l.body.last_event_id,u,new Date(l.body.date_updated),!1);case 8:case"end":return f.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=ze.default(le.default.mark(function a(o){var s;return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(s=this.cache.get(o),!s){l.next=5;break}return l.abrupt("return",s);case 5:return l.abrupt("return",this._getItemFromServer(o));case 6:case"end":return l.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getItemFromServer",value:function(){var n=ze.default(le.default.mark(function a(o){var s;return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.queryItems({index:o});case 2:if(s=l.sent,!(s.items.length<1)){l.next=7;break}throw new Sn("No item with index ".concat(o," found"),404,54151);case 7:return l.abrupt("return",s.items[0]);case 8:case"end":return l.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"queryItems",value:function(){var n=ze.default(le.default.mark(function a(o){var s=this,u,l,c,f;return le.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=o||{},u=new ku(this.links.items).queryParam("From",o.from).queryParam("PageSize",o.limit).queryParam("Index",o.index).queryParam("PageToken",o.pageToken).queryParam("Order",o.order).build(),v.next=4,this.services.network.get(u);case 4:return l=v.sent,c=l.body.items.map(function(p){p.date_updated=new Date(p.date_updated);var y=s.cache.get(p.index);return y?s._handleItemMutated(p.index,p.url,p.last_event_id,p.revision,p.data,p.date_updated,p.date_expires,!1,!0):s.cache.store(Number(p.index),new L_({index:Number(p.index),uri:p.url,revision:p.revision,lastEventId:p.last_event_id,dateUpdated:p.date_updated,dateExpires:p.date_expires,data:p.data}),p.last_event_id),s.cache.get(p.index)}),f=l.body.meta,v.abrupt("return",new U_(c,function(p){return s.queryItems({pageToken:p})},f.previous_token,f.next_token));case 8:case"end":return v.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o=o||{},pA(o.pageSize),o.limit=o.pageSize||o.limit||50,o.order=o.order||"asc",u.abrupt("return",this.queryItems(o));case 5:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getContext",value:function(){var n=ze.default(le.default.mark(function a(){var o;return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.context){u.next=5;break}return u.next=3,this.services.network.get(this.links.context);case 3:o=u.sent,this._updateContextIfRequired(o.body.data,o.body.last_event_id);case 5:return u.abrupt("return",this.context);case 6:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=ze.default(le.default.mark(function a(o){var s,u;return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,s={ttl:o},c.next=4,this.services.network.post(this.uri,s);case 4:u=c.sent,this.descriptor.date_expires=u.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u,l,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.get(o);case 2:return u=d.sent,l={ttl:s},d.next=6,this.services.network.post(u.uri,l);case 6:c=d.sent,u.updateDateExpires(c.body.date_expires);case 8:case"end":return d.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"removeList",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}},{key:"shouldIgnoreEvent",value:function(i,a){return this.cache.isKnown(i,a)}},{key:"_update",value:function(i,a){var o=Number(i.item_index);switch(i.date_created=new Date(i.date_created),i.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(o,i.item_url,i.id,i.item_revision,i.item_data,i.date_created,void 0,i.type==="list_item_added",!0);break;case"list_item_removed":this._handleItemRemoved(o,i.id,i.item_data,i.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(i.context_data,i.id,i.date_created);break;case"list_removed":this.onRemoved(!1);break}a&&this._advanceLastEventId(i.id,i.list_revision)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i,a&&(this.descriptor.revision=a))}},{key:"_updateRootDateUpdated",value:function(i){(!this.descriptor.date_updated||i.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=i,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:i}))}},{key:"_handleItemMutated",value:function(i,a,o,s,u,l,c,f,d){if(this.shouldIgnoreEvent(i,o)){Kt.trace("Item ".concat(i," update skipped, current: ").concat(this.lastEventId,", remote: ").concat(o));return}this._updateRootDateUpdated(l);var v=this.cache.get(i);if(!v){var p=new L_({index:i,uri:a,lastEventId:o,revision:s,data:u,dateUpdated:l,dateExpires:c});this.cache.store(i,p,o),this.emitItemMutationEvent(p,d,f);return}var y=vi(v.data);v.update(o,s,u,l),this.cache.store(i,v,o),c!==void 0&&v.updateDateExpires(c),this.emitItemMutationEvent(v,d,!1,y)}},{key:"emitItemMutationEvent",value:function(i,a,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=o?"itemAdded":"itemUpdated",l={item:i,isLocal:!a};o||(l.previousItemData=s),this.broadcastEventToListeners(u,l)}},{key:"_handleItemRemoved",value:function(i,a,o,s,u){this._updateRootDateUpdated(s),this.cache.delete(i,a),this.broadcastEventToListeners("itemRemoved",{index:i,isLocal:!u,previousItemData:o})}},{key:"_handleContextUpdate",value:function(i,a,o){this._updateRootDateUpdated(o),this._updateContextIfRequired(i,a)&&this.broadcastEventToListeners("contextUpdated",{context:i,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(i,a){return!this.contextEventId||a>this.contextEventId?(this.context=i,this.contextEventId=a,!0):(Kt.trace("Context update skipped, current:",this.lastEventId,", remote:",a),!1)}}],[{key:"type",get:function(){return"list"}}]),e}(_c),Lr=function(t){dn.default(e,t);var r=TA(e);function e(n){var i;return qt.default(this,e),i=r.call(this),i.syncListImpl=n,i.syncListImpl.attach($i.default(i)),i}return nr.default(e,[{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return V_.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}},{key:"push",value:function(){var n=ze.default(le.default.mark(function a(o,s){return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncListImpl.push(o,s));case 2:case"end":return l.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"set",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.set(o,s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.mutate(o,s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.update(o,s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.remove(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.get(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getContext",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.ensureNotClosed(),s.abrupt("return",this.syncListImpl.getContext());case 2:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.getItems(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.setTtl(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=ze.default(le.default.mark(function a(o,s){return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncListImpl.setItemTtl(o,s));case 2:case"end":return l.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"removeList",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.ensureNotClosed(),s.abrupt("return",this.syncListImpl.removeList());case 2:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){hc.default(Dr.default(e.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return V_.type}}]),e}(wc);lr.default(Lr,"itemAdded","itemAdded"),lr.default(Lr,"itemUpdated","itemUpdated"),lr.default(Lr,"itemRemoved","itemRemoved"),lr.default(Lr,"removed","removed"),Yt([xe.validateTypesAsync(xe.pureObject,["undefined",xe.objectSchema("item metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[Object,Object]),je("design:returntype",Promise)],Lr.prototype,"push",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger,xe.pureObject,["undefined",xe.objectSchema("item metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[Number,Object,Object]),je("design:returntype",Promise)],Lr.prototype,"set",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger,"function",["undefined",xe.objectSchema("item metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[Number,Function,Object]),je("design:returntype",Promise)],Lr.prototype,"mutate",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger,xe.pureObject,["undefined",xe.objectSchema("item metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[Number,Object,Object]),je("design:returntype",Promise)],Lr.prototype,"update",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger),je("design:type",Function),je("design:paramtypes",[Number]),je("design:returntype",Promise)],Lr.prototype,"remove",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger),je("design:type",Function),je("design:paramtypes",[Number]),je("design:returntype",Promise)],Lr.prototype,"get",null),Yt([xe.validateTypesAsync(["undefined",xe.objectSchema("query options",{from:[xe.nonNegativeInteger,"undefined"],pageSize:[xe.custom(function(t){return[x_(t),"a positive integer"]}),"undefined"]})]),je("design:type",Function),je("design:paramtypes",[Object]),je("design:returntype",Promise)],Lr.prototype,"getItems",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger),je("design:type",Function),je("design:paramtypes",[Number]),je("design:returntype",Promise)],Lr.prototype,"setTtl",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger,xe.nonNegativeInteger),je("design:type",Function),je("design:paramtypes",[Number,Number]),je("design:returntype",Promise)],Lr.prototype,"setItemTtl",null);var kc=function(){function t(r){qt.default(this,t),this.descriptor=r}return nr.default(t,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"update",value:function(e,n,i,a){return this.descriptor.last_event_id=e,this.descriptor.revision=n,this.descriptor.data=i,this.descriptor.date_updated=a,this}},{key:"updateDateExpires",value:function(e){this.descriptor.date_expires=e}}]),t}();function SA(t){var r=k_e();return function(){var n=Dr.default(t),i;if(r){var a=Dr.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fo.default(this,i)}}function k_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var F_=function(t){dn.default(e,t);var r=SA(e);function e(n,i,a){var o;qt.default(this,e),o=r.call(this,n,a);var s=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return o.updateMergingQueue=new bA(s),o.cache=new j_,o.descriptor=i,o.descriptor.date_updated=new Date(o.descriptor.date_updated),i.items&&i.items.forEach(function(u){u.date_updated=new Date(u.date_updated),o.cache.store(u.key,new kc(u),u.last_event_id)}),o}return nr.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"set",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){var l=this,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=u||{},d.abrupt("return",this.updateMergingQueue.squashAndAdd(o,c,function(v){return l._putItemUnconditionally(o,s,v.ttl)}));case 2:case"end":return d.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(o!=null){u.next=2;break}throw new Sn("SyncMapItem key may not be empty",400,54209);case 2:if(!this.cache.has(o)){u.next=6;break}return u.abrupt("return",this.cache.get(o));case 6:return u.abrupt("return",this._getItemFromServer(o));case 7:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getItemFromServer",value:function(){var n=ze.default(le.default.mark(function a(o){var s;return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.queryItems({key:o});case 2:if(s=l.sent,!(s.items.length<1)){l.next=7;break}throw new Sn("The specified Map Item does not exist",404,54201);case 7:return l.abrupt("return",s.items[0]);case 8:case"end":return l.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){var l=this,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=u||{},d.abrupt("return",this.updateMergingQueue.add(o,c,function(v){return l._putItemWithIfMatch(o,s,v.ttl)}));case 2:case"end":return d.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(o,function(f){return Object.assign(f,s)},u));case 1:case"end":return c.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"_putItemUnconditionally",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){var l,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this._putItemToServer(o,s,void 0,u);case 2:return l=d.sent,c=l.item,this._handleItemMutated(c.key,c.url,c.last_event_id,c.revision,c.data,c.date_updated,c.date_expires,l.added,!1),d.abrupt("return",this.cache.get(c.key));case 6:case"end":return d.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"_putItemWithIfMatch",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){var l,c,f,d,v;return le.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.get(o).catch(function(k){if(k.status===404)return new kc({key:o,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw k});case 2:if(l=y.sent,c=s(vi(l.data)),!c){y.next=26;break}return f=l.revision,y.prev=6,y.next=9,this._putItemToServer(o,c,f,u);case 9:return d=y.sent,v=d.item,this._handleItemMutated(v.key,v.url,v.last_event_id,v.revision,v.data,v.date_updated,v.date_expires,d.added,!1),y.abrupt("return",this.cache.get(v.key));case 15:if(y.prev=15,y.t0=y.catch(6),y.t0.status!==412){y.next=23;break}return y.next=20,this._getItemFromServer(o);case 20:return y.abrupt("return",this._putItemWithIfMatch(o,s,u));case 23:throw y.t0;case 24:y.next=27;break;case 26:return y.abrupt("return",l);case 27:case"end":return y.stop()}},a,this,[[6,15]])}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"_putItemToServer",value:function(){var n=ze.default(le.default.mark(function a(o,s,u,l){var c,f,d,v,p;return le.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return c=new ku(this.links.items).pathSegment(o).build(),f={data:s},l!==void 0&&(f.ttl=l),k.prev=3,k.next=6,this.services.network.put(c,f,u);case 6:return d=k.sent,v=d.body,v.data=s,v.date_updated=new Date(v.date_updated),p=d.status.code===201,k.abrupt("return",{added:p,item:v});case 14:throw k.prev=14,k.t0=k.catch(3),k.t0.status===404&&this.onRemoved(!1),k.t0;case 18:case"end":return k.stop()}},a,this,[[3,14]])}));function i(a,o,s,u){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=ze.default(le.default.mark(function a(o){var s,u,l;return le.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.get(o);case 2:return s=f.sent,u=vi(s.data),f.next=6,this.services.network.delete(s.uri);case 6:l=f.sent,this._handleItemRemoved(o,l.body.last_event_id,u,new Date(l.body.date_updated),!1);case 8:case"end":return f.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"queryItems",value:function(){var n=ze.default(le.default.mark(function a(o){var s=this,u,l,c,f;return le.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=o||{},u=new ku(this.links.items).queryParam("From",o.from).queryParam("PageSize",o.limit).queryParam("Key",o.key).queryParam("PageToken",o.pageToken).queryParam("Order",o.order).build(),v.next=4,this.services.network.get(u);case 4:return l=v.sent,c=l.body.items.map(function(p){p.date_updated=new Date(p.date_updated);var y=s.cache.get(p.key);return y?s._handleItemMutated(p.key,p.url,p.last_event_id,p.revision,p.data,p.date_updated,p.date_expires,!1,!0):s.cache.store(p.key,new kc(p),p.last_event_id),s.cache.get(p.key)}),f=l.body.meta,v.abrupt("return",new U_(c,function(p){return s.queryItems({pageToken:p})},f.previous_token,f.next_token));case 8:case"end":return v.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o=o||{},pA(o.pageSize),o.limit=o.pageSize||o.limit||50,o.order=o.order||"asc",u.abrupt("return",this.queryItems(o));case 5:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"shouldIgnoreEvent",value:function(i,a){return this.cache.isKnown(i,a)}},{key:"_update",value:function(i,a){switch(i.date_created=new Date(i.date_created),i.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(i.item_key,i.item_url,i.id,i.item_revision,i.item_data,i.date_created,void 0,i.type==="map_item_added",!0);break;case"map_item_removed":this._handleItemRemoved(i.item_key,i.id,i.item_data,i.date_created,!0);break;case"map_removed":this.onRemoved(!1);break}a&&this._advanceLastEventId(i.id,i.map_revision)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i,a&&(this.descriptor.revision=a))}},{key:"_updateRootDateUpdated",value:function(i){(!this.descriptor.date_updated||i.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=i,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:i}))}},{key:"_handleItemMutated",value:function(i,a,o,s,u,l,c,f,d){if(this.shouldIgnoreEvent(i,o)){Kt.trace("SyncMapItem ",i," update skipped, current:",this.lastEventId,", remote:",o);return}this._updateRootDateUpdated(l);var v=this.cache.get(i);if(!v){var p=new kc({key:i,url:a,last_event_id:o,revision:s,data:u,date_updated:l,date_expires:c});this.cache.store(i,p,o),this.emitItemMutationEvent(p,d,f);return}var y=vi(v.data);v.update(o,s,u,l),this.cache.store(i,v,o),c!==void 0&&v.updateDateExpires(c),this.emitItemMutationEvent(v,d,!1,y)}},{key:"emitItemMutationEvent",value:function(i,a,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=o?"itemAdded":"itemUpdated",l={item:i,isLocal:!a};o||(l.previousItemData=s),this.broadcastEventToListeners(u,l)}},{key:"_handleItemRemoved",value:function(i,a,o,s,u){this._updateRootDateUpdated(s),this.cache.delete(i,a),this.broadcastEventToListeners("itemRemoved",{key:i,isLocal:!u,previousItemData:o})}},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}},{key:"setTtl",value:function(){var n=ze.default(le.default.mark(function a(o){var s,u;return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,s={ttl:o},c.next=4,this.services.network.post(this.uri,s);case 4:u=c.sent,this.descriptor.date_expires=u.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u,l,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.get(o);case 2:return u=d.sent,l={ttl:s},d.next=6,this.services.network.post(u.uri,l);case 6:c=d.sent,u.updateDateExpires(c.body.date_expires);case 8:case"end":return d.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"removeMap",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}],[{key:"type",get:function(){return"map"}}]),e}(_c),$r=function(t){dn.default(e,t);var r=SA(e);function e(n){var i;return qt.default(this,e),i=r.call(this),i.syncMapImpl=n,i.syncMapImpl.attach($i.default(i)),i}return nr.default(e,[{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return F_.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}},{key:"set",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.set(o,s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.get(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.mutate(o,s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=ze.default(le.default.mark(function a(o,s,u){return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.update(o,s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.remove(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.getItems(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.setTtl(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=ze.default(le.default.mark(function a(o,s){return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncMapImpl.setItemTtl(o,s));case 2:case"end":return l.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"removeMap",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.ensureNotClosed(),s.next=3,this.syncMapImpl.removeMap();case 3:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){hc.default(Dr.default(e.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return F_.type}}]),e}(wc);lr.default($r,"itemAdded","itemAdded"),lr.default($r,"itemUpdated","itemUpdated"),lr.default($r,"itemRemoved","itemRemoved"),lr.default($r,"removed","removed"),Yt([xe.validateTypesAsync("string",xe.pureObject,["undefined",xe.objectSchema("item metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[String,Object,Object]),je("design:returntype",Promise)],$r.prototype,"set",null),Yt([xe.validateTypesAsync("string"),je("design:type",Function),je("design:paramtypes",[String]),je("design:returntype",Promise)],$r.prototype,"get",null),Yt([xe.validateTypesAsync("string","function",["undefined",xe.objectSchema("item metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[String,Function,Object]),je("design:returntype",Promise)],$r.prototype,"mutate",null),Yt([xe.validateTypesAsync("string",xe.pureObject,["undefined",xe.objectSchema("item metadata",{ttl:[xe.nonNegativeInteger,"undefined"]})]),je("design:type",Function),je("design:paramtypes",[String,Object,Object]),je("design:returntype",Promise)],$r.prototype,"update",null),Yt([xe.validateTypesAsync("string"),je("design:type",Function),je("design:paramtypes",[String]),je("design:returntype",Promise)],$r.prototype,"remove",null),Yt([xe.validateTypesAsync(["undefined",xe.objectSchema("query options",{from:["string","undefined"],pageSize:[xe.custom(function(t){return[x_(t),"a positive integer"]}),"undefined"]})]),je("design:type",Function),je("design:paramtypes",[Object]),je("design:returntype",Promise)],$r.prototype,"getItems",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger),je("design:type",Function),je("design:paramtypes",[Number]),je("design:returntype",Promise)],$r.prototype,"setTtl",null),Yt([xe.validateTypesAsync("string",xe.nonNegativeInteger),je("design:type",Function),je("design:paramtypes",[String,Number]),je("design:returntype",Promise)],$r.prototype,"setItemTtl",null);function EA(t){var r=T_e();return function(){var n=Dr.default(t),i;if(r){var a=Dr.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fo.default(this,i)}}function T_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Tc=function(t){dn.default(e,t);var r=EA(e);function e(n,i,a){var o;return qt.default(this,e),o=r.call(this,n,a),o.descriptor=i,o}return nr.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"publishMessage",value:function(){var n=ze.default(le.default.mark(function a(o){var s,u,l,c;return le.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return s={data:o},d.next=3,this.services.network.post(this.links.messages,s);case 3:return u=d.sent,l=u.body,c=this._handleMessagePublished(l.sid,o,!1),d.abrupt("return",c);case 7:case"end":return d.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=ze.default(le.default.mark(function a(o){var s,u;return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,s={ttl:o},c.next=4,this.services.network.post(this.uri,s);case 4:u=c.sent,this.descriptor.date_expires=u.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeStream",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"_update",value:function(i){switch(i.type){case"stream_message_published":{this._handleMessagePublished(i.message_sid,i.message_data,!0);break}case"stream_removed":{this.onRemoved(!1);break}}}},{key:"_handleMessagePublished",value:function(i,a,o){var s={sid:i,data:a};return this.broadcastEventToListeners("messagePublished",{message:s,isLocal:!o}),s}},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}}],[{key:"type",get:function(){return"stream"}}]),e}(_c);Yt([xe.validateTypesAsync(xe.pureObject),je("design:type",Function),je("design:paramtypes",[Object]),je("design:returntype",Promise)],Tc.prototype,"publishMessage",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger),je("design:type",Function),je("design:paramtypes",[Number]),je("design:returntype",Promise)],Tc.prototype,"setTtl",null);var zi=function(t){dn.default(e,t);var r=EA(e);function e(n){var i;return qt.default(this,e),i=r.call(this),i.syncStreamImpl=n,i.syncStreamImpl.attach($i.default(i)),i}return nr.default(e,[{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return Tc.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}},{key:"publishMessage",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.publishMessage(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.setTtl(o));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeStream",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.ensureNotClosed(),s.abrupt("return",this.syncStreamImpl.removeStream());case 2:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){hc.default(Dr.default(e.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Tc.type}}]),e}(wc);lr.default(zi,"messagePublished","messagePublished"),lr.default(zi,"removed","removed"),Yt([xe.validateTypesAsync(xe.pureObject),je("design:type",Function),je("design:paramtypes",[Object]),je("design:returntype",Promise)],zi.prototype,"publishMessage",null),Yt([xe.validateTypesAsync(xe.nonNegativeInteger),je("design:type",Function),je("design:paramtypes",[Number]),je("design:returntype",Promise)],zi.prototype,"setTtl",null);var S_e=function t(r){qt.default(this,t),this.sdk="js",this.sdkVer=r,this.os=Xp.os.family,this.osVer=Xp.os.version,this.pl=Xp.name,this.plVer=Xp.version},E_e=function(){function t(){qt.default(this,t),this.names=new Map,this.entities=new Map}return nr.default(t,[{key:"store",value:function(e){var n=this.entities.get(e.sid);return n||(this.entities.set(e.sid,e),e.uniqueName&&this.names.set(e.type+"::"+e.uniqueName,e.sid),e)}},{key:"getResolved",value:function(e,n){var i=this.names.get(n+"::"+e);return i?this.entities.get(i):null}},{key:"get",value:function(e,n){return this.entities.get(e)||this.getResolved(e,n)||null}},{key:"remove",value:function(e){var n=this.entities.get(e);n&&(this.entities.delete(e),n.uniqueName&&this.names.delete(n.type+"::"+n.uniqueName))}}]),t}();function $_(t){var r=M_e();return function(){var n=Dr.default(t),i;if(r){var a=Dr.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fo.default(this,i)}}function M_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var C_e=function t(){qt.default(this,t)},z_=function(t){dn.default(e,t);var r=$_(e);function e(n,i,a,o){var s;return qt.default(this,e),s=r.call(this,i,a),s.descriptor=n,s.cache=new j_,o&&o.forEach(function(u){s.cache.store(u.key,{key:u.key,value:u.data},u.revision)}),s}return nr.default(e,[{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return e.type}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var i={};return this.cache.forEach(function(a,o){i[a]=o.value}),i}},{key:"_update",value:function(i,a){switch(i.type){case"live_query_item_updated":this.handleItemMutated(i.item_key,i.item_data,i.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(i.item_key,i.item_revision);break;case"live_query_updated":this.handleBatchUpdate(i.items);break}a&&this._advanceLastEventId(i.last_event_id)}},{key:"handleItemMutated",value:function(i,a,o){if(this.shouldIgnoreEvent(i,o))Kt.trace("Item ".concat(i," update skipped, revision: ").concat(o));else{var s={key:i,value:a};this.cache.store(i,s,o),this.broadcastEventToListeners("itemUpdated",s)}}},{key:"handleItemRemoved",value:function(i,a){var o=a===null;this.shouldIgnoreEvent(i,a)?Kt.trace("Item ".concat(i," delete skipped, revision: ").concat(a)):(this.cache.delete(i,a,o),this.broadcastEventToListeners("itemRemoved",{key:i}))}},{key:"handleBatchUpdate",value:function(i){var a=this,o={};i!=null&&i.forEach(function(u){o[u.key]={data:u.data,revision:u.revision}}),this.cache.forEach(function(u,l){var c=o[u];c!=null?a.handleItemMutated(u,c.data,c.revision):a.handleItemRemoved(u,null),delete o[u]});for(var s in o)this.handleItemMutated(s,o[s].data,o[s].revision)}},{key:"shouldIgnoreEvent",value:function(i,a){return i!=null&&a!=null&&this.cache.isKnown(i,a)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i)}}],[{key:"type",get:function(){return"live_query"}}]),e}(_c);function MA(t){return W_.apply(this,arguments)}function W_(){return W_=ze.default(le.default.mark(function t(r){var e,n,i,a,o,s;return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(e=r.network,n=r.queryString,i=r.uri,a=r.type,n!=null){l.next=3;break}throw new Sn("Invalid query",400,54507);case 3:return o={query_string:n},a===Ia.type&&(o.type=a),l.next=7,e.post(i,o,void 0,!0);case 7:return s=l.sent,l.abrupt("return",s.body);case 9:case"end":return l.stop()}},t)})),W_.apply(this,arguments)}var Ia=function(t){dn.default(e,t);var r=$_(e);function e(n){var i;return qt.default(this,e),i=r.call(this),i.liveQueryImpl=n,i.liveQueryImpl.attach($i.default(i)),i}return nr.default(e,[{key:"type",get:function(){return z_.type}},{key:"lastEventId",get:function(){return this.liveQueryImpl.lastEventId}},{key:"sid",get:function(){return this.liveQueryImpl.sid}},{key:"close",value:function(){hc.default(Dr.default(e.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}],[{key:"type",get:function(){return z_.type}}]),e}(wc);lr.default(Ia,"itemUpdated","itemUpdated"),lr.default(Ia,"itemRemoved","itemRemoved");var Sc=function(t){dn.default(e,t);var r=$_(e);function e(n){var i;return qt.default(this,e),i=r.call(this),lr.default($i.default(i),"queryExpression",null),lr.default($i.default(i),"items",{}),Object.assign($i.default(i),n),i.updateIndexName(n.indexName),i}return nr.default(e,[{key:"type",get:function(){return e.type}},{key:"search",value:function(){var n=ze.default(le.default.mark(function a(o){var s=this;return le.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.items={},l.abrupt("return",MA({network:this.network,uri:this.queryUri,queryString:o}).then(function(c){s.queryExpression=o,c.items&&c.items.forEach(function(f){s.items[f.key]=f.data}),s.emit("searchResult",s.getItems())}).catch(function(c){throw Kt.error("Error '".concat(c.message,"' while executing query '").concat(o,"'")),s.queryExpression=null,c}));case 2:case"end":return l.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"subscribe",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.queryExpression!=null){s.next=2;break}return s.abrupt("return",Promise.reject(new Sn("Invalid query",400,54507)));case 2:return s.abrupt("return",this.liveQueryCreator(this.indexName,this.queryExpression));case 3:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){return this.items}},{key:"updateIndexName",value:function(i){this.indexName=i,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(i){return new ku(this.insightsUri).pathSegment(i).pathSegment("Items").build()}}],[{key:"type",get:function(){return"instant_query"}}]),e}(cr);lr.default(Sc,"searchResult","searchResult"),Yt([xe.validateTypesAsync("string"),je("design:type",Function),je("design:paramtypes",[String]),je("design:returntype",Promise)],Sc.prototype,"search",null),Yt([xe.validateTypes(xe.nonEmptyString),je("design:type",Function),je("design:paramtypes",[String]),je("design:returntype",void 0)],Sc.prototype,"updateIndexName",null);var R_e="3.1.0";function I_e(t){var r=O_e();return function(){var n=Dr.default(t),i;if(r){var a=Dr.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fo.default(this,i)}}function O_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function CA(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function RA(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?CA(Object(e),!0).forEach(function(n){lr.default(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):CA(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var N_e="data_sync",B_=R_e;function Kp(t){if(t){if(typeof t=="string")return{id:t,mode:"open_or_create"};var r=t.mode||(t.id?"open_or_create":"create_new");return RA(RA({},t),{},{mode:r})}else return{mode:"create_new"}}var IA="com.twilio.rtd.cds.document",OA="com.twilio.rtd.cds.list",NA="com.twilio.rtd.cds.map",AA="twilio.sync.event",Pn=function(t){dn.default(e,t);var r=I_e(e);function e(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(qt.default(this,e),i=r.call(this),!n)throw new Error("Sync library needs a valid Twilio token to be passed");a.hasOwnProperty("logLevel")?Kt.setLevel(a.logLevel):Kt.setLevel("silent");var o=a.productId=a.productId||N_e;a.clientMetadata=a.clientMetadata||{},a.clientMetadata.hasOwnProperty("type")||(a.clientMetadata.type="sync"),a.clientMetadata.hasOwnProperty("sdk")||(a.clientMetadata.sdk="JS",a.clientMetadata.sdkv=B_);var s=!a.twilsockClient;if(!a.initRegistrations){var u=new Jp.InitRegistration(o);e.populateInitRegistrations(u),a.initRegistrations=[u]}var l=a.twilsockClient=a.twilsockClient||new Jp.Twilsock(n,o,a);l.on("tokenAboutToExpire",function(v){return i.emit("tokenAboutToExpire",v)}),l.on("tokenExpired",function(){return i.emit("tokenExpired")}),l.on("connectionError",function(v){return i.emit("connectionError",v)}),l.on("stateChanged",function(v){i.emit("connectionStateChanged",v),i.services.subscriptions.onConnectionStateChanged(v==="connected")}),l.on("message",function(v,p){return i._routeMessage(v,p)});var c=new Xbe(a),f=new o_e(new S_e(B_),c,l),d=new s_e(c);return i.services={config:c,twilsock:l,network:f,storage:d,router:$i.default(i),subscriptions:null},i.services.subscriptions=new t_e(i.services),i.entities=new E_e,s&&l.connect(),i}return nr.default(e,[{key:"_routeMessage",value:function(i,a){switch(Kt.trace("Notification type:",i,"content:",a),i){case IA:case OA:case NA:this.services.subscriptions.acceptMessage(a,!1);break;case AA:this.services.subscriptions.acceptMessage(a,!0);break}}},{key:"_subscribe",value:function(i,a){this.services.subscriptions.add(i,a)}},{key:"_unsubscribe",value:function(i){this.services.subscriptions.remove(i)}},{key:"connectionState",get:function(){return this.services.twilsock.state}},{key:"ensureReady",value:function(){var n=ze.default(le.default.mark(function a(){var o;return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.services.config.sessionStorageEnabled){u.next=2;break}return u.abrupt("return");case 2:return u.prev=2,u.next=5,this.services.twilsock.storageId();case 5:o=u.sent,this.services.storage.updateStorageId(o.id),u.next=12;break;case 9:u.prev=9,u.t0=u.catch(2),Kt.warn("Failed to initialize storage",u.t0);case 12:case"end":return u.stop()}},a,this,[[2,9]])}));function i(){return n.apply(this,arguments)}return i}()},{key:"storeRootInSessionCache",value:function(i,a,o){if(!(!this.services.config.sessionStorageEnabled||!a)){var s=vi(o);(i===Lr.type||i===$r.type)&&(s.last_event_id=null,delete s.items),this.services.storage.store(i,a,s)}}},{key:"readRootFromSessionCache",value:function(i,a){return!this.services.config.sessionStorageEnabled||!a?null:this.services.storage.read(i,a)}},{key:"_get",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u,l,c,f=arguments;return le.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(u=f.length>2&&f[2]!==void 0?f[2]:!1,s){v.next=3;break}throw new Sn("Cannot get entity without id",404);case 3:return l=new ku(o).pathSegment(s).queryParam("Include",u?"items":void 0).build(),v.next=6,this.services.network.get(l);case 6:return c=v.sent,v.abrupt("return",c.body);case 8:case"end":return v.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"_createDocument",value:function(i,a,o){var s={unique_name:i,data:a||{}};return o!==void 0&&(s.ttl=o),this.services.network.post(this.services.config.documentsUri,s).then(function(u){return u.body.data=s.data,u.body})}},{key:"_getDocument",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(Yn.type,o)||this._get(this.services.config.documentsUri,o));case 1:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createList",value:function(i,a,o,s){var u={unique_name:i,purpose:a,context:o};return s!==void 0&&(u.ttl=s),this.services.network.post(this.services.config.listsUri,u).then(function(l){return l.body})}},{key:"_getList",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(Lr.type,o)||this._get(this.services.config.listsUri,o));case 1:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createMap",value:function(i,a){var o={unique_name:i};return a!==void 0&&(o.ttl=a),this.services.network.post(this.services.config.mapsUri,o).then(function(s){return s.body})}},{key:"_getMap",value:function(){var n=ze.default(le.default.mark(function a(o){var s,u=arguments;return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=u.length>1&&u[1]!==void 0?u[1]:!1,c.abrupt("return",this.readRootFromSessionCache($r.type,o)||this._get(this.services.config.mapsUri,o,s));case 2:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getStream",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(zi.type,o)||this._get(this.services.config.streamsUri,o,!1));case 1:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createStream",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u,l;return le.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return u={unique_name:o},s!==void 0&&(u.ttl=s),f.next=4,this.services.network.post(this.services.config.streamsUri,u);case 4:return l=f.sent,f.abrupt("return",l.body);case 6:case"end":return f.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"_getLiveQuery",value:function(i){return this.readRootFromSessionCache(Ia.type,i)}},{key:"getCached",value:function(i,a){return i&&this.entities.get(i,a)||null}},{key:"removeFromCacheAndSession",value:function(i,a,o){this.entities.remove(a),this.services.config.sessionStorageEnabled&&this.services.storage.remove(i,a,o)}},{key:"document",value:function(){var n=ze.default(le.default.mark(function a(o){var s=this,u,l,c,f;return le.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,this.ensureReady();case 2:if(u=Kp(o),u.mode!=="create_new"){v.next=9;break}return v.next=6,this._createDocument(u.id,u.data,u.ttl);case 6:l=v.sent,v.next=39;break;case 9:if(c=this.getCached(u.id,Yn.type),!c){v.next=14;break}return v.abrupt("return",new Yn(c));case 14:return v.prev=14,v.next=17,this._getDocument(u.id);case 17:l=v.sent,v.next=39;break;case 20:if(v.prev=20,v.t0=v.catch(14),!(v.t0.status!==404||u.mode==="open_existing")){v.next=26;break}throw v.t0;case 26:return v.prev=26,v.next=29,this._createDocument(u.id,u.data,u.ttl);case 29:l=v.sent,v.next=39;break;case 32:if(v.prev=32,v.t1=v.catch(26),v.t1.status!==409){v.next=38;break}return v.abrupt("return",this.document(o));case 38:throw v.t1;case 39:return this.storeRootInSessionCache(Yn.type,u.id,l),f=new D_(this.services,l,function(p,y,k){return s.removeFromCacheAndSession(p,y,k)}),f=this.entities.store(f),v.abrupt("return",new Yn(f));case 43:case"end":return v.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"map",value:function(){var n=ze.default(le.default.mark(function a(o){var s=this,u,l,c,f;return le.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,this.ensureReady();case 2:if(u=Kp(o),u.mode!=="create_new"){v.next=9;break}return v.next=6,this._createMap(u.id,u.ttl);case 6:l=v.sent,v.next=39;break;case 9:if(c=this.getCached(u.id,$r.type),!c){v.next=14;break}return v.abrupt("return",new $r(c));case 14:return v.prev=14,v.next=17,this._getMap(u.id,u.includeItems);case 17:l=v.sent,v.next=39;break;case 20:if(v.prev=20,v.t0=v.catch(14),!(v.t0.status!==404||u.mode==="open_existing")){v.next=26;break}throw v.t0;case 26:return v.prev=26,v.next=29,this._createMap(u.id,u.ttl);case 29:l=v.sent,v.next=39;break;case 32:if(v.prev=32,v.t1=v.catch(26),v.t1.status!==409){v.next=38;break}return v.abrupt("return",this.map(o));case 38:throw v.t1;case 39:return this.storeRootInSessionCache($r.type,u.id,l),f=new F_(this.services,l,function(p,y,k){return s.removeFromCacheAndSession(p,y,k)}),f=this.entities.store(f),v.abrupt("return",new $r(f));case 43:case"end":return v.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"list",value:function(){var n=ze.default(le.default.mark(function a(o){var s=this,u,l,c,f;return le.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,this.ensureReady();case 2:if(u=Kp(o),u.mode!=="create_new"){v.next=9;break}return v.next=6,this._createList(u.id,u.purpose,u.context,u.ttl);case 6:l=v.sent,v.next=39;break;case 9:if(c=this.getCached(u.id,Lr.type),!c){v.next=14;break}return v.abrupt("return",new Lr(c));case 14:return v.prev=14,v.next=17,this._getList(u.id);case 17:l=v.sent,v.next=39;break;case 20:if(v.prev=20,v.t0=v.catch(14),!(v.t0.status!==404||u.mode==="open_existing")){v.next=26;break}throw v.t0;case 26:return v.prev=26,v.next=29,this._createList(u.id,u.purpose,u.context,u.ttl);case 29:l=v.sent,v.next=39;break;case 32:if(v.prev=32,v.t1=v.catch(26),v.t1.status!==409){v.next=38;break}return v.abrupt("return",this.list(o));case 38:throw v.t1;case 39:return this.storeRootInSessionCache(Lr.type,u.id,l),f=new V_(this.services,l,function(p,y,k){return s.removeFromCacheAndSession(p,y,k)}),f=this.entities.store(f),v.abrupt("return",new Lr(f));case 43:case"end":return v.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"stream",value:function(){var n=ze.default(le.default.mark(function a(o){var s=this,u,l,c,f,d;return le.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.ensureReady();case 2:if(u=Kp(o),u.mode!=="create_new"){p.next=9;break}return p.next=6,this._createStream(u.id,u.ttl);case 6:l=p.sent,p.next=39;break;case 9:if(c=this.getCached(u.id,zi.type),!c){p.next=14;break}return p.abrupt("return",new zi(c));case 14:return p.prev=14,p.next=17,this._getStream(u.id);case 17:l=p.sent,p.next=39;break;case 20:if(p.prev=20,p.t0=p.catch(14),!(p.t0.status!==404||u.mode==="open_existing")){p.next=26;break}throw p.t0;case 26:return p.prev=26,p.next=29,this._createStream(u.id,u.ttl);case 29:l=p.sent,p.next=39;break;case 32:if(p.prev=32,p.t1=p.catch(26),p.t1.status!==409){p.next=38;break}return p.abrupt("return",this.stream(o));case 38:throw p.t1;case 39:return this.storeRootInSessionCache(zi.type,u.id,l),f=function(k,I,C){return s.removeFromCacheAndSession(k,I,C)},d=new Tc(this.services,l,f),d=this.entities.store(d),p.abrupt("return",new zi(d));case 44:case"end":return p.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"shutdown",value:function(){var n=ze.default(le.default.mark(function a(){return le.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.services.subscriptions.shutdown();case 2:return s.next=4,this.services.twilsock.disconnect();case 4:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"updateToken",value:function(){var n=ze.default(le.default.mark(function a(o){return le.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.services.twilsock.updateToken(o).catch(function(l){var c,f=l==null||(c=l.reply)===null||c===void 0?void 0:c.status;throw(f==null?void 0:f.code)===401&&(f==null?void 0:f.status)==="UNAUTHORIZED"?new Sn("Updated token was rejected by server",400,51130):l}));case 1:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"liveQuery",value:function(){var n=ze.default(le.default.mark(function a(o,s){var u=this,l,c,f,d,v;return le.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.ensureReady();case 2:return l=new ku(this.services.config.insightsUri).pathSegment(o).pathSegment("Items").build(),y.next=5,MA({network:this.services.network,uri:l,queryString:s,type:Ia.type});case 5:return c=y.sent,f=this.getCached(c.query_id,Ia.type),f||(d=this._getLiveQuery(c.query_id),d||(d={indexName:o,queryExpression:s,sid:c.query_id,queryUri:l,last_event_id:c.last_event_id}),v=function(I,C,L){return u.removeFromCacheAndSession(I,C,L)},f=new z_(d,this.services,v,c.items)),this.storeRootInSessionCache(Ia.type,c.query_id,f.liveQueryDescriptor),f=this.entities.store(f),y.abrupt("return",new Ia(f));case 11:case"end":return y.stop()}},a,this)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"instantQuery",value:function(){var n=ze.default(le.default.mark(function a(o){var s=this,u;return le.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.ensureReady();case 2:return u=function(d,v){return s.liveQuery(d,v)},c.abrupt("return",new Sc({indexName:o,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:u}));case 4:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()}],[{key:"populateInitRegistrations",value:function(i){i.populateInitRegistrations([AA,IA,OA,NA])}},{key:"version",get:function(){return B_}}]),e}(cr);lr.default(Pn,"connectionStateChanged","connectionStateChanged"),lr.default(Pn,"connectionError","connectionError"),lr.default(Pn,"tokenAboutToExpire","tokenAboutToExpire"),lr.default(Pn,"tokenExpired","tokenExpired"),Yt([xe.validateTypesAsync(["undefined","string",xe.objectSchema("open document options",{id:["string","undefined"],mode:[xe.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[xe.nonNegativeInteger,"undefined"],data:[xe.pureObject,"undefined",xe.literal(null)]})]),je("design:type",Function),je("design:paramtypes",[Object]),je("design:returntype",Promise)],Pn.prototype,"document",null),Yt([xe.validateTypesAsync(["undefined","string",xe.objectSchema("open map options",{id:["string","undefined"],mode:[xe.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[xe.nonNegativeInteger,"undefined"],data:[xe.pureObject,"undefined",xe.literal(null)],includeItems:["boolean","undefined"]})]),je("design:type",Function),je("design:paramtypes",[Object]),je("design:returntype",Promise)],Pn.prototype,"map",null),Yt([xe.validateTypesAsync(["undefined","string",xe.objectSchema("open list options",{id:["string","undefined"],mode:[xe.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[xe.nonNegativeInteger,"undefined"],data:[xe.pureObject,"undefined",xe.literal(null)],purpose:["string","undefined"],context:[xe.pureObject,"undefined"],includeItems:["boolean","undefined"]})]),je("design:type",Function),je("design:paramtypes",[Object]),je("design:returntype",Promise)],Pn.prototype,"list",null),Yt([xe.validateTypesAsync(["undefined","string",xe.objectSchema("open stream options",{id:["string","undefined"],mode:[xe.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[xe.nonNegativeInteger,"undefined"],data:[xe.pureObject,"undefined",xe.literal(null)]})]),je("design:type",Function),je("design:paramtypes",[Object]),je("design:returntype",Promise)],Pn.prototype,"stream",null),Yt([xe.validateTypesAsync(xe.nonEmptyString),je("design:type",Function),je("design:paramtypes",[String]),je("design:returntype",Promise)],Pn.prototype,"updateToken",null),Yt([xe.validateTypesAsync(xe.nonEmptyString,"string"),je("design:type",Function),je("design:paramtypes",[String,String]),je("design:returntype",Promise)],Pn.prototype,"liveQuery",null),Yt([xe.validateTypesAsync(xe.nonEmptyString),je("design:type",Function),je("design:paramtypes",[String]),je("design:returntype",Promise)],Pn.prototype,"instantQuery",null),Tn.Client=Pn,Tn.InsightsItem=C_e,Tn.InstantQuery=Sc,Tn.LiveQuery=Ia,Tn.Paginator=U_,Tn.SyncClient=Pn,Tn.SyncDocument=Yn,Tn.SyncList=Lr,Tn.SyncListItem=L_,Tn.SyncMap=$r,Tn.SyncMapItem=kc,Tn.SyncStream=zi;var PA={},A_e=w3,P_e=TypeError,xA=function(t){if(A_e(t))throw P_e("The method doesn't accept regular expressions");return t},x_e=pr,D_e=x_e("match"),DA=function(t){var r=/./;try{"/./"[t](r)}catch{try{return r[D_e]=!1,"/./"[t](r)}catch{}}return!1},L_e=Lt,LA=Md,U_e=Ni.f,j_e=ca,UA=Fr,V_e=xA,F_e=xi,$_e=DA,jA=LA("".startsWith),z_e=LA("".slice),W_e=Math.min,VA=$_e("startsWith"),B_e=!VA&&!!function(){var t=U_e(String.prototype,"startsWith");return t&&!t.writable}();L_e({target:"String",proto:!0,forced:!B_e&&!VA},{startsWith:function(r){var e=UA(F_e(this));V_e(r);var n=j_e(W_e(arguments.length>1?arguments[1]:void 0,e.length)),i=UA(r);return jA?jA(e,i,n):z_e(e,n,n+i.length)===i}});var Z_e=Ot,q_e=pr,Q_e=wr,FA=gE,Y_e=q_e("iterator"),$A=!Z_e(function(){var t=new URL("b?a=1&b=2&c=3","http://a"),r=t.searchParams,e=new URLSearchParams("a=1&a=2"),n="";return t.pathname="c%20d",r.forEach(function(i,a){r.delete("b"),n+=a+i}),e.delete("a",2),FA&&(!t.toJSON||!e.has("a",1)||e.has("a",2))||!r.size&&(FA||!Q_e)||!r.sort||t.href!=="http://a/c%20d?a=1&c=3"||r.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!r[Y_e]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://").host!=="xn--e1aybc"||new URL("http://a#").hash!=="#%D0%B1"||n!=="a1c3"||new URL("http://x",void 0).host!=="x"}),ss=Dt,Z_=2147483647,Ec=36,zA=1,q_=26,G_e=38,H_e=700,J_e=72,X_e=128,K_e="-",e0e=/[^\0-\u007E]/,WA=/[.\u3002\uFF0E\uFF61]/g,BA="Overflow: input needs wider integers to process",Q_=Ec-zA,ZA=RangeError,t0e=ss(WA.exec),Su=Math.floor,Y_=String.fromCharCode,qA=ss("".charCodeAt),QA=ss([].join),vo=ss([].push),r0e=ss("".replace),n0e=ss("".split),i0e=ss("".toLowerCase),a0e=function(t){for(var r=[],e=0,n=t.length;e<n;){var i=qA(t,e++);if(i>=55296&&i<=56319&&e<n){var a=qA(t,e++);(a&64512)==56320?vo(r,((i&1023)<<10)+(a&1023)+65536):(vo(r,i),e--)}else vo(r,i)}return r},YA=function(t){return t+22+75*(t<26)},o0e=function(t,r,e){var n=0;for(t=e?Su(t/H_e):t>>1,t+=Su(t/r);t>Q_*q_>>1;)t=Su(t/Q_),n+=Ec;return Su(n+(Q_+1)*t/(t+G_e))},s0e=function(t){var r=[];t=a0e(t);var e=t.length,n=X_e,i=0,a=J_e,o,s;for(o=0;o<t.length;o++)s=t[o],s<128&&vo(r,Y_(s));var u=r.length,l=u;for(u&&vo(r,K_e);l<e;){var c=Z_;for(o=0;o<t.length;o++)s=t[o],s>=n&&s<c&&(c=s);var f=l+1;if(c-n>Su((Z_-i)/f))throw ZA(BA);for(i+=(c-n)*f,n=c,o=0;o<t.length;o++){if(s=t[o],s<n&&++i>Z_)throw ZA(BA);if(s==n){for(var d=i,v=Ec;;){var p=v<=a?zA:v>=a+q_?q_:v-a;if(d<p)break;var y=d-p,k=Ec-p;vo(r,Y_(YA(p+y%k))),d=Su(y/k),v+=Ec}vo(r,Y_(YA(d))),a=o0e(i,f,l==u),i=0,l++}}i++,n++}return QA(r,"")},u0e=function(t){var r=[],e=n0e(r0e(i0e(t),WA,"."),"."),n,i;for(n=0;n<e.length;n++)i=e[n],vo(r,t0e(e0e,i)?"xn--"+s0e(i):i);return QA(r,".")},G_=Lt,Eu=zt,ev=dr,Wi=Dt,Mu=wr,GA=$A,HA=un,l0e=Ui,c0e=gb,f0e=fa,d0e=SR,H_=zn,JA=Zo,J_=sr,p0e=Er,v0e=pa,h0e=da,m0e=Or,XA=Sr,pn=Fr,g0e=Ha,KA=Uo,X_=Qd,y0e=Ql,Cu=Fg,b0e=pr,_0e=c_,w0e=b0e("iterator"),Mc="URLSearchParams",eP=Mc+"Iterator",tP=H_.set,Gn=H_.getterFor(Mc),k0e=H_.getterFor(eP),T0e=Object.getOwnPropertyDescriptor,K_=function(t){if(!Mu)return Eu[t];var r=T0e(Eu,t);return r&&r.value},rP=K_("fetch"),tv=K_("Request"),Cc=K_("Headers"),e0=tv&&tv.prototype,nP=Cc&&Cc.prototype,S0e=Eu.RegExp,E0e=Eu.TypeError,iP=Eu.decodeURIComponent,M0e=Eu.encodeURIComponent,C0e=Wi("".charAt),aP=Wi([].join),us=Wi([].push),t0=Wi("".replace),R0e=Wi([].shift),oP=Wi([].splice),sP=Wi("".split),I0e=Wi("".slice),O0e=/\+/g,uP=Array(4),N0e=function(t){return uP[t-1]||(uP[t-1]=S0e("((?:%[\\da-f]{2}){"+t+"})","gi"))},A0e=function(t){try{return iP(t)}catch{return t}},lP=function(t){var r=t0(t,O0e," "),e=4;try{return iP(r)}catch{for(;e;)r=t0(r,N0e(e--),A0e);return r}},P0e=/[!'()~]|%20/g,x0e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},D0e=function(t){return x0e[t]},cP=function(t){return t0(M0e(t),P0e,D0e)},r0=d0e(function(r,e){tP(this,{type:eP,iterator:X_(Gn(r).entries),kind:e})},"Iterator",function(){var r=k0e(this),e=r.kind,n=r.iterator.next(),i=n.value;return n.done||(n.value=e==="keys"?i.key:e==="values"?i.value:[i.key,i.value]),n},!0),fP=function(t){this.entries=[],this.url=null,t!==void 0&&(XA(t)?this.parseObject(t):this.parseQuery(typeof t=="string"?C0e(t,0)==="?"?I0e(t,1):t:pn(t)))};fP.prototype={type:Mc,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var r=y0e(t),e,n,i,a,o,s,u;if(r)for(e=X_(t,r),n=e.next;!(i=ev(n,e)).done;){if(a=X_(m0e(i.value)),o=a.next,(s=ev(o,a)).done||(u=ev(o,a)).done||!ev(o,a).done)throw E0e("Expected sequence with length 2");us(this.entries,{key:pn(s.value),value:pn(u.value)})}else for(var l in t)p0e(t,l)&&us(this.entries,{key:l,value:pn(t[l])})},parseQuery:function(t){if(t)for(var r=sP(t,"&"),e=0,n,i;e<r.length;)n=r[e++],n.length&&(i=sP(n,"="),us(this.entries,{key:lP(R0e(i)),value:lP(aP(i,"="))}))},serialize:function(){for(var t=this.entries,r=[],e=0,n;e<t.length;)n=t[e++],us(r,cP(n.key)+"="+cP(n.value));return aP(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var rv=function(){JA(this,Ru);var r=arguments.length>0?arguments[0]:void 0,e=tP(this,new fP(r));Mu||(this.size=e.entries.length)},Ru=rv.prototype;if(c0e(Ru,{append:function(r,e){var n=Gn(this);Cu(arguments.length,2),us(n.entries,{key:pn(r),value:pn(e)}),Mu||this.length++,n.updateURL()},delete:function(t){for(var r=Gn(this),e=Cu(arguments.length,1),n=r.entries,i=pn(t),a=e<2?void 0:arguments[1],o=a===void 0?a:pn(a),s=0;s<n.length;){var u=n[s];if(u.key===i&&(o===void 0||u.value===o)){if(oP(n,s,1),o!==void 0)break}else s++}Mu||(this.size=n.length),r.updateURL()},get:function(r){var e=Gn(this).entries;Cu(arguments.length,1);for(var n=pn(r),i=0;i<e.length;i++)if(e[i].key===n)return e[i].value;return null},getAll:function(r){var e=Gn(this).entries;Cu(arguments.length,1);for(var n=pn(r),i=[],a=0;a<e.length;a++)e[a].key===n&&us(i,e[a].value);return i},has:function(r){for(var e=Gn(this).entries,n=Cu(arguments.length,1),i=pn(r),a=n<2?void 0:arguments[1],o=a===void 0?a:pn(a),s=0;s<e.length;){var u=e[s++];if(u.key===i&&(o===void 0||u.value===o))return!0}return!1},set:function(r,e){var n=Gn(this);Cu(arguments.length,1);for(var i=n.entries,a=!1,o=pn(r),s=pn(e),u=0,l;u<i.length;u++)l=i[u],l.key===o&&(a?oP(i,u--,1):(a=!0,l.value=s));a||us(i,{key:o,value:s}),Mu||(this.size=i.length),n.updateURL()},sort:function(){var r=Gn(this);_0e(r.entries,function(e,n){return e.key>n.key?1:-1}),r.updateURL()},forEach:function(r){for(var e=Gn(this).entries,n=v0e(r,arguments.length>1?arguments[1]:void 0),i=0,a;i<e.length;)a=e[i++],n(a.value,a.key,this)},keys:function(){return new r0(this,"keys")},values:function(){return new r0(this,"values")},entries:function(){return new r0(this,"entries")}},{enumerable:!0}),HA(Ru,w0e,Ru.entries,{name:"entries"}),HA(Ru,"toString",function(){return Gn(this).serialize()},{enumerable:!0}),Mu&&l0e(Ru,"size",{get:function(){return Gn(this).entries.length},configurable:!0,enumerable:!0}),f0e(rv,Mc),G_({global:!0,constructor:!0,forced:!GA},{URLSearchParams:rv}),!GA&&J_(Cc)){var L0e=Wi(nP.has),U0e=Wi(nP.set),dP=function(t){if(XA(t)){var r=t.body,e;if(h0e(r)===Mc)return e=t.headers?new Cc(t.headers):new Cc,L0e(e,"content-type")||U0e(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),g0e(t,{body:KA(0,pn(r)),headers:KA(0,e)})}return t};if(J_(rP)&&G_({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(r){return rP(r,arguments.length>1?dP(arguments[1]):{})}}),J_(tv)){var n0=function(r){return JA(this,e0),new tv(r,arguments.length>1?dP(arguments[1]):{})};e0.constructor=n0,n0.prototype=e0,G_({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:n0})}}var j0e={URLSearchParams:rv,getState:Gn},V0e=Lt,i0=wr,F0e=$A,a0=zt,pP=pa,Hn=Dt,nv=un,Jn=Ui,$0e=Zo,o0=Er,s0=P3,Iu=gR,hi=Pl,z0e=yy.codeAt,W0e=u0e,Oa=Fr,B0e=fa,Z0e=Fg,vP=j0e,hP=zn,q0e=hP.set,iv=hP.getterFor("URL"),Q0e=vP.URLSearchParams,Y0e=vP.getState,Rc=a0.URL,u0=a0.TypeError,av=a0.parseInt,G0e=Math.floor,mP=Math.pow,Xn=Hn("".charAt),mi=Hn(/./.exec),Ic=Hn([].join),H0e=Hn(1 .toString),J0e=Hn([].pop),Ou=Hn([].push),l0=Hn("".replace),X0e=Hn([].shift),K0e=Hn("".split),Oc=Hn("".slice),ov=Hn("".toLowerCase),e1e=Hn([].unshift),t1e="Invalid authority",c0="Invalid scheme",ls="Invalid host",gP="Invalid port",yP=/[a-z]/i,r1e=/[\d+-.a-z]/i,f0=/\d/,n1e=/^0x/i,i1e=/^[0-7]+$/,a1e=/^\d+$/,bP=/^[\da-f]+$/i,o1e=/[\0\t\n\r #%/:<>?@[\\\]^|]/,s1e=/[\0\t\n\r #/:<>?@[\\\]^|]/,u1e=/^[\u0000-\u0020]+/,l1e=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,c1e=/[\t\n\r]/g,Kn,f1e=function(t){var r=K0e(t,"."),e,n,i,a,o,s,u;if(r.length&&r[r.length-1]==""&&r.length--,e=r.length,e>4)return t;for(n=[],i=0;i<e;i++){if(a=r[i],a=="")return t;if(o=10,a.length>1&&Xn(a,0)=="0"&&(o=mi(n1e,a)?16:8,a=Oc(a,o==8?1:2)),a==="")s=0;else{if(!mi(o==10?a1e:o==8?i1e:bP,a))return t;s=av(a,o)}Ou(n,s)}for(i=0;i<e;i++)if(s=n[i],i==e-1){if(s>=mP(256,5-e))return null}else if(s>255)return null;for(u=J0e(n),i=0;i<n.length;i++)u+=n[i]*mP(256,3-i);return u},d1e=function(t){var r=[0,0,0,0,0,0,0,0],e=0,n=null,i=0,a,o,s,u,l,c,f,d=function(){return Xn(t,i)};if(d()==":"){if(Xn(t,1)!=":")return;i+=2,e++,n=e}for(;d();){if(e==8)return;if(d()==":"){if(n!==null)return;i++,e++,n=e;continue}for(a=o=0;o<4&&mi(bP,d());)a=a*16+av(d(),16),i++,o++;if(d()=="."){if(o==0||(i-=o,e>6))return;for(s=0;d();){if(u=null,s>0)if(d()=="."&&s<4)i++;else return;if(!mi(f0,d()))return;for(;mi(f0,d());){if(l=av(d(),10),u===null)u=l;else{if(u==0)return;u=u*10+l}if(u>255)return;i++}r[e]=r[e]*256+u,s++,(s==2||s==4)&&e++}if(s!=4)return;break}else if(d()==":"){if(i++,!d())return}else if(d())return;r[e++]=a}if(n!==null)for(c=e-n,e=7;e!=0&&c>0;)f=r[e],r[e--]=r[n+c-1],r[n+--c]=f;else if(e!=8)return;return r},p1e=function(t){for(var r=null,e=1,n=null,i=0,a=0;a<8;a++)t[a]!==0?(i>e&&(r=n,e=i),n=null,i=0):(n===null&&(n=a),++i);return i>e&&(r=n,e=i),r},Nc=function(t){var r,e,n,i;if(typeof t=="number"){for(r=[],e=0;e<4;e++)e1e(r,t%256),t=G0e(t/256);return Ic(r,".")}else if(typeof t=="object"){for(r="",n=p1e(t),e=0;e<8;e++)i&&t[e]===0||(i&&(i=!1),n===e?(r+=e?":":"::",i=!0):(r+=H0e(t[e],16),e<7&&(r+=":")));return"["+r+"]"}return t},sv={},_P=s0({},sv,{" ":1,'"':1,"<":1,">":1,"`":1}),wP=s0({},_P,{"#":1,"?":1,"{":1,"}":1}),d0=s0({},wP,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ho=function(t,r){var e=z0e(t,0);return e>32&&e<127&&!o0(r,t)?t:encodeURIComponent(t)},uv={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Ac=function(t,r){var e;return t.length==2&&mi(yP,Xn(t,0))&&((e=Xn(t,1))==":"||!r&&e=="|")},kP=function(t){var r;return t.length>1&&Ac(Oc(t,0,2))&&(t.length==2||(r=Xn(t,2))==="/"||r==="\\"||r==="?"||r==="#")},v1e=function(t){return t==="."||ov(t)==="%2e"},h1e=function(t){return t=ov(t),t===".."||t==="%2e."||t===".%2e"||t==="%2e%2e"},p0={},TP={},v0={},SP={},EP={},h0={},MP={},CP={},lv={},cv={},m0={},g0={},y0={},b0={},RP={},_0={},Nu={},Bi={},IP={},cs={},Na={},w0=function(t,r,e){var n=Oa(t),i,a,o;if(r){if(a=this.parse(n),a)throw u0(a);this.searchParams=null}else{if(e!==void 0&&(i=new w0(e,!0)),a=this.parse(n,null,i),a)throw u0(a);o=Y0e(new Q0e),o.bindURL(this),this.searchParams=o}};w0.prototype={type:"URL",parse:function(t,r,e){var n=this,i=r||p0,a=0,o="",s=!1,u=!1,l=!1,c,f,d,v;for(t=Oa(t),r||(n.scheme="",n.username="",n.password="",n.host=null,n.port=null,n.path=[],n.query=null,n.fragment=null,n.cannotBeABaseURL=!1,t=l0(t,u1e,""),t=l0(t,l1e,"$1")),t=l0(t,c1e,""),c=Iu(t);a<=c.length;){switch(f=c[a],i){case p0:if(f&&mi(yP,f))o+=ov(f),i=TP;else{if(r)return c0;i=v0;continue}break;case TP:if(f&&(mi(r1e,f)||f=="+"||f=="-"||f=="."))o+=ov(f);else if(f==":"){if(r&&(n.isSpecial()!=o0(uv,o)||o=="file"&&(n.includesCredentials()||n.port!==null)||n.scheme=="file"&&!n.host))return;if(n.scheme=o,r){n.isSpecial()&&uv[n.scheme]==n.port&&(n.port=null);return}o="",n.scheme=="file"?i=b0:n.isSpecial()&&e&&e.scheme==n.scheme?i=SP:n.isSpecial()?i=CP:c[a+1]=="/"?(i=EP,a++):(n.cannotBeABaseURL=!0,Ou(n.path,""),i=IP)}else{if(r)return c0;o="",i=v0,a=0;continue}break;case v0:if(!e||e.cannotBeABaseURL&&f!="#")return c0;if(e.cannotBeABaseURL&&f=="#"){n.scheme=e.scheme,n.path=hi(e.path),n.query=e.query,n.fragment="",n.cannotBeABaseURL=!0,i=Na;break}i=e.scheme=="file"?b0:h0;continue;case SP:if(f=="/"&&c[a+1]=="/")i=lv,a++;else{i=h0;continue}break;case EP:if(f=="/"){i=cv;break}else{i=Bi;continue}case h0:if(n.scheme=e.scheme,f==Kn)n.username=e.username,n.password=e.password,n.host=e.host,n.port=e.port,n.path=hi(e.path),n.query=e.query;else if(f=="/"||f=="\\"&&n.isSpecial())i=MP;else if(f=="?")n.username=e.username,n.password=e.password,n.host=e.host,n.port=e.port,n.path=hi(e.path),n.query="",i=cs;else if(f=="#")n.username=e.username,n.password=e.password,n.host=e.host,n.port=e.port,n.path=hi(e.path),n.query=e.query,n.fragment="",i=Na;else{n.username=e.username,n.password=e.password,n.host=e.host,n.port=e.port,n.path=hi(e.path),n.path.length--,i=Bi;continue}break;case MP:if(n.isSpecial()&&(f=="/"||f=="\\"))i=lv;else if(f=="/")i=cv;else{n.username=e.username,n.password=e.password,n.host=e.host,n.port=e.port,i=Bi;continue}break;case CP:if(i=lv,f!="/"||Xn(o,a+1)!="/")continue;a++;break;case lv:if(f!="/"&&f!="\\"){i=cv;continue}break;case cv:if(f=="@"){s&&(o="%40"+o),s=!0,d=Iu(o);for(var p=0;p<d.length;p++){var y=d[p];if(y==":"&&!l){l=!0;continue}var k=ho(y,d0);l?n.password+=k:n.username+=k}o=""}else if(f==Kn||f=="/"||f=="?"||f=="#"||f=="\\"&&n.isSpecial()){if(s&&o=="")return t1e;a-=Iu(o).length+1,o="",i=m0}else o+=f;break;case m0:case g0:if(r&&n.scheme=="file"){i=_0;continue}else if(f==":"&&!u){if(o=="")return ls;if(v=n.parseHost(o),v)return v;if(o="",i=y0,r==g0)return}else if(f==Kn||f=="/"||f=="?"||f=="#"||f=="\\"&&n.isSpecial()){if(n.isSpecial()&&o=="")return ls;if(r&&o==""&&(n.includesCredentials()||n.port!==null))return;if(v=n.parseHost(o),v)return v;if(o="",i=Nu,r)return;continue}else f=="["?u=!0:f=="]"&&(u=!1),o+=f;break;case y0:if(mi(f0,f))o+=f;else if(f==Kn||f=="/"||f=="?"||f=="#"||f=="\\"&&n.isSpecial()||r){if(o!=""){var I=av(o,10);if(I>65535)return gP;n.port=n.isSpecial()&&I===uv[n.scheme]?null:I,o=""}if(r)return;i=Nu;continue}else return gP;break;case b0:if(n.scheme="file",f=="/"||f=="\\")i=RP;else if(e&&e.scheme=="file")if(f==Kn)n.host=e.host,n.path=hi(e.path),n.query=e.query;else if(f=="?")n.host=e.host,n.path=hi(e.path),n.query="",i=cs;else if(f=="#")n.host=e.host,n.path=hi(e.path),n.query=e.query,n.fragment="",i=Na;else{kP(Ic(hi(c,a),""))||(n.host=e.host,n.path=hi(e.path),n.shortenPath()),i=Bi;continue}else{i=Bi;continue}break;case RP:if(f=="/"||f=="\\"){i=_0;break}e&&e.scheme=="file"&&!kP(Ic(hi(c,a),""))&&(Ac(e.path[0],!0)?Ou(n.path,e.path[0]):n.host=e.host),i=Bi;continue;case _0:if(f==Kn||f=="/"||f=="\\"||f=="?"||f=="#"){if(!r&&Ac(o))i=Bi;else if(o==""){if(n.host="",r)return;i=Nu}else{if(v=n.parseHost(o),v)return v;if(n.host=="localhost"&&(n.host=""),r)return;o="",i=Nu}continue}else o+=f;break;case Nu:if(n.isSpecial()){if(i=Bi,f!="/"&&f!="\\")continue}else if(!r&&f=="?")n.query="",i=cs;else if(!r&&f=="#")n.fragment="",i=Na;else if(f!=Kn&&(i=Bi,f!="/"))continue;break;case Bi:if(f==Kn||f=="/"||f=="\\"&&n.isSpecial()||!r&&(f=="?"||f=="#")){if(h1e(o)?(n.shortenPath(),f!="/"&&!(f=="\\"&&n.isSpecial())&&Ou(n.path,"")):v1e(o)?f!="/"&&!(f=="\\"&&n.isSpecial())&&Ou(n.path,""):(n.scheme=="file"&&!n.path.length&&Ac(o)&&(n.host&&(n.host=""),o=Xn(o,0)+":"),Ou(n.path,o)),o="",n.scheme=="file"&&(f==Kn||f=="?"||f=="#"))for(;n.path.length>1&&n.path[0]==="";)X0e(n.path);f=="?"?(n.query="",i=cs):f=="#"&&(n.fragment="",i=Na)}else o+=ho(f,wP);break;case IP:f=="?"?(n.query="",i=cs):f=="#"?(n.fragment="",i=Na):f!=Kn&&(n.path[0]+=ho(f,sv));break;case cs:!r&&f=="#"?(n.fragment="",i=Na):f!=Kn&&(f=="'"&&n.isSpecial()?n.query+="%27":f=="#"?n.query+="%23":n.query+=ho(f,sv));break;case Na:f!=Kn&&(n.fragment+=ho(f,_P));break}a++}},parseHost:function(t){var r,e,n;if(Xn(t,0)=="["){if(Xn(t,t.length-1)!="]"||(r=d1e(Oc(t,1,-1)),!r))return ls;this.host=r}else if(this.isSpecial()){if(t=W0e(t),mi(o1e,t)||(r=f1e(t),r===null))return ls;this.host=r}else{if(mi(s1e,t))return ls;for(r="",e=Iu(t),n=0;n<e.length;n++)r+=ho(e[n],sv);this.host=r}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return o0(uv,this.scheme)},shortenPath:function(){var t=this.path,r=t.length;r&&(this.scheme!="file"||r!=1||!Ac(t[0],!0))&&t.length--},serialize:function(){var t=this,r=t.scheme,e=t.username,n=t.password,i=t.host,a=t.port,o=t.path,s=t.query,u=t.fragment,l=r+":";return i!==null?(l+="//",t.includesCredentials()&&(l+=e+(n?":"+n:"")+"@"),l+=Nc(i),a!==null&&(l+=":"+a)):r=="file"&&(l+="//"),l+=t.cannotBeABaseURL?o[0]:o.length?"/"+Ic(o,"/"):"",s!==null&&(l+="?"+s),u!==null&&(l+="#"+u),l},setHref:function(t){var r=this.parse(t);if(r)throw u0(r);this.searchParams.update()},getOrigin:function(){var t=this.scheme,r=this.port;if(t=="blob")try{return new Au(t.path[0]).origin}catch{return"null"}return t=="file"||!this.isSpecial()?"null":t+"://"+Nc(this.host)+(r!==null?":"+r:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(t){this.parse(Oa(t)+":",p0)},getUsername:function(){return this.username},setUsername:function(t){var r=Iu(Oa(t));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var e=0;e<r.length;e++)this.username+=ho(r[e],d0)}},getPassword:function(){return this.password},setPassword:function(t){var r=Iu(Oa(t));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var e=0;e<r.length;e++)this.password+=ho(r[e],d0)}},getHost:function(){var t=this.host,r=this.port;return t===null?"":r===null?Nc(t):Nc(t)+":"+r},setHost:function(t){this.cannotBeABaseURL||this.parse(t,m0)},getHostname:function(){var t=this.host;return t===null?"":Nc(t)},setHostname:function(t){this.cannotBeABaseURL||this.parse(t,g0)},getPort:function(){var t=this.port;return t===null?"":Oa(t)},setPort:function(t){this.cannotHaveUsernamePasswordPort()||(t=Oa(t),t==""?this.port=null:this.parse(t,y0))},getPathname:function(){var t=this.path;return this.cannotBeABaseURL?t[0]:t.length?"/"+Ic(t,"/"):""},setPathname:function(t){this.cannotBeABaseURL||(this.path=[],this.parse(t,Nu))},getSearch:function(){var t=this.query;return t?"?"+t:""},setSearch:function(t){t=Oa(t),t==""?this.query=null:(Xn(t,0)=="?"&&(t=Oc(t,1)),this.query="",this.parse(t,cs)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var t=this.fragment;return t?"#"+t:""},setHash:function(t){if(t=Oa(t),t==""){this.fragment=null;return}Xn(t,0)=="#"&&(t=Oc(t,1)),this.fragment="",this.parse(t,Na)},update:function(){this.query=this.searchParams.serialize()||null}};var Au=function(r){var e=$0e(this,vn),n=Z0e(arguments.length,1)>1?arguments[1]:void 0,i=q0e(e,new w0(r,!1,n));i0||(e.href=i.serialize(),e.origin=i.getOrigin(),e.protocol=i.getProtocol(),e.username=i.getUsername(),e.password=i.getPassword(),e.host=i.getHost(),e.hostname=i.getHostname(),e.port=i.getPort(),e.pathname=i.getPathname(),e.search=i.getSearch(),e.searchParams=i.getSearchParams(),e.hash=i.getHash())},vn=Au.prototype,ei=function(t,r){return{get:function(){return iv(this)[t]()},set:r&&function(e){return iv(this)[r](e)},configurable:!0,enumerable:!0}};if(i0&&(Jn(vn,"href",ei("serialize","setHref")),Jn(vn,"origin",ei("getOrigin")),Jn(vn,"protocol",ei("getProtocol","setProtocol")),Jn(vn,"username",ei("getUsername","setUsername")),Jn(vn,"password",ei("getPassword","setPassword")),Jn(vn,"host",ei("getHost","setHost")),Jn(vn,"hostname",ei("getHostname","setHostname")),Jn(vn,"port",ei("getPort","setPort")),Jn(vn,"pathname",ei("getPathname","setPathname")),Jn(vn,"search",ei("getSearch","setSearch")),Jn(vn,"searchParams",ei("getSearchParams")),Jn(vn,"hash",ei("getHash","setHash"))),nv(vn,"toJSON",function(){return iv(this).serialize()},{enumerable:!0}),nv(vn,"toString",function(){return iv(this).serialize()},{enumerable:!0}),Rc){var OP=Rc.createObjectURL,NP=Rc.revokeObjectURL;OP&&nv(Au,"createObjectURL",pP(OP,Rc)),NP&&nv(Au,"revokeObjectURL",pP(NP,Rc))}B0e(Au,"URL"),V0e({global:!0,constructor:!0,forced:!F0e,sham:!i0},{URL:Au});/*
  @license
  Copyright (c) 2018, Twilio, Inc.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted, provided that the above
  copyright notice and this permission notice appear in all copies.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
  WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
  MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
  SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
  WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
  OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
  CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

  */(function(t){var r=typeof r<"u"?r:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(t,"__esModule",{value:!0});var e=qn,n=ji,i=Bn,a=Zn,o=wn,s=bu,u=ma,l=Bo,c=Yl,f=_n,d=Ho,v=Ta,p=Zr;function y(se){return se&&typeof se=="object"&&"default"in se?se:{default:se}}function k(se){if(se&&se.__esModule)return se;var be=Object.create(null);return se&&Object.keys(se).forEach(function(oe){if(oe!=="default"){var pe=Object.getOwnPropertyDescriptor(se,oe);Object.defineProperty(be,oe,pe.get?pe:{enumerable:!0,get:function(){return se[oe]}})}}),be.default=se,Object.freeze(be)}var I=y(e),C=y(n),L=y(i),R=y(a),q=y(o),z=y(s),F=y(u),D=y(l),W=y(c),X=y(f),me=k(d),de={exports:{}},H=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(H){var ee=new Uint8Array(16);de.exports=function(){return H(ee),ee}}else{var Z=new Array(16);de.exports=function(){for(var be=0,oe;be<16;be++)be&3||(oe=Math.random()*4294967296),Z[be]=oe>>>((be&3)<<3)&255;return Z}}for(var te=[],re=0;re<256;++re)te[re]=(re+256).toString(16).substr(1);function K(se,be){var oe=be||0,pe=te;return[pe[se[oe++]],pe[se[oe++]],pe[se[oe++]],pe[se[oe++]],"-",pe[se[oe++]],pe[se[oe++]],"-",pe[se[oe++]],pe[se[oe++]],"-",pe[se[oe++]],pe[se[oe++]],"-",pe[se[oe++]],pe[se[oe++]],pe[se[oe++]],pe[se[oe++]],pe[se[oe++]],pe[se[oe++]]].join("")}var fe=K,Te=de.exports,$=fe,We,et,dt=0,$e=0;function ue(se,be,oe){var pe=be&&oe||0,ae=be||[];se=se||{};var Ze=se.node||We,Pe=se.clockseq!==void 0?se.clockseq:et;if(Ze==null||Pe==null){var ct=Te();Ze==null&&(Ze=We=[ct[0]|1,ct[1],ct[2],ct[3],ct[4],ct[5]]),Pe==null&&(Pe=et=(ct[6]<<8|ct[7])&16383)}var tt=se.msecs!==void 0?se.msecs:new Date().getTime(),it=se.nsecs!==void 0?se.nsecs:$e+1,pt=tt-dt+(it-$e)/1e4;if(pt<0&&se.clockseq===void 0&&(Pe=Pe+1&16383),(pt<0||tt>dt)&&se.nsecs===void 0&&(it=0),it>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");dt=tt,$e=it,et=Pe,tt+=122192928e5;var vt=((tt&268435455)*1e4+it)%4294967296;ae[pe++]=vt>>>24&255,ae[pe++]=vt>>>16&255,ae[pe++]=vt>>>8&255,ae[pe++]=vt&255;var st=tt/4294967296*1e4&268435455;ae[pe++]=st>>>8&255,ae[pe++]=st&255,ae[pe++]=st>>>24&15|16,ae[pe++]=st>>>16&255,ae[pe++]=Pe>>>8|128,ae[pe++]=Pe&255;for(var ft=0;ft<6;++ft)ae[pe+ft]=Ze[ft];return be||$(ae)}var Rr=ue,Ue=de.exports,ke=fe;function Gt(se,be,oe){var pe=be&&oe||0;typeof se=="string"&&(be=se==="binary"?new Array(16):null,se=null),se=se||{};var ae=se.random||(se.rng||Ue)();if(ae[6]=ae[6]&15|64,ae[8]=ae[8]&63|128,be)for(var Ze=0;Ze<16;++Ze)be[pe+Ze]=ae[Ze];return be||ke(ae)}var Qe=Gt,vr=Rr,At=Qe,Oe=At;Oe.v1=vr,Oe.v4=At;var _t=Oe;function Bt(se){var be=Fe();return function(){var pe=q.default(se),ae;if(be){var Ze=q.default(this).constructor;ae=Reflect.construct(pe,arguments,Ze)}else ae=pe.apply(this,arguments);return R.default(this,ae)}}function Fe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rr=function(se){L.default(oe,se);var be=Bt(oe);function oe(pe){var ae;I.default(this,oe);var Ze=_t.v4(),Pe;return ae=be.call(this,function(ct,tt){return Pe=tt,pe(function(it){oe.cancellationMap.delete(Ze),ct(it)},function(it){oe.cancellationMap.delete(Ze),tt(it)},function(it){oe.cancellationMap.set(Ze,it)})}),ae.id=Ze,ae.rejectPromise=Pe,ae}return C.default(oe,[{key:"cancel",value:function(){var ae=oe.cancellationMap.get(this.id);return ae==null||ae(),this.rejectPromise&&(this.catch(function(){}),this.rejectPromise(new Error("Promise was cancelled"))),this}}]),oe}(z.default(Promise));F.default(rr,"cancellationMap",new Map);function Pt(se,be,oe,pe){var ae=arguments.length,Ze=ae<3?be:pe===null?pe=Object.getOwnPropertyDescriptor(be,oe):pe,Pe;if((typeof Reflect>"u"?"undefined":X.default(Reflect))==="object"&&typeof Reflect.decorate=="function")Ze=Reflect.decorate(se,be,oe,pe);else for(var ct=se.length-1;ct>=0;ct--)(Pe=se[ct])&&(Ze=(ae<3?Pe(Ze):ae>3?Pe(be,oe,Ze):Pe(be,oe))||Ze);return ae>3&&Ze&&Object.defineProperty(be,oe,Ze),Ze}function ot(se,be){if((typeof Reflect>"u"?"undefined":X.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(se,be)}function Tt(se,be){return["".concat(new Date().toISOString()," MCS Client ").concat(se,":")].concat(Array.from(be))}var Be=function(){function se(be){I.default(this,se),F.default(this,"prefix",""),this.prefix=be!=null&&be.length>0?be+" ":""}return C.default(se,[{key:"setLevel",value:function(oe){me.setLevel(oe)}},{key:"trace",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.trace.apply(null,Tt(this.prefix+"T",pe))}},{key:"debug",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.debug.apply(null,Tt(this.prefix+"D",pe))}},{key:"info",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.info.apply(null,Tt(this.prefix+"I",pe))}},{key:"warn",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.warn.apply(null,Tt(this.prefix+"W",pe))}},{key:"error",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.error.apply(null,Tt(this.prefix+"E",pe))}}],[{key:"scope",value:function(oe){return new se(oe)}},{key:"setLevel",value:function(oe){me.setLevel(oe)}},{key:"trace",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.trace.apply(null,Tt("T",pe))}},{key:"debug",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.debug.apply(null,Tt("D",pe))}},{key:"info",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.info.apply(null,Tt("I",pe))}},{key:"warn",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.warn.apply(null,Tt("W",pe))}},{key:"error",value:function(){for(var oe=arguments.length,pe=new Array(oe),ae=0;ae<oe;ae++)pe[ae]=arguments[ae];me.error.apply(null,Tt("E",pe))}}]),se}(),Dn=1e3,_i=4e3,Qt=3,er=!0,jt=function(be){return"https://mcs.".concat(be??"us1",".twilio.com")},kt=function(be){return be.startsWith("http")},br=function(be,oe){return"".concat(kt(be)?"":jt(oe)).concat(be)},Nr=function(){function se(be,oe,pe,ae){var Ze,Pe,ct,tt,it,pt;I.default(this,se);var vt=(Ze=(Pe=ae.MCS)!==null&&Pe!==void 0?Pe:ae)!==null&&Ze!==void 0?Ze:{};this.region=(ct=(tt=vt.region)!==null&&tt!==void 0?tt:ae.region)!==null&&ct!==void 0?ct:"us1",this.mediaUrl=br(oe,this.region),this.mediaSetUrl=pe?br(pe):"".concat(this.mediaUrl,"Set"),this.token=be,this.retryWhenThrottledOverride=(it=vt.retryWhenThrottledOverride)!==null&&it!==void 0?it:er,this.backoffConfigOverride=(pt=vt.backoffConfigOverride)!==null&&pt!==void 0?pt:se.backoffConfigDefault}return C.default(se,[{key:"updateToken",value:function(oe){this.token=oe}}],[{key:"backoffConfigDefault",get:function(){return{min:Dn,max:_i,maxAttemptsCount:Qt}}},{key:"retryWhenThrottledDefault",get:function(){return er}}]),se}(),Xr=function(){function se(be,oe,pe){I.default(this,se),this.config=be,this.network=oe,this._update(pe)}return C.default(se,[{key:"sid",get:function(){return this.state.sid}},{key:"serviceSid",get:function(){return this.state.serviceSid}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"fileName",get:function(){return this.state.filename}},{key:"filename",get:function(){return this.state.filename}},{key:"category",get:function(){return this.state.category}},{key:"getContentUrl",value:function(){var oe=this;return new rr(function(){var pe=D.default(W.default.mark(function ae(Ze,Pe,ct){var tt,it;return W.default.wrap(function(vt){for(;;)switch(vt.prev=vt.next){case 0:return tt=oe.network.get("".concat(oe.config.mediaUrl,"/").concat(oe.sid)),ct(function(){return tt.cancel()}),vt.prev=2,vt.next=5,tt;case 5:it=vt.sent,oe._update(it.body),Ze(oe.state.contentDirectUrl),vt.next=13;break;case 10:vt.prev=10,vt.t0=vt.catch(2),Pe(vt.t0);case 13:case"end":return vt.stop()}},ae,null,[[2,10]])}));return function(ae,Ze,Pe){return pe.apply(this,arguments)}}())}},{key:"_update",value:function(oe){var pe,ae,Ze,Pe;this.state={sid:oe.sid,serviceSid:oe.service_sid,channelSid:oe.channel_sid,messageSid:oe.message_sid,dateCreated:oe.date_created?new Date(oe.date_created):null,dateUploadUpdated:oe.date_upload_updated?new Date(oe.date_upload_updated):null,dateUpdated:oe.date_updated?new Date(oe.date_updated):null,size:oe.size,contentType:oe.content_type,author:oe.author,url:oe.url,contentUrl:oe.links.content,contentDirectUrl:(pe=oe.links.content_direct_temporary)!==null&&pe!==void 0?pe:null,filename:(ae=oe.filename)!==null&&ae!==void 0?ae:null,category:(Ze=oe.category)!==null&&Ze!==void 0?Ze:"media",isMultipartUpstream:(Pe=oe.is_multipart_upstream)!==null&&Pe!==void 0?Pe:!1}}}]),se}();function Yi(se){var be=La();return function(){var pe=q.default(se),ae;if(be){var Ze=q.default(this).constructor;ae=Reflect.construct(pe,arguments,Ze)}else ae=pe.apply(this,arguments);return R.default(this,ae)}}function La(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var hn=function(se){L.default(oe,se);var be=Yi(oe);function oe(pe,ae,Ze,Pe,ct){var tt;return I.default(this,oe),tt=be.call(this,pe),tt.code=ae,tt.body=Ze,tt.status=Pe,tt.headers=ct,tt}return C.default(oe)}(z.default(Error)),qr=r.XMLHttpRequest||{};function Ln(se){return se?se.split(`\r
`).map(function(be){return be.split(": ")}).filter(function(be){return be.length===2&&be[1].length>0}).reduce(function(be,oe){return be[oe[0]]=oe[1],be},{}):{}}function Re(se){var be=se.getResponseHeader("Content-Type");if(!be||be.indexOf("application/json")!==0||se.responseText.length===0)return se.responseText;try{return JSON.parse(se.responseText)}catch{return se.responseText}}var Ie=function(){function se(){I.default(this,se)}return C.default(se,[{key:"get",value:function(oe,pe){return se.request("GET",oe,pe)}},{key:"post",value:function(oe,pe,ae){return se.request("POST",oe,pe,ae)}}],[{key:"request",value:function(oe,pe,ae,Ze){return new rr(function(Pe,ct,tt){var it=new qr,pt=!1;tt(function(){it.abort(),pt=!0}),it.open(oe,pe,!0),it.onreadystatechange=function(){if(!(it.readyState!==4||pt)){var ft=Ln(it.getAllResponseHeaders()),ht=Re(it);if(200<=it.status&&it.status<300)Pe({status:it.status,headers:ft,body:ht});else{var Mt,tn=(Mt=it.statusText)!==null&&Mt!==void 0?Mt:"NONE",Un;if(typeof ht=="string")if(ht&&ht.split(`
`,2).length===1)Un=ht;else{var St,ri=(St=ht.replace(/<.*?>/g,"").split(/\r\n/g).filter(function(bo){return bo.length})[0])===null||St===void 0?void 0:St.split(" ");Un=(ri==null?void 0:ri.length)>2?ri==null?void 0:ri.slice(1).join(" "):""}else Un=JSON.stringify(ht);var Qr="".concat(it.status,": [").concat(tn,"] ").concat(Un);ct(new hn(Qr,it.status,ht,tn,ft))}}};for(var vt in ae)it.setRequestHeader(vt,ae[vt]),vt==="Content-Type"&&ae[vt]==="application/json"&&(Ze=JSON.stringify(Ze));it.send(Ze)})}}]),se}(),he=Be.scope("Network"),ye=function(){function se(be,oe){I.default(this,se),this.config=be,this.transport=oe}return C.default(se,[{key:"backoffConfig",value:function(){return Object.assign(Nr.backoffConfigDefault,this.config.backoffConfigOverride)}},{key:"retryWhenThrottled",value:function(){var oe,pe;return(oe=(pe=this.config.retryWhenThrottledOverride)!==null&&pe!==void 0?pe:Nr.retryWhenThrottledDefault)!==null&&oe!==void 0?oe:!1}},{key:"executeWithRetry",value:function(oe,pe){var ae=this;return new rr(function(){var Ze=D.default(W.default.mark(function Pe(ct,tt,it){var pt,vt;return W.default.wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:pt=new v.Retrier(ae.backoffConfig()),vt=[502,503,504],pe&&vt.push(429),it(function(){pt.cancel(),pt.removeAllListeners()}),pt.on("attempt",D.default(W.default.mark(function ht(){var Mt,tn;return W.default.wrap(function(St){for(;;)switch(St.prev=St.next){case 0:return St.prev=0,Mt=oe(),it(function(){Mt.cancel(),pt.cancel(),pt.removeAllListeners()}),St.next=5,Mt;case 5:tn=St.sent,pt.succeeded(tn),St.next=12;break;case 9:St.prev=9,St.t0=St.catch(0),vt.indexOf(St.t0.status)>-1||St.t0.message==="Twilsock disconnected"?pt.failed(St.t0):(pt.removeAllListeners(),pt.cancel(),tt(St.t0));case 12:case"end":return St.stop()}},ht,null,[[0,9]])}))),pt.on("succeeded",function(ht){ct(ht)}),pt.on("cancelled",function(ht){return tt(ht)}),pt.on("failed",function(ht){return tt(ht)}),pt.start();case 9:case"end":return ft.stop()}},Pe)}));return function(Pe,ct,tt){return Ze.apply(this,arguments)}}())}},{key:"get",value:function(oe){var pe=this;return new rr(function(){var ae=D.default(W.default.mark(function Ze(Pe,ct,tt){var it,pt,vt;return W.default.wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:return it={"X-Twilio-Token":pe.config.token},pt=pe.executeWithRetry(function(){return pe.transport.get(oe,it)},pe.retryWhenThrottled()),he.trace("sending GET request to ",oe," headers ",it),tt(function(){return pt.cancel()}),ft.prev=4,ft.next=7,pt;case 7:vt=ft.sent,he.trace("response",vt),Pe(vt),ft.next=16;break;case 12:ft.prev=12,ft.t0=ft.catch(4),he.debug("get() error ".concat(ft.t0)),ct(ft.t0);case 16:case"end":return ft.stop()}},Ze,null,[[4,12]])}));return function(Ze,Pe,ct){return ae.apply(this,arguments)}}())}},{key:"post",value:function(oe,pe,ae,Ze,Pe){var ct=this,tt={"X-Twilio-Token":this.config.token};(typeof FormData>"u"||!(ae instanceof FormData))&&Ze&&Object.assign(tt,{"Content-Type":Ze});var it=new URL(oe);return pe&&it.searchParams.append("Category",pe),Pe&&it.searchParams.append("Filename",Pe),new rr(function(){var pt=D.default(W.default.mark(function vt(st,ft,ht){var Mt,tn;return W.default.wrap(function(St){for(;;)switch(St.prev=St.next){case 0:return Mt=ct.transport.post(it.href,tt,ae),ht(function(){return Mt.cancel()}),he.trace("sending POST request to ".concat(oe," with headers ").concat(tt)),St.prev=3,St.next=6,Mt;case 6:tn=St.sent,St.next=17;break;case 9:if(St.prev=9,St.t0=St.catch(3),!(r.XMLHttpRequest===void 0&&ae instanceof FormData)){St.next=14;break}return ft(new TypeError("Posting FormData supported only with browser engine's FormData")),St.abrupt("return");case 14:return he.debug("post() error ".concat(St.t0)),ft(St.t0),St.abrupt("return");case 17:he.trace("response",tn),st(tn);case 19:case"end":return St.stop()}},vt,null,[[3,9]])}));return function(vt,st,ft){return pt.apply(this,arguments)}}())}}]),se}(),ge="0.6.5",Ae,De=Be.scope("");t.default=(Ae=function(){function se(be,oe,pe){var ae,Ze,Pe=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};I.default(this,se),this.options=Pe,this.options.logLevel=(ae=this.options.logLevel)!==null&&ae!==void 0?ae:"silent",this.config=new Nr(be,oe,pe,this.options),De.setLevel(this.options.logLevel),this.options.transport=(Ze=this.options.transport)!==null&&Ze!==void 0?Ze:new Ie,this.transport=this.options.transport,this.network=new ye(this.config,this.transport)}return C.default(se,[{key:"updateToken",value:function(oe){De.info("updateToken"),this.config.updateToken(oe)}},{key:"get",value:function(oe){var pe=this;return new rr(function(){var ae=D.default(W.default.mark(function Ze(Pe,ct,tt){var it,pt;return W.default.wrap(function(st){for(;;)switch(st.prev=st.next){case 0:return it=pe.network.get("".concat(pe.config.mediaUrl,"/").concat(oe)),tt(function(){return it.cancel()}),st.prev=2,st.next=5,it;case 5:pt=st.sent,Pe(new Xr(pe.config,pe.network,pt.body)),st.next=12;break;case 9:st.prev=9,st.t0=st.catch(2),ct(st.t0);case 12:case"end":return st.stop()}},Ze,null,[[2,9]])}));return function(Ze,Pe,ct){return ae.apply(this,arguments)}}())}},{key:"post",value:function(oe,pe,ae,Ze){var Pe=this;return new rr(function(){var ct=D.default(W.default.mark(function tt(it,pt,vt){var st,ft;return W.default.wrap(function(Mt){for(;;)switch(Mt.prev=Mt.next){case 0:return st=Pe.network.post(Pe.config.mediaUrl,ae??"media",pe,oe,Ze),vt(function(){return st.cancel()}),Mt.prev=2,Mt.next=5,st;case 5:ft=Mt.sent,it(new Xr(Pe.config,Pe.network,ft.body)),Mt.next=12;break;case 9:Mt.prev=9,Mt.t0=Mt.catch(2),pt(Mt.t0);case 12:case"end":return Mt.stop()}},tt,null,[[2,9]])}));return function(tt,it,pt){return ct.apply(this,arguments)}}())}},{key:"postFormData",value:function(oe,pe){var ae=this;return new rr(function(){var Ze=D.default(W.default.mark(function Pe(ct,tt,it){var pt,vt;return W.default.wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:return pt=ae.network.post(ae.config.mediaUrl,pe??"media",oe),it(function(){return pt.cancel()}),ft.prev=2,ft.next=5,pt;case 5:vt=ft.sent,ct(new Xr(ae.config,ae.network,vt.body)),ft.next=12;break;case 9:ft.prev=9,ft.t0=ft.catch(2),tt(ft.t0);case 12:case"end":return ft.stop()}},Pe,null,[[2,9]])}));return function(Pe,ct,tt){return Ze.apply(this,arguments)}}())}},{key:"mediaSetGet",value:function(oe){var pe=this;return new rr(function(){var ae=D.default(W.default.mark(function Ze(Pe,ct,tt){var it,pt,vt,st;return W.default.wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:return it={command:"get",list:oe.map(function(Mt){return{media_sid:Mt}})},pt=pe.network.post("".concat(pe.config.mediaSetUrl),null,it,"application/json"),tt(function(){return pt.cancel()}),ht.prev=3,ht.next=6,pt;case 6:vt=ht.sent,st=vt.body.map(function(Mt){if(Mt.code!==200){ct("Failed to obtain detailed information about Media items (failed SID ".concat(Mt.media_record.sid,")"));return}return new Xr(pe.config,pe.network,Mt.media_record)}),Pe(st),ht.next=14;break;case 11:ht.prev=11,ht.t0=ht.catch(3),ct(ht.t0);case 14:case"end":return ht.stop()}},Ze,null,[[3,11]])}));return function(Ze,Pe,ct){return ae.apply(this,arguments)}}())}},{key:"mediaSetGetContentUrls",value:function(oe){var pe=this;return new rr(function(){var ae=D.default(W.default.mark(function Ze(Pe,ct,tt){var it,pt,vt,st;return W.default.wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:return it={command:"get",list:oe.map(function(Mt){return{media_sid:Mt}})},pt=pe.network.post("".concat(pe.config.mediaSetUrl),null,it,"application/json"),tt(function(){return pt.cancel()}),ht.prev=3,ht.next=6,pt;case 6:vt=ht.sent,st=new Map,vt.body.forEach(function(Mt){if(Mt.code!==200){ct("Failed to obtain detailed information about Media items (failed SID ".concat(Mt.media_record.sid,")"));return}st.set(Mt.media_record.sid,Mt.media_record.links.content_direct_temporary)}),Pe(st),ht.next=15;break;case 12:ht.prev=12,ht.t0=ht.catch(3),ct(ht.t0);case 15:case"end":return ht.stop()}},Ze,null,[[3,12]])}));return function(Ze,Pe,ct){return ae.apply(this,arguments)}}())}}]),se}(),F.default(Ae,"version",ge),Ae),Pt([p.validateTypes(p.nonEmptyString),ot("design:type",Function),ot("design:paramtypes",[String]),ot("design:returntype",void 0)],t.default.prototype,"updateToken",null),Pt([p.validateTypesAsync(p.nonEmptyString),ot("design:type",Function),ot("design:paramtypes",[String]),ot("design:returntype",rr)],t.default.prototype,"get",null),t.default=Pt([p.validateConstructorTypes(p.nonEmptyString,p.nonEmptyString,[p.nonEmptyString,p.literal(null)],[p.pureObject,"undefined"]),ot("design:paramtypes",[String,String,Object,Object])],t.default),t.CancellablePromise=rr,t.Client=t.default,t.McsClient=t.default,t.McsMedia=Xr,t.Media=Xr})(PA);var AP=yr,m1e=Jr,g1e=Li,y1e=AP.aTypedArray,b1e=AP.exportTypedArrayMethod;b1e("at",function(r){var e=y1e(this),n=m1e(e),i=g1e(r),a=i>=0?i:n+i;return a<0||a>=n?void 0:e[a]});var _1e=Lt,w1e=zt,k1e=iN,T1e=Dd,k0="ArrayBuffer",PP=k1e[k0],S1e=w1e[k0];_1e({global:!0,constructor:!0,forced:S1e!==PP},{ArrayBuffer:PP}),T1e(k0);var E1e=Lt,xP=Dt,M1e=$n,C1e=en,DP=Jr,R1e=Kb,LP=Fr,T0=Ot,I1e=c_,O1e=Jd,UP=a3,N1e=o3,jP=zs,VP=u3,mo=[],FP=xP(mo.sort),A1e=xP(mo.push),P1e=T0(function(){mo.sort(void 0)}),x1e=T0(function(){mo.sort(null)}),D1e=O1e("sort"),$P=!T0(function(){if(jP)return jP<70;if(!(UP&&UP>3)){if(N1e)return!0;if(VP)return VP<603;var t="",r,e,n,i;for(r=65;r<76;r++){switch(e=String.fromCharCode(r),r){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)mo.push({k:e+i,v:n})}for(mo.sort(function(a,o){return o.v-a.v}),i=0;i<mo.length;i++)e=mo[i].k.charAt(0),t.charAt(t.length-1)!==e&&(t+=e);return t!=="DGBEFHACIJK"}}),L1e=P1e||!x1e||!D1e||!$P,U1e=function(t){return function(r,e){return e===void 0?-1:r===void 0?1:t!==void 0?+t(r,e)||0:LP(r)>LP(e)?1:-1}};E1e({target:"Array",proto:!0,forced:L1e},{sort:function(r){r!==void 0&&M1e(r);var e=C1e(this);if($P)return r===void 0?FP(e):FP(e,r);var n=[],i=DP(e),a,o;for(o=0;o<i;o++)o in e&&A1e(n,e[o]);for(I1e(n,U1e(r)),a=DP(n),o=0;o<a;)e[o]=n[o++];for(;o<i;)R1e(e,o++);return e}});var j1e=Lt,V1e=Dt,F1e=xA,$1e=xi,zP=Fr,z1e=DA,W1e=V1e("".indexOf);j1e({target:"String",proto:!0,forced:!z1e("includes")},{includes:function(r){return!!~W1e(zP($1e(this)),zP(F1e(r)),arguments.length>1?arguments[1]:void 0)}});var fv={},S0={},B1e={get exports(){return S0},set exports(t){S0=t}};(function(t){(function(r,e){t.exports?t.exports=e():r.log=e()})(V,function(){var r=function(){},e="undefined",n=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function a(y,k){var I=y[k];if(typeof I.bind=="function")return I.bind(y);try{return Function.prototype.bind.call(I,y)}catch{return function(){return Function.prototype.apply.apply(I,[y,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(y){return y==="debug"&&(y="log"),typeof console===e?!1:y==="trace"&&n?o:console[y]!==void 0?a(console,y):console.log!==void 0?a(console,"log"):r}function u(y,k){for(var I=0;I<i.length;I++){var C=i[I];this[C]=I<y?r:this.methodFactory(C,y,k)}this.log=this.debug}function l(y,k,I){return function(){typeof console!==e&&(u.call(this,k,I),this[y].apply(this,arguments))}}function c(y,k,I){return s(y)||l.apply(this,arguments)}function f(y,k,I){var C=this,L;k=k??"WARN";var R="loglevel";typeof y=="string"?R+=":"+y:typeof y=="symbol"&&(R=void 0);function q(W){var X=(i[W]||"silent").toUpperCase();if(!(typeof window===e||!R)){try{window.localStorage[R]=X;return}catch{}try{window.document.cookie=encodeURIComponent(R)+"="+X+";"}catch{}}}function z(){var W;if(!(typeof window===e||!R)){try{W=window.localStorage[R]}catch{}if(typeof W===e)try{var X=window.document.cookie,me=X.indexOf(encodeURIComponent(R)+"=");me!==-1&&(W=/^([^;]+)/.exec(X.slice(me))[1])}catch{}return C.levels[W]===void 0&&(W=void 0),W}}function F(){if(!(typeof window===e||!R)){try{window.localStorage.removeItem(R);return}catch{}try{window.document.cookie=encodeURIComponent(R)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}C.name=y,C.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},C.methodFactory=I||c,C.getLevel=function(){return L},C.setLevel=function(W,X){if(typeof W=="string"&&C.levels[W.toUpperCase()]!==void 0&&(W=C.levels[W.toUpperCase()]),typeof W=="number"&&W>=0&&W<=C.levels.SILENT){if(L=W,X!==!1&&q(W),u.call(C,W,y),typeof console===e&&W<C.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+W},C.setDefaultLevel=function(W){k=W,z()||C.setLevel(W,!1)},C.resetLevel=function(){C.setLevel(k,!1),F()},C.enableAll=function(W){C.setLevel(C.levels.TRACE,W)},C.disableAll=function(W){C.setLevel(C.levels.SILENT,W)};var D=z();D==null&&(D=k),C.setLevel(D,!1)}var d=new f,v={};d.getLogger=function(k){if(typeof k!="symbol"&&typeof k!="string"||k==="")throw new TypeError("You must supply a name when creating a logger.");var I=v[k];return I||(I=v[k]=new f(k,d.getLevel(),d.methodFactory)),I};var p=typeof window!==e?window.log:void 0;return d.noConflict=function(){return typeof window!==e&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return v},d.default=d,d})})(B1e);/*
  @license
  Copyright (c) 2022 Twilio Inc.

  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


  */Object.defineProperty(fv,"__esModule",{value:!0});var Z1e=S0;function q1e(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var dv=q1e(Z1e),Q1e=function(r,e,n){return function(i,a,o){if(typeof o.value!="function"&&(o==null?void 0:o.get)===void 0)throw new Error("The deprecated decorator can only be applied to methods or getters");if(typeof o.value=="function"){var s=o.value;o.value=function(){E0("The method ".concat(r," is deprecated").concat(e?", use "+e+" instead":"").concat(n?", "+n:"."));for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return s.apply(this,c)};return}var u=o.get;o.get=function(){return E0("The getter ".concat(r," is deprecated").concat(e?", use "+e+" instead":"").concat(n?", "+n:".")),u==null?void 0:u.apply(this)}}},E0=function(r){var e=dv.default.getLevel();dv.default.setLevel("warn"),dv.default.warn(r),dv.default.setLevel(e)};fv.deprecated=Q1e,fv.deprecationWarning=E0;var Y1e=Lt,G1e=In.find,H1e=Oy,M0="find",WP=!0;M0 in[]&&Array(1)[M0](function(){WP=!1}),Y1e({target:"Array",proto:!0,forced:WP},{find:function(r){return G1e(this,r,arguments.length>1?arguments[1]:void 0)}}),H1e(M0);var pv={},BP={get exports(){return pv},set exports(t){pv=t}},ZP=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(ZP){var qP=new Uint8Array(16);BP.exports=function(){return ZP(qP),qP}}else{var QP=new Array(16);BP.exports=function(){for(var r=0,e;r<16;r++)r&3||(e=Math.random()*4294967296),QP[r]=e>>>((r&3)<<3)&255;return QP}}for(var YP=[],vv=0;vv<256;++vv)YP[vv]=(vv+256).toString(16).substr(1);function J1e(t,r){var e=r||0,n=YP;return[n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],"-",n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]],n[t[e++]]].join("")}var GP=J1e,X1e=pv,K1e=GP,HP,C0,R0=0,I0=0;function ewe(t,r,e){var n=r&&e||0,i=r||[];t=t||{};var a=t.node||HP,o=t.clockseq!==void 0?t.clockseq:C0;if(a==null||o==null){var s=X1e();a==null&&(a=HP=[s[0]|1,s[1],s[2],s[3],s[4],s[5]]),o==null&&(o=C0=(s[6]<<8|s[7])&16383)}var u=t.msecs!==void 0?t.msecs:new Date().getTime(),l=t.nsecs!==void 0?t.nsecs:I0+1,c=u-R0+(l-I0)/1e4;if(c<0&&t.clockseq===void 0&&(o=o+1&16383),(c<0||u>R0)&&t.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");R0=u,I0=l,C0=o,u+=122192928e5;var f=((u&268435455)*1e4+l)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=f&255;var d=u/4294967296*1e4&268435455;i[n++]=d>>>8&255,i[n++]=d&255,i[n++]=d>>>24&15|16,i[n++]=d>>>16&255,i[n++]=o>>>8|128,i[n++]=o&255;for(var v=0;v<6;++v)i[n+v]=a[v];return r||K1e(i)}var twe=ewe,rwe=pv,nwe=GP;function iwe(t,r,e){var n=r&&e||0;typeof t=="string"&&(r=t==="binary"?new Array(16):null,t=null),t=t||{};var i=t.random||(t.rng||rwe)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,r)for(var a=0;a<16;++a)r[n+a]=i[a];return r||nwe(i)}var awe=iwe,owe=twe,JP=awe,O0=JP;O0.v1=owe,O0.v4=JP;var swe=O0,uwe=Lt,lwe=$I,cwe=Ot,fwe=Sr,dwe=rc.onFreeze,N0=Object.freeze,pwe=cwe(function(){N0(1)});uwe({target:"Object",stat:!0,forced:pwe,sham:!lwe},{freeze:function(r){return N0&&fwe(r)?N0(dwe(r)):r}});/*
  @license
  The following license applies to all parts of this software except as
  documented below.

      Copyright (c) 2019, Twilio, inc.
      All rights reserved.

      Redistribution and use in source and binary forms, with or without
      modification, are permitted provided that the following conditions are
      met:

        1. Redistributions of source code must retain the above copyright
           notice, this list of conditions and the following disclaimer.

        2. Redistributions in binary form must reproduce the above copyright
           notice, this list of conditions and the following disclaimer in
           the documentation and/or other materials provided with the
           distribution.

        3. Neither the name of Twilio nor the names of its contributors may
           be used to endorse or promote products derived from this software
           without specific prior written permission.

      THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
      "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
      LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
      A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
      HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
      SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
      LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
      DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
      THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
      (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
      OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

  This software includes javascript-state-machine under the following license.

      Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

      Permission is hereby granted, free of charge, to any person obtaining a copy
      of this software and associated documentation files (the "Software"), to deal
      in the Software without restriction, including without limitation the rights
      to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
      copies of the Software, and to permit persons to whom the Software is
      furnished to do so, subject to the following conditions:

      The above copyright notice and this permission notice shall be included in all
      copies or substantial portions of the Software.

      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
      IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
      FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
      AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
      LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
      OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

  This software includes loglevel under the following license.

      Copyright (c) 2013 Tim Perry

      Permission is hereby granted, free of charge, to any person
      obtaining a copy of this software and associated documentation
      files (the "Software"), to deal in the Software without
      restriction, including without limitation the rights to use,
      copy, modify, merge, publish, distribute, sublicense, and/or sell
      copies of the Software, and to permit persons to whom the
      Software is furnished to do so, subject to the following
      conditions:

      The above copyright notice and this permission notice shall be
      included in all copies or substantial portions of the Software.

      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
      EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
      OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
      NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
      HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
      WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
      FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
      OTHER DEALINGS IN THE SOFTWARE.

  This software includes q under the following license.

      Copyright 20092014 Kristopher Michael Kowal. All rights reserved.
      Permission is hereby granted, free of charge, to any person obtaining a copy
      of this software and associated documentation files (the "Software"), to
      deal in the Software without restriction, including without limitation the
      rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
      sell copies of the Software, and to permit persons to whom the Software is
      furnished to do so, subject to the following conditions:

      The above copyright notice and this permission notice shall be included in
      all copies or substantial portions of the Software.

      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
      IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
      FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
      AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
      LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
      FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
      IN THE SOFTWARE.

  This software includes platform.js under the following license.

      Copyright 2014 Benjamin Tan <https://d10.github.io/>
      Copyright 2011-2015 John-David Dalton <http://allyoucanleet.com/>

      Permission is hereby granted, free of charge, to any person obtaining
      a copy of this software and associated documentation files (the
      "Software"), to deal in the Software without restriction, including
      without limitation the rights to use, copy, modify, merge, publish,
      distribute, sublicense, and/or sell copies of the Software, and to
      permit persons to whom the Software is furnished to do so, subject to
      the following conditions:

      The above copyright notice and this permission notice shall be
      included in all copies or substantial portions of the Software.

      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
      EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
      MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
      NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
      LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
      OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
      WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  */(function(t){var r=typeof r<"u"?r:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(t,"__esModule",{value:!0});var e=Bo,n=ha,i=Bn,a=Zn,o=wn,s=ma,u=ji,l=qn,c=Yl,f=_n,d=Ho,v=loe,p=Zr,y=to,k=cb,I=gp,C=eo,L=Ta,R=kp,q=O3,z=Tn,F=PA,D=fv,W=bu,X=swe;function me(M){return M&&typeof M=="object"&&"default"in M?M:{default:M}}function de(M){if(M&&M.__esModule)return M;var O=Object.create(null);return M&&Object.keys(M).forEach(function(T){if(T!=="default"){var g=Object.getOwnPropertyDescriptor(M,T);Object.defineProperty(O,T,g.get?g:{enumerable:!0,get:function(){return M[T]}})}}),O.default=M,Object.freeze(O)}var H=me(e),ee=me(n),Z=me(i),te=me(a),re=me(o),K=me(s),fe=me(u),Te=me(l),$=me(c),We=me(f),et=de(d),dt=me(y),$e=me(I),ue=me(C),Rr=me(W);function Ue(M,O,T,g){var m=arguments.length,S=m<3?O:g===null?g=Object.getOwnPropertyDescriptor(O,T):g,b;if((typeof Reflect>"u"?"undefined":We.default(Reflect))==="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(M,O,T,g);else for(var _=M.length-1;_>=0;_--)(b=M[_])&&(S=(m<3?b(S):m>3?b(O,T,S):b(O,T))||S);return m>3&&S&&Object.defineProperty(O,T,S),S}function ke(M,O){if((typeof Reflect>"u"?"undefined":We.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(M,O)}function Gt(M,O){return["".concat(new Date().toISOString()," Conversations ").concat(M,":")].concat(Array.from(O))}var Qe=et.getLogger("twilio-conversations"),vr=function(){function M(O){Te.default(this,M),K.default(this,"prefix",""),this.prefix=O!=null&&O.length>0?O+" ":""}return fe.default(M,[{key:"setLevel",value:function(T){Qe.setLevel(T)}},{key:"trace",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.trace.apply(null,Gt(this.prefix+"T",g))}},{key:"debug",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.debug.apply(null,Gt(this.prefix+"D",g))}},{key:"info",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.info.apply(null,Gt(this.prefix+"I",g))}},{key:"warn",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.warn.apply(null,Gt(this.prefix+"W",g))}},{key:"error",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.error.apply(null,Gt(this.prefix+"E",g))}}],[{key:"scope",value:function(T){return new M(T)}},{key:"setLevel",value:function(T){Qe.setLevel(T)}},{key:"trace",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.trace.apply(null,Gt("T",g))}},{key:"debug",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.debug.apply(null,Gt("D",g))}},{key:"info",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.info.apply(null,Gt("I",g))}},{key:"warn",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.warn.apply(null,Gt("W",g))}},{key:"error",value:function(){for(var T=arguments.length,g=new Array(T),m=0;m<T;m++)g[m]=arguments[m];Qe.error.apply(null,Gt("E",g))}}]),M}();function At(M,O){var T=Object.keys(M);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(M);O&&(g=g.filter(function(m){return Object.getOwnPropertyDescriptor(M,m).enumerable})),T.push.apply(T,g)}return T}function Oe(M){for(var O=1;O<arguments.length;O++){var T=arguments[O]!=null?arguments[O]:{};O%2?At(Object(T),!0).forEach(function(g){K.default(M,g,T[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(T)):At(Object(T)).forEach(function(g){Object.defineProperty(M,g,Object.getOwnPropertyDescriptor(T,g))})}return M}var _t=5,Bt="PT5S",Fe="PT5S",rr=100,Pt=1e3,ot=4e3,Tt=3,Be=!0,Dn=fe.default(function M(){var O,T,g,m,S,b,_,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=arguments.length>1?arguments[1]:void 0,N=arguments.length>2?arguments[2]:void 0;Te.default(this,M),K.default(this,"typingIndicatorTimeoutDefault",_t*1e3);var J=w.Chat||w.IPMessaging||w||{};this.productId=J.productId,this.links={myConversations:E.links.my_conversations,conversations:E.links.conversations,users:E.links.users,currentUser:E.links.current_user,typing:E.links.typing,mediaService:E.links.media_service,mediaSetService:E.links.media_set_service,messagesReceipts:E.links.messages_receipts},this.limits={mediaAttachmentsCountLimit:E.options.media_attachments_count_limit,mediaAttachmentSizeLimitInMb:E.options.media_attachment_size_limit_in_mb,mediaAttachmentsTotalSizeLimitInMb:E.options.media_attachments_total_size_limit_in_mb,emailHistoriesAllowedContentTypes:E.options.email_histories_allowed_mime_types,emailBodiesAllowedContentTypes:E.options.email_bodies_allowed_mime_types},this.typingIndicatorTimeoutOverride=J.typingIndicatorTimeoutOverride,this.backoffConfiguration=Oe({min:Pt,max:ot,maxAttemptsCount:Tt},J.backoffConfigOverride),this.retryWhenThrottled=J.retryWhenThrottledOverride!==void 0?J.retryWhenThrottledOverride:Be,this.userInfosToSubscribe=(O=(T=J.userInfosToSubscribeOverride)!==null&&T!==void 0?T:E.options.user_infos_to_subscribe)!==null&&O!==void 0?O:rr,this.reachabilityEnabled=E.options.reachability_enabled,this.userIdentity=E.identity,this.userInfo=E.sync_objects.my_user_info,this.myConversations=E.sync_objects.my_conversations;var ne=(g=(m=J.httpCacheIntervalOverride)!==null&&m!==void 0?m:E.options.http_cache_interval)!==null&&g!==void 0?g:Bt;try{this.httpCacheInterval=v.toSeconds(v.parse(ne))}catch{N.error("Failed to parse http cache interval ".concat(ne,", using default value ").concat(Bt)),this.httpCacheInterval=v.toSeconds(v.parse(Bt))}var ce=(S=(b=J.consumptionReportIntervalOverride)!==null&&b!==void 0?b:E.options.consumption_report_interval)!==null&&S!==void 0?S:Fe;try{this.consumptionReportInterval=v.toSeconds(v.parse(ce))}catch{N.error("Failed to parse consumption report interval ".concat(ce,", using default value ").concat(Fe)),this.consumptionReportInterval=v.toSeconds(v.parse(Fe))}this.channelMetadataCacheCapacity=(_=w.channelMetadataCacheCapacity)!==null&&_!==void 0?_:100});function _i(M){return JSON.parse(JSON.stringify(M))}function Qt(M){return typeof M<"u"&&!isNaN(Number(M))?Number(M):null}function er(M){try{return new Date(M)}catch{return null}}function jt(M,O,T){var g={};if(M)try{g=JSON.parse(M)}catch(m){T.warn(O,m)}return g}var kt=function(){function M(O){Te.default(this,M),this.base=O.replace(/\/$/,""),this.args=[],this.paths=[]}return fe.default(M,[{key:"arg",value:function(T,g){return typeof g<"u"&&this.args.push(encodeURIComponent(T)+"="+encodeURIComponent(g)),this}},{key:"path",value:function(T){return this.paths.push(encodeURIComponent(T)),this}},{key:"build",value:function(){var T=this.base;return this.paths.length&&(T+="/"+this.paths.join("/")),this.args.length&&(T+="?"+this.args.join("&")),T}}]),M}(),br=p.custom(function(M){return[["string","number","boolean","object"].includes(We.default(M)),"a JSON type"]}),Nr=p.custom(function(M){return[["undefined","string","number","boolean","object"].includes(We.default(M)),"an optional JSON type"]}),Xr=p.objectSchema("send media options",{contentType:[p.literal(null),"string"],filename:["string","undefined"],media:[p.literal("null"),"string"].concat(dt.default(typeof Buffer=="function"?[Buffer]:[]),dt.default(typeof Blob=="function"?[Blob]:[]))});function Yi(M){var O=La();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function La(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var hn=vr.scope("User"),qr=function(M){Z.default(T,M);var O=Yi(T);function T(g,m,S,b){var _;return Te.default(this,T),_=O.call(this),K.default(ee.default(_),"promiseToFetch",null),K.default(ee.default(_),"updated","updated"),K.default(ee.default(_),"userSubscribed","userSubscribed"),K.default(ee.default(_),"userUnsubscribed","userUnsubscribed"),_.services=b,_.subscribed="initializing",_.setMaxListeners(0),_.state={identity:g,entityName:m,friendlyName:null,attributes:{},online:null,notifiable:null},_._initializationPromise=new Promise(function(w){_._resolveInitializationPromise=w}),S!==null&&_._resolveInitialization(S,g,m,!1),_}return fe.default(T,[{key:"identity",get:function(){return this.state.identity},set:function(m){this.state.identity=m}},{key:"entityName",set:function(m){this.state.entityName=m}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"isOnline",get:function(){return this.state.online}},{key:"isNotifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return this.subscribed=="subscribed"}},{key:"_update",value:function(){var g=H.default($.default.mark(function S(b,_){var w,E;return $.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,this._initializationPromise;case 2:w=[],hn.debug("User for",this.state.identity,"updated:",b,_),J.t0=b,J.next=J.t0==="friendlyName"?7:J.t0==="attributes"?9:J.t0==="reachability"?12:15;break;case 7:return this.state.friendlyName!==_.value&&(w.push("friendlyName"),this.state.friendlyName=_.value),J.abrupt("break",16);case 9:return E=jt(_.value,"Retrieved malformed attributes from the server for user: ".concat(this.state.identity),hn),$e.default(this.state.attributes,E)||(this.state.attributes=E,w.push("attributes")),J.abrupt("break",16);case 12:return this.state.online!==_.online&&(this.state.online=_.online,w.push("reachabilityOnline")),this.state.notifiable!==_.notifiable&&(this.state.notifiable=_.notifiable,w.push("reachabilityNotifiable")),J.abrupt("break",16);case 15:return J.abrupt("return");case 16:w.length>0&&this.emit("updated",{user:this,updateReasons:w});case 17:case"end":return J.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"_updateReachabilityInfo",value:function(){var g=H.default($.default.mark(function S(b,_){var w=this;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this._initializationPromise;case 2:if(this.configuration.reachabilityEnabled){N.next=4;break}return N.abrupt("return",Promise.resolve());case 4:return N.abrupt("return",b.get("reachability").then(_).catch(function(J){hn.warn("Failed to get reachability info for ",w.state.identity,J)}));case 5:case"end":return N.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"_fetch",value:function(){var g=H.default($.default.mark(function S(){var b=this;return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._initializationPromise;case 2:if(this.state.entityName){w.next=4;break}return w.abrupt("return",this);case 4:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then(function(E){return b.entity=E,E.on("itemUpdated",function(N){return hn.debug(b.state.entityName+" ("+b.state.identity+") itemUpdated: "+N.item.key),b._update(N.item.key,N.item.data)}),E.on("itemAdded",function(N){return hn.debug(b.state.entityName+" ("+b.state.identity+") itemAdded: "+N.item.key),b._update(N.item.key,N.item.data)}),Promise.all([E.get("friendlyName").then(function(N){return b._update(N.key,N.data)}),E.get("attributes").then(function(N){return b._update(N.key,N.data)}),b._updateReachabilityInfo(E,function(N){return b._update(N.key,N.data)})])}).then(function(){return hn.debug("Fetched for",b.identity),b.subscribed="subscribed",b.emit("userSubscribed",b),b}).catch(function(E){throw b.promiseToFetch=null,E}),w.abrupt("return",this.promiseToFetch);case 6:case"end":return w.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"_ensureFetched",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._initializationPromise;case 2:return _.abrupt("return",this.promiseToFetch||this._fetch());case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"updateAttributes",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){w.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return w.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(b)});case 6:return w.abrupt("return",this);case 7:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"updateFriendlyName",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){w.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return w.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:b});case 6:return w.abrupt("return",this);case 7:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"unsubscribe",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._initializationPromise;case 2:if(!this.promiseToFetch){_.next=9;break}return _.next=5,this.promiseToFetch;case 5:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 9:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"_resolveInitialization",value:function(m,S,b,_){this.configuration=m,this.identity=S,this.entityName=b,this.links={self:"".concat(this.configuration.links.users,"/").concat(encodeURIComponent(this.identity))},this._resolveInitializationPromise(),_&&this.emit("updated",{user:this,updateReasons:["friendlyName","attributes","reachabilityOnline","reachabilityNotifiable"]})}}]),T}(k.ReplayEventEmitter);Ue([p.validateTypesAsync(br),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Promise)],qr.prototype,"updateAttributes",null),Ue([p.validateTypesAsync(["string"]),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],qr.prototype,"updateFriendlyName",null);function Ln(M,O){var T=typeof Symbol<"u"&&M[Symbol.iterator]||M["@@iterator"];if(!T){if(Array.isArray(M)||(T=Re(M))||O&&M&&typeof M.length=="number"){T&&(M=T);var g=0,m=function(){};return{s:m,n:function(){return g>=M.length?{done:!0}:{done:!1,value:M[g++]}},e:function(E){throw E},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,b=!1,_;return{s:function(){T=T.call(M)},n:function(){var E=T.next();return S=E.done,E},e:function(E){b=!0,_=E},f:function(){try{!S&&T.return!=null&&T.return()}finally{if(b)throw _}}}}function Re(M,O){if(M){if(typeof M=="string")return Ie(M,O);var T=Object.prototype.toString.call(M).slice(8,-1);if(T==="Object"&&M.constructor&&(T=M.constructor.name),T==="Map"||T==="Set")return Array.from(M);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return Ie(M,O)}}function Ie(M,O){(O==null||O>M.length)&&(O=M.length);for(var T=0,g=new Array(O);T<O;T++)g[T]=M[T];return g}var he=function(){function M(O,T){Te.default(this,M),this.configuration=O,this.services=T,this.cache=new Map,this.cacheLifetime=this.configuration.httpCacheInterval*100,this.cleanupCache()}return fe.default(M,[{key:"isExpired",value:function(T){return!this.cacheLifetime||Date.now()-T>this.cacheLifetime}},{key:"cleanupCache",value:function(){var T=Ln(this.cache),g;try{for(T.s();!(g=T.n()).done;){var m=ue.default(g.value,2),S=m[0],b=m[1];this.isExpired(b.timestamp)&&this.cache.delete(S)}}catch(_){T.e(_)}finally{T.f()}this.cache.size===0&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var T=this;this.timer=this.timer||setInterval(function(){return T.cleanupCache()},this.cacheLifetime*2)}},{key:"executeWithRetry",value:function(T){var g=this,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise(function(S,b){var _=[502,503,504];m&&_.push(429);var w=new L.Retrier(g.configuration.backoffConfiguration);w.on("attempt",function(){T().then(function(E){return w.succeeded(E)}).catch(function(E){_.indexOf(E.status)>-1||E.message==="Twilsock disconnected"?w.failed(E):(w.removeAllListeners(),w.cancel(),b(E))})}),w.on("succeeded",function(E){S(E)}),w.on("cancelled",function(E){return b(E)}),w.on("failed",function(E){return b(E)}),w.start()})}},{key:"get",value:function(){var O=H.default($.default.mark(function g(m){var S=this,b,_,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(b=this.cache.get(m),!(b&&!this.isExpired(b.timestamp))){N.next=3;break}return N.abrupt("return",b.response);case 3:return _={},N.next=6,this.executeWithRetry(function(){return S.services.transport.get(m,_,S.configuration.productId)},this.configuration.retryWhenThrottled);case 6:return w=N.sent,this.cache.set(m,{response:w,timestamp:Date.now()}),this.pokeTimer(),N.abrupt("return",w);case 10:case"end":return N.stop()}},g,this)}));function T(g){return O.apply(this,arguments)}return T}()}]),M}(),ye=fe.default(function M(){Te.default(this,M)});K.default(ye,"TYPING_INDICATOR","twilio.ipmsg.typing_indicator"),K.default(ye,"NEW_MESSAGE","twilio.conversations.new_message"),K.default(ye,"ADDED_TO_CONVERSATION","twilio.conversations.added_to_conversation"),K.default(ye,"REMOVED_FROM_CONVERSATION","twilio.conversations.removed_from_conversation"),K.default(ye,"CONSUMPTION_UPDATE","twilio.channel.consumption_update");function ge(M){var O=Ae();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function Ae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var De=vr.scope("Participant"),se=function(M){Z.default(T,M);var O=ge(T);function T(g,m,S,b,_){var w,E,N;if(Te.default(this,T),N=O.call(this),N.conversation=S,N.links=b,N.services=_,N.state={attributes:jt(g.attributes,"Retrieved malformed attributes from the server for participant: "+m,De),dateCreated:g.dateCreated?er(g.dateCreated):null,dateUpdated:g.dateCreated?er(g.dateUpdated):null,sid:m,typingTimeout:null,isTyping:!1,identity:g.identity,roleSid:(w=g.roleSid)!==null&&w!==void 0?w:"",lastReadMessageIndex:Number.isInteger(g.lastConsumedMessageIndex)?g.lastConsumedMessageIndex:null,lastReadTimestamp:g.lastConsumptionTimestamp?er(g.lastConsumptionTimestamp):null,type:g.type||"chat",userInfo:g.userInfo,bindings:(E=g.bindings)!==null&&E!==void 0?E:{}},!g.identity&&!g.type)throw new Error("Received invalid Participant object from server: Missing identity or type of Participant.");return N}return fe.default(T,[{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastReadMessageIndex",get:function(){return this.state.lastReadMessageIndex}},{key:"lastReadTimestamp",get:function(){return this.state.lastReadTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}},{key:"bindings",get:function(){var m;return(m=this.state.bindings)!==null&&m!==void 0?m:{}}},{key:"_startTyping",value:function(m){var S=this;return this.state.typingTimeout&&clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.conversation.emit("typingStarted",this),this.state.typingTimeout=Number(setTimeout(function(){return S._endTyping()},m)),this}},{key:"_endTyping",value:function(){this.state.typingTimeout&&(this.state.isTyping=!1,this.emit("typingEnded",this),this.conversation.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(m){var S=[],b=jt(m.attributes,"Retrieved malformed attributes from the server for participant: "+this.state.sid,De);m.attributes&&!$e.default(this.state.attributes,b)&&(this.state.attributes=b,S.push("attributes"));var _=er(m.dateUpdated);m.dateUpdated&&(_==null?void 0:_.getTime())!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=_,S.push("dateUpdated"));var w=er(m.dateCreated);if(m.dateCreated&&(w==null?void 0:w.getTime())!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=w,S.push("dateCreated")),m.roleSid&&this.state.roleSid!==m.roleSid&&(this.state.roleSid=m.roleSid,S.push("roleSid")),(Number.isInteger(m.lastConsumedMessageIndex)||m.lastConsumedMessageIndex===null)&&this.state.lastReadMessageIndex!==m.lastConsumedMessageIndex&&(this.state.lastReadMessageIndex=m.lastConsumedMessageIndex,S.push("lastReadMessageIndex")),m.lastConsumptionTimestamp){var E=new Date(m.lastConsumptionTimestamp);(!this.state.lastReadTimestamp||this.state.lastReadTimestamp.getTime()!==E.getTime())&&(this.state.lastReadTimestamp=E,S.push("lastReadTimestamp"))}return m.bindings&&!$e.default(this.state.bindings,m.bindings)&&(this.state.bindings=m.bindings,S.push("bindings")),S.length>0&&this.emit("updated",{participant:this,updateReasons:S}),this}},{key:"getUser",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(this.type=="chat"){_.next=2;break}throw new Error("Getting User is not supported for this Participant type: "+this.type);case 2:return _.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"remove",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",this.conversation.removeParticipant(this));case 1:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"updateAttributes",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(b)});case 2:return w.abrupt("return",this);case 3:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()}]),T}(k.ReplayEventEmitter);K.default(se,"typingStarted","typingStarted"),K.default(se,"typingEnded","typingEnded"),K.default(se,"updated","updated"),Ue([p.validateTypesAsync(br),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Promise)],se.prototype,"updateAttributes",null);function be(M){var O=oe();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function oe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pe=vr.scope("Participants"),ae=function(M){Z.default(T,M);var O=be(T);function T(g,m,S,b,_){var w;return Te.default(this,T),w=O.call(this),K.default(ee.default(w),"rosterEntityPromise",null),w.conversation=g,w.participants=m,w.links=S,w.configuration=b,w.services=_,w}return fe.default(T,[{key:"unsubscribe",value:function(){var g=H.default($.default.mark(function S(){var b;return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(!this.rosterEntityPromise){w.next=6;break}return w.next=3,this.rosterEntityPromise;case 3:b=w.sent,b.close(),this.rosterEntityPromise=null;case 6:case"end":return w.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"subscribe",value:function(m){var S=this,b=typeof m=="string"?this.services.syncClient.map({id:m,mode:"open_existing"}):Promise.resolve(m);return this.rosterEntityPromise=this.rosterEntityPromise||b.then(function(_){_.on("itemAdded",function(N){pe.debug(S.conversation.sid+" itemAdded: "+N.item.key),S.upsertParticipant(N.item.key,N.item.data).then(function(J){S.emit("participantJoined",J)})}),_.on("itemRemoved",function(N){pe.debug(S.conversation.sid+" itemRemoved: "+N.key);var J=N.key;if(S.participants.has(J)){var ne=S.participants.get(J);S.participants.delete(J),ne&&S.emit("participantLeft",ne)}}),_.on("itemUpdated",function(N){pe.debug(S.conversation.sid+" itemUpdated: "+N.item.key),S.upsertParticipant(N.item.key,N.item.data)});var w=[],E=function N(J){return J.items.forEach(function(ne){w.push(S.upsertParticipant(ne.key,ne.data))}),J.hasNextPage?J.nextPage().then(N):null};return _.getItems().then(E).then(function(){return Promise.all(w)}).then(function(){return _})}).catch(function(_){throw S.rosterEntityPromise=null,S.services.syncClient.connectionState!="disconnected"&&pe.error("Failed to get roster object for conversation",S.conversation.sid,_),pe.debug("ERROR: Failed to get roster object for conversation",S.conversation.sid,_),_})}},{key:"upsertParticipantFromResponse",value:function(){var g=H.default($.default.mark(function S(b){var _,w,E,N,J,ne,ce,ve;return $.default.wrap(function(Ct){for(;;)switch(Ct.prev=Ct.next){case 0:return w=b.sid,E=b.attributes,N=b.date_created,J=b.date_updated,ne=b.identity,ce=b.role_sid,ve=b.messaging_binding,Ct.next=3,this.upsertParticipant(w,{attributes:E,dateCreated:new Date(N),dateUpdated:new Date(J),identity:ne,roleSid:ce,lastConsumedMessageIndex:null,lastConsumptionTimestamp:null,type:(_=ve==null?void 0:ve.type)!==null&&_!==void 0?_:"chat"});case 3:return Ct.abrupt("return",Ct.sent);case 4:case"end":return Ct.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"upsertParticipant",value:function(){var g=H.default($.default.mark(function S(b,_){var w=this,E,N;return $.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(E=this.participants.get(b),!E){ne.next=3;break}return ne.abrupt("return",E._update(_));case 3:return N={self:"".concat(this.links.participants,"/").concat(b)},E=new se(_,b,this.conversation,N,this.services),this.participants.set(b,E),E.on("updated",function(ce){return w.emit("participantUpdated",ce)}),ne.abrupt("return",E);case 8:case"end":return ne.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"getParticipants",value:function(){var g=H.default($.default.mark(function S(){var b=this;return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var E=[];return b.participants.forEach(function(N){return E.push(N)}),E}):[]);case 1:case"end":return w.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getParticipantBySid",value:function(){var g=H.default($.default.mark(function S(b){var _=this;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var N=_.participants.get(b);if(!N)throw new Error("Participant with SID "+b+" was not found");return N}):null);case 1:case"end":return E.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getParticipantByIdentity",value:function(){var g=H.default($.default.mark(function S(b){var _=this,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return w=null,N.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){if(_.participants.forEach(function(J){J.identity===b&&(w=J)}),!w)throw new Error("Participant with identity "+b+" was not found");return w}):null);case 2:case"end":return N.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"add",value:function(){var g=H.default($.default.mark(function S(b,_){return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:b,attributes:typeof _<"u"?JSON.stringify(_):void 0});case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"addNonChatParticipant",value:function(){var g=H.default($.default.mark(function S(b,_){var w,E,N,J,ne=arguments;return $.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return N=ne.length>2&&ne[2]!==void 0?ne[2]:{},J=ne.length>3&&ne[3]!==void 0?ne[3]:{},ve.next=4,this.services.commandExecutor.mutateResource("post",this.links.participants,{attributes:typeof N<"u"?JSON.stringify(N):void 0,messaging_binding:{address:_,proxy_address:b,name:J==null||(w=J.email)===null||w===void 0?void 0:w.name,level:J==null||(E=J.email)===null||E===void 0?void 0:E.level}});case 4:return ve.abrupt("return",ve.sent);case 5:case"end":return ve.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"remove",value:function(m){return this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(encodeURIComponent(m)))}}]),T}(k.ReplayEventEmitter),Ze=function(){function M(O,T){Te.default(this,M),K.default(this,"mcsMedia",null),this.services=T,O instanceof F.McsMedia&&(this.mcsMedia=O),this.state={sid:O.sid,category:O.category,filename:O.filename,contentType:O.contentType,size:O.size}}return fe.default(M,[{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"category",get:function(){return this.state.category}},{key:"getContentTemporaryUrl",value:function(){var T=this;return new F.CancellablePromise(function(){var g=H.default($.default.mark(function m(S,b,_){var w,E,N,J;return $.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(E=T._fetchMcsMedia(),N=(w=T.mcsMedia)===null||w===void 0?void 0:w.getContentUrl(),_(function(){E.cancel(),N&&N.cancel()}),ce.prev=3,T.mcsMedia){ce.next=9;break}return ce.next=7,E;case 7:J=ce.sent,N=J.getContentUrl();case 9:if(ce.t0=S,!N){ce.next=16;break}return ce.next=13,N;case 13:ce.t1=ce.sent,ce.next=17;break;case 16:ce.t1=null;case 17:ce.t2=ce.t1,(0,ce.t0)(ce.t2),ce.next=24;break;case 21:ce.prev=21,ce.t3=ce.catch(3),b(ce.t3);case 24:case"end":return ce.stop()}},m,null,[[3,21]])}));return function(m,S,b){return g.apply(this,arguments)}}())}},{key:"_fetchMcsMedia",value:function(){var T=this;return new F.CancellablePromise(function(){var g=H.default($.default.mark(function m(S,b,_){var w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(w=T.services.mcsClient.get(T.state.sid),!T.services.mcsClient){N.next=14;break}return _(function(){return w.cancel()}),N.prev=3,N.next=6,w;case 6:T.mcsMedia=N.sent,S(T.mcsMedia),N.next=13;break;case 10:N.prev=10,N.t0=N.catch(3),b(N.t0);case 13:return N.abrupt("return");case 14:b(new Error("Media Content Service is unavailable"));case 15:case"end":return N.stop()}},m,null,[[3,10]])}));return function(m,S,b){return g.apply(this,arguments)}}())}}]),M}(),Pe=function(){function M(O){Te.default(this,M),this.state=O}return fe.default(M,[{key:"total",get:function(){return this.state.total}},{key:"sent",get:function(){return this.state.sent}},{key:"delivered",get:function(){return this.state.delivered}},{key:"read",get:function(){return this.state.read}},{key:"undelivered",get:function(){return this.state.undelivered}},{key:"failed",get:function(){return this.state.failed}},{key:"_update",value:function(T){this.state=T}},{key:"_isEquals",value:function(T){var g=this.total===T.total,m=this.sent===T.sent,S=this.delivered===T.delivered,b=this.read===T.read,_=this.undelivered===T.undelivered,w=this.failed===T.failed;return g&&m&&S&&b&&_&&w}}]),M}(),ct=function(){function M(O,T,g,m){Te.default(this,M),this.state={prevToken:g,nextToken:m,source:T,items:O}}return fe.default(M,[{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}},{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):Promise.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):Promise.reject(new Error("No previous page"))}}]),M}(),tt=fe.default(function M(O){Te.default(this,M),this.sid=O.sid,this.messageSid=O.message_sid,this.conversationSid=O.conversation_sid,this.channelMessageSid=O.channel_message_sid,this.participantSid=O.participant_sid,this.status=O.status||"queued",this.errorCode=O.error_code||0,this.dateCreated=O.date_created,this.dateUpdated=O.date_updated}),it=function(O){return O.map(function(T){var g,m,S,b,_=JSON.stringify(T);switch(T.type){case"QUICK_REPLY":return{type:"reply",title:T.title,id:(g=T.id)!==null&&g!==void 0?g:"",index:(m=T.index)!==null&&m!==void 0?m:0,rawData:_};case"PHONE_NUMBER":return{type:"phone",title:T.title,phone:(S=T.phone)!==null&&S!==void 0?S:"",rawData:_};case"URL":return{type:"url",title:T.title,url:(b=T.url)!==null&&b!==void 0?b:"",rawData:_};default:return{type:"other",rawData:_}}})},pt=function(O,T){var g=JSON.stringify(T);switch(O){case"twilio/text":{var m=T;return{type:"text",body:m.body,rawData:g}}case"twilio/media":{var S=T;return{type:"media",body:S.body,media:S.media,rawData:g}}case"twilio/location":{var b=T;return{type:"location",longitude:b.longitude,latitude:b.latitude,label:b.label,rawData:g}}case"twilio/quick-reply":{var _=T;return{type:"quickReply",body:_.body,replies:_.actions,rawData:g}}case"twilio/call-to-action":{var w=T;return{type:"callToAction",body:w.body,actions:it(w.actions),rawData:g}}case"twilio/list-picker":{var E=T;return{type:"listPicker",body:E.body,button:E.button,items:E.items,rawData:g}}case"twilio/card":{var N,J,ne=T;return{type:"card",title:ne.title,subtitle:ne.subtitle,media:(N=ne.media)!==null&&N!==void 0?N:[],actions:it((J=ne.actions)!==null&&J!==void 0?J:[]),rawData:g}}default:return{type:"other",rawData:g}}},vt=function(O){for(var T=new Map,g=0,m=Object.entries(O);g<m.length;g++){var S=ue.default(m[g],2),b=S[0],_=S[1];T.set(b,pt(b,_))}return T},st=function(){function M(O,T){Te.default(this,M),this.name=O,this.value=T}return fe.default(M,[{key:"copyWithValue",value:function(T){return new M(this.name,T)}}]),M}(),ft=fe.default(function M(O){Te.default(this,M),this.sid=O.sid,this.friendlyName=O.friendly_name,this.variables=Object.entries(JSON.parse(O.variables)).map(function(T){var g=ue.default(T,2),m=g[0],S=g[1];return new st(m,S)}),this.variants=vt(O.variants),this.dateCreated=new Date(O.date_created),this.dateUpdated=new Date(O.date_updated)});function ht(M,O){var T=Object.keys(M);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(M);O&&(g=g.filter(function(m){return Object.getOwnPropertyDescriptor(M,m).enumerable})),T.push.apply(T,g)}return T}function Mt(M){for(var O=1;O<arguments.length;O++){var T=arguments[O]!=null?arguments[O]:{};O%2?ht(Object(T),!0).forEach(function(g){K.default(M,g,T[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(T)):ht(Object(T)).forEach(function(g){Object.defineProperty(M,g,Object.getOwnPropertyDescriptor(T,g))})}return M}function tn(M){var O=Un();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function Un(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var St=vr.scope("Message"),ri=r.XMLHttpRequest||{},Qr=function(M){Z.default(T,M);var O=tn(T);function T(g,m,S,b,_,w){var E,N,J,ne,ce,ve;return Te.default(this,T),ve=O.call(this),ve.conversation=S,ve.links=b,ve.configuration=_,ve.services=w,ve.state={sid:m.sid,index:g,author:m.author,subject:m.subject,contentSid:m.contentSid,body:(E=m.text)!==null&&E!==void 0?E:null,timestamp:m.timestamp?new Date(m.timestamp):null,dateUpdated:m.dateUpdated?new Date(m.dateUpdated):null,lastUpdatedBy:(N=m.lastUpdatedBy)!==null&&N!==void 0?N:null,attributes:jt(m.attributes,"Got malformed attributes for the message ".concat(m.sid),St),type:(J=m.type)!==null&&J!==void 0?J:"text",media:m.type==="media"&&m.media?new Ze(m.media,ve.services):null,medias:m.type==="media"&&m.medias?m.medias.map(function(ut){return new Ze(ut,ve.services)}):m.type==="media"&&m.media&&!m.medias?[new Ze(Mt(Mt({},m.media),{},{category:"media"}),ve.services)]:null,participantSid:(ne=m.memberSid)!==null&&ne!==void 0?ne:null,aggregatedDeliveryReceipt:m.delivery?new Pe(m.delivery):null,hasChannelMetadata:(ce=m.channelMetadata)!==null&&ce!==void 0?ce:!1},ve}return fe.default(T,[{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"subject",get:function(){return this.state.subject}},{key:"contentSid",get:function(){return this.state.contentSid}},{key:"body",get:function(){return this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"attachedMedia",get:function(){return this.getMediaByCategories(["media"])}},{key:"participantSid",get:function(){return this.state.participantSid}},{key:"aggregatedDeliveryReceipt",get:function(){return this.state.aggregatedDeliveryReceipt}},{key:"getMediaByCategory",value:function(m){return this.getMediaByCategories(m)}},{key:"getMediaByCategories",value:function(m){var S;return((S=this.state.medias)!==null&&S!==void 0?S:[]).filter(function(b){return m.includes(b.category)})}},{key:"getEmailBody",value:function(){var m,S,b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(m=(S=this.getMediaByCategories(["body"]))===null||S===void 0?void 0:S.filter(function(_){return _.contentType==b}).shift())!==null&&m!==void 0?m:null}},{key:"getEmailHistory",value:function(){var m,S,b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(m=(S=this.getMediaByCategories(["history"]))===null||S===void 0?void 0:S.filter(function(_){return _.contentType==b}).shift())!==null&&m!==void 0?m:null}},{key:"_update",value:function(m){var S=[];(m.text||typeof m.text=="string")&&m.text!==this.state.body&&(this.state.body=m.text,S.push("body")),m.subject&&m.subject!==this.state.subject&&(this.state.subject=m.subject,S.push("subject")),m.lastUpdatedBy&&m.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=m.lastUpdatedBy,S.push("lastUpdatedBy")),m.author&&m.author!==this.state.author&&(this.state.author=m.author,S.push("author")),m.dateUpdated&&new Date(m.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(m.dateUpdated),S.push("dateUpdated")),m.timestamp&&new Date(m.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(m.timestamp),S.push("dateCreated"));var b=jt(m.attributes,"Got malformed attributes for the message ".concat(this.sid),St);$e.default(this.state.attributes,b)||(this.state.attributes=b,S.push("attributes"));var _=m.delivery,w=this.state.aggregatedDeliveryReceipt,E=!!_&&!!_.total&&!!_.delivered&&!!_.failed&&!!_.read&&!!_.sent&&!!_.undelivered;E&&(w?w._isEquals(_)||(w._update(_),S.push("deliveryReceipt")):(this.state.aggregatedDeliveryReceipt=new Pe(_),S.push("deliveryReceipt"))),S.length>0&&this.emit("updated",{message:this,updateReasons:S})}},{key:"getParticipant",value:function(){var g=H.default($.default.mark(function S(){var b=this,_,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(_=null,!this.state.participantSid){N.next=5;break}return N.next=4,this.conversation.getParticipantBySid(this.state.participantSid).catch(function(){return St.debug('Participant with sid "'.concat(b.participantSid,'" not found for message ').concat(b.sid)),null});case 4:_=N.sent;case 5:if(!(!_&&this.state.author)){N.next=9;break}return N.next=8,this.conversation.getParticipantByIdentity(this.state.author).catch(function(){return St.debug('Participant with identity "'.concat(b.author,'" not found for message ').concat(b.sid)),null});case 8:_=N.sent;case 9:if(!_){N.next=11;break}return N.abrupt("return",_);case 11:throw w="Participant with ",this.state.participantSid&&(w+="SID '"+this.state.participantSid+"' "),this.state.author&&(this.state.participantSid&&(w+="or "),w+="identity '"+this.state.author+"' "),w==="Participant with "&&(w="Participant "),w+="was not found",new Error(w);case 17:case"end":return N.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getDetailedDeliveryReceipts",value:function(){var g=H.default($.default.mark(function S(){var b,_;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._getDetailedDeliveryReceiptsPaginator();case 2:b=E.sent,_=b.items;case 4:if(!b.hasNextPage){E.next=11;break}return E.next=7,b.nextPage();case 7:b=E.sent,_=[].concat(dt.default(_),dt.default(b.items)),E.next=4;break;case 11:return E.abrupt("return",_);case 12:case"end":return E.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"remove",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return _.abrupt("return",this);case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"updateBody",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{body:b});case 2:return w.abrupt("return",this);case 3:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"updateAttributes",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:typeof b<"u"?JSON.stringify(b):void 0});case 2:return w.abrupt("return",this);case 3:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"attachTemporaryUrlsFor",value:function(){var g=H.default($.default.mark(function S(b){var _=this,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(w=b==null?void 0:b.map(function(J){return J.sid}),!(this.services.mcsClient&&w)){N.next=7;break}return N.next=4,this.services.mcsClient.mediaSetGet(w);case 4:return N.abrupt("return",N.sent.map(function(J){return new Ze(J,_.services)}));case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return N.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getTemporaryContentUrlsForMedia",value:function(m){var S=m.map(function(b){return b.sid});return this.getTemporaryContentUrlsForMediaSids(S)}},{key:"getTemporaryContentUrlsForMediaSids",value:function(m){var S=this;return new F.CancellablePromise(function(){var b=H.default($.default.mark(function _(w,E,N){var J,ne;return $.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(J=S.services.mcsClient.mediaSetGetContentUrls(m??[]),!(!S.services.mcsClient||!m)){ve.next=4;break}return E(new Error("Media Content Service is unavailable")),ve.abrupt("return");case 4:return N(function(){J.cancel()}),ve.prev=5,ve.next=8,J;case 8:ne=ve.sent,w(ne),ve.next=15;break;case 12:ve.prev=12,ve.t0=ve.catch(5),E(ve.t0);case 15:case"end":return ve.stop()}},_,null,[[5,12]])}));return function(_,w,E){return b.apply(this,arguments)}}())}},{key:"getTemporaryContentUrlsForAttachedMedia",value:function(){var m,S=this.attachedMedia,b=(m=S==null?void 0:S.map(function(_){return _.sid}))!==null&&m!==void 0?m:[];return this.getTemporaryContentUrlsForMediaSids(b)}},{key:"_getDetailedDeliveryReceiptsPaginator",value:function(){var g=H.default($.default.mark(function S(b){var _=this,w,E,N;return $.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return w=this.configuration.links.messagesReceipts.replace("%s",this.conversation.sid).replace("%s",this.sid),E=new kt(w).arg("PageToken",b==null?void 0:b.pageToken).arg("PageSize",b==null?void 0:b.pageSize).build(),ne.next=4,this.services.network.get(E);case 4:return N=ne.sent,ne.abrupt("return",new ct(N.body.delivery_receipts.map(function(ce){return new tt(ce)}),function(ce,ve){return _._getDetailedDeliveryReceiptsPaginator({pageToken:ce,pageSize:ve})},N.body.meta.previous_token,N.body.meta.next_token));case 6:case"end":return ne.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getContentData",value:function(){var m=this;return new F.CancellablePromise(function(){var S=H.default($.default.mark(function b(_,w,E){var N,J,ne,ce,ve,ut,Ct,Vt,Ft,En;return $.default.wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(m.state.contentSid!==null){Ut.next=3;break}return _(null),Ut.abrupt("return");case 3:if(N=m.getMediaByCategories(["body"]),N!==null){Ut.next=7;break}return _(null),Ut.abrupt("return");case 7:if(J="application/x-vnd.com.twilio.rich.",ne=N.filter(function(Hi){return Hi.contentType.startsWith(J)}),ne.length!==0){Ut.next=12;break}return _(null),Ut.abrupt("return");case 12:return ce=ne[0],ve=ce.getContentTemporaryUrl(),E(function(){ve.cancel()}),Ut.prev=15,Ut.next=18,ve;case 18:ut=Ut.sent,Ut.next=25;break;case 21:return Ut.prev=21,Ut.t0=Ut.catch(15),w(Ut.t0),Ut.abrupt("return");case 25:if(ut!==null){Ut.next=28;break}return _(null),Ut.abrupt("return");case 28:return Ct=new Promise(function(Hi,Rv){var wt,ko=!1,si=new ri;si.open("GET",(wt=ut)!==null&&wt!==void 0?wt:"",!0),si.responseType="text",si.onreadystatechange=function(){si.readyState!==4||ko||Hi(si.responseText)},si.onerror=function(){Rv(si.statusText)},E(function(){ko=!0,si.abort(),Rv(new Error("XHR has been aborted"))}),si.send()}),Ut.prev=29,Ut.next=32,Ct;case 32:Ft=Ut.sent,Vt=JSON.parse(Ft),Ut.next=40;break;case 36:return Ut.prev=36,Ut.t1=Ut.catch(29),w(Ut.t1),Ut.abrupt("return");case 40:En=ce.contentType.replace(J,"").replace(".","/"),_(pt(En,Vt.data));case 42:case"end":return Ut.stop()}},b,null,[[15,21],[29,36]])}));return function(b,_,w){return S.apply(this,arguments)}}())}},{key:"getChannelMetadata",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(this.state.hasChannelMetadata){_.next=2;break}return _.abrupt("return",null);case 2:return _.next=4,this.services.channelMetadataClient.getChannelMetadata(this.conversation.sid,this.sid);case 4:return _.abrupt("return",_.sent);case 5:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()}]),T}(k.ReplayEventEmitter);K.default(Qr,"updated","updated"),Ue([D.deprecated("getMediaByCategory","getMediaByCategories"),ke("design:type",Function),ke("design:paramtypes",[Array]),ke("design:returntype",Array)],Qr.prototype,"getMediaByCategory",null),Ue([p.validateTypes([p.nonEmptyString,"undefined"]),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Ze)],Qr.prototype,"getEmailBody",null),Ue([p.validateTypes([p.nonEmptyString,"undefined"]),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Ze)],Qr.prototype,"getEmailHistory",null),Ue([p.validateTypesAsync("string"),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],Qr.prototype,"updateBody",null),Ue([p.validateTypesAsync(br),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Promise)],Qr.prototype,"updateAttributes",null),Ue([D.deprecated("attachTemporaryUrlsFor","getTemporaryContentUrlsForMedia"),ke("design:type",Function),ke("design:paramtypes",[Array]),ke("design:returntype",Promise)],Qr.prototype,"attachTemporaryUrlsFor",null),Ue([p.validateTypesAsync(p.nonEmptyArray("media",Ze)),ke("design:type",Function),ke("design:paramtypes",[Array]),ke("design:returntype",F.CancellablePromise)],Qr.prototype,"getTemporaryContentUrlsForMedia",null),Ue([p.validateTypesAsync(p.nonEmptyArray("strings","string")),ke("design:type",Function),ke("design:paramtypes",[Array]),ke("design:returntype",F.CancellablePromise)],Qr.prototype,"getTemporaryContentUrlsForMediaSids",null);function bo(M,O){var T=Object.keys(M);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(M);O&&(g=g.filter(function(m){return Object.getOwnPropertyDescriptor(M,m).enumerable})),T.push.apply(T,g)}return T}function Du(M){for(var O=1;O<arguments.length;O++){var T=arguments[O]!=null?arguments[O]:{};O%2?bo(Object(T),!0).forEach(function(g){K.default(M,g,T[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(T)):bo(Object(T)).forEach(function(g){Object.defineProperty(M,g,Object.getOwnPropertyDescriptor(T,g))})}return M}function Fc(M,O){var T=typeof Symbol<"u"&&M[Symbol.iterator]||M["@@iterator"];if(!T){if(Array.isArray(M)||(T=wi(M))||O&&M&&typeof M.length=="number"){T&&(M=T);var g=0,m=function(){};return{s:m,n:function(){return g>=M.length?{done:!0}:{done:!1,value:M[g++]}},e:function(E){throw E},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,b=!1,_;return{s:function(){T=T.call(M)},n:function(){var E=T.next();return S=E.done,E},e:function(E){b=!0,_=E},f:function(){try{!S&&T.return!=null&&T.return()}finally{if(b)throw _}}}}function wi(M,O){if(M){if(typeof M=="string")return Lu(M,O);var T=Object.prototype.toString.call(M).slice(8,-1);if(T==="Object"&&M.constructor&&(T=M.constructor.name),T==="Map"||T==="Set")return Array.from(M);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return Lu(M,O)}}function Lu(M,O){(O==null||O>M.length)&&(O=M.length);for(var T=0,g=new Array(O);T<O;T++)g[T]=M[T];return g}function $c(M){var O=zc();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function zc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mn=vr.scope("Messages"),Wc=function(M){Z.default(T,M);var O=$c(T);function T(g,m,S){var b;return Te.default(this,T),b=O.call(this),b.conversation=g,b.configuration=m,b.services=S,b.messagesByIndex=new Map,b.messagesListPromise=null,b}return fe.default(T,[{key:"subscribe",value:function(){var g=H.default($.default.mark(function S(b){var _=this,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(!this.messagesListPromise){N.next=2;break}return N.abrupt("return",this.messagesListPromise);case 2:return this.messagesListPromise=typeof b=="string"?this.services.syncClient.list({id:b,mode:"open_existing"}):Promise.resolve(b),N.prev=3,N.next=6,this.messagesListPromise;case 6:return w=N.sent,w.on("itemAdded",function(J){mn.debug("".concat(_.conversation.sid," itemAdded: ").concat(J.item.index));var ne={self:"".concat(_.conversation._links.messages,"/").concat(J.item.data.sid),conversation:_.conversation._links.self,messages_receipts:"".concat(_.conversation._links.messages,"/").concat(J.item.data.sid,"/Receipts")},ce=new Qr(J.item.index,J.item.data,_.conversation,ne,_.configuration,_.services);if(_.messagesByIndex.has(ce.index)){mn.debug("Message arrived, but is already known and ignored",_.conversation.sid,ce.index);return}_.messagesByIndex.set(ce.index,ce),ce.on("updated",function(ve){return _.emit("messageUpdated",ve)}),_.emit("messageAdded",ce)}),w.on("itemRemoved",function(J){mn.debug("#{this.conversation.sid} itemRemoved: ".concat(J.index));var ne=J.index;if(_.messagesByIndex.has(ne)){var ce=_.messagesByIndex.get(ne);if(!ce)return;_.messagesByIndex.delete(ce.index),ce.removeAllListeners("updated"),_.emit("messageRemoved",ce)}}),w.on("itemUpdated",function(J){mn.debug("".concat(_.conversation.sid," itemUpdated: ").concat(J.item.index));var ne=_.messagesByIndex.get(J.item.index);ne&&ne._update(J.item.data)}),N.abrupt("return",w);case 13:throw N.prev=13,N.t0=N.catch(3),this.messagesListPromise=null,this.services.syncClient.connectionState!=="disconnected"&&mn.error("Failed to get messages object for conversation",this.conversation.sid,N.t0),mn.debug("ERROR: Failed to get messages object for conversation",this.conversation.sid,N.t0),N.t0;case 19:case"end":return N.stop()}},S,this,[[3,13]])}));function m(S){return g.apply(this,arguments)}return m}()},{key:"unsubscribe",value:function(){var g=H.default($.default.mark(function S(){var b;return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.messagesListPromise){w.next=2;break}return w.abrupt("return");case 2:return w.next=4,this.messagesListPromise;case 4:b=w.sent,b.close(),this.messagesListPromise=null;case 7:case"end":return w.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"sendV2",value:function(m){var S=this;return mn.debug("Sending message V2",m.mediaContent,m.attributes,m.emailOptions),new F.CancellablePromise(function(){var b=H.default($.default.mark(function _(w,E,N){var J,ne,ce,ve,ut,Ct,Vt,Ft,En,nn,Ut,Hi;return $.default.wrap(function(wt){for(;;)switch(wt.prev=wt.next){case 0:ne=[],ce=[],N(function(){ce.forEach(function(ko){return ko.cancel()})}),ve=Fc(m.mediaContent),wt.prev=4,ve.s();case 6:if((ut=ve.n()).done){wt.next=25;break}return Ct=ue.default(ut.value,2),Vt=Ct[0],Ft=Ct[1],wt.prev=8,mn.debug("Adding media to a message as ".concat(Ft instanceof FormData?"FormData":"SendMediaOptions"),Ft),Ut=Ft instanceof FormData?S.services.mcsClient.postFormData(Ft,Vt):S.services.mcsClient.post((En=Ft.contentType)!==null&&En!==void 0?En:"",(nn=Ft.media)!==null&&nn!==void 0?nn:"",Vt,Ft.filename),ce.push(Ut),wt.t0=ne,wt.next=15,Ut;case 15:wt.t1=wt.sent,wt.t0.push.call(wt.t0,wt.t1),wt.next=23;break;case 19:return wt.prev=19,wt.t2=wt.catch(8),E(wt.t2),wt.abrupt("return");case 23:wt.next=6;break;case 25:wt.next=30;break;case 27:wt.prev=27,wt.t3=wt.catch(4),ve.e(wt.t3);case 30:return wt.prev=30,ve.f(),wt.finish(30);case 33:return Hi=S.services.commandExecutor.mutateResource("post",S.conversation._links.messages,{body:m.text,subject:(J=m.emailOptions)===null||J===void 0?void 0:J.subject,media_sids:ne.map(function(ko){return ko.sid}),attributes:typeof m.attributes<"u"?JSON.stringify(m.attributes):void 0,content_sid:m.contentSid,content_variables:typeof m.contentVariables<"u"?JSON.stringify(m.contentVariables.reduce(function(ko,si){return Du(Du({},ko),{},K.default({},si.name,si.value))},{})):void 0}),wt.prev=34,wt.t4=w,wt.next=38,Hi;case 38:wt.t5=wt.sent,(0,wt.t4)(wt.t5),wt.next=45;break;case 42:wt.prev=42,wt.t6=wt.catch(34),E(wt.t6);case 45:case"end":return wt.stop()}},_,null,[[4,27,30,33],[8,19],[34,42]])}));return function(_,w,E){return b.apply(this,arguments)}}())}},{key:"send",value:function(){var g=H.default($.default.mark(function S(b){var _,w,E=arguments;return $.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return _=E.length>1&&E[1]!==void 0?E[1]:{},w=E.length>2?E[2]:void 0,mn.debug("Sending text message",b,_,w),J.abrupt("return",this.services.commandExecutor.mutateResource("post",this.conversation._links.messages,{body:b??"",attributes:typeof _<"u"?JSON.stringify(_):void 0,subject:w==null?void 0:w.subject}));case 4:case"end":return J.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"sendMedia",value:function(){var g=H.default($.default.mark(function S(b){var _,w,E,N,J,ne=arguments;return $.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(E=ne.length>1&&ne[1]!==void 0?ne[1]:{},N=ne.length>2?ne[2]:void 0,mn.debug("Sending media message",b,E,N),mn.debug("Sending media message as ".concat(b instanceof FormData?"FormData":"SendMediaOptions"),b,E),!(b instanceof FormData)){ve.next=10;break}return ve.next=7,this.services.mcsClient.postFormData(b);case 7:ve.t0=ve.sent,ve.next=13;break;case 10:return ve.next=12,this.services.mcsClient.post((_=b.contentType)!==null&&_!==void 0?_:"",(w=b.media)!==null&&w!==void 0?w:"","media",b.filename);case 12:ve.t0=ve.sent;case 13:return J=ve.t0,ve.next=16,this.services.commandExecutor.mutateResource("post",this.conversation._links.messages,{media_sids:[J.sid],attributes:typeof E<"u"?JSON.stringify(E):void 0});case 16:return ve.abrupt("return",ve.sent);case 17:case"end":return ve.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getMessages",value:function(){var g=H.default($.default.mark(function S(b,_){var w,E=arguments;return $.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return w=E.length>2&&E[2]!==void 0?E[2]:"backwards",J.abrupt("return",this._getMessages(b,_,w));case 2:case"end":return J.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"_wrapPaginator",value:function(m,S,b){var _=this,w=m==="desc",E=function(){return S.nextPage().then(function(ne){return _._wrapPaginator(m,ne,b)})},N=function(){return S.prevPage().then(function(ne){return _._wrapPaginator(m,ne,b)})};return b(S.items).then(function(J){return{items:J.sort(function(ne,ce){return ne.index-ce.index}),hasPrevPage:w?S.hasNextPage:S.hasPrevPage,hasNextPage:w?S.hasPrevPage:S.hasNextPage,prevPage:w?E:N,nextPage:w?N:E}})}},{key:"_upsertMessage",value:function(m,S){var b=this,_=this.messagesByIndex.get(m);if(_)return _;var w={self:"".concat(this.conversation._links.messages,"/").concat(S.sid),conversation:this.conversation._links.self,messages_receipts:"".concat(this.conversation._links.messages,"/").concat(S.sid,"/Receipts")},E=new Qr(m,S,this.conversation,w,this.configuration,this.services);return this.messagesByIndex.set(E.index,E),E.on("updated",function(N){return b.emit("messageUpdated",N)}),E}},{key:"_getMessages",value:function(){var g=H.default($.default.mark(function S(){var b=this,_,w,E,N,J,ne,ce=arguments;return $.default.wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:return _=ce.length>0&&ce[0]!==void 0?ce[0]:30,w=ce.length>1&&ce[1]!==void 0?ce[1]:"end",E=ce.length>2&&ce[2]!==void 0?ce[2]:"forward",N=E==="backwards"?"desc":"asc",ut.next=6,this.messagesListPromise;case 6:return J=ut.sent,ut.next=9,J==null?void 0:J.getItems({from:w!=="end"?w:void 0,pageSize:_,order:N,limit:_});case 9:return ne=ut.sent,ut.next=12,this._wrapPaginator(N,ne,function(Ct){return Promise.all(Ct.map(function(Vt){return b._upsertMessage(Vt.index,Vt.data)}))});case 12:return ut.abrupt("return",ut.sent);case 13:case"end":return ut.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()}]),T}(k.ReplayEventEmitter),Ua=function(){function M(O){Te.default(this,M),K.default(this,"attributes",{}),K.default(this,"mediaContent",[]),K.default(this,"emailOptions",{}),this.messagesEntity=O}return fe.default(M,[{key:"send",value:function(){var T=this;return new F.CancellablePromise(function(){var g=H.default($.default.mark(function m(S,b,_){var w,E;return $.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return w=T.messagesEntity.sendV2(T),_(function(){return w.cancel()}),J.prev=2,J.next=5,w;case 5:E=J.sent,S(Qt(E.index)),J.next=12;break;case 9:J.prev=9,J.t0=J.catch(2),b(J.t0);case 12:case"end":return J.stop()}},m,null,[[2,9]])}));return function(m,S,b){return g.apply(this,arguments)}}())}}]),M}(),Ur=function(){function M(O,T){Te.default(this,M),this.limits=O,this.message=new Ua(T),this.emailBodies=new Map,this.emailHistories=new Map}return fe.default(M,[{key:"setBody",value:function(T){return this.message.text=T,this}},{key:"setSubject",value:function(T){return this.message.emailOptions.subject=T,this}},{key:"setAttributes",value:function(T){return this.message.attributes=T,this}},{key:"setEmailBody",value:function(T,g){return this.emailBodies.set(T,g),this}},{key:"setEmailHistory",value:function(T,g){return this.emailHistories.set(T,g),this}},{key:"setContentTemplate",value:function(T){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return this.message.contentSid=T,this.message.contentVariables=g,this}},{key:"addMedia",value:function(T){if(typeof FormData>"u"&&T instanceof FormData)throw new Error("Could not add FormData content whilst not in a browser");if(!(T instanceof FormData)){var g=T;if(!g.contentType||!g.media)throw new Error("Media content in SendMediaOptions must contain non-empty contentType and media")}return this.message.mediaContent.push(["media",T]),this}},{key:"build",value:function(){var T=this;if(this.emailBodies.forEach(function(g,m){if(!T.limits.emailBodiesAllowedContentTypes.includes(m))throw new Error("Unsupported email body content type ".concat(m))}),this.emailHistories.forEach(function(g,m){if(!T.limits.emailHistoriesAllowedContentTypes.includes(m))throw new Error("Unsupported email history content type ".concat(m))}),this.emailBodies.size>this.limits.emailBodiesAllowedContentTypes.length)throw new Error("Too many email bodies attached to the message (".concat(this.emailBodies.size," > ").concat(this.limits.emailBodiesAllowedContentTypes.length,")"));if(this.emailHistories.size>this.limits.emailHistoriesAllowedContentTypes.length)throw new Error("Too many email histories attached to the message (".concat(this.emailHistories.size," > ").concat(this.limits.emailHistoriesAllowedContentTypes.length,")"));if(this.message.mediaContent.length>this.limits.mediaAttachmentsCountLimit)throw new Error("Too many media attachments in the message (".concat(this.message.mediaContent.length," > ").concat(this.limits.mediaAttachmentsCountLimit,")"));return this.emailBodies.forEach(function(g){T.message.mediaContent.push(["body",g])}),this.emailHistories.forEach(function(g){T.message.mediaContent.push(["history",g])}),this.message}},{key:"buildAndSend",value:function(){return this.build().send()}}]),M}();Ue([p.validateTypes("string"),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Ur)],Ur.prototype,"setBody",null),Ue([p.validateTypes("string"),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Ur)],Ur.prototype,"setSubject",null),Ue([p.validateTypes(br),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Ur)],Ur.prototype,"setAttributes",null),Ue([p.validateTypes("string",[FormData,Xr]),ke("design:type",Function),ke("design:paramtypes",[String,Object]),ke("design:returntype",Ur)],Ur.prototype,"setEmailBody",null),Ue([p.validateTypes("string",[FormData,Xr]),ke("design:type",Function),ke("design:paramtypes",[String,Object]),ke("design:returntype",Ur)],Ur.prototype,"setEmailHistory",null),Ue([p.validateTypes("string",[p.array("content variables",st),"undefined"]),ke("design:type",Function),ke("design:paramtypes",[String,Array]),ke("design:returntype",Ur)],Ur.prototype,"setContentTemplate",null),Ue([p.validateTypes([FormData,Xr]),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Ur)],Ur.prototype,"addMedia",null);function Bc(M,O){var T=typeof Symbol<"u"&&M[Symbol.iterator]||M["@@iterator"];if(!T){if(Array.isArray(M)||(T=ni(M))||O&&M&&typeof M.length=="number"){T&&(M=T);var g=0,m=function(){};return{s:m,n:function(){return g>=M.length?{done:!0}:{done:!1,value:M[g++]}},e:function(E){throw E},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,b=!1,_;return{s:function(){T=T.call(M)},n:function(){var E=T.next();return S=E.done,E},e:function(E){b=!0,_=E},f:function(){try{!S&&T.return!=null&&T.return()}finally{if(b)throw _}}}}function ni(M,O){if(M){if(typeof M=="string")return Uu(M,O);var T=Object.prototype.toString.call(M).slice(8,-1);if(T==="Object"&&M.constructor&&(T=M.constructor.name),T==="Map"||T==="Set")return Array.from(M);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return Uu(M,O)}}function Uu(M,O){(O==null||O>M.length)&&(O=M.length);for(var T=0,g=new Array(O);T<O;T++)g[T]=M[T];return g}function Zc(M){var O=qc();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function qc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ki={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",uniqueName:"uniqueName",state:"state",bindings:"bindings"},ir=function(M){Z.default(T,M);var O=Zc(T);function T(g,m,S,b,_){var w,E,N;Te.default(this,T),N=O.call(this),N.sid=m,N._links=S,N._configuration=b,N._services=_,N._entityName=g.channel,N._internalState={uniqueName:g.uniqueName||null,status:"notParticipating",attributes:(w=g.attributes)!==null&&w!==void 0?w:{},createdBy:g.createdBy,dateCreated:er(g.dateCreated),dateUpdated:er(g.dateUpdated),friendlyName:g.friendlyName||null,lastReadMessageIndex:Number.isInteger(g.lastConsumedMessageIndex)?g.lastConsumedMessageIndex:null,bindings:(E=g.bindings)!==null&&E!==void 0?E:{}},g.notificationLevel&&(N._internalState.notificationLevel=g.notificationLevel);var J={participants:N._links.participants};return N._participants=new Map,N._participantsEntity=new ae(ee.default(N),N._participants,J,N._configuration,N._services),N._participantsEntity.on("participantJoined",function(ne){return N.emit("participantJoined",ne)}),N._participantsEntity.on("participantLeft",function(ne){return N.emit("participantLeft",ne)}),N._participantsEntity.on("participantUpdated",function(ne){return N.emit("participantUpdated",ne)}),N._messagesEntity=new Wc(ee.default(N),b,_),N._messagesEntity.on("messageAdded",function(ne){return N._onMessageAdded(ne)}),N._messagesEntity.on("messageUpdated",function(ne){return N.emit("messageUpdated",ne)}),N._messagesEntity.on("messageRemoved",function(ne){return N.emit("messageRemoved",ne)}),N}return fe.default(T,[{key:"uniqueName",get:function(){return this._internalState.uniqueName}},{key:"status",get:function(){return this._internalState.status}},{key:"friendlyName",get:function(){return this._internalState.friendlyName}},{key:"dateUpdated",get:function(){return this._internalState.dateUpdated}},{key:"dateCreated",get:function(){return this._internalState.dateCreated}},{key:"createdBy",get:function(){var m;return(m=this._internalState.createdBy)!==null&&m!==void 0?m:""}},{key:"attributes",get:function(){return this._internalState.attributes}},{key:"lastReadMessageIndex",get:function(){return this._internalState.lastReadMessageIndex}},{key:"lastMessage",get:function(){var m;return(m=this._internalState.lastMessage)!==null&&m!==void 0?m:void 0}},{key:"notificationLevel",get:function(){var m;return(m=this._internalState.notificationLevel)!==null&&m!==void 0?m:"default"}},{key:"bindings",get:function(){return this._internalState.bindings}},{key:"limits",get:function(){return this._configuration.limits}},{key:"state",get:function(){return this._internalState.state}},{key:"_statusSource",get:function(){return this._dataSource}},{key:"add",value:function(){var g=H.default($.default.mark(function S(b,_){return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",this._participantsEntity.add(b,_??{}));case 1:case"end":return E.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"addNonChatParticipant",value:function(){var g=H.default($.default.mark(function S(b,_){var w,E,N=arguments;return $.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return w=N.length>2&&N[2]!==void 0?N[2]:{},E=N.length>3&&N[3]!==void 0?N[3]:{},ne.abrupt("return",this._participantsEntity.addNonChatParticipant(b,_,w??{},E??{}));case 3:case"end":return ne.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"advanceLastReadMessageIndex",value:function(){var g=H.default($.default.mark(function S(b){var _;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._subscribeStreams();case 2:if(!(b<((_=this.lastReadMessageIndex)!==null&&_!==void 0?_:0))){E.next=6;break}return E.next=5,this._setLastReadMessageIndex(this.lastReadMessageIndex);case 5:return E.abrupt("return",E.sent);case 6:return E.next=8,this._setLastReadMessageIndex(b);case 8:return E.abrupt("return",E.sent);case 9:case"end":return E.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"delete",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._services.commandExecutor.mutateResource("delete",this._links.self);case 2:return _.abrupt("return",this);case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getAttributes",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._subscribe();case 2:return _.abrupt("return",this.attributes);case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getMessages",value:function(){var g=H.default($.default.mark(function S(b,_,w){return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this._subscribeStreams();case 2:return N.abrupt("return",this._messagesEntity.getMessages(b,_,w));case 3:case"end":return N.stop()}},S,this)}));function m(S,b,_){return g.apply(this,arguments)}return m}()},{key:"getParticipants",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._subscribeStreams();case 2:return _.abrupt("return",this._participantsEntity.getParticipants());case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getParticipantsCount",value:function(){var g=H.default($.default.mark(function S(){var b,_,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return _=new kt(this._configuration.links.conversations).path(this.sid).build(),N.next=3,this._services.network.get(_);case 3:return w=N.sent,N.abrupt("return",(b=w.body.participants_count)!==null&&b!==void 0?b:0);case 5:case"end":return N.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getParticipantBySid",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",this._participantsEntity.getParticipantBySid(b));case 1:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getParticipantByIdentity",value:function(){var g=H.default($.default.mark(function S(){var b,_=arguments;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return b=_.length>0&&_[0]!==void 0?_[0]:"",E.abrupt("return",this._participantsEntity.getParticipantByIdentity(b??""));case 2:case"end":return E.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getMessagesCount",value:function(){var g=H.default($.default.mark(function S(){var b,_,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return _=new kt(this._configuration.links.conversations).path(this.sid).build(),N.next=3,this._services.network.get(_);case 3:return w=N.sent,N.abrupt("return",(b=w.body.messages_count)!==null&&b!==void 0?b:0);case 5:case"end":return N.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getUnreadMessagesCount",value:function(){var g=H.default($.default.mark(function S(){var b,_,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return b=new kt(this._configuration.links.myConversations).path(this.sid).build(),N.next=3,this._services.network.get(b);case 3:if(_=N.sent,_.body.conversation_sid===this.sid){N.next=6;break}throw new Error("Conversation was not found in the user conversations list");case 6:if(w=_.body.unread_messages_count,typeof w!="number"){N.next=9;break}return N.abrupt("return",w);case 9:return N.abrupt("return",null);case 10:case"end":return N.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"join",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._services.commandExecutor.mutateResource("post",this._links.participants,{identity:this._configuration.userIdentity});case 2:return _.abrupt("return",this);case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"leave",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(this._internalState.status!=="joined"){_.next=3;break}return _.next=3,this._services.commandExecutor.mutateResource("delete","".concat(this._links.participants,"/").concat(encodeURIComponent(this._configuration.userIdentity)));case 3:return _.abrupt("return",this);case 4:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"removeParticipant",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._participantsEntity.remove(typeof b=="string"?b:b.sid);case 2:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"sendMessage",value:function(){var g=H.default($.default.mark(function S(b,_,w){var E,N,J,ne;return $.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(!(typeof b=="string"||b===null)){ve.next=5;break}return ve.next=3,this._messagesEntity.send(b,_,w);case 3:return J=ve.sent,ve.abrupt("return",(N=Qt(J.index))!==null&&N!==void 0?N:0);case 5:return ve.next=7,this._messagesEntity.sendMedia(b,_,w);case 7:return ne=ve.sent,ve.abrupt("return",(E=Qt(ne.index))!==null&&E!==void 0?E:0);case 9:case"end":return ve.stop()}},S,this)}));function m(S,b,_){return g.apply(this,arguments)}return m}()},{key:"prepareMessage",value:function(){return new Ur(this.limits,this._messagesEntity)}},{key:"setAllMessagesRead",value:function(){var g=H.default($.default.mark(function S(){var b;return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._subscribeStreams();case 2:return w.next=4,this.getMessages(1);case 4:if(b=w.sent,!(b.items.length>0)){w.next=7;break}return w.abrupt("return",this.advanceLastReadMessageIndex(b.items[0].index));case 7:return w.abrupt("return",0);case 8:case"end":return w.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"setAllMessagesUnread",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._subscribeStreams();case 2:return _.next=4,this._setLastReadMessageIndex(null);case 4:return _.abrupt("return",_.sent);case 5:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"setUserNotificationLevel",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._services.commandExecutor.mutateResource("post","".concat(this._configuration.links.myConversations,"/").concat(this.sid),{notification_level:b});case 2:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"typing",value:function(){return this._services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._services.commandExecutor.mutateResource("post",this._links.self,{attributes:b!==void 0?JSON.stringify(b):void 0});case 2:return w.abrupt("return",this);case 3:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"updateFriendlyName",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this._internalState.friendlyName===b){w.next=3;break}return w.next=3,this._services.commandExecutor.mutateResource("post",this._links.self,{friendly_name:b});case 3:return w.abrupt("return",this);case 4:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"updateLastReadMessageIndex",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._subscribeStreams();case 2:return w.abrupt("return",this._setLastReadMessageIndex(b));case 3:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"updateUniqueName",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this._internalState.uniqueName===b){w.next=4;break}return b||(b=""),w.next=4,this._services.commandExecutor.mutateResource("post",this._links.self,{unique_name:b});case 4:return w.abrupt("return",this);case 5:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"_subscribe",value:function(){var g=H.default($.default.mark(function S(){var b=this;return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(!this._entityPromise){w.next=2;break}return w.abrupt("return",this._entityPromise);case 2:return this._entityPromise=this._services.syncClient.document({id:this._entityName,mode:"open_existing"}),w.prev=3,w.next=6,this._entityPromise;case 6:return this._entity=w.sent,this._entity.on("updated",function(E){return b._update(E.data)}),this._entity.on("removed",function(){return b.emit("removed",b)}),this._update(this._entity.data),w.abrupt("return",this._entity);case 13:throw w.prev=13,w.t0=w.catch(3),this._entity=null,this._entityPromise=null,this._services.syncClient.connectionState!="disconnected"&&T._logger.error("Failed to get conversation object",w.t0),T._logger.debug("ERROR: Failed to get conversation object",w.t0),w.t0;case 20:case"end":return w.stop()}},S,this,[[3,13]])}));function m(){return g.apply(this,arguments)}return m}()},{key:"_fetchStreams",value:function(){var g=H.default($.default.mark(function S(){var b,_,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this._subscribe();case 2:return T._logger.trace("_streamsAvailable, this.entity.data=",(b=this._entity)===null||b===void 0?void 0:b.data),w=(_=this._entity)===null||_===void 0?void 0:_.data,N.next=6,this._services.syncClient.list({id:w.messages,mode:"open_existing"});case 6:return this._messagesList=N.sent,N.next=9,this._services.syncClient.map({id:w.roster,mode:"open_existing"});case 9:this._participantsMap=N.sent;case 10:case"end":return N.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"_subscribeStreams",value:function(){var g=H.default($.default.mark(function S(){var b,_,w,E,N,J,ne;return $.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ve.prev=0,ve.next=3,this._subscribe();case 3:return T._logger.trace("_subscribeStreams, this.entity.data=",(b=this._entity)===null||b===void 0?void 0:b.data),N=(_=this._entity)===null||_===void 0?void 0:_.data,J=N.messages,ne=N.roster,ve.next=9,Promise.all([this._messagesEntity.subscribe((w=this._messagesList)!==null&&w!==void 0?w:J),this._participantsEntity.subscribe((E=this._participantsMap)!==null&&E!==void 0?E:ne)]);case 9:ve.next=16;break;case 11:throw ve.prev=11,ve.t0=ve.catch(0),this._services.syncClient.connectionState!=="disconnected"&&T._logger.error("Failed to subscribe on conversation objects",this.sid,ve.t0),T._logger.debug("ERROR: Failed to subscribe on conversation objects",this.sid,ve.t0),ve.t0;case 16:case"end":return ve.stop()}},S,this,[[0,11]])}));function m(){return g.apply(this,arguments)}return m}()},{key:"_unsubscribe",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!this._entity){_.next=5;break}return _.next=3,this._entity.close();case 3:this._entity=null,this._entityPromise=null;case 5:return _.abrupt("return",Promise.all([this._participantsEntity.unsubscribe(),this._messagesEntity.unsubscribe()]));case 6:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"_setStatus",value:function(m,S){var b=this;if(this._dataSource=S,this._internalState.status!==m){if(this._internalState.status=m,m==="joined"){this._subscribeStreams().catch(function(_){if(T._logger.debug("ERROR while setting conversation status "+m,_),b._services.syncClient.connectionState!=="disconnected")throw _});return}this._entityPromise&&this._unsubscribe().catch(function(_){if(T._logger.debug("ERROR while setting conversation status "+m,_),b._services.syncClient.connectionState!=="disconnected")throw _})}}},{key:"_update",value:function(m){var S,b,_,w,E;T._logger.trace("_update",m),T.preprocessUpdate(m,this.sid);for(var N=new Set,J=0,ne=Object.keys(m);J<ne.length;J++){var ce=ne[J],ve=ki[ce];if(ve)switch(ve){case ki.status:if(!m.status||m.status==="unknown"||this._internalState.status===m.status)break;this._internalState.status=m.status,N.add(ve);break;case ki.attributes:if($e.default(this._internalState.attributes,m.attributes))break;this._internalState.attributes=m.attributes,N.add(ve);break;case ki.lastConsumedMessageIndex:if(m.lastConsumedMessageIndex===void 0||m.lastConsumedMessageIndex===this._internalState.lastReadMessageIndex)break;this._internalState.lastReadMessageIndex=m.lastConsumedMessageIndex,N.add("lastReadMessageIndex");break;case ki.lastMessage:if(this._internalState.lastMessage&&!m.lastMessage){delete this._internalState.lastMessage,N.add(ve);break}this._internalState.lastMessage=this._internalState.lastMessage||{},((S=m.lastMessage)===null||S===void 0?void 0:S.index)!==void 0&&m.lastMessage.index!==this._internalState.lastMessage.index&&(this._internalState.lastMessage.index=m.lastMessage.index,N.add(ve)),((b=m.lastMessage)===null||b===void 0?void 0:b.timestamp)!==void 0&&((_=this._internalState.lastMessage)===null||_===void 0||(w=_.dateCreated)===null||w===void 0?void 0:w.getTime())!==m.lastMessage.timestamp.getTime()&&(this._internalState.lastMessage.dateCreated=m.lastMessage.timestamp,N.add(ve)),$e.default(this._internalState.lastMessage,{})&&delete this._internalState.lastMessage;break;case ki.state:var ut=m.state||void 0;if(ut!==void 0&&(ut.dateUpdated=new Date(ut.dateUpdated)),$e.default(this._internalState.state,ut))break;this._internalState.state=ut,N.add(ve);break;case ki.bindings:if($e.default(this._internalState.bindings,m.bindings))break;this._internalState.bindings=m.bindings,N.add(ve);break;default:var Ct=m[ce]instanceof Date,Vt=Ct&&((E=this._internalState[ve])===null||E===void 0?void 0:E.getTime())===m[ce].getTime(),Ft=!Ct&&this[ve]===m[ce];if(Vt||Ft)break;this._internalState[ve]=m[ce],N.add(ve)}}N.size>0&&this.emit("updated",{conversation:this,updateReasons:dt.default(N)})}},{key:"_onMessageAdded",value:function(m){var S=Bc(this._participants.values()),b;try{for(S.s();!(b=S.n()).done;){var _=b.value;if(_.identity===m.author){_._endTyping();break}}}catch(w){S.e(w)}finally{S.f()}this.emit("messageAdded",m)}},{key:"_setLastReadMessageIndex",value:function(){var g=H.default($.default.mark(function S(b){var _;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._services.commandExecutor.mutateResource("post","".concat(this._configuration.links.myConversations,"/").concat(this.sid),{last_read_message_index:b});case 2:return _=E.sent,E.abrupt("return",_.unread_messages_count);case 4:case"end":return E.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()}],[{key:"preprocessUpdate",value:function(m,S){try{typeof m.attributes=="string"?m.attributes=JSON.parse(m.attributes):m.attributes&&JSON.stringify(m.attributes)}catch{T._logger.warn("Retrieved malformed attributes from the server for conversation: "+S),m.attributes={}}try{m.dateCreated&&(m.dateCreated=new Date(m.dateCreated))}catch{T._logger.warn("Retrieved malformed dateCreated from the server for conversation: "+S),delete m.dateCreated}try{m.dateUpdated&&(m.dateUpdated=new Date(m.dateUpdated))}catch{T._logger.warn("Retrieved malformed dateUpdated from the server for conversation: "+S),delete m.dateUpdated}try{m.lastMessage&&m.lastMessage.timestamp&&(m.lastMessage.timestamp=new Date(m.lastMessage.timestamp))}catch{T._logger.warn("Retrieved malformed lastMessage.timestamp from the server for conversation: "+S),delete m.lastMessage.timestamp}}}]),T}(k.ReplayEventEmitter);K.default(ir,"participantJoined","participantJoined"),K.default(ir,"participantLeft","participantLeft"),K.default(ir,"participantUpdated","participantUpdated"),K.default(ir,"messageAdded","messageAdded"),K.default(ir,"messageRemoved","messageRemoved"),K.default(ir,"messageUpdated","messageUpdated"),K.default(ir,"typingEnded","typingEnded"),K.default(ir,"typingStarted","typingStarted"),K.default(ir,"updated","updated"),K.default(ir,"removed","removed"),K.default(ir,"_logger",vr.scope("Conversation")),Ue([p.validateTypesAsync(p.nonEmptyString,Nr),ke("design:type",Function),ke("design:paramtypes",[String,Object]),ke("design:returntype",Promise)],ir.prototype,"add",null),Ue([p.validateTypesAsync(p.nonEmptyString,p.nonEmptyString,Nr),ke("design:type",Function),ke("design:paramtypes",[String,String,Object,Object]),ke("design:returntype",Promise)],ir.prototype,"addNonChatParticipant",null),Ue([p.validateTypesAsync(p.nonNegativeInteger),ke("design:type",Function),ke("design:paramtypes",[Number]),ke("design:returntype",Promise)],ir.prototype,"advanceLastReadMessageIndex",null),Ue([p.validateTypesAsync(["undefined",p.nonNegativeInteger],["undefined",p.nonNegativeInteger],["undefined",p.literal("backwards","forward")]),ke("design:type",Function),ke("design:paramtypes",[Number,Number,String]),ke("design:returntype",Promise)],ir.prototype,"getMessages",null),Ue([p.validateTypesAsync(p.nonEmptyString),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],ir.prototype,"getParticipantBySid",null),Ue([p.validateTypesAsync(p.nonEmptyString),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],ir.prototype,"getParticipantByIdentity",null),Ue([p.validateTypesAsync([p.nonEmptyString,se]),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Promise)],ir.prototype,"removeParticipant",null),Ue([p.validateTypesAsync(["string",FormData,p.literal(null),p.objectSchema("media options",{contentType:p.nonEmptyString,media:p.custom(function(M){var O=typeof M=="string"&&M.length>0||M instanceof Uint8Array||M instanceof ArrayBuffer;return typeof Blob=="function"&&(O=O||M instanceof Blob),[O,"a non-empty string, an instance of Buffer or an instance of Blob"]})})],Nr,["undefined",p.literal(null),p.objectSchema("email attributes",{subject:[p.nonEmptyString,"undefined"]})]),ke("design:type",Function),ke("design:paramtypes",[Object,Object,Object]),ke("design:returntype",Promise)],ir.prototype,"sendMessage",null),Ue([p.validateTypesAsync(p.literal("default","muted")),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],ir.prototype,"setUserNotificationLevel",null),Ue([p.validateTypesAsync(br),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Promise)],ir.prototype,"updateAttributes",null),Ue([p.validateTypesAsync("string"),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],ir.prototype,"updateFriendlyName",null),Ue([p.validateTypesAsync([p.literal(null),p.nonNegativeInteger]),ke("design:type",Function),ke("design:paramtypes",[Number]),ke("design:returntype",Promise)],ir.prototype,"updateLastReadMessageIndex",null),Ue([p.validateTypesAsync(["string",p.literal(null)]),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],ir.prototype,"updateUniqueName",null);var Qc=function(){function M(){var O=this;Te.default(this,M),this._promise=new Promise(function(T,g){O._resolve=T,O._reject=g})}return fe.default(M,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(T){this._resolve(T)}},{key:"set",value:function(T){this.current=T,this._resolve(T)}},{key:"fail",value:function(T){this._reject(T)}}]),M}();function _o(M,O){var T=typeof Symbol<"u"&&M[Symbol.iterator]||M["@@iterator"];if(!T){if(Array.isArray(M)||(T=Yc(M))||O&&M&&typeof M.length=="number"){T&&(M=T);var g=0,m=function(){};return{s:m,n:function(){return g>=M.length?{done:!0}:{done:!1,value:M[g++]}},e:function(E){throw E},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,b=!1,_;return{s:function(){T=T.call(M)},n:function(){var E=T.next();return S=E.done,E},e:function(E){b=!0,_=E},f:function(){try{!S&&T.return!=null&&T.return()}finally{if(b)throw _}}}}function Yc(M,O){if(M){if(typeof M=="string")return ii(M,O);var T=Object.prototype.toString.call(M).slice(8,-1);if(T==="Object"&&M.constructor&&(T=M.constructor.name),T==="Map"||T==="Set")return Array.from(M);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return ii(M,O)}}function ii(M,O){(O==null||O>M.length)&&(O=M.length);for(var T=0,g=new Array(O);T<O;T++)g[T]=M[T];return g}function vs(M,O){var T=Object.keys(M);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(M);O&&(g=g.filter(function(m){return Object.getOwnPropertyDescriptor(M,m).enumerable})),T.push.apply(T,g)}return T}function ju(M){for(var O=1;O<arguments.length;O++){var T=arguments[O]!=null?arguments[O]:{};O%2?vs(Object(T),!0).forEach(function(g){K.default(M,g,T[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(T)):vs(Object(T)).forEach(function(g){Object.defineProperty(M,g,Object.getOwnPropertyDescriptor(T,g))})}return M}function Gc(M){var O=Hc();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function Hc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rn=vr.scope("Conversations"),Jc=function(M){Z.default(T,M);var O=Gc(T);function T(g,m){var S;return Te.default(this,T),S=O.call(this),K.default(ee.default(S),"conversations",new Map),K.default(ee.default(S),"myConversationsRead",new Qc),K.default(ee.default(S),"tombstones",new Set),K.default(ee.default(S),"myConversationsFetched",!1),S.configuration=g,S.services=m,S}return fe.default(T,[{key:"addConversation",value:function(){var g=H.default($.default.mark(function S(b){var _,w,E,N,J,ne,ce,ve,ut,Ct;return $.default.wrap(function(Ft){for(;;)switch(Ft.prev=Ft.next){case 0:return N=typeof(b==null?void 0:b.attributes)<"u"?b.attributes:{},Ft.next=3,this.services.commandExecutor.mutateResource("post",this.configuration.links.conversations,{friendly_name:b.friendlyName,unique_name:b.uniqueName,attributes:typeof N<"u"?JSON.stringify(N):void 0});case 3:if(J=Ft.sent,ne=(_=J.sid)!==null&&_!==void 0?_:null,ce=(w=(E=J.sync_objects)===null||E===void 0?void 0:E.conversation)!==null&&w!==void 0?w:null,ve=ju({self:J.url},J.links),ut=this.conversations.get(ne),!ut){Ft.next=12;break}return Ft.next=11,ut._subscribe();case 11:return Ft.abrupt("return",ut);case 12:return Ct=new ir({channel:ce,entityName:"",uniqueName:"",attributes:null,createdBy:"",friendlyName:"",lastConsumedMessageIndex:0,dateCreated:null,dateUpdated:null},ne,ve,this.configuration,this.services),this.conversations.set(Ct.sid,Ct),this._registerForEvents(Ct),Ft.next=17,Ct._subscribe();case 17:return this.emit("conversationAdded",Ct),Ft.abrupt("return",Ct);case 19:case"end":return Ft.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"fetchConversations",value:function(){var g=H.default($.default.mark(function S(){var b=this,_,w,E,N,J,ne,ce;return $.default.wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:return ut.prev=0,ut.next=3,this._getMap();case 3:return _=ut.sent,_.on("itemAdded",function(Ct){rn.debug("itemAdded: ".concat(Ct.item.key)),b._upsertConversation("sync",Ct.item.key,Ct.item.data)}),_.on("itemRemoved",function(Ct){rn.debug("itemRemoved: ".concat(Ct.key));var Vt=Ct.key;b.myConversationsFetched||b.tombstones.add(Vt);var Ft=b.conversations.get(Vt);Ft&&(Ft.status==="joined"&&(Ft._setStatus("notParticipating","sync"),b.emit("conversationLeft",Ft)),b.conversations.delete(Vt),b.emit("conversationRemoved",Ft),Ft.emit("removed",Ft))}),_.on("itemUpdated",function(Ct){rn.debug("itemUpdated: ".concat(Ct.item.key)),b._upsertConversation("sync",Ct.item.key,Ct.item.data)}),ut.next=9,this._fetchMyConversations();case 9:w=ut.sent,E=[],N=_o(w);try{for(N.s();!(J=N.n()).done;)ne=J.value,E.push(this._upsertConversation("rest",ne.channel_sid,ne))}catch(Ct){N.e(Ct)}finally{N.f()}return this.myConversationsRead.set(!0),ut.next=16,Promise.all(E);case 16:return this.myConversationsFetched=!0,this.tombstones.clear(),rn.debug("The conversations list has been successfully fetched"),ut.abrupt("return",this);case 22:throw ut.prev=22,ut.t0=ut.catch(0),ce="Failed to fetch the conversations list",this.services.syncClient.connectionState!=="disconnected"&&rn.error(ce,ut.t0),rn.debug("ERROR: ".concat(ce),ut.t0),ut.t0;case 28:case"end":return ut.stop()}},S,this,[[0,22]])}));function m(){return g.apply(this,arguments)}return m}()},{key:"getConversations",value:function(){var g=H.default($.default.mark(function S(){var b=this,_,w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this._getMap();case 2:return _=N.sent,N.next=5,_.getItems();case 5:return w=N.sent,N.abrupt("return",this._wrapPaginator(w,function(J){return Promise.all(J.map(function(ne){return b._upsertConversation("sync",ne.key,ne.data)}))}));case 7:case"end":return N.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getConversation",value:function(){var g=H.default($.default.mark(function S(b){var _=this,w,E,N;return $.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.next=2,this._getMap();case 2:return w=ne.sent,ne.next=5,w.getItems({key:b});case 5:return E=ne.sent,N=E.items.map(function(ce){return _._upsertConversation("sync",ce.key,ce.data)}),ne.abrupt("return",N.length>0?N[0]:null);case 8:case"end":return ne.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getConversationByUniqueName",value:function(){var g=H.default($.default.mark(function S(b){var _,w,E,N,J;return $.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return _=new kt(this.configuration.links.myConversations).path(b).build(),ce.next=3,this.services.network.get(_);case 3:return w=ce.sent,E=w.body,N=E.conversation_sid,J={entityName:null,lastConsumedMessageIndex:E.last_read_message_index,status:(E==null?void 0:E.status)||"unknown",friendlyName:E.friendly_name,dateUpdated:E.date_updated,dateCreated:E.date_created,uniqueName:E.unique_name,createdBy:E.created_by,attributes:E.attributes,channel:E.sync_objects.conversation,notificationLevel:E==null?void 0:E.notification_level,sid:N},ce.abrupt("return",N?this._upsertConversation("sync",N,J):null);case 8:case"end":return ce.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"peekConversation",value:function(){var g=H.default($.default.mark(function S(b){var _,w,E,N;return $.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return _=new kt(this.configuration.links.conversations).path(b).build(),ne.next=3,this.services.network.get(_);case 3:return w=ne.sent,E=w.body,N={entityName:null,status:(E==null?void 0:E.status)||"unknown",friendlyName:E.friendly_name,dateUpdated:E.date_updated,dateCreated:E.date_created,uniqueName:E.unique_name,createdBy:E.created_by,attributes:E.attributes,channel:"".concat(b,".channel"),sid:b},ne.abrupt("return",this._upsertConversation("sync",b,N));case 7:case"end":return ne.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"_getMap",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.services.syncClient.map({id:this.configuration.myConversations,mode:"open_existing"});case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"_wrapPaginator",value:function(){var g=H.default($.default.mark(function S(b,_){var w=this,E;return $.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,_(b.items);case 2:return E=J.sent,J.abrupt("return",{items:E.filter(function(ne){return ne!==null}),hasNextPage:b.hasNextPage,hasPrevPage:b.hasPrevPage,nextPage:function(){return b.nextPage().then(function(ce){return w._wrapPaginator(ce,_)})},prevPage:function(){return b.prevPage().then(function(ce){return w._wrapPaginator(ce,_)})}});case 4:case"end":return J.stop()}},S)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"_updateConversation",value:function(){var g=H.default($.default.mark(function S(b,_,w){var E,N,J;return $.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(E=_._statusSource!==void 0&&b!==_._statusSource,N=b!=="rest"||_._statusSource==="sync",!(E&&N&&b!=="sync")){ce.next=5;break}return rn.trace("upsertConversation: conversation is known from sync and came from REST, ignoring",{sid:_.sid,data:w.status,conversation:_.status}),ce.abrupt("return");case 5:if(!(w.status==="joined"&&_.status!=="joined")){ce.next=15;break}return _._setStatus("joined",b),J={},typeof w.notificationLevel<"u"&&(J.notificationLevel=w.notificationLevel),typeof w.lastConsumedMessageIndex<"u"&&(J.lastConsumedMessageIndex=w.lastConsumedMessageIndex),$e.default(J,{})||_._update(J),ce.next=13,_._subscribe();case 13:return this.emit("conversationJoined",_),ce.abrupt("return");case 15:if(!(w.status==="notParticipating"&&_.status==="joined")){ce.next=22;break}return _._setStatus("notParticipating",b),_._update(w),ce.next=20,_._subscribe();case 20:return this.emit("conversationLeft",_),ce.abrupt("return");case 22:if(w.status!=="notParticipating"){ce.next=26;break}return ce.next=25,_._subscribe();case 25:return ce.abrupt("return");case 26:_._update(w);case 27:case"end":return ce.stop()}},S,this)}));function m(S,b,_){return g.apply(this,arguments)}return m}()},{key:"_upsertConversation",value:function(){var g=H.default($.default.mark(function S(b,_,w){var E,N,J,ne;return $.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(rn.trace("upsertConversation called for ".concat(_),w),E=this.conversations.get(_),!E){ve.next=9;break}return rn.trace("upsertConversation: the conversation ".concat(E.sid," is known;")+"its status is known from the source ".concat(E._statusSource," ")+"and the update came from the source ".concat(b),E),ve.next=6,this._updateConversation(b,E,w);case 6:return ve.next=8,E._subscribe();case 8:return ve.abrupt("return",E);case 9:if(!(b==="rest"&&this.tombstones.has(_))){ve.next=12;break}return rn.trace("upsertChannel: the conversation is deleted but reappeared again from REST, ignoring",_),ve.abrupt("return",null);case 12:return rn.trace("upsertConversation: creating a local conversation object with sid "+_,w),N="".concat(this.configuration.links.conversations,"/").concat(_),J={self:N,messages:"".concat(N,"/Messages"),participants:"".concat(N,"/Participants")},ne=new ir(w,_,J,this.configuration,this.services),this.conversations.set(_,ne),ve.prev=17,ve.next=20,ne._subscribe();case 20:if(w.status!=="joined"){ve.next=23;break}return ve.next=23,ne._fetchStreams();case 23:ve.next=32;break;case 25:if(ve.prev=25,ve.t0=ve.catch(17),ve.t0.name==="SyncError"){ve.next=29;break}throw ve.t0;case 29:return rn.trace("upsertChannel: the conversation is missing some Sync entity(ies), ignoring",_,ve.t0),this.conversations.delete(_),ve.abrupt("return",null);case 32:return this._registerForEvents(ne),this.emit("conversationAdded",ne),w.status==="joined"&&(ne._setStatus("joined",b),this.emit("conversationJoined",ne)),ve.abrupt("return",ne);case 36:case"end":return ve.stop()}},S,this,[[17,25]])}));function m(S,b,_){return g.apply(this,arguments)}return m}()},{key:"_fetchMyConversations",value:function(){var g=H.default($.default.mark(function S(){var b,_,w,E,N,J;return $.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:b=[],_=null;case 2:return E=new kt(this.configuration.links.myConversations),_&&E.arg("PageToken",_),ce.next=6,this.services.network.get(E.build());case 6:N=ce.sent,J=(w=N.body)===null||w===void 0?void 0:w.conversations.map(function(ve){return{descriptor:ve,channel_sid:ve.conversation_sid,status:ve.status,channel:ve.sync_objects.conversation,messages:ve.sync_objects.messages,roster:"".concat(ve.conversation_sid,".roster"),lastConsumedMessageIndex:ve.last_read_message_index,notificationLevel:ve.notification_level}}),_=N.body.meta.next_token,b=[].concat(dt.default(b),dt.default(J));case 10:if(_){ce.next=2;break}case 11:return ce.abrupt("return",b);case 12:case"end":return ce.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"_onConversationRemoved",value:function(m){var S=this.conversations.get(m);S&&(this.conversations.delete(m),this.emit("conversationRemoved",S))}},{key:"_registerForEvents",value:function(m){var S=this;m.on("removed",function(){return S._onConversationRemoved(m.sid)}),m.on("updated",function(b){return S.emit("conversationUpdated",b)}),m.on("participantJoined",function(b){return S.emit("participantJoined",b)}),m.on("participantLeft",function(b){return S.emit("participantLeft",b)}),m.on("participantUpdated",function(b){return S.emit("participantUpdated",b)}),m.on("messageAdded",function(b){return S.emit("messageAdded",b)}),m.on("messageUpdated",function(b){return S.emit("messageUpdated",b)}),m.on("messageRemoved",function(b){return S.emit("messageRemoved",b)}),m.on("typingStarted",function(b){return S.emit("typingStarted",b)}),m.on("typingEnded",function(b){return S.emit("typingEnded",b)})}}]),T}(k.ReplayEventEmitter);function Vu(M){var O=Xc();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function Xc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Kc=function(M){Z.default(T,M);var O=Vu(T);function T(g,m,S){var b;return Te.default(this,T),b=O.call(this),b.configuration=m,b.services=S,b.fifoStack=[],b.myself=g,b.myself.on("updated",function(_){return b.emit("userUpdated",_)}),b.myself.on("userSubscribed",function(){return b.emit("userSubscribed",b.myself)}),b.myself.on("userUnsubscribed",function(){b.emit("userUnsubscribed",b.myself),b.myself._ensureFetched()}),b.subscribedUsers=new Map,b}return fe.default(T,[{key:"handleUnsubscribeUser",value:function(m){this.subscribedUsers.has(m.identity)&&this.subscribedUsers.delete(m.identity);var S=0,b=this.fifoStack.find(function(_,w){return _==m.identity?(S=w,!0):!1});b&&this.fifoStack.splice(S,1),this.emit("userUnsubscribed",m)}},{key:"handleSubscribeUser",value:function(m){if(!this.subscribedUsers.has(m.identity)){if(this.fifoStack.length>=this.configuration.userInfosToSubscribe){var S,b,_=this.fifoStack.shift();(S=this.subscribedUsers)===null||S===void 0||(b=S.get(_))===null||b===void 0||b.unsubscribe()}this.fifoStack.push(m.identity),this.subscribedUsers.set(m.identity,m),this.emit("userSubscribed",m)}}},{key:"getUser",value:function(){var g=H.default($.default.mark(function S(b,_){var w,E=this,N,J;return $.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,this.myself._ensureFetched();case 2:if(b!=this.myself.identity){ce.next=4;break}return ce.abrupt("return",this.myself);case 4:if(N=this.subscribedUsers.get(b),!N){ce.next=7;break}return ce.abrupt("return",N);case 7:if(!((w=_)!==null&&w!==void 0)){ce.next=11;break}ce.next=14;break;case 11:return ce.next=13,this.getSyncUniqueName(b);case 13:_=ce.sent;case 14:return J=new qr(b,_,this.configuration,this.services),J.on("updated",function(ve){return E.emit("userUpdated",ve)}),J.on("userSubscribed",function(){return E.handleSubscribeUser(J)}),J.on("userUnsubscribed",function(){return E.handleUnsubscribeUser(J)}),ce.next=20,J._ensureFetched();case 20:return ce.abrupt("return",J);case 21:case"end":return ce.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"getSubscribedUsers",value:function(){var g=H.default($.default.mark(function S(){var b;return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.myself._ensureFetched();case 2:return b=[this.myself],this.subscribedUsers.forEach(function(E){return b.push(E)}),w.abrupt("return",b);case 5:case"end":return w.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getSyncUniqueName",value:function(){var g=H.default($.default.mark(function S(b){var _,w,E,N;return $.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return E=new kt(this.configuration.links.users).path(b).build(),ne.next=3,this.services.network.get(E);case 3:return N=ne.sent,ne.abrupt("return",(_=(w=N.body)===null||w===void 0?void 0:w.sync_objects.user_info_map)!==null&&_!==void 0?_:"");case 5:case"end":return ne.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()}]),T}(k.ReplayEventEmitter),Gi=vr.scope("TypingIndicator"),ja=function(){function M(O,T,g){Te.default(this,M),this.configuration=T,this.services=g,this.getConversation=O,this.serviceTypingTimeout=null,this.sentUpdates=new Map}return fe.default(M,[{key:"typingTimeout",get:function(){return this.configuration.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.configuration.typingIndicatorTimeoutDefault}},{key:"initialize",value:function(){var T=this;this.services.notificationClient.on("message",function(){var g=H.default($.default.mark(function m(S,b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(S!==ye.TYPING_INDICATOR){w.next=3;break}return w.next=3,T._handleRemoteTyping(b);case 3:case"end":return w.stop()}},m)}));return function(m,S){return g.apply(this,arguments)}}())}},{key:"_handleRemoteTyping",value:function(){var O=H.default($.default.mark(function g(m){var S=this;return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:Gi.trace("Got new typing indicator ",m),this.getConversation(m.channel_sid).then(function(w){w&&w._participants.forEach(function(E){if(E.identity===m.identity){var N=S.configuration.typingIndicatorTimeoutOverride?S.configuration.typingIndicatorTimeoutOverride+1e3:m.typing_timeout*1e3;E._startTyping(N)}})}).catch(function(w){throw Gi.error(w),w});case 2:case"end":return _.stop()}},g,this)}));function T(g){return O.apply(this,arguments)}return T}()},{key:"send",value:function(T){var g=this.sentUpdates.get(T);return g&&g>Date.now()-this.typingTimeout?Promise.resolve():(this.sentUpdates.set(T,Date.now()),this._send(T))}},{key:"_send",value:function(T){var g=this;Gi.trace("Sending typing indicator");var m=this.configuration.links.typing,S={"Content-Type":"application/x-www-form-urlencoded"},b="ChannelSid=".concat(T);return this.services.twilsockClient.post(m,S,b,this.configuration.productId).then(function(_){_.body.hasOwnProperty("typing_timeout")&&(g.serviceTypingTimeout=_.body.typing_timeout*1e3)}).catch(function(_){throw Gi.error("Failed to send typing indicator:",_),_})}}]),M}(),jr=fe.default(function M(O){Te.default(this,M),this.title=O.title||null,this.body=O.body||null,this.sound=O.sound||null,this.badge=O.badge||null,this.action=O.action||null,this.type=O.type||null,this.data=O.data||{}}),wo="2.4.0";function Fu(M,O){var T=Object.keys(M);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(M);O&&(g=g.filter(function(m){return Object.getOwnPropertyDescriptor(M,m).enumerable})),T.push.apply(T,g)}return T}function ai(M){for(var O=1;O<arguments.length;O++){var T=arguments[O]!=null?arguments[O]:{};O%2?Fu(Object(T),!0).forEach(function(g){K.default(M,g,T[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(T)):Fu(Object(T)).forEach(function(g){Object.defineProperty(M,g,Object.getOwnPropertyDescriptor(T,g))})}return M}function Ti(M){var O=ef();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function ef(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var B=function(O){return O.replace(/(^\/+|\/+$)/g,"")},G=function(O){return O.status.code===202},x=function(M){Z.default(T,M);var O=Ti(T);function T(g){return Te.default(this,T),O.call(this,g)}return fe.default(T)}(Rr.default(Error)),P=function(){function M(O,T,g){Te.default(this,M),this._serviceUrl=O,this._services=T,this._productId=g}return fe.default(M,[{key:"_preProcessUrl",value:function(T){var g=B(T);return/^https?:\/\//.test(T)?g:"".concat(B(this._serviceUrl),"/").concat(g)}},{key:"_makeRequest",value:function(){var O=H.default($.default.mark(function g(m,S,b,_){var w,E,N,J;return $.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:w=this._preProcessUrl(S),E=ai({"Content-Type":"application/json; charset=utf-8"},_||{}),ce.t0=m,ce.next=ce.t0==="get"?5:ce.t0==="post"?11:ce.t0==="delete"?15:19;break;case 5:return J=w,b&&(J+="?"+Object.entries(b).map(function(ve){return ve.map(encodeURIComponent).join("=")}).join("&")),ce.next=9,this._services.transport.get(J,E,this._productId);case 9:return N=ce.sent,ce.abrupt("break",19);case 11:return ce.next=13,this._services.transport.post(w,E,JSON.stringify(b),this._productId);case 13:return N=ce.sent,ce.abrupt("break",19);case 15:return ce.next=17,this._services.transport.delete(w,E,{},this._productId);case 17:return N=ce.sent,ce.abrupt("break",19);case 19:if(!(N.status.code<200||N.status.code>=300)){ce.next=21;break}throw new Error("Request responded with a non-success code ".concat(N.status.code));case 21:return ce.abrupt("return",N);case 22:case"end":return ce.stop()}},g,this)}));function T(g,m,S,b){return O.apply(this,arguments)}return T}()},{key:"fetchResource",value:function(){var O=H.default($.default.mark(function g(m,S){var b=this,_,w,E;return $.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return _=6,w=new L.AsyncRetrier({min:50,max:1600,maxAttemptsCount:_}),J.prev=2,J.next=5,w.run(H.default($.default.mark(function ne(){var ce,ve,ut;return $.default.wrap(function(Vt){for(;;)switch(Vt.prev=Vt.next){case 0:return Vt.prev=0,Vt.next=3,b._makeRequest("get",m,S);case 3:return ce=Vt.sent,Vt.abrupt("return",{type:"success",data:ce.body});case 7:if(Vt.prev=7,Vt.t0=Vt.catch(0),!((Vt.t0===null||Vt.t0===void 0||(ve=Vt.t0.body)===null||ve===void 0?void 0:ve.status)===404&&(Vt.t0===null||Vt.t0===void 0||(ut=Vt.t0.body)===null||ut===void 0?void 0:ut.code)===50530)){Vt.next=11;break}return Vt.abrupt("return",{type:"noMetadata"});case 11:throw Vt.t0;case 12:case"end":return Vt.stop()}},ne,null,[[0,7]])})));case 5:E=J.sent,J.next=11;break;case 8:throw J.prev=8,J.t0=J.catch(2),new Error('Fetch resource from "'.concat(m,'" failed.'));case 11:if(E.type!=="noMetadata"){J.next=13;break}throw new x("No metadata found.");case 13:return J.abrupt("return",E.data);case 14:case"end":return J.stop()}},g,null,[[2,8]])}));function T(g,m){return O.apply(this,arguments)}return T}()},{key:"mutateResource",value:function(){var O=H.default($.default.mark(function g(m,S,b){var _;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._makeRequest(m,S,b,{"X-Twilio-Mutation-Id":X.v4()});case 2:if(_=E.sent,!G(_)){E.next=7;break}return E.next=6,this.fetchResource(_.body.resource_url);case 6:return E.abrupt("return",E.sent);case 7:return E.abrupt("return",_.body);case 8:case"end":return E.stop()}},g,this)}));function T(g,m,S){return O.apply(this,arguments)}return T}()}]),M}(),A=function(){function M(O){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5e3;Te.default(this,M),K.default(this,"_cachedTemplates",null),this._services=O,this._pageSize=T,this._cacheTtlMs=g}return fe.default(M,[{key:"getContentTemplates",value:function(){var O=H.default($.default.mark(function g(){var m=this,S,b,_,w,E,N,J;return $.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(this._cachedTemplates===null){ce.next=2;break}return ce.abrupt("return",this._cachedTemplates);case 2:return ce.next=4,this._fetchContentTemplates();case 4:S=ce.sent,b=ue.default(S,2),_=b[0],w=b[1],E=_;case 9:if(w===null){ce.next=19;break}return ce.next=12,this._fetchContentTemplates(w);case 12:N=ce.sent,J=ue.default(N,2),_=J[0],w=J[1],E=[].concat(dt.default(E),dt.default(_)),ce.next=9;break;case 19:return this._cachedTemplates=Object.freeze(E),setTimeout(function(){m._cachedTemplates=null},this._cacheTtlMs),ce.abrupt("return",E);case 22:case"end":return ce.stop()}},g,this)}));function T(){return O.apply(this,arguments)}return T}()},{key:"_fetchContentTemplates",value:function(){var O=H.default($.default.mark(function g(m){var S,b,_;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return S="Client/v2/ContentTemplates",b=new kt(S),b.arg("PageSize",this._pageSize),m!==void 0&&b.arg("PageToken",m),E.next=6,this._services.commandExecutor.fetchResource(b.build());case 6:return _=E.sent,E.abrupt("return",[_.templates.map(function(N){return new ft(N)}),_.meta.next_token]);case 8:case"end":return E.stop()}},g,this)}));function T(g){return O.apply(this,arguments)}return T}()}]),M}();function Q(M,O){var T=typeof Symbol<"u"&&M[Symbol.iterator]||M["@@iterator"];if(!T){if(Array.isArray(M)||(T=j(M))||O&&M&&typeof M.length=="number"){T&&(M=T);var g=0,m=function(){};return{s:m,n:function(){return g>=M.length?{done:!0}:{done:!1,value:M[g++]}},e:function(E){throw E},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,b=!1,_;return{s:function(){T=T.call(M)},n:function(){var E=T.next();return S=E.done,E},e:function(E){b=!0,_=E},f:function(){try{!S&&T.return!=null&&T.return()}finally{if(b)throw _}}}}function j(M,O){if(M){if(typeof M=="string")return Se(M,O);var T=Object.prototype.toString.call(M).slice(8,-1);if(T==="Object"&&M.constructor&&(T=M.constructor.name),T==="Map"||T==="Set")return Array.from(M);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return Se(M,O)}}function Se(M,O){(O==null||O>M.length)&&(O=M.length);for(var T=0,g=new Array(O);T<O;T++)g[T]=M[T];return g}var we=function(M){function O(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Te.default(this,O),!(T.maxSize&&T.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=T.maxSize,this.onEviction=T.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}return fe.default(O,[{key:"_set",value:function(g,m){if(this.cache.set(g,m),this._size++,this._size>=this.maxSize){if(this._size=0,typeof this.onEviction=="function"){var S=Q(this.oldCache.entries()),b;try{for(S.s();!(b=S.n()).done;){var _=ue.default(b.value,2),w=_[0],E=_[1];this.onEviction(w,E)}}catch(N){S.e(N)}finally{S.f()}}this.oldCache=this.cache,this.cache=new Map}}},{key:"get",value:function(g){if(this.cache.has(g))return this.cache.get(g);if(this.oldCache.has(g)){var m=this.oldCache.get(g);return this.oldCache.delete(g),this._set(g,m),m}}},{key:"set",value:function(g,m){return this.cache.has(g)?this.cache.set(g,m):this._set(g,m),this}},{key:"has",value:function(g){return this.cache.has(g)||this.oldCache.has(g)}},{key:"peek",value:function(g){if(this.cache.has(g))return this.cache.get(g);if(this.oldCache.has(g))return this.oldCache.get(g)}},{key:"delete",value:function(g){var m=this.cache.delete(g);return m&&this._size--,this.oldCache.delete(g)||m}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"keys",value:$.default.mark(function T(){var g,m,S,b;return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:g=Q(this),w.prev=1,g.s();case 3:if((m=g.n()).done){w.next=9;break}return S=ue.default(m.value,1),b=S[0],w.next=7,b;case 7:w.next=3;break;case 9:w.next=14;break;case 11:w.prev=11,w.t0=w.catch(1),g.e(w.t0);case 14:return w.prev=14,g.f(),w.finish(14);case 17:case"end":return w.stop()}},T,this,[[1,11,14,17]])})},{key:"values",value:$.default.mark(function T(){var g,m,S,b;return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:g=Q(this),w.prev=1,g.s();case 3:if((m=g.n()).done){w.next=9;break}return S=ue.default(m.value,2),b=S[1],w.next=7,b;case 7:w.next=3;break;case 9:w.next=14;break;case 11:w.prev=11,w.t0=w.catch(1),g.e(w.t0);case 14:return w.prev=14,g.f(),w.finish(14);case 17:case"end":return w.stop()}},T,this,[[1,11,14,17]])})},{key:M,value:$.default.mark(function T(){var g,m,S,b,_,w,E,N;return $.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:g=Q(this.cache),ne.prev=1,g.s();case 3:if((m=g.n()).done){ne.next=9;break}return S=m.value,ne.next=7,S;case 7:ne.next=3;break;case 9:ne.next=14;break;case 11:ne.prev=11,ne.t0=ne.catch(1),g.e(ne.t0);case 14:return ne.prev=14,g.f(),ne.finish(14);case 17:b=Q(this.oldCache),ne.prev=18,b.s();case 20:if((_=b.n()).done){ne.next=28;break}if(w=_.value,E=ue.default(w,1),N=E[0],this.cache.has(N)){ne.next=26;break}return ne.next=26,w;case 26:ne.next=20;break;case 28:ne.next=33;break;case 30:ne.prev=30,ne.t1=ne.catch(18),b.e(ne.t1);case 33:return ne.prev=33,b.f(),ne.finish(33);case 36:case"end":return ne.stop()}},T,this,[[1,11,14,17],[18,30,33,36]])})},{key:"size",get:function(){var g=0,m=Q(this.oldCache.keys()),S;try{for(m.s();!(S=m.n()).done;){var b=S.value;this.cache.has(b)||g++}}catch(_){m.e(_)}finally{m.f()}return Math.min(this._size+g,this.maxSize)}}]),O}(Symbol.iterator),Ve=we,Ye=fe.default(function M(O,T){Te.default(this,M),this.type=O,this.data=T,Object.freeze(T)}),gt=function(){function M(O,T){Te.default(this,M),this._services=O,this._configuration=T,this._cache=new Ve({maxSize:T.channelMetadataCacheCapacity})}return fe.default(M,[{key:"getChannelMetadata",value:function(){var O=H.default($.default.mark(function g(m,S){var b,_,w,E,N;return $.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(b="".concat(m,",").concat(S),_=this._cache.get(b),!_){ne.next=4;break}return ne.abrupt("return",_.item);case 4:return w="".concat(this._configuration.links.conversations,"/").concat(m,"/Messages/").concat(S,"/ChannelMetadata"),ne.prev=5,ne.next=8,this._services.commandExecutor.fetchResource(w);case 8:E=ne.sent,ne.next=17;break;case 11:if(ne.prev=11,ne.t0=ne.catch(5),!(ne.t0 instanceof x)){ne.next=16;break}return this._cache.set(b,{item:null}),ne.abrupt("return",null);case 16:throw new Error(ne.t0);case 17:return N=new Ye(E.type,E.data),this._cache.set(b,{item:N}),ne.abrupt("return",N);case 20:case"end":return ne.stop()}},g,this,[[5,11]])}));function T(g,m){return O.apply(this,arguments)}return T}()}]),M}(),xt;function oi(M,O){var T=Object.keys(M);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(M);O&&(g=g.filter(function(m){return Object.getOwnPropertyDescriptor(M,m).enumerable})),T.push.apply(T,g)}return T}function Yr(M){for(var O=1;O<arguments.length;O++){var T=arguments[O]!=null?arguments[O]:{};O%2?oi(Object(T),!0).forEach(function(g){K.default(M,g,T[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(T)):oi(Object(T)).forEach(function(g){Object.defineProperty(M,g,Object.getOwnPropertyDescriptor(T,g))})}return M}function Si(M){var O=K0();return function(){var g=re.default(M),m;if(O){var S=re.default(this).constructor;m=Reflect.construct(g,arguments,S)}else m=g.apply(this,arguments);return te.default(this,m)}}function K0(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ir,Y=fe.default(function M(){Te.default(this,M)});t.Client=Ir=(xt=function(M){Z.default(T,M);var O=Si(T);function T(g){var m,S,b,_,w,E,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Te.default(this,T),E=O.call(this),K.default(ee.default(E),"version",wo),K.default(ee.default(E),"connectionState","unknown"),K.default(ee.default(E),"parsePushNotification",Ir.parsePushNotification),E._fpaToken=g??"",E._options=N??{},!E._options.disableDeepClone){var J=Yr(Yr({},E._options),{},{transport:void 0,twilsockClient:void 0});J=_i(J),J.transport=E._options.transport,J.twilsockClient=E._options.twilsockClient,E._options=J}E._options.logLevel=(m=E._options.logLevel)!==null&&m!==void 0?m:"silent",Ir._logger.setLevel(E._options.logLevel);var ne=E._options.productId="ip_messaging";if(E._options.clientMetadata=E._options.clientMetadata||{},E._options.clientMetadata.hasOwnProperty("type")||(E._options.clientMetadata.type="conversations"),E._options.clientMetadata.hasOwnProperty("sdk")||(E._options.clientMetadata.sdk="JS",E._options.clientMetadata.sdkv=wo),E._options.Sync=E._options.Sync||{},typeof E._options.Sync.enableSessionStorage>"u"&&(E._options.Sync.enableSessionStorage=!0),E._options.region&&(E._options.Sync.region=E._options.region),!g)throw new Error("A valid Twilio token should be provided");E._services=new Y,E._myself=new qr("","",null,E._services);var ce=!E._options.twilsockClient;if(!E._options.initRegistrations){var ve=new R.InitRegistration(ne);Ir.populateInitRegistrations(ve),E._options.initRegistrations=[ve]}E._services.twilsockClient=E._options.twilsockClient=(S=E._options.twilsockClient)!==null&&S!==void 0?S:new R.TwilsockClient(g,ne,E._options),E._services.twilsockClient.on("tokenAboutToExpire",function(){return E.emit("tokenAboutToExpire")}),E._services.twilsockClient.on("tokenExpired",function(){return E.emit("tokenExpired")}),E._services.twilsockClient.on("connectionError",function(nn){return E.emit("connectionError",nn)}),E._services.twilsockClient.on("stateChanged",function(nn){Ir._logger.debug("Handling stateChanged for ConversationsClient: new state ".concat(nn)),nn!==E.connectionState&&(E.connectionState=nn,E.emit("connectionStateChanged",E.connectionState))}),E._services.transport=E._options.transport=(b=E._options.transport)!==null&&b!==void 0?b:E._options.twilsockClient,E._services.notificationClient=E._options.notificationsClient=(_=E._options.notificationsClient)!==null&&_!==void 0?_:new q.Notifications(g,E._options),E._services.syncClient=E._options.syncClient=(w=E._options.syncClient)!==null&&w!==void 0?w:new z.SyncClient(g,E._options);var ut=(N==null?void 0:N.Chat)||(N==null?void 0:N.IPMessaging)||N||{},Ct=ut.region||(N==null?void 0:N.region),Vt=ut.apiUri||ut.typingUri||"https://aim.".concat(Ct||"us1",".twilio.com");E._services.commandExecutor=new P(Vt,{transport:E._options.transport},ne),E._services.contentClient=new A(E._services);var Ft=function(Ut){E._rejectEnsureReady(Ut),E.emit("stateChanged","failed"),E.emit("initFailed",{error:Ut})},En=function(){Ft({terminal:!0,message:"Twilsock has disconnected."})};return E._services.twilsockClient.once("connectionError",Ft),E._services.twilsockClient.once("disconnected",En),E._services.twilsockClient.once("connected",H.default($.default.mark(function nn(){var Ut,Hi;return $.default.wrap(function(wt){for(;;)switch(wt.prev=wt.next){case 0:return Ir._logger.debug("ConversationsClient started INITIALIZING"),E._services.twilsockClient.off("connectionError",Ft),E._services.twilsockClient.off("disconnected",En),wt.prev=3,Ut="conversations.client.startup",E._services.twilsockClient.addPartialTelemetryEvent(new R.TelemetryEventDescription(Ut,"Conversations client startup",new Date),Ut,R.TelemetryPoint.Start),wt.next=8,E._initialize();case 8:E._services.twilsockClient.addPartialTelemetryEvent(new R.TelemetryEventDescription("","",new Date),Ut,R.TelemetryPoint.End),wt.next=17;break;case 11:wt.prev=11,wt.t0=wt.catch(3),Hi={terminal:!0,message:wt.t0.message},E._rejectEnsureReady(Hi),E.emit("stateChanged","failed"),E.emit("initFailed",{error:Hi});case 17:case"end":return wt.stop()}},nn,null,[[3,11]])}))),E._ensureReady=new Promise(function(nn,Ut){E._resolveEnsureReady=nn,E._rejectEnsureReady=Ut}).catch(function(){}),ce&&E._services.twilsockClient.connect(),E}return fe.default(T,[{key:"user",get:function(){return this._myself}},{key:"reachabilityEnabled",get:function(){if(!this._configuration)throw new Error("Reachability information could not yet be accessed as the client has not yet been initialized. Subscribe to the 'stateChanged' event to properly react to the client initialization.");return this._configuration.reachabilityEnabled}},{key:"token",get:function(){return this._fpaToken}},{key:"shutdown",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._ensureReady;case 2:return _.next=4,this._services.twilsockClient.disconnect();case 4:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"updateToken",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:if(Ir._logger.info("updateToken"),this._fpaToken!==b){w.next=5;break}return w.abrupt("return",this);case 5:return w.next=7,this._services.twilsockClient.updateToken(b);case 7:return w.next=9,this._services.notificationClient.updateToken(b);case 9:return w.next=11,this._services.mcsClient.updateToken(b);case 11:return this._fpaToken=b,w.abrupt("return",this);case 13:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getConversationBySid",value:function(){var g=H.default($.default.mark(function S(b){var _;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._ensureReady;case 2:return E.next=4,this._conversationsEntity.myConversationsRead.promise;case 4:return E.next=6,this._conversationsEntity.getConversation(b);case 6:if(_=E.sent,_){E.next=12;break}return E.next=10,this.peekConversationBySid(b);case 10:_=E.sent,_&&D.deprecationWarning("The method getConversationBySid is deprecated to retrieve conversations you're not part of. Use peekConversationBySid instead.");case 12:if(_){E.next=14;break}throw new Error("Conversation with SID ".concat(b," was not found."));case 14:return E.abrupt("return",_);case 15:case"end":return E.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"peekConversationBySid",value:function(){var g=H.default($.default.mark(function S(b){var _;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._ensureReady;case 2:return E.next=4,this._conversationsEntity.peekConversation(b);case 4:if(_=E.sent,_){E.next=7;break}throw new Error("Conversation with SID ".concat(b," was not found."));case 7:return E.abrupt("return",_);case 8:case"end":return E.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getConversationByUniqueName",value:function(){var g=H.default($.default.mark(function S(b){var _;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._ensureReady;case 2:return E.next=4,this._conversationsEntity.myConversationsRead.promise;case 4:return E.next=6,this._conversationsEntity.getConversationByUniqueName(b);case 6:if(_=E.sent,_){E.next=9;break}throw new Error("Conversation with unique name ".concat(b," was not found."));case 9:return E.abrupt("return",_);case 10:case"end":return E.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getSubscribedConversations",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._ensureReady;case 2:return _.abrupt("return",this._conversationsPromise.then(function(w){return w.getConversations()}));case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"createConversation",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:return b=b||{},w.abrupt("return",this._conversationsPromise.then(function(E){return E.addConversation(b)}));case 4:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"setPushRegistrationId",value:function(){var g=H.default($.default.mark(function S(b,_){return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._ensureReady;case 2:return this._subscribeToPushNotifications(b),this._services.notificationClient.setPushRegistrationId(b,_),E.next=6,this._services.notificationClient.commitChanges();case 6:case"end":return E.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"unsetPushRegistrationId",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:return this._unsubscribeFromPushNotifications(b),w.next=5,this._services.notificationClient.commitChanges();case 5:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"removePushRegistrations",value:function(){var g=H.default($.default.mark(function S(b,_){return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._services.notificationClient.removeRegistrations(b,_);case 2:case"end":return E.stop()}},S,this)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"handlePushNotification",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:Ir._logger.debug("handlePushNotification, notificationPayload=",b),this.emit("pushNotification",Ir.parsePushNotification(b));case 4:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getUser",value:function(){var g=H.default($.default.mark(function S(b){return $.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:return w.abrupt("return",this._services.users.getUser(b));case 3:case"end":return w.stop()}},S,this)}));function m(S){return g.apply(this,arguments)}return m}()},{key:"getSubscribedUsers",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._ensureReady;case 2:return _.abrupt("return",this._services.users.getSubscribedUsers());case 3:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"getTemporaryContentUrlsForMediaSids",value:function(m){var S=this;return new F.CancellablePromise(function(){var b=H.default($.default.mark(function _(w,E,N){var J,ne;return $.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(!(!S._services.mcsClient||!m)){ve.next=3;break}return E(new Error("Media Content Service is unavailable")),ve.abrupt("return");case 3:return J=S._services.mcsClient.mediaSetGetContentUrls(m),N(function(){J.cancel()}),ve.prev=5,ve.next=8,J;case 8:ne=ve.sent,w(ne),ve.next=15;break;case 12:ve.prev=12,ve.t0=ve.catch(5),E(ve.t0);case 15:case"end":return ve.stop()}},_,null,[[5,12]])}));return function(_,w,E){return b.apply(this,arguments)}}())}},{key:"getTemporaryContentUrlsForMedia",value:function(m){var S=m.map(function(b){return b.sid});return this.getTemporaryContentUrlsForMediaSids(S)}},{key:"getContentTemplates",value:function(){var g=H.default($.default.mark(function S(){return $.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._ensureReady;case 2:return _.next=4,this._services.contentClient.getContentTemplates();case 4:return _.abrupt("return",_.sent);case 5:case"end":return _.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"_initialize",value:function(){var g=H.default($.default.mark(function S(){var b=this,_;return $.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._services.commandExecutor.fetchResource("Client/v2/Configuration");case 2:return _=E.sent,this._configuration=new Dn(this._options,_,Ir._logger),this._services.channelMetadataClient=new gt(this._services,this._configuration),this._myself._resolveInitialization(this._configuration,this._configuration.userIdentity,this._configuration.userInfo,!0),this._services.typingIndicator=new ja(this.getConversationBySid.bind(this),this._configuration,this._services),this._services.network=new he(this._configuration,this._services),this._services.users=new Kc(this._myself,this._configuration,this._services),this._services.users.on("userSubscribed",function(N){b.emit("userSubscribed",N)}),this._services.users.on("userUpdated",function(N){return b.emit("userUpdated",N)}),this._services.users.on("userUnsubscribed",function(N){b.emit("userUnsubscribed",N)}),this._conversationsEntity=new Jc(this._configuration,this._services),this._conversationsEntity.on("conversationAdded",function(N){b.emit("conversationAdded",N)}),this._conversationsEntity.on("conversationRemoved",function(N){b.emit("conversationRemoved",N)}),this._conversationsEntity.on("conversationJoined",function(N){b.emit("conversationJoined",N)}),this._conversationsEntity.on("conversationLeft",function(N){b.emit("conversationLeft",N)}),this._conversationsEntity.on("conversationUpdated",function(N){return b.emit("conversationUpdated",N)}),this._conversationsEntity.on("participantJoined",function(N){b.emit("participantJoined",N)}),this._conversationsEntity.on("participantLeft",function(N){b.emit("participantLeft",N)}),this._conversationsEntity.on("participantUpdated",function(N){return b.emit("participantUpdated",N)}),this._conversationsEntity.on("messageAdded",function(N){return b.emit("messageAdded",N)}),this._conversationsEntity.on("messageUpdated",function(N){return b.emit("messageUpdated",N)}),this._conversationsEntity.on("messageRemoved",function(N){return b.emit("messageRemoved",N)}),this._conversationsEntity.on("typingStarted",function(N){return b.emit("typingStarted",N)}),this._conversationsEntity.on("typingEnded",function(N){return b.emit("typingEnded",N)}),this._conversationsPromise=this._conversationsEntity.fetchConversations().then(function(){return b._conversationsEntity}).catch(function(N){throw N}),E.next=29,this._services.users.myself._ensureFetched();case 29:Ir._supportedPushChannels.forEach(function(N){return b._subscribeToPushNotifications(N)}),this._services.typingIndicator.initialize(),this._services.mcsClient=new F.McsClient(this._fpaToken,this._configuration.links.mediaService,this._configuration.links.mediaSetService,Yr(Yr({},this._options),{},{transport:void 0})),this._resolveEnsureReady(),this.emit("stateChanged","initialized"),this.emit("initialized");case 35:case"end":return E.stop()}},S,this)}));function m(){return g.apply(this,arguments)}return m}()},{key:"_subscribeToPushNotifications",value:function(m){var S=this;[ye.NEW_MESSAGE,ye.ADDED_TO_CONVERSATION,ye.REMOVED_FROM_CONVERSATION,ye.TYPING_INDICATOR,ye.CONSUMPTION_UPDATE].forEach(function(b){S._services.notificationClient.subscribe(m,b)})}},{key:"_unsubscribeFromPushNotifications",value:function(m){var S=this;[ye.NEW_MESSAGE,ye.ADDED_TO_CONVERSATION,ye.REMOVED_FROM_CONVERSATION,ye.TYPING_INDICATOR,ye.CONSUMPTION_UPDATE].forEach(function(b){S._services.notificationClient.unsubscribe(m,b)})}}],[{key:"create",value:function(){var g=H.default($.default.mark(function S(b,_){var w;return $.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(!(_!=null&&_.twilsockClient)){N.next=2;break}throw new Error("Obsolete usage of ConversationsClient.create() factory method: if you pass twilsock from the outside then you must use ConversationsClient constructor and be prepared to work with uninitialized client.");case 2:return w=new Ir(b,_),N.next=5,w._ensureReady;case 5:return N.abrupt("return",w);case 6:case"end":return N.stop()}},S)}));function m(S,b){return g.apply(this,arguments)}return m}()},{key:"parsePushNotification",value:function(m){if(Ir._logger.debug("parsePushNotification, notificationPayload=",m),typeof m.aps<"u"){if(!m.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var S=Ir._parsePushNotificationChatData(m),b=m.aps,_,w=null;if(typeof b.alert=="string")_=b.alert||null;else{var E,N;_=((E=b.alert)===null||E===void 0?void 0:E.body)||null,w=((N=b.alert)===null||N===void 0?void 0:N.title)||null}return new jr({title:w,body:_,sound:b.sound||null,badge:b.badge||null,action:b.category||null,type:m.twi_message_type,data:S})}if(typeof m.data<"u"){var J=m.data;if(!J.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var ne=Ir._parsePushNotificationChatData(m.data);return new jr({title:J.twi_title||null,body:J.twi_body||null,sound:J.twi_sound||null,badge:null,action:J.twi_action||null,type:J.twi_message_type,data:ne})}throw new Error("Provided push notification payload is not Programmable Chat notification")}},{key:"_parsePushNotificationChatData",value:function(m){var S={};for(var b in Ir._supportedPushDataFields){var _=m[b];if(!(typeof _>"u"||_===null)){if(b==="message_index"||b==="media_count"){var w=Qt(_);w!==null&&(S[Ir._supportedPushDataFields[b]]=w);continue}if(b==="media"){if(typeof _=="string")try{S[Ir._supportedPushDataFields[b]]=JSON.parse(_)}catch{Ir._logger.debug("Media message notification parsing error")}continue}S[Ir._supportedPushDataFields[b]]=_}}return S}},{key:"populateInitRegistrations",value:function(m){m.populateInitRegistrations([ye.TYPING_INDICATOR]),z.SyncClient.populateInitRegistrations(m)}}]),T}(k.ReplayEventEmitter),K.default(xt,"conversationAdded","conversationAdded"),K.default(xt,"conversationJoined","conversationJoined"),K.default(xt,"conversationLeft","conversationLeft"),K.default(xt,"conversationRemoved","conversationRemoved"),K.default(xt,"conversationUpdated","conversationUpdated"),K.default(xt,"participantJoined","participantJoined"),K.default(xt,"participantLeft","participantLeft"),K.default(xt,"participantUpdated","participantUpdated"),K.default(xt,"messageAdded","messageAdded"),K.default(xt,"messageRemoved","messageRemoved"),K.default(xt,"messageUpdated","messageUpdated"),K.default(xt,"tokenAboutToExpire","tokenAboutToExpire"),K.default(xt,"tokenExpired","tokenExpired"),K.default(xt,"typingEnded","typingEnded"),K.default(xt,"typingStarted","typingStarted"),K.default(xt,"pushNotification","pushNotification"),K.default(xt,"userSubscribed","userSubscribed"),K.default(xt,"userUnsubscribed","userUnsubscribed"),K.default(xt,"userUpdated","userUpdated"),K.default(xt,"stateChanged","stateChanged"),K.default(xt,"initialized","initialized"),K.default(xt,"initFailed","initFailed"),K.default(xt,"connectionStateChanged","connectionStateChanged"),K.default(xt,"connectionError","connectionError"),K.default(xt,"version",wo),K.default(xt,"_logger",vr.scope("Client")),K.default(xt,"_supportedPushChannels",["fcm","apn"]),K.default(xt,"_supportedPushDataFields",{conversation_sid:"conversationSid",conversation_title:"conversationTitle",message_sid:"messageSid",message_index:"messageIndex",media_count:"mediaCount",media:"media"}),xt),Ue([D.deprecated("token"),ke("design:type",String),ke("design:paramtypes",[])],t.Client.prototype,"token",null),Ue([p.validateTypesAsync(p.nonEmptyString),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],t.Client.prototype,"updateToken",null),Ue([p.validateTypesAsync(p.nonEmptyString),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],t.Client.prototype,"getConversationBySid",null),Ue([p.validateTypesAsync(p.nonEmptyString),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],t.Client.prototype,"peekConversationBySid",null),Ue([p.validateTypesAsync(p.nonEmptyString),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],t.Client.prototype,"getConversationByUniqueName",null),Ue([p.validateTypesAsync(["undefined",p.objectSchema("conversation options",{friendlyName:["string","undefined"],isPrivate:["boolean","undefined"],uniqueName:["string","undefined"]})]),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Promise)],t.Client.prototype,"createConversation",null),Ue([p.validateTypesAsync(p.literal("fcm","apn"),"string"),ke("design:type",Function),ke("design:paramtypes",[String,String]),ke("design:returntype",Promise)],t.Client.prototype,"setPushRegistrationId",null),Ue([p.validateTypesAsync(p.literal("fcm","apn")),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],t.Client.prototype,"unsetPushRegistrationId",null),Ue([p.validateTypesAsync(p.literal("fcm","apn"),p.nonEmptyString),ke("design:type",Function),ke("design:paramtypes",[String,String]),ke("design:returntype",Promise)],t.Client.prototype,"removePushRegistrations",null),Ue([p.validateTypesAsync(p.pureObject),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",Promise)],t.Client.prototype,"handlePushNotification",null),Ue([p.validateTypesAsync(p.nonEmptyString),ke("design:type",Function),ke("design:paramtypes",[String]),ke("design:returntype",Promise)],t.Client.prototype,"getUser",null),Ue([p.validateTypesAsync(p.nonEmptyArray("strings","string")),ke("design:type",Function),ke("design:paramtypes",[Array]),ke("design:returntype",F.CancellablePromise)],t.Client.prototype,"getTemporaryContentUrlsForMediaSids",null),Ue([p.validateTypesAsync(p.nonEmptyArray("media",Ze)),ke("design:type",Function),ke("design:paramtypes",[Array]),ke("design:returntype",F.CancellablePromise)],t.Client.prototype,"getTemporaryContentUrlsForMedia",null),Ue([D.deprecated("Client.create()","new Client()"),p.validateTypesAsync("string",["undefined",p.pureObject]),ke("design:type",Function),ke("design:paramtypes",[String,Object]),ke("design:returntype",Promise)],t.Client,"create",null),Ue([p.validateTypes(p.pureObject),ke("design:type",Function),ke("design:paramtypes",[Object]),ke("design:returntype",jr)],t.Client,"parsePushNotification",null),t.Client=Ir=Ue([p.validateConstructorTypes(p.nonEmptyString,[p.pureObject,"undefined"]),ke("design:paramtypes",[String,Object])],t.Client),Object.defineProperty(t,"CancellablePromise",{enumerable:!0,get:function(){return F.CancellablePromise}}),t.AggregatedDeliveryReceipt=Pe,t.ChannelMetadata=Ye,t.ContentTemplate=ft,t.ContentTemplateVariable=st,t.Conversation=ir,t.DetailedDeliveryReceipt=tt,t.Media=Ze,t.Message=Qr,t.MessageBuilder=Ur,t.NotificationTypes=ye,t.Participant=se,t.PushNotification=jr,t.RestPaginator=ct,t.UnsentMessage=Ua,t.User=qr})(eE);const vwe=5;class hwe{constructor(){$t(this,"messages");$t(this,"client");$t(this,"conversation");$t(this,"roomId");$t(this,"isChatWindowOpen");$t(this,"hasUnreadMessages");$t(this,"unsubscribe");$t(this,"retryCount");$t(this,"token");$t(this,"setMessages",r=>{this.messages.update(e=>[...e,r])});$t(this,"getMessagesHistory",async()=>{this.conversation&&this.messages.set((await this.conversation.getMessages()).items)});$t(this,"sendMessage",r=>{if(this.conversation)return this.conversation.sendMessage(r.trim())});$t(this,"sendMedia",r=>{const e=new FormData;return e.append("userfile",r),this.conversation&&this.conversation.sendMessage(e)});$t(this,"connect",(r,e)=>{this.client||(this.token=r,this.client=new eE.Client(r),this.roomId=e,this.client.on("stateChanged",this.handleClientInitialized))});$t(this,"handleClientInitialized",r=>{if(r==="initialized")this.client&&this.client.getConversationByUniqueName(this.roomId).then(e=>{this.conversation=e,this.getMessagesHistory(),this.conversation.on("messageAdded",this.handleMessageAdded)});else{if(r==="failed")throw this.retryCount<=vwe&&(this.retryCount++,this.connect(this.token,this.roomId)),this.onUnmount(),new Error("There was a problem connecting to Twilio's conversation service.");r==="disconnected"&&(console.log("disconnected..."),this.onUnmount())}});$t(this,"handleMessageAdded",r=>{this.setMessages(r)});$t(this,"onUnmount",()=>{this.conversation&&this.conversation.off("messageAdded",this.handleMessageAdded),this.client&&this.client.off("stateChanged",this.handleClientInitialized),this.unsubscribe.map(r=>r()),this.client=null,this.messages.set([]),this.conversation=null,this.hasUnreadMessages.set(!1),this.roomId="",this.token="",this.retryCount=0});this.retryCount=0,this.messages=ra([]),this.isChatWindowOpen=!1,this.hasUnreadMessages=ra(!1);const r=Wt.subscribe(n=>{this.isChatWindowOpen=n.chat,this.isChatWindowOpen&&this.hasUnreadMessages.set(!1)}),e=this.messages.subscribe(n=>{n.length&&!this.isChatWindowOpen&&this.hasUnreadMessages.set(!0)});this.unsubscribe=[r,e]}}const Vc=class{};let Zi=Vc;$t(Zi,"instance"),$t(Zi,"getInstance",()=>(Vc.instance||(Vc.instance=new hwe),Vc.instance));const A0=ra({room:null});class P0{static async disconnect(){const{room:r}=Tr(A0);r&&yv(r)}}const gi=(()=>typeof navigator>"u"||typeof navigator.userAgent!="string"?!1:/Mobile/.test(navigator.userAgent))(),mwe=async t=>new Promise(async(r,e)=>{let n=null;t!=null&&t.enableTimeout&&(n=setTimeout(()=>{e(new Error("permission-request-timeout"))},3e4));try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(a=>a.stop()),r(!0)}catch(i){e(i)}finally{n&&clearTimeout(n)}}),Pc=t=>t==null||t.toLocaleLowerCase()==="undefined"||t.toLocaleLowerCase()==="null";async function gwe(t){return t.paused?t.hasAttribute("autoplay")?Promise.race([new Promise(r=>t.onplay=r),new Promise(r=>setTimeout(r,500))]).then(()=>t.paused):t.play().catch(r=>r.name==="NotAllowedError"):Promise.resolve(!1)}const ywe=t=>/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/.test(t);class x0{constructor(r){$t(this,"messageKey");$t(this,"error");this.messageKey=r}static fromError(r,e){const n=new x0(e);return n.error=r,n}}class yi{static getErrorMsgKey(r){var n,i,a,o;const e="something_went_wrong";return r instanceof x0?r.messageKey??((i=(n=r.error.response)==null?void 0:n.data)==null?void 0:i.message)??e:r instanceof Error?((o=(a=r.response)==null?void 0:a.data)==null?void 0:o.message)??r.message??e:e}}var bi=(t=>(t.PageView="page_view",t.CustomEventSDK="custom_event_sdk",t.CustomEventAPI="custom_event_api",t.IncomingPopup="popup",t.Call="call",t.Floater="floater",t.Scheduler="scheduler",t))(bi||{}),D0=(t=>(t.Mobile="mobile",t.Web="web",t))(D0||{}),Aa=(t=>(t.BRAVE="Brave",t.OPERA="Opera",t.EDGE="Edge",t.CHROME="Chrome",t.SAFARI="Safari",t.FIREFOX="Firefox",t.IE="IE",t.Others="Others",t))(Aa||{}),ti=(t=>(t.iOS="iOS",t.Android="Android",t.MacOS="MacOS",t.Windows="Windows",t.Linux="Linux",t.Others="Others",t))(ti||{}),Pa=(t=>(t.iPad="iPad",t.iPhone="iPhone",t.MacBook="Macbook",t.WindowsLaptop="Windows Laptop",t.WindowsTablet="Windows Tablet",t.AndroidMobile="Android Mobile",t.AndroidTablet="Android Tablet",t.Others="Others",t))(Pa||{});class Pu{}$t(Pu,"isPageViewEventEnabled"),$t(Pu,"isCustomEventEnabled",!1);const bwe=()=>{var n,i,a,o,s,u,l,c,f;const t=navigator.userAgent;let r=Aa.Others,e;return navigator.brave?(r=Aa.BRAVE,e=(n=t.match(/Chrome\/(\S+)/))==null?void 0:n[1]):t.includes("Opera")||t.includes("OPR")?(r=Aa.OPERA,e=((i=t.match(/OPR\/(\S+)/))==null?void 0:i[1])??((a=t.match(/Opera\/(\S+)/))==null?void 0:a[1])):t.includes("Edg")?(r=Aa.EDGE,e=(o=t.match(/Edg\/(\S+)/))==null?void 0:o[1]):t.includes("Firefox")?(r=Aa.FIREFOX,e=(s=t.match(/Firefox\/(\S+)/))==null?void 0:s[1]):t.includes("MSIE")||t.includes("Trident")?(r=Aa.IE,e=((u=t.match(/rv:(\S+)/))==null?void 0:u[1])||((l=t.match(/Trident(\S+)/))==null?void 0:l[1])):t.includes("Chrome")?(r=Aa.CHROME,e=(c=t.match(/Chrome\/(\S+)/))==null?void 0:c[1]):t.includes("Safari")&&(r=Aa.SAFARI,e=(f=t.match(/Version\/(\S+).*Safari/))==null?void 0:f[1]),{name:r,version:e??"others"}},XP=()=>{var n,i;const t=navigator.userAgent;let r=ti.Others;/Windows NT/.test(t)?r=ti.Windows:/iPhone/.test(t)?r=ti.iOS:/Mac OS X/.test(t)?r=ti.MacOS:/Android/.test(t)?r=ti.Android:/Linux/.test(t)&&(r=ti.Linux);let e;return r===ti.Windows?/Windows NT 10.0/.test(t)?e="10":/Windows NT 6.3/.test(t)?e="8.1":/Windows NT 6.2/.test(t)?e="8":/Windows NT 6.1/.test(t)?e="7":/Windows NT 6.0/.test(t)?e="Vista":/Windows NT 5.1/.test(t)&&(e="XP"):r===ti.MacOS?/Mac OS X 10_15/.test(t)?e="Catalina":/Mac OS X 10_14/.test(t)?e="Mojave":/Mac OS X 10_13/.test(t)?e="High Sierra":/Mac OS X 10_12/.test(t)?e="Sierra":/Mac OS X 10_11/.test(t)?e="El Capitan":/Mac OS X 10_10/.test(t)&&(e="Yosemite"):r===ti.Android?/Android\s+(\d+(\.\d+)?)/.test(t)&&(e=(n=t.match(/Android\s+(\d+(\.\d+)?)/))==null?void 0:n[1]):r===ti.iOS&&/CPU( iPhone)? OS (\d+(_\d+)*)/.test(t)&&(e=(i=t.match(/CPU( iPhone)? OS (\d+(_\d+)*)/))==null?void 0:i[2].replace(/_/g,".")),{name:r,version:e??"unknown"}},_we=()=>{const t=navigator.userAgent;return/Android/.test(t)?/Mobile/.test(t)?Pa.AndroidMobile:Pa.AndroidTablet:/iPhone/.test(t)?Pa.iPhone:/iPad/.test(t)?Pa.iPad:/Mac/.test(t)?Pa.MacBook:/Windows/.test(t)?/Tablet/.test(t)?Pa.WindowsTablet:Pa.WindowsLaptop:Pa.Others};let hv=window.location.href;function L0(){const t=bwe(),r=XP(),{origin:e,href:n,hostname:i}=window.location;let a=null;try{a=document.referrer&&new URL(document.referrer).hostname!==i?document.referrer:null}catch{}return{url:e===n.replace(/\/$/,"")?e:n,platform:gi?D0.Mobile:D0.Web,os:r.name,osVerison:r.version,browser:t.name,browserVersion:t.version,deviceType:_we(),userAgent:navigator.userAgent,...a&&{referrerUrl:a,referrerDomain:new URL(a).hostname},visitorId:window.visitorId}}function wwe(){j0(),window.addEventListener("popstate",()=>{let t=window.location.href;t!==hv&&(hv=t,j0())}),["pushState","replaceState"].forEach(t=>{const r=window.history[t];window.history[t]=function(...e){r.apply(this,e);const n=e[2]||"";n!==hv&&(hv=n,j0())}})}async function U0(t){await Kr.post("events/sdk",t)}function j0(){U0({eventType:bi.PageView,defaultProperties:L0()})}function kwe(t,r,e){if(!t)throw new Error("eventName is required.");if(!Pu.isCustomEventEnabled)throw new Error("custom-event-disabled");U0({eventType:bi.CustomEventSDK,defaultProperties:L0(),eventName:t,userProperties:r,...e&&{visitorName:e}})}async function go(t,r,e){await U0({eventType:t,defaultProperties:L0(),eventName:r,userProperties:e})}async function Twe(){const{data:t}=await Kr.get("visitors/event");Pu.isPageViewEventEnabled=t.isPageViewEventEnabled,Pu.isCustomEventEnabled=t.isCustomEventEnabled,Pu.isPageViewEventEnabled&&wwe()}const KP={},mv=[],Swe={sdkAssetsPath:`${Zu.service.appUrl}/noisecancellation`,vendor:"krisp"};async function Ewe(t){var i,a;const r=await Pwe(t.identity),e=document.createElement("div");e.id=t.sid,e.classList.add("participant-revly__2023"),e.setAttribute("data-identity",((i=r.name)==null?void 0:i.trim())||"Expert");const n=document.createElement("div");return n.innerHTML=K2(((a=r.name)==null?void 0:a.trim().at(0))||"E",r.profilePic),n.classList.add("avatar-revly__2023"),e.appendChild(n),e}async function ex(t){var i,a,o,s;const{camera:r,mic:e}=Tr(Wt),n=await Ss.connect(t,{name:"Revly",video:r,audio:e,preferredVideoCodecs:"auto",bandwidthProfile:{video:{mode:"collaboration",contentPreferencesMode:"auto"}}});A0.update(u=>({...u,room:n})),n.participants.forEach(tx),Mwe(n.localParticipant,n),n.on("participantConnected",tx),n.on("participantDisconnected",u=>{Rwe(u)}),n.on("disconnected",(u,l)=>{}),window.addEventListener("pagehide",()=>yv(n)),window.addEventListener("beforeunload",()=>yv(n)),(i=document.getElementById("callEndBtn"))==null||i.addEventListener("click",()=>Nwe(n)),(a=document.getElementById("micBtnRevly"))==null||a.addEventListener("click",()=>rx(n)),(o=document.getElementById("cameraBtnRevly"))==null||o.addEventListener("click",()=>Iwe(n)),navigator.mediaDevices.addEventListener("devicechange",()=>Awe(n)),(s=document.getElementById("main-call-revly__2023"))==null||s.addEventListener("click",()=>{mv.forEach(u=>u.play()),mv.splice(0,mv.length)})}function Mwe(t,r){const e=document.getElementById("localParticipantRevly"),n=document.querySelector("#localParticipantRevly > .avatar-revly__2023");if(!e||!n)return;e.setAttribute("data-identity","You"),n.innerHTML=K2("Y"),t.tracks.forEach(a=>{gv(e,a.track)}),qi(e,!0);const{callSettings:i}=Tr(_r);i.audio!==ks.None&&rx(r)}async function tx(t){var e;const r=await Ewe(t);(e=document.getElementById("participantContainerRevly"))==null||e.prepend(r),xwe(),t.tracks.size===0?qi(r,!0):t.tracks.forEach(n=>{n.isSubscribed&&n.track&&gv(r,n.track)}),t.on("trackSubscribed",n=>gv(r,n)),t.on("trackUnsubscribed",Cwe)}async function gv(t,r){if(r.kind!=="data"){if(r.name==="screen"){await xn.toggleScreenShare();const e=document.getElementById("screen-share");if(!e)return;e.appendChild(r.attach())}else{const e=r.attach();e instanceof HTMLVideoElement&&r.kind==="video"?e.disablePictureInPicture=!0:await gwe(e)&&mv.push(e),t.appendChild(e)}r.kind==="audio"&&(r.isEnabled?qi(t,!1,r):qi(t,!0),r.on("disabled",()=>qi(t,!0)),r.on("enabled",()=>qi(t,!1,r)))}}async function Cwe(t){t.detach().forEach(r=>r.remove()),t.name==="screen"&&xn.toggleScreenShare()}function Rwe(t,r){t.removeAllListeners();const e=document.getElementById(t.sid);e&&e.remove()}async function qi(t,r,e){r?(t.classList.add("participant-mute"),jwe(t.id)):(t.classList.remove("participant-mute"),e&&Uwe(e,t.id))}async function Iwe(t){var i;const r=Array.from(t.localParticipant.videoTracks.values())[0],{camera:e}=Tr(Wt),n=document.getElementById("localParticipantRevly");if(e)r.track.disable(),r.track.stop(),r.unpublish(),n&&((i=n.querySelector("video"))==null||i.remove());else if(r)r.track.enable();else{const a=await Ss.createLocalVideoTrack({aspectRatio:1.77});n&&gv(n,a),t.localParticipant.publishTrack(a)}Wt.update(a=>({...a,camera:!e}))}async function rx(t){const r=Array.from(t.localParticipant.audioTracks.values())[0],{mic:e}=Tr(Wt),n=document.getElementById("localParticipantRevly");if(e)r.track.disable(),qi(n,!0),Wt.update(i=>({...i,mic:!1}));else{let i;if(r)r.track.enable(),i=r.track,qi(n,!1,i),Wt.update(a=>({...a,mic:!0}));else try{const a=await Ss.createLocalAudioTrack({noiseCancellationOptions:Swe});t.localParticipant.publishTrack(a),i=a,qi(n,!1,i),Wt.update(o=>({...o,mic:!0}))}catch(a){qi(n,!0);let s=yi.getErrorMsgKey(a)==="Permission denied";s&&go(bi.Call,"displayed-microphone-blocked-popup",{roomId:t.name}),Wt.update(u=>({...u,mic:!1,showMicBlockedDialog:s}))}}}function Owe(t){Array.from(t.localParticipant.videoTracks.values()).forEach(n=>{n.track.stop(),n.unpublish()}),Array.from(t.localParticipant.audioTracks.values()).forEach(n=>{n.track.stop(),n.unpublish()})}async function yv(t){Owe(t),t.disconnect(),A0.update(r=>({...r,room:null})),xn.resetCall(),Zi.getInstance().onUnmount()}async function Nwe(t){const{roomId:r}=Tr(Wt);Wt.update(e=>({...e,roomId:null,token:null})),await Kr.post("calls/call-complete",{visitorId:Ar.cookieId,roomId:r}),await yv(t),Mr.showVisitorEndedCall()}const Awe=t=>{var e;const r=(e=Array.from(t.localParticipant.audioTracks.values())[0])==null?void 0:e.track;(r==null?void 0:r.mediaStreamTrack.readyState)==="ended"&&r.restart({})};async function Pwe(t){const{data:r}=await Kr.get("users/profile/"+t);return xn.addParticipant(t,r),r}function xwe(){new Audio(iL).play()}function Dwe(t){const r=new AudioContext,e=r.createMediaStreamSource(t),n=r.createAnalyser();return n.fftSize=32,e.connect(n),t.addEventListener("cleanup",()=>{r.state!=="closed"&&r.close()}),n}function Lwe(t,r){const e=document.querySelector(`#${t} > .avatar-revly__2023`);e&&(e.style.borderWidth=`${r>.3?(e.clientWidth*.25*r).toString():0}px`)}function Uwe(t,r){const{mediaStreamTrack:e}=t,n=new MediaStream([e]),i=Dwe(n),a=i.frequencyBinCount,o=new Uint8Array(a);function s(){i.getByteFrequencyData(o);const c=u(o)/128;Lwe(r,Math.min(c,1)),KP[r]=requestAnimationFrame(s)}function u(l){let c=0;const f=l.length;for(let d=0;d<f;d++)c+=l[d];return c/f}s()}function jwe(t){cancelAnimationFrame(KP[t]);const r=document.querySelector(`#${t} > .avatar-revly__2023`);r&&(r.style.borderWidth="0px")}var V0=(t=>(t.call="call",t.chat="chat",t))(V0||{}),xu=(t=>(t.Offline="offline",t.Online="online",t))(xu||{});const nx={visible:!1,meetingName:"",mic:!1,camera:!1,chat:!1,screenShare:!1,screenSize:Xt.Small,participants:{},callType:xu.Online,callId:null,leadFormConfig:[],showMicBlockedDialog:!1},Wt=ra(nx);class xn{static async generateToken(r,e,n){const{data:{token:i}}=await Kr.post("/twilio/generate-token",{roomId:r,participantId:e,tokenType:n});return i}static async connectCall(r,e,n){try{Wt.update(s=>({...s,roomId:r}));const i=Ar.cookieId,a=await this.generateToken(r,i,V0.call),{callSettings:o}=Tr(_r);if(a){Wt.update(u=>({...u,visible:!0,screenSize:(o==null?void 0:o.defaultCallView)||Xt.Small,roomId:r,...e&&{callId:e},...n&&{callType:n}})),await ex(a);const s=await this.generateToken(r,i,V0.chat);Zi.getInstance().connect(s,r),this.setToken(a,s,r),Pr.eraseCookie(bf)}Mr.resetState()}catch(i){console.log(yi.getErrorMsgKey(i)),xn.resetCall()}}static async connectCallWithToken(r,e){e=Pc(e)?null:e;const n=e?e.split("#revly#"):[],i=n.at(0),a=n.at(1);try{i&&a?(Wt.update(o=>({...o,visible:!0,roomId:r})),await ex(i),Zi.getInstance().connect(a,r),this.setToken(i,a,r)):r&&await this.connectCall(r),Pr.eraseCookie(ah),Pr.eraseCookie(oh),Mr.resetState()}catch{xn.resetCall()}}static resetCall(){Wt.update(r=>({...r,...nx}))}static toggleCamera(){Wt.update(r=>({...r,camera:!r.camera}))}static toggleChat(){const{screenSize:r,chat:e}=Tr(Wt);Wt.update(n=>({...n,chat:!n.chat,...!e&&r!==Xt.Full&&{screenSize:Xt.Full}}))}static async toggleScreenShare(){Wt.update(r=>({...r,screenShare:!r.screenShare}))}static addParticipant(r,e){Wt.update(n=>({...n,participants:{...n.participants,[r]:e}}))}static showLeadForm(r){Wt.update(e=>({...e,leadFormConfig:r}))}static setToken(r,e,n){Wt.update(i=>({...i,token:r+"#revly#"+e,roomId:n}))}}var Qi=(t=>(t.CallCreated="call-created",t.AddedInQueue="added-in-queue",t.AllAgentsOffline="all-agents-offline",t.AllAgentsEnagage="all-agents-enagage",t.NoLastCall="no-last-call",t.AgentNotAvailable="agent-not-available",t.CallingOfflineAgents="calling-offline-agents",t.RequestedVisitorInput="requested-visitor-input",t.Disqualified="user-disqualified",t))(Qi||{});const ix={visible:!1,campaignId:null,uiConfig:null,agentInfo:null,config:{defaultCloseInSec:15,inactiveCloseInSec:3,lostInternetCloseInSec:3},callSettings:{audio:ks.None,video:!1,visitorDetailsForm:{isEnable:!1,formJson:[]}}},fs=ra(ix);class ax{static updatePopupStateFromPing(r){const e=r.qualifiedCampaigns.find(n=>n.type===_s.PopUp);e&&fs.update(n=>({...n,visitorCampaignId:e.campaignId,uiConfig:e.uiConfig,visible:!!e.agentAvailabilityStatus.availableAgentCount}))}static async showIncommingCall(r,e){fs.update(i=>({...i,visible:!0,uiConfig:e.uiConfig,campaignId:r.campaignId,agentInfo:r.agentProfile,config:r.config,callSettings:e.callSettings}));const n={campaignId:r.campaignId,agentId:r.agentProfile.id};go(bi.IncomingPopup,"popup-shown",n)}static reset(){fs.update(r=>({...r,...ix}))}}class ox{static async sleep(r){return new Promise(e=>setTimeout(e,r))}static debounce(r,e){let n;return(...i)=>{clearTimeout(n),n=setTimeout(()=>{r(...i)},e)}}}const ds=ra({pingRes:{qualifiedCampaigns:[]}});class Vwe{static updatePing(r){ds.update(e=>({...e,pingRes:r}))}}var F0=(t=>(t.unknown="unknwon",t.Yes="yes",t.No="no",t))(F0||{});const sx={visible:!1,meetingName:"",dialogType:He.None,campaignId:null,isHideConnectingScreen:!1,isHideQueueScreen:!1,agentCount:0,queueLength:0,isBlockedInQueue:!1,isQueuingEnabled:!1,callType:xu.Online,callId:null,callSettings:{audio:ks.None,video:!1,visitorDetailsForm:{isEnable:!1,formJson:[]}},lastCampaignId:ui.get(z1),isRetryCall:!1},_r=ra(sx);class Mr{static showAllAgentOffline(){_r.update(r=>({...r,visible:!0,dialogType:He.AllAgentOffline}))}static async initCall(r){const{campaignId:e,hideQueueDialog:n,enableQueuing:i,hideConnectingScreen:a,isIncommingCall:o,callSettings:s,visitorDetails:u,isRetryCall:l,disqualificationText:c=""}=r;if(s.audio===ks.BeforeCall)try{_r.update(p=>({...p,visible:!0,dialogType:He.RequestingMicPermission})),await mwe({enableTimeout:!0})}catch(p){const y=yi.getErrorMsgKey(p);let k=y==="Permission denied";throw _r.update(I=>({...I,visible:!0,dialogType:this.getMicDialogTypeByError(y)})),k&&go(bi.Call,"displayed-microphone-blocked-popup",{campaignId:e,...u}),p}if(_r.update(p=>({...p,visible:!0,dialogType:He.WatingForAgentJoin})),!await Mr.waitForQWidgetCall(e))return _r.update(p=>({...p,visible:!0,dialogType:He.Disqualified,disqualificationText:c})),Qi.Disqualified;const{qualify:d,agentEmail:v}=await this.waitForQfieldApi(e);if(!d)return _r.update(p=>({...p,visible:!0,dialogType:He.Disqualified,disqualificationText:c})),Qi.Disqualified;try{const{data:p}=await Kr.post("visitors/call",{campaignId:e,...i&&{isQueuingEnabled:i},...o&&{isIncommingCall:!0},...u&&{visitorDetails:u},...v&&{agentEmail:v}}),y=p.message===Qi.CallingOfflineAgents?xu.Offline:xu.Online,k=p.message===Qi.AddedInQueue?He.InQueue:He.WatingForAgentJoin;return _r.update(I=>({...I,visible:!(k===He.InQueue&&n||k===He.WatingForAgentJoin&&a),campaignId:e,lastCampaignId:e,dialogType:k,isHideQueueScreen:!!n,isHideConnectingScreen:!!a,queueLength:p.queueNo||0,isQueuingEnabled:!!i,callId:p.callId,callType:y,callSettings:s,...l&&{isRetryCall:!0}})),ui.set(z1,e),p.message}catch(p){const y=yi.getErrorMsgKey(p);throw(y===Qi.AllAgentsOffline||y===Qi.AllAgentsEnagage)&&this.showAllAgentOffline(),new Error(y)}}static async callToLastAgent(){try{const{data:r}=await Kr.post("visitors/call-last-agent");return _r.update(e=>({...e,visible:!0,campaignId:r.campaignId,dialogType:He.WatingForAgentJoin})),r.message}catch(r){throw new Error(yi.getErrorMsgKey(r))}}static async joinQueue(r){try{const e=await Kr.post("visitors/queue",{campaignId:r});_r.update(n=>({...n,visible:!0,queueLength:e.data.queueNo,campaignId:r,dialogType:He.InQueue}))}catch(e){console.log(yi.getErrorMsgKey(e))}}static async leaveQueue(){try{await Kr.delete("visitors/queue"),this.resetState()}catch(r){console.error(yi.getErrorMsgKey(r))}}static async synCallDetailsAndQuelen(r){var l;const{dialogType:e,campaignId:n,isHideQueueScreen:i,isHideConnectingScreen:a,callType:o,callId:s,lastCampaignId:u}=Tr(_r);if((l=r.leadFormConfig)!=null&&l.length&&xn.showLeadForm(r.leadFormConfig),r.shouldRetryCall){const c=+(Pr.getCookie(bf)||0);if(P0.disconnect(),xn.resetCall(),u&&c>=0&&c<1){const f=r.qualifiedCampaigns.find(d=>d.campaignId===u);f&&(Pr.setCookie(bf,(c+1).toString(),60*60*5),await ox.sleep(1e3),Mr.initCall({campaignId:f.campaignId,callSettings:f.callSettings,isRetryCall:!0,visitorDetails:ui.get(ws)||void 0,disqualificationText:f.uiConfig.callDisqualificationText}))}else c>=0&&c>=1?(this.showDialog(He.AllAgentOffline),Pr.eraseCookie(bf)):r.showDialog===He.AgentLeft?this.showAgentLeft():this.showDialog(He.CallCompleted)}else if(r.showDialog){r.showDialog===He.AgentLeft?this.showAgentLeft():this.showDialog(r.showDialog);return}if([He.InQueue,He.WatingForAgentJoin].includes(e)){const c=r.qualifiedCampaigns.find(f=>f.campaignId===n);if(c&&!c.agentAvailabilityStatus.onlineAgentCount&&o===xu.Online){if(He.InQueue===e&&i||He.WatingForAgentJoin===e&&a){Mr.resetState();return}Mr.showAllAgentOffline();return}}if(r.callDetails){const{visible:c}=Tr(Wt);c||xn.connectCall(r.callDetails.roomId,s,o);return}if(r!=null&&r.incommingCallDetails){const{visible:c}=Tr(fs);if(!c){const f=r.incommingCallDetails,d=r.qualifiedCampaigns.find(v=>v.campaignId===f.campaignId);ax.showIncommingCall(f,d)}}r.queueNo&&!r.callDetails&&_r.update(c=>({...c,queueLength:r.queueNo,isBlockedInQueue:r.isBlocked}))}static showDialog(r){r===He.CallCompleted&&P0.disconnect(),_r.update(e=>({...e,...this.getinitValue(),visible:!0,dialogType:r}))}static showAgentLeft(){P0.disconnect(),_r.update(r=>({...r,...this.getinitValue(),visible:!0,dialogType:He.AgentLeft}))}static showVisitorEndedCall(){_r.update(r=>({...r,...this.getinitValue(),visible:!0,dialogType:He.VisitorEndedCall}))}static resetState(){_r.update(r=>({...r,...this.getinitValue()}))}static getinitValue(){const r=structuredClone(sx);return r.lastCampaignId&&delete r.lastCampaignId,r}static getMicDialogTypeByError(r){switch(r){case"Permission denied":return He.MicPermissionBlocked;case"Permission dismissed":return He.MicPermissionDismissed;default:return He.MicPermissionTimeout}}static showVisitorDetails(r,e,n){_r.update(i=>({...i,visible:!0,dialogType:He.VisitorDetails,initCallOptions:r,callSettings:r.callSettings,themeConfig:e,position:n}))}static connectCallWithCallIdAndType(r,e,n){_r.update(i=>({...i,visible:!0,dialogType:n,callId:r,callType:e})),Pr.eraseCookie(rh),Pr.eraseCookie(nh),Pr.eraseCookie(ih)}static async openScheduler(r,e,n,i){_r.update(a=>({...a,visible:!0,dialogType:He.Scheduler,campaignId:r,themeConfig:e,position:n,disqualificationText:i}))}static async waitForQfieldApi(r){const{pingRes:e}=Tr(ds),n=e.qualifiedCampaigns.find(a=>a.campaignId===r);if((n==null?void 0:n.qfieldApiDefault)===void 0)return{qualify:!0,agentEmail:n==null?void 0:n.assignedAgent};let i=5;return new Promise(a=>{let o=setInterval(()=>{const{pingRes:s}=Tr(ds),u=s.qualifiedCampaigns.find(l=>l.campaignId===r);(u==null?void 0:u.qfieldApi)===F0.Yes&&u.assignedAgent&&(a({qualify:!0,agentEmail:u.assignedAgent}),clearInterval(o)),(u==null?void 0:u.qfieldApi)===F0.No&&(a({qualify:!1,agentEmail:void 0}),clearInterval(o)),i--,i==0&&(a({qualify:!!(u!=null&&u.qfieldApiDefault),agentEmail:void 0}),clearInterval(o))},1e3)})}static async waitForQWidgetCall(r){const{pingRes:e}=Tr(ds),n=e.qualifiedCampaigns.find(a=>a.campaignId===r);if(n!=null&&n.qwidgetConfig.qfieldCall)return!0;let i=5;return new Promise(a=>{let o=setInterval(()=>{const{pingRes:s}=Tr(ds),u=s.qualifiedCampaigns.find(l=>l.campaignId===r);u!=null&&u.qwidgetConfig.qfieldCall&&(a(!0),clearInterval(o)),i--,i==0&&(a(!1),clearInterval(o))},1e3)})}static async waitForQWidgetScheduler(r){const{pingRes:e}=Tr(ds),n=e.qualifiedCampaigns.find(a=>a.campaignId===r);if(n!=null&&n.qwidgetConfig.qfieldScheduler)return!0;let i=5;return new Promise(a=>{let o=setInterval(()=>{const{pingRes:s}=Tr(ds),u=s.qualifiedCampaigns.find(l=>l.campaignId===r);u!=null&&u.qwidgetConfig.qfieldScheduler&&(a(!0),clearInterval(o)),i--,i==0&&(a(!1),clearInterval(o))},1e3)})}}class Fwe{constructor(){$t(this,"CookieName","main-call-revly__2023");$t(this,"metadata",{});$t(this,"apiResponse")}init(r,e){Ar.orgId=r,Ar.tabId=t1(),this.setUserId(e)}getUserId(){return Ar.visitorId}setUserId(r){if(r)Ar.visitorId=r;else if(!Ar.visitorId){let e=Pr.getCookie(this.CookieName);e||(e=t1(),Pr.setCookie(this.CookieName,e)),Ar.cookieId=e}}setUserProperty(r,e){this.metadata[r]=e}getUserProperty(r){return this.metadata[r]}async logEvent(r,e){console.log("Logging event: ",r,e)}async pingCall(){const{dialogType:r,isBlockedInQueue:e,callType:n,callId:i}=Tr(_r),{visible:a}=Tr(fs),{visible:o,roomId:s}=Tr(Wt),u={...(r===He.WatingForAgentJoin||e)&&{...n&&i&&{callType:n},...i&&{callId:i}},...o&&s&&{roomId:s},...r===He.InQueue&&{queueNo:!0},...a&&{isIncommingPopupOpen:!0}};try{const{data:l}=await Kr.get("visitors/ping",{params:u});return Vwe.updatePing(l),xc.syncButtonStates(l),nL.updateButtonStateFromPing(l),Mr.synCallDetailsAndQuelen(l),l}catch(l){const c=yi.getErrorMsgKey(l);throw[Qi.AllAgentsOffline,Qi.AgentNotAvailable].includes(c)&&Mr.showAllAgentOffline(),l}}}class bv{static getInstance(){return this.instance||(this.instance=new Fwe),this.instance}}$t(bv,"instance");class $0{constructor(){$t(this,"element");$t(this,"id");$t(this,"agentProperty",null)}applyState(r,e,n){const i=`agent-available-${this.id}`,a=`agent-unavailable-${this.id}`,o=`agent-busy-${this.id}`;this.element.classList.remove(i,a,o);let s;switch(r){case jn.Available:s=i;break;case jn.Busy:s=o;break;default:s=a}this.element.classList.add(s)}static new(r){const e=new $0;return e.element=r,e.id=e.element.getAttribute("data-campaign-id"),e.element.getAttribute("data-agent-property")&&(e.agentProperty=JSON.parse(e.element.getAttribute("data-agent-property"))),e}}class xc{static syncButtonsListWithUI(r){const e=document.querySelectorAll(".revly-btn"),n=[];e.forEach(i=>{if(i instanceof HTMLButtonElement){const a=$0.new(i);n.push(a)}}),this.list=n,(r!=null&&r.added||e.length)&&bv.getInstance().pingCall()}static async syncButtonStates(r){const e=r.qualifiedCampaigns;for(let n of this.list){const i=e.find(u=>u.campaignId===n.id);if(!i)continue;const{agentAvailabilityStatus:{availableAgentCount:a,onlineAgentCount:o}}=i,s=a?jn.Available:o>0&&a===0?jn.Busy:jn.NotAvailable;n.applyState(s,i.uiConfig,i.agentAvailabilityStatus)}}static getCustomButtonList(){return this.list.map(r=>({id:r.id,agentProperty:r.agentProperty}))}}$t(xc,"list",[]);class $we{static init(){const r=new MutationObserver(n=>{for(const i of n)if(i.type==="childList"){for(const a of Array.from(i.removedNodes))if(a instanceof Element&&a.querySelectorAll(".revly-btn").length){xc.syncButtonsListWithUI();break}for(const a of Array.from(i.addedNodes))if(a instanceof Element&&a.querySelectorAll(".revly-btn").length){xc.syncButtonsListWithUI({added:!0});break}}});xc.syncButtonsListWithUI();const e=document.querySelector("body");r.observe(e,{childList:!0,subtree:!0})}}class z0{static getContainer(){if(!this.container){const r=document.createElement("div");r.id=this.containerId,r.style.position="absolute",r.style.zIndex="9999999999999999",document.body.appendChild(r),this.container=r}return this.container}}$t(z0,"containerId","main-call-revly__2023"),$t(z0,"container");function zwe(t){return--t*t*((1.70158+1)*t+1.70158)+1}function ux(t){const r=t-1;return r*r*r+1}function lx(t,{delay:r=0,duration:e=400,easing:n=qu}={}){const i=+getComputedStyle(t).opacity;return{delay:r,duration:e,easing:n,css:a=>`opacity: ${a*i}`}}function xa(t,{delay:r=0,duration:e=400,easing:n=ux,x:i=0,y:a=0,opacity:o=0}={}){const s=getComputedStyle(t),u=+s.opacity,l=s.transform==="none"?"":s.transform,c=u*(1-o);return{delay:r,duration:e,easing:n,css:(f,d)=>`
			transform: ${l} translate(${(1-f)*i}px, ${(1-f)*a}px);
			opacity: ${u-c*d}`}}function Wwe(t,{delay:r=0,duration:e=400,easing:n=ux,start:i=0,opacity:a=0}={}){const o=getComputedStyle(t),s=+o.opacity,u=o.transform==="none"?"":o.transform,l=1-i,c=s*(1-a);return{delay:r,duration:e,easing:n,css:(f,d)=>`
			transform: ${u} scale(${1-l*d});
			opacity: ${s-c*d}
		`}}var ps=(t=>(t.FloaterDismiss="floater-dismiss",t.FloaterMinimized="floater-minimized",t.FloaterMaximized="floater-maximized",t.ClickedCallBtn="clicked-call-button",t.ClickedSchedulerBtn="clicked-schedule-button",t))(ps||{}),_v=(t=>(t.PopupShown="popup-shown",t.PopupClosed="popup-closed",t.FilledCallForm="filled-call-form",t.CallRequested="call-requested",t.CallJoined="call-joined",t.CallLeft="call-left",t.FloaterDismiss="floater-dismiss",t.FloaterMinimized="floater-minimized",t.FloaterMaximized="floater-maximized",t.ClickedCallBtn="clicked-call-button",t.ClickedSchedulerBtn="clicked-schedule-button",t.FilledSchedulerForm="filled-scheduler-form",t.ScheduledMeeting="scheduled-meeting",t))(_v||{});let Dc={qualifiedCampaigns:[]},W0=!0;window.addEventListener("blur",()=>W0=!1),window.addEventListener("focus",()=>W0=!0);async function Bwe(){for(;;)try{Dc=await bv.getInstance().pingCall()}catch(t){console.log(t)}finally{await ox.sleep(W0?1e3:2e3)}}function cx(){const t=window.navigator.userAgent.toLocaleLowerCase(),r=["instagram","facebook"],e=XP();return!r.some(i=>t.includes(i)&&e.name!==ti.iOS)}function fx(){return cx()?!1:(window.location.href=`${Zu.service.baseUrl}?redirectUrl=${window.location.href}`,!0)}async function dx(t,r=!1,e=!1,n=!1){var i;try{if(fx())return;const a=Dc.qualifiedCampaigns.find(c=>c.campaignId===t);if(!a)throw new Error("invalid campaign id");const o=a.callSettings,s={campaignId:t,enableQueuing:r,hideQueueDialog:e,hideConnectingScreen:n,callSettings:o,disqualificationText:((i=a.uiConfig)==null?void 0:i.callDisqualificationText)||""},u=(a==null?void 0:a.type)===_s.FloatingButton?a.uiConfig.templateConfig.themeConfig:a.uiConfig.themeConfig,l=a.uiConfig.position;return o.visitorDetailsForm.isEnable?(Mr.showVisitorDetails(s,u,l),Qi.RequestedVisitorInput):Mr.initCall(s)}catch(a){throw a}}function Zwe(t){const r=Dc.qualifiedCampaigns.find(e=>e.campaignId===t);if(!r)throw new Error("invalid-campaign-id");return{...r.agentAvailabilityStatus,isQualified:r.isQualified,availableAgentsProfile:r.availableAgentsProfile}}function qwe(t){const r=Dc.qualifiedCampaigns.find(e=>e.campaignId===t);return{call:!!(r!=null&&r.isQualified)&&!!(r!=null&&r.qwidgetConfig.qfieldCall),scheduler:!!(r!=null&&r.isQualified)&&!!(r!=null&&r.qwidgetConfig.qfieldScheduler)}}function Qwe(){const{queueLength:t,dialogType:r}=Tr(_r),{visible:e}=Tr(Wt);if(e)throw new Error("already-in-call");if(r!==He.InQueue)throw new Error("visitor-not-in-queue");return t}function Ywe(){const{dialogType:t}=Tr(_r);if(t!==He.InQueue)throw new Error("visitor-not-in-queue");Mr.leaveQueue()}async function Gwe(){const{data:t}=await Kr.get("visitors/last-call");return t||null}async function Hwe(){try{return await Mr.callToLastAgent()}catch(t){throw t}}function wv(t){const r=Zu.service.baseUrl.includes("revly")?"https://revly.io":"https://stage.revly.io",e=new URL(r);return t!=null&&t.campaignId&&e.searchParams.append("id",t.campaignId),e.searchParams.append("source","floater"),e.toString()+`&referrer_url=${window.location.href}`}async function Jwe(){let t=Pr.getCookie(oh),r=Pr.getCookie(ah),e=Pr.getCookie(rh),n=Pr.getCookie(nh),i=Pr.getCookie(ih);r=Pc(r)?null:r,e=Pc(e)?null:e,n=Pc(n)?null:n,i=Pc(i)?null:i,r?xn.connectCallWithToken(r,t):e&&i&&n&&Mr.connectCallWithCallIdAndType(e,n,i)}function px(t){const r=Dc.qualifiedCampaigns.find(n=>n.campaignId===t);if(!r)throw new Error("invalid-campaign-id");const e=r.type===_s.FloatingButton?r.uiConfig.templateConfig.themeConfig:r.uiConfig.themeConfig;Mr.openScheduler(t,e,r.uiConfig.position,r.uiConfig.schedulerDisqualificationText)}const B0="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQwIiBoZWlnaHQ9IjE0MCIgdmlld0JveD0iMCAwIDE0MCAxNDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNDAiIGhlaWdodD0iMTQwIiBmaWxsPSIjRTZFQ0ZGIi8+CjxwYXRoIGQ9Ik0xMjYuNjc2IDEwMS42NDFDMTIwLjEzIDkyLjg3NzMgMTExLjYzIDg1Ljc2MSAxMDEuODUxIDgwLjg1NzlDOTIuMDcyOCA3NS45NTQ3IDgxLjI4NTUgNzMuMzk5OSA3MC4zNDY3IDczLjM5NjVDNTkuNDA3OCA3My4zOTMxIDQ4LjYxOSA3NS45NDExIDM4LjgzNzUgODAuODM4MUMyOS4wNTYgODUuNzM1MSAyMC41NTE2IDkyLjg0NjEgMTQgMTAxLjYwNkMyMC41MTgzIDExMC40MSAyOS4wMDg4IDExNy41NjUgMzguNzkwOSAxMjIuNDk2QzQ4LjU3MjkgMTI3LjQyNyA1OS4zNzQzIDEyOS45OTcgNzAuMzI4OSAxMzBDODEuMjgzNSAxMzAuMDA0IDkyLjA4NjUgMTI3LjQ0IDEwMS44NzIgMTIyLjUxNUMxMTEuNjU3IDExNy41OTEgMTIwLjE1MiAxMTAuNDQyIDEyNi42NzYgMTAxLjY0MVoiIGZpbGw9IiM0Mjk0RkYiLz4KPHBhdGggZD0iTTcwLjM1MDUgNjQuMzM5NkM4NS4zNTU5IDY0LjMzOTYgOTcuNTIwMiA1Mi4xNzUzIDk3LjUyMDIgMzcuMTY5OEM5Ny41MjAyIDIyLjE2NDMgODUuMzU1OSAxMCA3MC4zNTA1IDEwQzU1LjM0NSAxMCA0My4xODA3IDIyLjE2NDMgNDMuMTgwNyAzNy4xNjk4QzQzLjE4MDcgNTIuMTc1MyA1NS4zNDUgNjQuMzM5NiA3MC4zNTA1IDY0LjMzOTZaIiBmaWxsPSIjNDI5NEZGIi8+Cjwvc3ZnPgo=",Z0="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQuMTY2NzUgMTBIMTUuODMzNCIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+Cg==";function Xwe(t){let r,e,n,i,a,o;return{c(){r=qe("svg"),e=qe("path"),n=qe("path"),i=qe("path"),a=qe("path"),o=qe("path"),h(e,"d","M12.4601 5.10425H5.28441C4.74433 5.10425 4.3839 5.66121 4.60514 6.15389L4.91165 6.83646C5.03177 7.10395 5.2977 7.27604 5.59092 7.27604H12.1613C12.4571 7.27604 12.7249 7.10095 12.8435 6.82997L13.1422 6.14741C13.3575 5.65544 12.9971 5.10425 12.4601 5.10425Z"),h(e,"fill","#625FFB"),h(n,"d","M11.1263 8.08133H6.64815C6.10848 8.08133 5.74805 8.63751 5.96849 9.1301L6.27395 9.81267C6.39387 10.0806 6.66004 10.2531 6.95361 10.2531H10.8264C11.1218 10.2531 11.3893 10.0785 11.5081 9.80798L11.808 9.12542C12.0241 8.63335 11.6637 8.08133 11.1263 8.08133Z"),h(n,"fill","#9290FD"),h(i,"d","M9.81552 11.0586H7.94839C7.40909 11.0586 7.04866 11.6141 7.26838 12.1066L7.65595 12.9753C7.77568 13.2437 8.04207 13.4165 8.33596 13.4165H9.435C9.73072 13.4165 9.99841 13.2415 10.1171 12.9707L10.4976 12.102C10.7131 11.61 10.3526 11.0586 9.81552 11.0586Z"),h(i,"fill","#BFBEFC"),h(a,"d","M21.4284 7.66449C21.2672 7.57378 21.1059 7.50323 20.9447 7.45284C20.7834 7.39237 20.6272 7.36213 20.476 7.36213C20.2744 7.36213 20.0829 7.41757 19.9015 7.52843C19.7201 7.63929 19.5538 7.79047 19.4026 7.98197C19.2515 8.17346 19.1154 8.39519 18.9945 8.64715C18.8836 8.89912 18.7979 9.16116 18.7374 9.43328V13.5H17.6792V6.54577H18.5107L18.6316 8.07267H18.6921C18.7626 7.84087 18.8534 7.61914 18.9642 7.40749C19.0852 7.19584 19.2263 7.00938 19.3875 6.84812C19.5589 6.68687 19.7503 6.56088 19.962 6.47018C20.1736 6.36939 20.4155 6.319 20.6877 6.319C20.8792 6.319 21.0807 6.35427 21.2924 6.42482C21.504 6.48529 21.6552 6.56592 21.7459 6.66671L21.4284 7.66449ZM26.0493 6.319C26.9362 6.319 27.6216 6.54577 28.1054 6.9993C28.5891 7.44276 28.831 8.07267 28.831 8.88904C28.831 9.06038 28.8209 9.23675 28.8008 9.41817C28.7806 9.5895 28.7453 9.71549 28.6949 9.79611H23.6002V9.94729C23.6002 10.3303 23.6506 10.6981 23.7514 11.0509C23.8522 11.4037 24.0034 11.7161 24.2049 11.9882C24.4065 12.2603 24.6585 12.477 24.9608 12.6383C25.2733 12.7995 25.6411 12.8802 26.0644 12.8802C26.3063 12.8802 26.5432 12.855 26.775 12.8046C27.0068 12.7441 27.2285 12.6736 27.4402 12.5929C27.6518 12.5022 27.8483 12.4065 28.0298 12.3057C28.2112 12.2049 28.3724 12.1041 28.5135 12.0033L28.6949 12.865C28.5639 12.9457 28.4027 13.0364 28.2112 13.1372C28.0197 13.2279 27.808 13.3135 27.5762 13.3942C27.3444 13.4748 27.0874 13.5403 26.8052 13.5907C26.5331 13.6512 26.2458 13.6814 25.9435 13.6814C25.3791 13.6814 24.8802 13.5857 24.4468 13.3942C24.0134 13.1926 23.6506 12.9255 23.3583 12.5929C23.0661 12.2503 22.8443 11.8572 22.6931 11.4137C22.542 10.9703 22.4664 10.5067 22.4664 10.0229C22.4664 9.52903 22.542 9.06038 22.6931 8.61692C22.8544 8.16338 23.0862 7.76528 23.3886 7.4226C23.6909 7.07993 24.0638 6.81285 24.5073 6.62136C24.9608 6.41978 25.4748 6.319 26.0493 6.319ZM26.004 7.1656C25.3388 7.1656 24.8197 7.34198 24.4468 7.69473C24.084 8.0374 23.8371 8.47078 23.706 8.99487H27.8332C27.8433 8.94447 27.8483 8.89912 27.8483 8.8588C27.8483 8.81849 27.8483 8.77314 27.8483 8.72274C27.8483 8.47078 27.798 8.24905 27.6972 8.05756C27.5964 7.85598 27.4603 7.68969 27.289 7.55867C27.1176 7.42764 26.9211 7.3319 26.6994 7.27143C26.4777 7.20087 26.2458 7.1656 26.004 7.1656ZM34.1767 13.5H32.8312L29.6716 6.54577H30.8205L33.5267 12.5022L36.2328 6.54577H37.3364L34.1767 13.5ZM39.7777 13.5H38.7194V2.31275H39.7777V13.5ZM45.5267 13.5605C45.3755 13.883 45.1941 14.2609 44.9825 14.6943C44.7708 15.1378 44.5189 15.556 44.2266 15.9491C43.9343 16.3422 43.5916 16.6748 43.1986 16.9469C42.8055 17.2291 42.362 17.3702 41.8682 17.3702C41.7876 17.3702 41.7271 17.3651 41.6868 17.3551C41.6465 17.3551 41.6011 17.345 41.5507 17.3248L41.3542 16.327C41.3844 16.3371 41.4197 16.3472 41.46 16.3573C41.5003 16.3674 41.5709 16.3724 41.6717 16.3724C41.8732 16.3724 42.0597 16.3522 42.231 16.3119C42.4124 16.2716 42.5888 16.191 42.7601 16.07C43.1129 15.8181 43.4304 15.4502 43.7126 14.9664C44.0049 14.4827 44.2669 13.9183 44.4987 13.2732L41.0216 6.54577H42.2764L45.0429 12.3359L47.5223 6.54577H48.7166L45.5267 13.5605ZM49.3298 12.9709C49.3298 12.7794 49.3953 12.6131 49.5264 12.472C49.6574 12.3208 49.8237 12.2452 50.0252 12.2452C50.2167 12.2452 50.383 12.3208 50.5241 12.472C50.6753 12.6131 50.7509 12.7794 50.7509 12.9709C50.7509 13.1624 50.6753 13.3287 50.5241 13.4698C50.383 13.6008 50.2167 13.6663 50.0252 13.6663C49.8237 13.6663 49.6574 13.6008 49.5264 13.4698C49.3953 13.3287 49.3298 13.1624 49.3298 12.9709ZM54.0519 13.5H52.9937V6.54577H54.0519V13.5ZM52.7669 4.00596C52.7669 3.80439 52.8374 3.62297 52.9785 3.46171C53.1297 3.30046 53.3111 3.21983 53.5228 3.21983C53.7244 3.21983 53.9058 3.30046 54.067 3.46171C54.2283 3.62297 54.3089 3.80439 54.3089 4.00596C54.3089 4.21761 54.2283 4.39902 54.067 4.5502C53.9058 4.6913 53.7244 4.76185 53.5228 4.76185C53.3111 4.76185 53.1297 4.6913 52.9785 4.5502C52.8374 4.39902 52.7669 4.21761 52.7669 4.00596ZM59.4579 6.319C60.0727 6.319 60.6018 6.42482 61.0452 6.63647C61.4887 6.83805 61.8515 7.11521 62.1337 7.46796C62.426 7.81063 62.6377 8.20874 62.7687 8.66227C62.9098 9.10573 62.9803 9.57439 62.9803 10.0682C62.9803 10.5621 62.9098 11.0307 62.7687 11.4742C62.6377 11.9076 62.4311 12.2906 62.1489 12.6232C61.8667 12.9457 61.5038 13.2027 61.0604 13.3942C60.627 13.5857 60.113 13.6814 59.5183 13.6814C58.9035 13.6814 58.3694 13.5806 57.9158 13.3791C57.4724 13.1775 57.1045 12.9104 56.8122 12.5778C56.52 12.2351 56.3033 11.8421 56.1622 11.3986C56.0211 10.9552 55.9505 10.4865 55.9505 9.99265C55.9505 9.4988 56.0211 9.03014 56.1622 8.58668C56.3033 8.14322 56.5149 7.7552 56.7971 7.4226C57.0894 7.07993 57.4573 6.81285 57.9007 6.62136C58.3442 6.41978 58.8632 6.319 59.4579 6.319ZM59.5032 12.8802C59.9064 12.8802 60.2541 12.8046 60.5464 12.6534C60.8487 12.5022 61.0956 12.3006 61.2871 12.0487C61.4887 11.7866 61.6348 11.4893 61.7256 11.1567C61.8163 10.8141 61.8616 10.4563 61.8616 10.0834C61.8616 9.70037 61.8112 9.3325 61.7104 8.97975C61.6197 8.627 61.4736 8.3196 61.272 8.05756C61.0704 7.78543 60.8134 7.56874 60.501 7.40749C60.1986 7.24623 59.8358 7.1656 59.4125 7.1656C58.9993 7.1656 58.6465 7.24119 58.3543 7.39237C58.062 7.54355 57.8201 7.74512 57.6286 7.99708C57.4371 8.24905 57.296 8.54637 57.2053 8.88904C57.1146 9.22163 57.0692 9.57439 57.0692 9.94729C57.0692 10.3303 57.1146 10.6981 57.2053 11.0509C57.3061 11.4037 57.4522 11.7161 57.6437 11.9882C57.8453 12.2603 58.0973 12.477 58.3996 12.6383C58.712 12.7995 59.0799 12.8802 59.5032 12.8802Z"),h(a,"fill","#2C2E39"),h(o,"d","M28.4056 9.3793H23.1143C23.1143 6.9666 25.1453 6.36342 26.1608 6.36342C27.7001 6.21263 28.2987 8.31117 28.4056 9.3793Z"),h(o,"fill","#2C2E39"),h(r,"width",t[1]),h(r,"height",t[2]),h(r,"viewBox","0 0 68 18"),h(r,"fill","none"),h(r,"xmlns","http://www.w3.org/2000/svg")},m(s,u){Ce(s,r,u),U(r,e),U(r,n),U(r,i),U(r,a),U(r,o)},p(s,u){u&2&&h(r,"width",s[1]),u&4&&h(r,"height",s[2])},d(s){s&&Me(r)}}}function Kwe(t){let r,e,n,i,a,o;return{c(){r=qe("svg"),e=qe("path"),n=qe("path"),i=qe("path"),a=qe("path"),o=qe("path"),h(e,"d","M15.9512 7.18652H3.85198C2.94132 7.18652 2.33358 8.12564 2.70664 8.95638L3.22346 10.1073C3.426 10.5583 3.87438 10.8485 4.3688 10.8485H15.4475C15.9463 10.8485 16.3977 10.5533 16.5977 10.0963L17.1014 8.94544C17.4644 8.11591 16.8567 7.18652 15.9512 7.18652Z"),h(e,"fill","#625FFB"),h(n,"d","M13.7018 12.209H6.15102C5.24106 12.209 4.63331 13.1468 5.00501 13.9774L5.52006 15.1283C5.72226 15.5801 6.17106 15.8709 6.66607 15.8709H13.1962C13.6943 15.8709 14.1453 15.5764 14.3457 15.1204L14.8513 13.9695C15.2157 13.1398 14.608 12.209 13.7018 12.209Z"),h(n,"fill","#9290FD"),h(i,"d","M11.4941 17.2305H8.34583C7.43649 17.2305 6.82875 18.1671 7.19923 18.9975L7.85272 20.4623C8.05461 20.9148 8.50379 21.2063 8.99932 21.2063H10.8525C11.3511 21.2063 11.8025 20.9112 12.0025 20.4545L12.6441 18.9897C13.0075 18.1602 12.3997 17.2305 11.4941 17.2305Z"),h(i,"fill","#BFBEFC"),h(a,"d","M32.3101 11.1605C32.0382 11.0075 31.7663 10.8886 31.4944 10.8036C31.2224 10.7016 30.959 10.6507 30.7041 10.6507C30.3643 10.6507 30.0414 10.7441 29.7355 10.9311C29.4296 11.118 29.1492 11.3729 28.8943 11.6958C28.6394 12.0187 28.4099 12.3925 28.206 12.8174C28.0191 13.2422 27.8746 13.6841 27.7727 14.1429V21H25.9883V9.27414H27.3903L27.5942 11.8487H27.6962C27.8152 11.4579 27.9681 11.084 28.155 10.7271C28.359 10.3703 28.5969 10.0559 28.8688 9.78396C29.1577 9.51206 29.4806 9.29963 29.8374 9.14669C30.1943 8.97675 30.6022 8.89178 31.061 8.89178C31.3839 8.89178 31.7238 8.95126 32.0806 9.07022C32.4375 9.17218 32.6924 9.30813 32.8454 9.47807L32.3101 11.1605ZM40.1015 8.89178C41.597 8.89178 42.7526 9.27414 43.5683 10.0389C44.384 10.7866 44.7919 11.8487 44.7919 13.2252C44.7919 13.5141 44.7749 13.8115 44.7409 14.1174C44.7069 14.4063 44.6474 14.6188 44.5625 14.7547H35.972V15.0096C35.972 15.6554 36.057 16.2757 36.2269 16.8705C36.3969 17.4652 36.6518 17.9921 36.9916 18.4509C37.3315 18.9097 37.7564 19.2751 38.2662 19.547C38.793 19.8189 39.4133 19.9549 40.127 19.9549C40.5349 19.9549 40.9342 19.9124 41.3251 19.8274C41.716 19.7255 42.0898 19.6065 42.4467 19.4705C42.8036 19.3176 43.135 19.1562 43.4409 18.9862C43.7468 18.8163 44.0187 18.6463 44.2566 18.4764L44.5625 19.9294C44.3415 20.0653 44.0696 20.2183 43.7468 20.3882C43.4239 20.5412 43.067 20.6856 42.6761 20.8216C42.2853 20.9575 41.8519 21.068 41.3761 21.1529C40.9173 21.2549 40.4329 21.3059 39.9231 21.3059C38.9714 21.3059 38.1302 21.1444 37.3995 20.8216C36.6688 20.4817 36.057 20.0313 35.5641 19.4705C35.0713 18.8927 34.6975 18.23 34.4425 17.4822C34.1876 16.7345 34.0602 15.9528 34.0602 15.1371C34.0602 14.3044 34.1876 13.5141 34.4425 12.7664C34.7144 12.0017 35.1053 11.3304 35.6151 10.7526C36.1249 10.1748 36.7537 9.72449 37.5015 9.4016C38.2662 9.06172 39.1329 8.89178 40.1015 8.89178ZM40.0251 10.3193C38.9035 10.3193 38.0283 10.6167 37.3995 11.2115C36.7877 11.7893 36.3714 12.52 36.1504 13.4037H43.1095C43.1265 13.3187 43.135 13.2422 43.135 13.1743C43.135 13.1063 43.135 13.0298 43.135 12.9448C43.135 12.52 43.05 12.1461 42.8801 11.8232C42.7101 11.4834 42.4807 11.203 42.1918 10.982C41.9029 10.7611 41.5715 10.5997 41.1977 10.4977C40.8238 10.3788 40.4329 10.3193 40.0251 10.3193ZM53.8055 21H51.5368L46.2092 9.27414H48.1465L52.7094 19.3176L57.2723 9.27414H59.1332L53.8055 21ZM63.2496 21H61.4652V2.13667H63.2496V21ZM72.9433 21.102C72.6884 21.6458 72.3825 22.283 72.0256 23.0138C71.6687 23.7615 71.2439 24.4668 70.7511 25.1295C70.2582 25.7923 69.6805 26.3531 69.0177 26.8119C68.3549 27.2878 67.6072 27.5257 66.7745 27.5257C66.6385 27.5257 66.5366 27.5172 66.4686 27.5002C66.4006 27.5002 66.3241 27.4832 66.2392 27.4492L65.9078 25.7668C65.9588 25.7838 66.0182 25.8008 66.0862 25.8178C66.1542 25.8348 66.2732 25.8433 66.4431 25.8433C66.783 25.8433 67.0974 25.8093 67.3863 25.7413C67.6922 25.6733 67.9895 25.5374 68.2784 25.3335C68.8732 24.9086 69.4085 24.2883 69.8844 23.4726C70.3772 22.6569 70.819 21.7053 71.2099 20.6176L65.347 9.27414H67.4627L72.1276 19.0372L76.3081 9.27414H78.3219L72.9433 21.102ZM79.3559 20.1078C79.3559 19.7849 79.4663 19.5045 79.6873 19.2666C79.9082 19.0117 80.1886 18.8842 80.5285 18.8842C80.8513 18.8842 81.1317 19.0117 81.3697 19.2666C81.6246 19.5045 81.752 19.7849 81.752 20.1078C81.752 20.4307 81.6246 20.7111 81.3697 20.949C81.1317 21.1699 80.8513 21.2804 80.5285 21.2804C80.1886 21.2804 79.9082 21.1699 79.6873 20.949C79.4663 20.7111 79.3559 20.4307 79.3559 20.1078ZM87.318 21H85.5337V9.27414H87.318V21ZM85.1513 4.99166C85.1513 4.65178 85.2702 4.34589 85.5082 4.07398C85.7631 3.80208 86.069 3.66613 86.4258 3.66613C86.7657 3.66613 87.0716 3.80208 87.3435 4.07398C87.6154 4.34589 87.7514 4.65178 87.7514 4.99166C87.7514 5.34853 87.6154 5.65442 87.3435 5.90933C87.0716 6.14725 86.7657 6.26621 86.4258 6.26621C86.069 6.26621 85.7631 6.14725 85.5082 5.90933C85.2702 5.65442 85.1513 5.34853 85.1513 4.99166ZM96.4332 8.89178C97.4699 8.89178 98.3621 9.07022 99.1098 9.42709C99.8575 9.76697 100.469 10.2343 100.945 10.8291C101.438 11.4069 101.795 12.0782 102.016 12.8429C102.254 13.5906 102.373 14.3808 102.373 15.2135C102.373 16.0463 102.254 16.8365 102.016 17.5842C101.795 18.3149 101.446 18.9607 100.971 19.5215C100.495 20.0653 99.883 20.4987 99.1353 20.8216C98.4045 21.1444 97.5379 21.3059 96.5352 21.3059C95.4986 21.3059 94.5979 21.136 93.8332 20.7961C93.0854 20.4562 92.4651 20.0059 91.9723 19.445C91.4795 18.8673 91.1141 18.2045 90.8762 17.4568C90.6383 16.709 90.5193 15.9188 90.5193 15.0861C90.5193 14.2534 90.6383 13.4632 90.8762 12.7154C91.1141 11.9677 91.471 11.3134 91.9468 10.7526C92.4397 10.1748 93.0599 9.72449 93.8077 9.4016C94.5554 9.06172 95.4306 8.89178 96.4332 8.89178ZM96.5097 19.9549C97.1895 19.9549 97.7758 19.8274 98.2686 19.5725C98.7784 19.3176 99.1948 18.9777 99.5177 18.5529C99.8575 18.111 100.104 17.6097 100.257 17.0489C100.41 16.4711 100.486 15.8678 100.486 15.239C100.486 14.5933 100.401 13.973 100.231 13.3782C100.078 12.7834 99.832 12.2651 99.4922 11.8232C99.1523 11.3644 98.7189 10.999 98.1921 10.7271C97.6823 10.4552 97.0705 10.3193 96.3568 10.3193C95.66 10.3193 95.0652 10.4467 94.5724 10.7016C94.0796 10.9565 93.6717 11.2964 93.3488 11.7213C93.026 12.1461 92.788 12.6475 92.6351 13.2252C92.4821 13.786 92.4057 14.3808 92.4057 15.0096C92.4057 15.6554 92.4821 16.2757 92.6351 16.8705C92.805 17.4652 93.0514 17.9921 93.3743 18.4509C93.7142 18.9097 94.1391 19.2751 94.6489 19.547C95.1757 19.8189 95.796 19.9549 96.5097 19.9549Z"),h(a,"fill",t[0]),h(o,"d","M44.0742 14.9761H35.1523C35.1523 10.908 38.5769 9.89093 40.2892 9.89093C42.8846 9.63667 43.8939 13.1751 44.0742 14.9761Z"),h(o,"fill",t[0]),h(r,"width",t[1]),h(r,"height",t[2]),h(r,"viewBox","0 0 104 28"),h(r,"fill","none"),h(r,"xmlns","http://www.w3.org/2000/svg")},m(s,u){Ce(s,r,u),U(r,e),U(r,n),U(r,i),U(r,a),U(r,o)},p(s,u){u&1&&h(a,"fill",s[0]),u&1&&h(o,"fill",s[0]),u&2&&h(r,"width",s[1]),u&4&&h(r,"height",s[2])},d(s){s&&Me(r)}}}function eke(t){let r;function e(a,o){return a[0]==="white"?Kwe:Xwe}let n=e(t),i=n(t);return{c(){i.c(),r=Fn()},m(a,o){i.m(a,o),Ce(a,r,o)},p(a,[o]){n===(n=e(a))&&i?i.p(a,o):(i.d(1),i=n(a),i&&(i.c(),i.m(r.parentNode,r)))},i:Ge,o:Ge,d(a){i.d(a),a&&Me(r)}}}function tke(t,r,e){let{color:n="white"}=r,{width:i="104"}=r,{height:a="28"}=r;return t.$$set=o=>{"color"in o&&e(0,n=o.color),"width"in o&&e(1,i=o.width),"height"in o&&e(2,a=o.height)},[n,i,a]}class Lc extends It{constructor(r){super(),Rt(this,r,tke,eke,Et,{color:0,width:1,height:2})}}const Cr={all_agent_offline:`Sorry, our agents are unavailable.
Please check back again in some time`,queue_head:"You are in the live call queue",queue_desc:"Your waiting number is",leaveBtn:"Leave",waiting_for_agent:"Connecting you with an agent",waiting_for_agent_retry:`Couldn't connect you to the last Agent.
Connecting you to another agent`,agent_left:`The agent has ended the call.
This window will close automatically`,call_ended:`The Call has been ended.
This window will close automatically`,call_completed:`The Call has been ended.
This window will close automatically`,requesting_mic_permission:"Please allow microphone (audio) permission to connect with an agent.",mic_permission_blocked:"Your microphone (audio) permission is blocked. Please grant microphone permission in your browser's site settings and try again to connect with an agent.",mic_permission_dismissed:"Microphone (audio) permission not given. Please try again to connect with an agent.",mic_permission_timeout:"Microphone (audio) permission not given. Please try again to connect with an agent.",time_remaining:"Time remaining 0:",connected_via:"Connected via",powered_by:"Powered by",lead_form_header:"Please fill the following details",mic_blocked_dialog_header:"Audio Permission Blocked",mic_blocked_dialog_desc:"Unable to unmute as your microphone permission is not allowed. Please grant microphone permission in your browser's site settings to unmute."};function rke(t){let r,e,n,i,a;return{c(){r=qe("svg"),e=qe("path"),n=qe("path"),i=qe("path"),a=qe("path"),h(e,"d","M19 3.3335H5C3.89543 3.3335 3 4.07969 3 5.00016V16.6668C3 17.5873 3.89543 18.3335 5 18.3335H19C20.1046 18.3335 21 17.5873 21 16.6668V5.00016C21 4.07969 20.1046 3.3335 19 3.3335Z"),h(e,"stroke",t[0]),h(e,"stroke-width","2"),h(e,"stroke-linecap","round"),h(e,"stroke-linejoin","round"),h(n,"d","M16 1.6665V4.99984"),h(n,"stroke",t[0]),h(n,"stroke-width","2"),h(n,"stroke-linecap","round"),h(n,"stroke-linejoin","round"),h(i,"d","M8 1.6665V4.99984"),h(i,"stroke",t[0]),h(i,"stroke-width","2"),h(i,"stroke-linecap","round"),h(i,"stroke-linejoin","round"),h(a,"d","M3 8.3335H21"),h(a,"stroke",t[0]),h(a,"stroke-width","2"),h(a,"stroke-linecap","round"),h(a,"stroke-linejoin","round"),h(r,"width","24"),h(r,"height","20"),h(r,"viewBox","0 0 24 20"),h(r,"fill","none"),h(r,"xmlns","http://www.w3.org/2000/svg")},m(o,s){Ce(o,r,s),U(r,e),U(r,n),U(r,i),U(r,a)},p(o,[s]){s&1&&h(e,"stroke",o[0]),s&1&&h(n,"stroke",o[0]),s&1&&h(i,"stroke",o[0]),s&1&&h(a,"stroke",o[0])},i:Ge,o:Ge,d(o){o&&Me(r)}}}function nke(t,r,e){let{color:n="#0020BB"}=r;return t.$$set=i=>{"color"in i&&e(0,n=i.color)},[n]}class ike extends It{constructor(r){super(),Rt(this,r,nke,rke,Et,{color:0})}}const kv="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzYwMjNfMTk2NzQpIj4KPHBhdGggZD0iTTIyLjEzMzggMjYuNjMyN0MyNC4zNTI3IDI3LjQwODMgMjYuNzk4NiAyNy42MSAyOC4xNCAyNi4xMDcyQzI4LjgzNyAyNS4yMzk3IDI5LjQ4ODUgMjQuMzM1NCAzMC4wOTA2IDIzLjM5OUMzMC42ODgyIDIyLjQ5NSAzMC40Mzk1IDIxLjI3NzkgMjkuNTM1NSAyMC42ODAzQzI5LjUxMzkgMjAuNjY2MiAyOS40OTIyIDIwLjY1MjEgMjkuNDY5OSAyMC42Mzg3TDI0LjEyMDkgMTcuNDI0M0MyMy40NDc2IDE3LjAyMTYgMjIuNTk5MSAxNy4wNTc5IDIxLjk2MzQgMTcuNTE4MkwxOS4zMDI2IDE5LjQ0MjdDMTYuNTcxNCAxNy45MjA3IDE0LjEzMDYgMTUuOTI2MyAxMi4wOTM2IDEzLjU1NDVMMTEuNzEyNCAxMy4xMTM5TDEzLjE1MDkgMTAuMTM3QzEzLjQ5MzggOS40MzEwNCAxMy4zODIyIDguNTg5MTMgMTIuODY4OCA3Ljk5NjAyTDguNzc0MzkgMy4yODY0M0M4LjA2MTM3IDIuNDcwODYgNi44MjExOCAyLjM4OTA1IDYuMDA1NjIgMy4xMDIwN0M1Ljk4NTk1IDMuMTE5MDkgNS45NjcwOSAzLjEzNjggNS45NDgyMyAzLjE1NDUxQzUuMTMwNTcgMy45MDk5OSA0LjM1MzEyIDQuNzA4NjcgMy42MTk4OCA1LjU0NTc1QzIuMzQ2NDQgNy4xNTkyNSAzLjAyNzg5IDkuNDQ3NTkgNC4xNDUzNSAxMS41NTJDNy41NTM2IDE4LjA4NjIgMTQuOTk3NCAyNC4xNTggMjIuMTMzOCAyNi42MzI3WiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF82MDIzXzE5Njc0Ij4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSJ3aGl0ZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzIgMzIpIHJvdGF0ZSgtMTgwKSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=",Uc={small:{frameBorder:"8px",buttonBorder:"8px",closeBtnBorder:"4px",imageBorder:"8px",miniframeBorder:"6px 6px 0px 0px"},large:{frameBorder:"24px",buttonBorder:"20px",closeBtnBorder:"20px",imageBorder:"24px",miniframeBorder:"20px 20px 0px 0px"}},vx={small:"12px",medium:"24px",rounded:"50%"};var Tv=(t=>(t.Agent="agent",t.Admin="admin",t.Group="group",t))(Tv||{});function ake(t){Zt(t,"svelte-7blad7",".group_image-revly__2023.svelte-7blad7.svelte-7blad7{box-sizing:border-box;display:flex;justify-content:center;gap:0px;align-items:center;position:relative;margin-top:12px}.agentImage-revly__2023.svelte-7blad7.svelte-7blad7{box-sizing:border-box;height:100px;width:100px;border:2px solid white;object-fit:cover;border-radius:50%;z-index:1;transition:transform 0.5s ease-in-out}.gap-revly__2023.svelte-7blad7.svelte-7blad7{gap:24px}.center-image-revly__2023.svelte-7blad7.svelte-7blad7{z-index:111;position:absolute;transform:scale(1.2)}.group_image-revly__2023.svelte-7blad7:not(:has(:nth-child(3))) .svelte-7blad7:not(:first-child){margin-left:-20px}.zindex0-revly__2023.svelte-7blad7.svelte-7blad7{z-index:0 !important}")}function hx(t,r,e){const n=t.slice();return n[2]=r[e],n[4]=e,n}function mx(t){let r,e;return{c(){r=ie("img"),Jt(r.src,e=t[2])||h(r,"src",e),h(r,"alt","agentIcon "+t[4]),h(r,"class","agentImage-revly__2023 svelte-7blad7"),zr(r,"center-image-revly__2023",t[0].length===3&&t[4]===t[1]),zr(r,"zindex0-revly__2023",t[0].length==2&&t[1]%2==t[4])},m(n,i){Ce(n,r,i)},p(n,i){i&1&&!Jt(r.src,e=n[2])&&h(r,"src",e),i&3&&zr(r,"center-image-revly__2023",n[0].length===3&&n[4]===n[1]),i&3&&zr(r,"zindex0-revly__2023",n[0].length==2&&n[1]%2==n[4])},d(n){n&&Me(r)}}}function oke(t){let r,e=t[0],n=[];for(let i=0;i<e.length;i+=1)n[i]=mx(hx(t,e,i));return{c(){r=ie("div");for(let i=0;i<n.length;i+=1)n[i].c();h(r,"class","group_image-revly__2023 svelte-7blad7"),zr(r,"gap-revly__2023",t[0].length===3)},m(i,a){Ce(i,r,a);for(let o=0;o<n.length;o+=1)n[o].m(r,null)},p(i,[a]){if(a&3){e=i[0];let o;for(o=0;o<e.length;o+=1){const s=hx(i,e,o);n[o]?n[o].p(s,a):(n[o]=mx(s),n[o].c(),n[o].m(r,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=e.length}a&1&&zr(r,"gap-revly__2023",i[0].length===3)},i:Ge,o:Ge,d(i){i&&Me(r),Fa(n,i)}}}function ske(t,r,e){let{images:n}=r,i=0;return ea(()=>{setInterval(()=>{e(1,i=(i+1)%n.length)},3e3)}),t.$$set=a=>{"images"in a&&e(0,n=a.images)},[n,i]}class uke extends It{constructor(r){super(),Rt(this,r,ske,oke,Et,{images:0},ake)}}function lke(t){Zt(t,"svelte-1mi3bdh","h4.svelte-1mi3bdh.svelte-1mi3bdh,p.svelte-1mi3bdh.svelte-1mi3bdh,img.svelte-1mi3bdh.svelte-1mi3bdh,button.svelte-1mi3bdh.svelte-1mi3bdh{margin:0;padding:0}.container-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{box-sizing:border-box;padding:24px 24px 16px 24px;word-break:break-word;text-align:center;font-style:normal;display:flex;flex-direction:column;align-items:center;gap:16px;width:300px;border:1px solid var(--primaryColor);background:var(--fillColor) !important;box-shadow:8px 8px 12px -2px rgba(0, 0, 0, 0.25);position:relative}.agentImage-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{box-sizing:border-box;height:120px;width:120px;border:1px solid var(--primaryColor)}.description-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{color:var(--fontColor) !important;text-align:center;font-size:14px !important;font-style:normal;font-weight:400;line-height:20px}.footer-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{display:flex;justify-content:center;align-items:center;gap:4px;font-size:10px;font-weight:500;line-height:12px}.poweredby-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{color:var(--fontColor) !important }.call-action-container.svelte-1mi3bdh.svelte-1mi3bdh{display:flex;justify-content:center;align-items:center;flex-direction:column;gap:12px;width:100%}button.svelte-1mi3bdh.svelte-1mi3bdh{box-sizing:border-box;width:100%;display:flex;justify-content:center;align-items:center;gap:4px;padding-top:10px !important;padding-bottom:10px !important;font-size:16px !important;font-weight:600;line-height:20px;height:40px !important}.button-accept-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{background:var(--primaryColor) !important;color:white !important}.button-schedule-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{color:var(--primaryColor) !important;background:white !important;border:1px solid var(--primaryColor) !important}.button-accept-revly__2023.svelte-1mi3bdh>img.svelte-1mi3bdh{width:20px;transform:translateY(2px);transform-origin:center;animation:svelte-1mi3bdh-vibration 1s infinite}.close-btn-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{box-sizing:border-box;background-color:var(--primaryColor);color:white !important;position:absolute;top:24px;right:24px;height:20px;width:20px;cursor:pointer}.minimized-floater-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{box-sizing:border-box;width:120px;height:120px;border:1px solid var(--primaryColor) !important;background-color:var(--fillColor);background-position:50%;background-size:cover;background-repeat:no-repeat;position:relative;cursor:pointer;margin-bottom:14px}.call-us-now-revly__2023.svelte-1mi3bdh.svelte-1mi3bdh{font-size:14px;line-height:18px;padding-top:5px;padding-bottom:5px;font-weight:500;border:1px solid var(--primaryColor) !important;background-color:var(--primaryColor) !important;color:white !important;text-align:center;position:absolute;left:-1px;right:-1px;bottom:-20px}@keyframes svelte-1mi3bdh-vibration{0%{transform:translateY(0)}25%{transform:translateY(-2px)}50%{transform:translateY(2px)}75%{transform:translateY(-2px)}100%{transform:translateY(0)}}@media(max-width: 550px){}")}function cke(t){let r,e,n,i,a,o,s=(t[11]===0&&t[1]?t[9]:t[8])+"",u,l,c,f,d,v,p,y,k,I,C,L,R,q,z,F,D,W;const X=[pke,dke],me=[];function de(Z,te){return te&4&&(e=null),e==null&&(e=!![Tv.Admin,Tv.Agent].includes(Z[2].imageType)),e?0:1}n=de(t,-1),i=me[n]=X[n](t);let H=t[11]>0&&gx(t),ee=t[1]&&yx(t);return I=new Lc({props:{color:"black",height:"18px",width:"68px"}}),{c(){r=ie("div"),i.c(),a=Le(),o=ie("h4"),u=Nt(s),l=Le(),c=ie("div"),H&&H.c(),f=Le(),ee&&ee.c(),d=Le(),v=ie("a"),p=ie("div"),y=ie("p"),y.textContent=`${Cr.powered_by}`,k=Le(),Ke(I.$$.fragment),L=Le(),R=ie("div"),q=ie("img"),h(o,"class","description-revly__2023 svelte-1mi3bdh"),h(c,"class","call-action-container svelte-1mi3bdh"),h(y,"class","poweredby-revly__2023 svelte-1mi3bdh"),h(p,"class","footer-revly__2023 svelte-1mi3bdh"),h(v,"href",t[10]),h(v,"target","_blank"),rt(v,"text-decoration","none"),h(r,"class","container-revly__2023 svelte-1mi3bdh"),h(r,"style",C=`border-radius: ${t[15].frameBorder} !important`),Jt(q.src,z=Z0)||h(q,"src",z),h(q,"alt","minimize-icon"),h(q,"class","svelte-1mi3bdh"),h(R,"class","close-btn-revly__2023 svelte-1mi3bdh"),rt(R,"border-radius",t[15].closeBtnBorder)},m(Z,te){Ce(Z,r,te),me[n].m(r,null),U(r,a),U(r,o),U(o,u),U(r,l),U(r,c),H&&H.m(c,null),U(c,f),ee&&ee.m(c,null),U(r,d),U(r,v),U(v,p),U(p,y),U(p,k),Je(I,p,null),Ce(Z,L,te),Ce(Z,R,te),U(R,q),F=!0,D||(W=nt(R,"click",Ju(function(){Mn(t[3])&&t[3].apply(this,arguments)})),D=!0)},p(Z,te){t=Z;let re=n;n=de(t,te),n===re?me[n].p(t,te):(ar(),Ee(me[re],1,1,()=>{me[re]=null}),or(),i=me[n],i?i.p(t,te):(i=me[n]=X[n](t),i.c()),_e(i,1),i.m(r,a)),(!F||te&2818)&&s!==(s=(t[11]===0&&t[1]?t[9]:t[8])+"")&&tr(u,s),t[11]>0?H?H.p(t,te):(H=gx(t),H.c(),H.m(c,f)):H&&(H.d(1),H=null),t[1]?ee?(ee.p(t,te),te&2&&_e(ee,1)):(ee=yx(t),ee.c(),_e(ee,1),ee.m(c,null)):ee&&(ar(),Ee(ee,1,1,()=>{ee=null}),or()),(!F||te&1024)&&h(v,"href",t[10]),(!F||te&32768&&C!==(C=`border-radius: ${t[15].frameBorder} !important`))&&h(r,"style",C),te&32768&&rt(R,"border-radius",t[15].closeBtnBorder)},i(Z){F||(_e(i),_e(ee),_e(I.$$.fragment,Z),F=!0)},o(Z){Ee(i),Ee(ee),Ee(I.$$.fragment,Z),F=!1},d(Z){Z&&Me(r),me[n].d(),H&&H.d(),ee&&ee.d(),Xe(I),Z&&Me(L),Z&&Me(R),D=!1,W()}}}function fke(t){let r,e,n=t[2].minimizedBtnText+"",i,a,o,s;return{c(){r=ie("div"),e=ie("div"),i=Nt(n),h(e,"class","call-us-now-revly__2023 svelte-1mi3bdh"),h(e,"style",a=`border-radius: ${t[15].buttonBorder} !important`),h(r,"class","minimized-floater-revly__2023 svelte-1mi3bdh"),rt(r,"background-image","url("+t[7]+")"),rt(r,"border-radius",t[15].miniframeBorder,1)},m(u,l){Ce(u,r,l),U(r,e),U(e,i),o||(s=nt(r,"click",Ju(function(){Mn(t[4])&&t[4].apply(this,arguments)})),o=!0)},p(u,l){t=u,l&4&&n!==(n=t[2].minimizedBtnText+"")&&tr(i,n),l&32768&&a!==(a=`border-radius: ${t[15].buttonBorder} !important`)&&h(e,"style",a),l&128&&rt(r,"background-image","url("+t[7]+")"),l&32768&&rt(r,"border-radius",t[15].miniframeBorder,1)},i:Ge,o:Ge,d(u){u&&Me(r),o=!1,s()}}}function dke(t){let r,e;return r=new uke({props:{images:t[14]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&16384&&(a.images=n[14]),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function pke(t){let r,e,n;return{c(){r=ie("img"),Jt(r.src,e=t[7])||h(r,"src",e),h(r,"alt","agentIcon"),h(r,"class","agentImage-revly__2023 svelte-1mi3bdh"),h(r,"style",n=`border-radius: ${vx[t[2].imageRoundness||"small"]} !important`)},m(i,a){Ce(i,r,a)},p(i,a){a&128&&!Jt(r.src,e=i[7])&&h(r,"src",e),a&4&&n!==(n=`border-radius: ${vx[i[2].imageRoundness||"small"]} !important`)&&h(r,"style",n)},i:Ge,o:Ge,d(i){i&&Me(r)}}}function gx(t){let r,e,n,i,a,o=t[2].callBtnText+"",s,u,l,c;return{c(){r=ie("button"),e=ie("img"),i=Le(),a=ie("span"),s=Nt(o),Jt(e.src,n=kv)||h(e,"src",n),h(e,"alt","call-accept-icon"),h(e,"class","svelte-1mi3bdh"),h(r,"class","button-accept-revly__2023 svelte-1mi3bdh"),h(r,"style",u=`border-radius: ${t[15].buttonBorder} !important`)},m(f,d){Ce(f,r,d),U(r,e),U(r,i),U(r,a),U(a,s),l||(c=nt(r,"click",function(){Mn(t[6])&&t[6].apply(this,arguments)}),l=!0)},p(f,d){t=f,d&4&&o!==(o=t[2].callBtnText+"")&&tr(s,o),d&32768&&u!==(u=`border-radius: ${t[15].buttonBorder} !important`)&&h(r,"style",u)},d(f){f&&Me(r),l=!1,c()}}}function yx(t){let r,e,n,i,a=t[12].scheduler.btnText+"",o,s,u,l,c;return e=new ike({props:{color:t[13].primaryColor}}),{c(){r=ie("button"),Ke(e.$$.fragment),n=Le(),i=ie("span"),o=Nt(a),h(r,"class","button-schedule-revly__2023 svelte-1mi3bdh"),h(r,"style",s=`border-radius: ${t[15].buttonBorder} !important`)},m(f,d){Ce(f,r,d),Je(e,r,null),U(r,n),U(r,i),U(i,o),u=!0,l||(c=nt(r,"click",function(){Mn(t[5])&&t[5].apply(this,arguments)}),l=!0)},p(f,d){t=f;const v={};d&8192&&(v.color=t[13].primaryColor),e.$set(v),(!u||d&4096)&&a!==(a=t[12].scheduler.btnText+"")&&tr(o,a),(!u||d&32768&&s!==(s=`border-radius: ${t[15].buttonBorder} !important`))&&h(r,"style",s)},i(f){u||(_e(e.$$.fragment,f),u=!0)},o(f){Ee(e.$$.fragment,f),u=!1},d(f){f&&Me(r),Xe(e),l=!1,c()}}}function bx(t){let r,e,n,i,a;const o=[fke,cke],s=[];function u(l,c){return l[0]?0:1}return e=u(t),n=s[e]=o[e](t),{c(){r=ie("div"),n.c(),h(r,"class","floater-container-revly__2023"),rt(r,"--primaryColor",t[13].primaryColor),rt(r,"--fillColor",t[13].fillColor),rt(r,"--fontColor",t[13].fontColor)},m(l,c){Ce(l,r,c),s[e].m(r,null),a=!0},p(l,c){t=l;let f=e;e=u(t),e===f?s[e].p(t,c):(ar(),Ee(s[f],1,1,()=>{s[f]=null}),or(),n=s[e],n?n.p(t,c):(n=s[e]=o[e](t),n.c()),_e(n,1),n.m(r,null)),c&8192&&rt(r,"--primaryColor",t[13].primaryColor),c&8192&&rt(r,"--fillColor",t[13].fillColor),c&8192&&rt(r,"--fontColor",t[13].fontColor)},i(l){a||(_e(n),i||Cn(()=>{i=th(r,Wwe,{easing:qu,duration:100}),i.start()}),a=!0)},o(l){Ee(n),a=!1},d(l){l&&Me(r),s[e].d()}}}function vke(t){let r=t[0],e,n,i=bx(t);return{c(){i.c(),e=Fn()},m(a,o){i.m(a,o),Ce(a,e,o),n=!0},p(a,[o]){o&1&&Et(r,r=a[0])?(ar(),Ee(i,1,1,Ge),or(),i=bx(a),i.c(),_e(i,1),i.m(e.parentNode,e)):i.p(a,o)},i(a){n||(_e(i),n=!0)},o(a){Ee(i),n=!1},d(a){a&&Me(e),i.d(a)}}}function hke(t,r,e){let n,i,a,{isMinimized:o}=r,{isSchedulerEnable:s}=r,{templateConfig:u}=r,{onMinimized:l}=r,{onMaximized:c}=r,{onSchedule:f}=r,{onCall:d}=r,{displayImage:v}=r,{callDescription:p}=r,{schedulerDescription:y}=r,{footerLink:k}=r,{availableAgentCount:I}=r,{agents:C}=r,{uiConfig:L}=r;return t.$$set=R=>{"isMinimized"in R&&e(0,o=R.isMinimized),"isSchedulerEnable"in R&&e(1,s=R.isSchedulerEnable),"templateConfig"in R&&e(2,u=R.templateConfig),"onMinimized"in R&&e(3,l=R.onMinimized),"onMaximized"in R&&e(4,c=R.onMaximized),"onSchedule"in R&&e(5,f=R.onSchedule),"onCall"in R&&e(6,d=R.onCall),"displayImage"in R&&e(7,v=R.displayImage),"callDescription"in R&&e(8,p=R.callDescription),"schedulerDescription"in R&&e(9,y=R.schedulerDescription),"footerLink"in R&&e(10,k=R.footerLink),"availableAgentCount"in R&&e(11,I=R.availableAgentCount),"agents"in R&&e(16,C=R.agents),"uiConfig"in R&&e(12,L=R.uiConfig)},t.$$.update=()=>{t.$$.dirty&4&&e(13,n=u.themeConfig),t.$$.dirty&8192&&e(15,i=Uc[n.border]),t.$$.dirty&65536&&e(14,a=C.map(R=>R.profilePic||B0).slice(0,3))},[o,s,u,l,c,f,d,v,p,y,k,I,L,n,a,i,C]}class mke extends It{constructor(r){super(),Rt(this,r,hke,vke,Et,{isMinimized:0,isSchedulerEnable:1,templateConfig:2,onMinimized:3,onMaximized:4,onSchedule:5,onCall:6,displayImage:7,callDescription:8,schedulerDescription:9,footerLink:10,availableAgentCount:11,agents:16,uiConfig:12},lke)}}function gke(t){let r,e,n;return{c(){r=qe("svg"),e=qe("path"),n=qe("path"),h(e,"d","M15 5L5 15"),h(e,"stroke",t[0]),h(e,"stroke-width","2"),h(e,"stroke-linecap","round"),h(e,"stroke-linejoin","round"),h(n,"d","M5 5L15 15"),h(n,"stroke",t[0]),h(n,"stroke-width","2"),h(n,"stroke-linecap","round"),h(n,"stroke-linejoin","round"),h(r,"class","svg-icon"),h(r,"height","100%"),h(r,"width","100%"),h(r,"viewBox","0 0 20 20"),h(r,"fill","none"),h(r,"xmlns","http://www.w3.org/2000/svg")},m(i,a){Ce(i,r,a),U(r,e),U(r,n)},p(i,[a]){a&1&&h(e,"stroke",i[0]),a&1&&h(n,"stroke",i[0])},i:Ge,o:Ge,d(i){i&&Me(r)}}}function yke(t,r,e){let{color:n="white"}=r;return t.$$set=i=>{"color"in i&&e(0,n=i.color)},[n]}class yo extends It{constructor(r){super(),Rt(this,r,yke,gke,Et,{color:0})}}function bke(t){Zt(t,"svelte-1qhttcl",`.form-control-revly__2023.svelte-1qhttcl.svelte-1qhttcl{width:100%;box-sizing:border-box}.label-revly__2023.svelte-1qhttcl.svelte-1qhttcl{color:var(--fontColor);margin:0 0 8px 0;font-size:12px !important;font-weight:600;text-transform:capitalize}.form-control-revly__2023.svelte-1qhttcl>input.svelte-1qhttcl,.form-control-revly__2023.svelte-1qhttcl>select.svelte-1qhttcl{margin:0px !important;box-sizing:border-box;width:100%;height:35px !important;border-radius:4px !important;border:1px solid #e4e7eb;background-color:white !important;color:var(--primaryColor) !important;outline:none;font-size:14px !important;font-weight:500 !important;padding:0 8px !important}.form-control-revly__2023.svelte-1qhttcl>input.svelte-1qhttcl:not(:placeholder-shown),.form-control-revly__2023.svelte-1qhttcl>select.svelte-1qhttcl:not(:placeholder-shown){border:1px solid var(--primaryColor)}.form-control-revly__2023.svelte-1qhttcl>select.svelte-1qhttcl{background:url("data:image/svg+xml,<svg height='10px' width='10px' viewBox='0 0 16 16' fill='%23000000' xmlns='http://www.w3.org/2000/svg'><path d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/></svg>")
      no-repeat;background-position:calc(100% - 0.75rem) center !important;-moz-appearance:none !important;-webkit-appearance:none !important;appearance:none !important;padding-right:2rem !important}.svelte-1qhttcl.svelte-1qhttcl::placeholder{font-weight:400;opacity:0.6}`)}function _x(t,r,e){const n=t.slice();return n[20]=r[e].text,n[11]=r[e].value,n}function _ke(t){let r,e,n,i,a=t[0].options,o=[];for(let s=0;s<a.length;s+=1)o[s]=wx(_x(t,a,s));return{c(){r=ie("select"),e=ie("option"),e.textContent="Select";for(let s=0;s<o.length;s+=1)o[s].c();e.__value="",e.value=e.__value,h(e,"class","svelte-1qhttcl"),h(r,"id",t[6]),h(r,"placeholder",t[9]),r.required=t[2],h(r,"name",t[10](t[7])),h(r,"class","svelte-1qhttcl")},m(s,u){Ce(s,r,u),U(r,e);for(let l=0;l<o.length;l+=1)o[l].m(r,null);FD(r,t[11]),n||(i=nt(r,"change",t[18]),n=!0)},p(s,u){if(u&1){a=s[0].options;let l;for(l=0;l<a.length;l+=1){const c=_x(s,a,l);o[l]?o[l].p(c,u):(o[l]=wx(c),o[l].c(),o[l].m(r,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=a.length}u&4&&(r.required=s[2])},d(s){s&&Me(r),Fa(o,s),n=!1,i()}}}function wke(t){let r,e,n;return{c(){r=ie("input"),h(r,"id",t[6]),r.value=t[11],h(r,"placeholder",t[9]),r.required=t[2],h(r,"type","email"),h(r,"title","Enter email"),h(r,"name",t[10](t[7])),h(r,"class","svelte-1qhttcl")},m(i,a){Ce(i,r,a),e||(n=[nt(r,"change",t[16]),nt(r,"input",t[17])],e=!0)},p(i,a){a&4&&(r.required=i[2])},d(i){i&&Me(r),e=!1,kr(n)}}}function kke(t){let r,e,n;return{c(){r=ie("input"),h(r,"id",t[6]),r.value=t[11],h(r,"placeholder",t[9]),r.required=t[2],h(r,"type","number"),h(r,"name",t[10](t[7])),h(r,"class","svelte-1qhttcl")},m(i,a){Ce(i,r,a),e||(n=[nt(r,"change",t[14]),nt(r,"input",t[15])],e=!0)},p(i,a){a&4&&(r.required=i[2])},d(i){i&&Me(r),e=!1,kr(n)}}}function Tke(t){let r,e,n;return{c(){r=ie("input"),h(r,"id",t[6]),r.value=t[11],h(r,"placeholder",t[9]),r.required=t[2],h(r,"type","text"),h(r,"name",t[10](t[7])),h(r,"class","svelte-1qhttcl")},m(i,a){Ce(i,r,a),e||(n=[nt(r,"change",t[12]),nt(r,"input",t[13])],e=!0)},p(i,a){a&4&&(r.required=i[2])},d(i){i&&Me(r),e=!1,kr(n)}}}function wx(t){let r,e=t[20]+"",n,i;return{c(){r=ie("option"),n=Nt(e),r.__value=i=t[11],r.value=r.__value,h(r,"class","svelte-1qhttcl")},m(a,o){Ce(a,r,o),U(r,n)},p(a,o){o&1&&e!==(e=a[20]+"")&&tr(n,e),o&1&&i!==(i=a[11])&&(r.__value=i,r.value=r.__value)},d(a){a&&Me(r)}}}function kx(t){let r,e;return{c(){r=ie("p"),e=Nt(t[5]),rt(r,"font-size","12px"),rt(r,"color","red"),rt(r,"line-height","24px"),h(r,"class","svelte-1qhttcl")},m(n,i){Ce(n,r,i),U(r,e)},p(n,i){i&32&&tr(e,n[5])},d(n){n&&Me(r)}}}function Ske(t){var c;let r,e,n,i,a;function o(f,d){if(f[8]==="text")return Tke;if(f[8]==="number")return kke;if(f[8]==="email")return wke;if(f[8]==="select")return _ke}let s=o(t),u=s&&s(t),l=((c=t[5])==null?void 0:c.length)&&kx(t);return{c(){r=ie("div"),e=ie("h5"),n=Nt(t[7]),i=Le(),u&&u.c(),a=Le(),l&&l.c(),h(e,"class","label-revly__2023 svelte-1qhttcl"),rt(e,"color",t[1]),h(r,"class","form-control-revly__2023 svelte-1qhttcl"),rt(r,"--primaryColor",t[4]),rt(r,"--fontColor",t[3])},m(f,d){Ce(f,r,d),U(r,e),U(e,n),U(r,i),u&&u.m(r,null),U(r,a),l&&l.m(r,null)},p(f,[d]){var v;d&2&&rt(e,"color",f[1]),u&&u.p(f,d),(v=f[5])!=null&&v.length?l?l.p(f,d):(l=kx(f),l.c(),l.m(r,null)):l&&(l.d(1),l=null),d&16&&rt(r,"--primaryColor",f[4]),d&8&&rt(r,"--fontColor",f[3])},i:Ge,o:Ge,d(f){f&&Me(r),u&&u.d(),l&&l.d()}}}function Eke(t,r,e){let{formField:n}=r,{labelColor:i="black"}=r,{required:a=!1}=r,{fontColor:o="black"}=r,{primaryColor:s="black"}=r,{errorText:u=""}=r;const{id:l,label:c,type:f,placeholder:d}=n,v=F=>F.split(" ").join(""),y=(ui.get(ws)||{})[v(n.label)]||"";function k(F){Hr.call(this,t,F)}function I(F){Hr.call(this,t,F)}function C(F){Hr.call(this,t,F)}function L(F){Hr.call(this,t,F)}function R(F){Hr.call(this,t,F)}function q(F){Hr.call(this,t,F)}function z(F){Hr.call(this,t,F)}return t.$$set=F=>{"formField"in F&&e(0,n=F.formField),"labelColor"in F&&e(1,i=F.labelColor),"required"in F&&e(2,a=F.required),"fontColor"in F&&e(3,o=F.fontColor),"primaryColor"in F&&e(4,s=F.primaryColor),"errorText"in F&&e(5,u=F.errorText)},[n,i,a,o,s,u,l,c,f,d,v,y,k,I,C,L,R,q,z]}class Sv extends It{constructor(r){super(),Rt(this,r,Eke,Ske,Et,{formField:0,labelColor:1,required:2,fontColor:3,primaryColor:4,errorText:5},bke)}}const Tx=["gmail.com","yahoo.com","hotmail.com","aol.com","zoho.com","outlook.com","msn.com","icloud.com","inbox.com","mail.com","hotmail.couk","protonmail.com","pm.com","aim.com","yandex.com","titan.email","gmx.com","hubspot.com"];class q0{}$t(q0,"extractDomain",r=>r.split("@").pop().toLowerCase());function Mke(t){Zt(t,"svelte-1ny2w7t","button.svelte-1ny2w7t.svelte-1ny2w7t{margin:0;padding:0}.container-revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{box-sizing:border-box;position:relative;background:var(--fillColor) !important;border:1px solid var(--primaryColor);font-size:16px;line-height:30px;border-radius:14px;width:300px;height:408px;padding:24px 24px 16px 24px;display:flex;flex-direction:column;gap:16px}.heading-revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{color:var(--fontColor);display:flex;justify-content:space-between;align-items:center;font-size:16px;font-style:normal;font-weight:500;line-height:20px}.sub-heading-revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{color:var(--fontColor) !important;font-size:12px;font-style:normal;font-weight:400;line-height:20px;margin-top:-4px}.closeBtn-revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{box-sizing:border-box;background-color:var(--primaryColor);cursor:pointer;width:20px;height:20px;padding:1px}.connectBtn-revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{box-sizing:border-box;border-radius:40px !important;background:var(--primaryColor) !important;color:#fff !important;width:100%;display:flex;justify-content:center;align-items:center;gap:4px !important;padding:10px !important;align-self:end}.connectBtn-revly__2023.svelte-1ny2w7t>img.svelte-1ny2w7t{width:20px}.connectBtn-revly__2023.svelte-1ny2w7t>span.svelte-1ny2w7t{font-weight:600;line-height:20px}.visitor-details_form__revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{display:flex;flex-direction:column;justify-content:center;gap:16px;height:calc(100% - 100px)}.inputFields__revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{display:flex;flex-direction:column;gap:16px;flex-grow:1;overflow-y:scroll}.footer-revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{display:flex;justify-content:center;align-items:center;gap:4px;font-size:10px;font-weight:500;line-height:12px}.poweredby-revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{color:var(--fontColor) !important }@media(max-width: 550px){.container-revly__2023.svelte-1ny2w7t.svelte-1ny2w7t{transform:scale(0.85);margin:0 -30px 0 -30px}}")}function Sx(t,r,e){const n=t.slice();return n[9]=r[e],n}function Ex(t){let r,e;return r=new Sv({props:{formField:t[9],labelColor:t[2].fontColor,fontColor:t[2].fontColor,primaryColor:t[2].primaryColor,errorText:t[5].get(t[6](t[9].label)),required:!0}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&2&&(a.formField=n[9]),i&4&&(a.labelColor=n[2].fontColor),i&4&&(a.fontColor=n[2].fontColor),i&4&&(a.primaryColor=n[2].primaryColor),i&2&&(a.errorText=n[5].get(n[6](n[9].label))),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function Cke(t){let r,e,n,i,a,o,s,u,l,c,f,d,v,p,y,k,I,C,L,R,q,z,F,D,W,X,me,de,H;o=new yo({});let ee=t[1],Z=[];for(let re=0;re<ee.length;re+=1)Z[re]=Ex(Sx(t,ee,re));const te=re=>Ee(Z[re],1,1,()=>{Z[re]=null});return W=new Lc({props:{color:"black",height:"18px",width:"68px"}}),{c(){r=ie("div"),e=ie("div"),n=ie("span"),n.textContent="Enter Details",i=Le(),a=ie("div"),Ke(o.$$.fragment),u=Le(),l=ie("div"),l.textContent="Please enter the details below to connect",c=Le(),f=ie("form"),d=ie("div");for(let re=0;re<Z.length;re+=1)Z[re].c();v=Le(),p=ie("button"),y=ie("img"),I=Le(),C=ie("span"),C.textContent="Connect Now",R=Le(),q=ie("a"),z=ie("div"),F=ie("p"),F.textContent=`${Cr.powered_by}`,D=Le(),Ke(W.$$.fragment),h(a,"class","closeBtn-revly__2023 svelte-1ny2w7t"),h(a,"style",s=`border-radius: ${t[3].closeBtnBorder} !important`),h(e,"class","heading-revly__2023 svelte-1ny2w7t"),h(l,"class","sub-heading-revly__2023 svelte-1ny2w7t"),h(d,"class","inputFields__revly__2023 svelte-1ny2w7t"),Jt(y.src,k=kv)||h(y,"src",k),h(y,"alt","call-accept-icon"),h(y,"class","svelte-1ny2w7t"),h(C,"class","svelte-1ny2w7t"),h(p,"class","connectBtn-revly__2023 svelte-1ny2w7t"),h(p,"style",L=`border-radius: ${t[3].buttonBorder} !important`),h(p,"type","submit"),h(f,"class","visitor-details_form__revly__2023 svelte-1ny2w7t"),h(F,"class","poweredby-revly__2023 svelte-1ny2w7t"),h(z,"class","footer-revly__2023 svelte-1ny2w7t"),h(q,"href",t[4]),h(q,"target","_blank"),rt(q,"text-decoration","none"),h(r,"class","container-revly__2023 svelte-1ny2w7t"),h(r,"style",X=`border-radius: ${t[3].frameBorder} !important`),rt(r,"--primaryColor",t[2].primaryColor),rt(r,"--fillColor",t[2].fillColor),rt(r,"--fontColor",t[2].fontColor)},m(re,K){Ce(re,r,K),U(r,e),U(e,n),U(e,i),U(e,a),Je(o,a,null),U(r,u),U(r,l),U(r,c),U(r,f),U(f,d);for(let fe=0;fe<Z.length;fe+=1)Z[fe].m(d,null);U(f,v),U(f,p),U(p,y),U(p,I),U(p,C),U(r,R),U(r,q),U(q,z),U(z,F),U(z,D),Je(W,z,null),me=!0,de||(H=[nt(a,"click",Ju(function(){Mn(t[0])&&t[0].apply(this,arguments)})),nt(f,"submit",Qv(t[7]))],de=!0)},p(re,[K]){if(t=re,(!me||K&8&&s!==(s=`border-radius: ${t[3].closeBtnBorder} !important`))&&h(a,"style",s),K&102){ee=t[1];let fe;for(fe=0;fe<ee.length;fe+=1){const Te=Sx(t,ee,fe);Z[fe]?(Z[fe].p(Te,K),_e(Z[fe],1)):(Z[fe]=Ex(Te),Z[fe].c(),_e(Z[fe],1),Z[fe].m(d,null))}for(ar(),fe=ee.length;fe<Z.length;fe+=1)te(fe);or()}(!me||K&8&&L!==(L=`border-radius: ${t[3].buttonBorder} !important`))&&h(p,"style",L),(!me||K&16)&&h(q,"href",t[4]),(!me||K&8&&X!==(X=`border-radius: ${t[3].frameBorder} !important`))&&h(r,"style",X),K&4&&rt(r,"--primaryColor",t[2].primaryColor),K&4&&rt(r,"--fillColor",t[2].fillColor),K&4&&rt(r,"--fontColor",t[2].fontColor)},i(re){if(!me){_e(o.$$.fragment,re);for(let K=0;K<ee.length;K+=1)_e(Z[K]);_e(W.$$.fragment,re),me=!0}},o(re){Ee(o.$$.fragment,re),Z=Z.filter(Boolean);for(let K=0;K<Z.length;K+=1)Ee(Z[K]);Ee(W.$$.fragment,re),me=!1},d(re){re&&Me(r),Xe(o),Fa(Z,re),Xe(W),de=!1,kr(H)}}}function Rke(t,r,e){let n,i,{onClose:a}=r,{initCallOptions:o}=r,{config:s}=r,{themeConfig:u}=r,l=new Map;const c=d=>d.split(" ").join("");async function f(d){const v=new FormData(d.target),p={};for(let[k,I]of v){const C=s.find(L=>k===c(L.label));if(C&&C.type==="email"){const L=c(C.label);if(!ywe(I)){l.set(L,"Enter a valid email");return}const R=q0.extractDomain(I);if(!C.isPersonalEmailAllowed&&Tx.includes(R)){l.set(L,"Enter work email");return}else l.delete(L)}p[k]=I}const y=ui.get(ws)||{};ui.set(ws,{...y,...p}),go(bi.Call,_v.FilledCallForm,{visitorDetails:p,campaignId:o.campaignId}),await Mr.initCall({...o,visitorDetails:p})}return t.$$set=d=>{"onClose"in d&&e(0,a=d.onClose),"initCallOptions"in d&&e(8,o=d.initCallOptions),"config"in d&&e(1,s=d.config),"themeConfig"in d&&e(2,u=d.themeConfig)},t.$$.update=()=>{t.$$.dirty&256&&e(4,n=wv({source:"call-form",campaignId:o.campaignId})),t.$$.dirty&4&&e(3,i=Uc[u.border])},[a,s,u,i,n,l,c,f,o]}class Mx extends It{constructor(r){super(),Rt(this,r,Rke,Cke,Et,{onClose:0,initCallOptions:8,config:1,themeConfig:2},Mke)}}var Cx=(t=>(t.Admin="admin",t.Agent="agent",t.Manager="manager",t))(Cx||{});const Ike="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTkgMThMMTUgMTJMOSA2IiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K";function Oke(t){let r,e,n,i,a,o,s,u,l,c,f,d,v,p,y,k,I,C,L,R,q,z,F,D,W,X,me,de,H,ee,Z,te,re,K,fe,Te,$;return{c(){r=qe("svg"),e=qe("g"),n=qe("rect"),i=qe("animate"),a=qe("g"),o=qe("rect"),s=qe("animate"),u=qe("g"),l=qe("rect"),c=qe("animate"),f=qe("g"),d=qe("rect"),v=qe("animate"),p=qe("g"),y=qe("rect"),k=qe("animate"),I=qe("g"),C=qe("rect"),L=qe("animate"),R=qe("g"),q=qe("rect"),z=qe("animate"),F=qe("g"),D=qe("rect"),W=qe("animate"),X=qe("g"),me=qe("rect"),de=qe("animate"),H=qe("g"),ee=qe("rect"),Z=qe("animate"),te=qe("g"),re=qe("rect"),K=qe("animate"),fe=qe("g"),Te=qe("rect"),$=qe("animate"),h(i,"attributeName","opacity"),h(i,"values","1;0"),h(i,"keyTimes","0;1"),h(i,"dur","1s"),h(i,"begin","-0.9166666666666666s"),h(i,"repeatCount","indefinite"),h(n,"x","48"),h(n,"y","28"),h(n,"rx","2"),h(n,"ry","2.1"),h(n,"width","3"),h(n,"height","8"),h(n,"fill",t[0]),h(e,"transform","rotate(0 50 50)"),h(s,"attributeName","opacity"),h(s,"values","1;0"),h(s,"keyTimes","0;1"),h(s,"dur","1s"),h(s,"begin","-0.8333333333333334s"),h(s,"repeatCount","indefinite"),h(o,"x","48"),h(o,"y","28"),h(o,"rx","2"),h(o,"ry","2.1"),h(o,"width","3"),h(o,"height","8"),h(o,"fill",t[0]),h(a,"transform","rotate(30 50 50)"),h(c,"attributeName","opacity"),h(c,"values","1;0"),h(c,"keyTimes","0;1"),h(c,"dur","1s"),h(c,"begin","-0.75s"),h(c,"repeatCount","indefinite"),h(l,"x","48"),h(l,"y","28"),h(l,"rx","2"),h(l,"ry","2.1"),h(l,"width","3"),h(l,"height","8"),h(l,"fill",t[0]),h(u,"transform","rotate(60 50 50)"),h(v,"attributeName","opacity"),h(v,"values","1;0"),h(v,"keyTimes","0;1"),h(v,"dur","1s"),h(v,"begin","-0.6666666666666666s"),h(v,"repeatCount","indefinite"),h(d,"x","48"),h(d,"y","28"),h(d,"rx","2"),h(d,"ry","2.1"),h(d,"width","3"),h(d,"height","8"),h(d,"fill",t[0]),h(f,"transform","rotate(90 50 50)"),h(k,"attributeName","opacity"),h(k,"values","1;0"),h(k,"keyTimes","0;1"),h(k,"dur","1s"),h(k,"begin","-0.5833333333333334s"),h(k,"repeatCount","indefinite"),h(y,"x","48"),h(y,"y","28"),h(y,"rx","2"),h(y,"ry","2.1"),h(y,"width","3"),h(y,"height","8"),h(y,"fill",t[0]),h(p,"transform","rotate(120 50 50)"),h(L,"attributeName","opacity"),h(L,"values","1;0"),h(L,"keyTimes","0;1"),h(L,"dur","1s"),h(L,"begin","-0.5s"),h(L,"repeatCount","indefinite"),h(C,"x","48"),h(C,"y","28"),h(C,"rx","2"),h(C,"ry","2.1"),h(C,"width","3"),h(C,"height","8"),h(C,"fill",t[0]),h(I,"transform","rotate(150 50 50)"),h(z,"attributeName","opacity"),h(z,"values","1;0"),h(z,"keyTimes","0;1"),h(z,"dur","1s"),h(z,"begin","-0.4166666666666667s"),h(z,"repeatCount","indefinite"),h(q,"x","48"),h(q,"y","28"),h(q,"rx","2"),h(q,"ry","2.1"),h(q,"width","3"),h(q,"height","8"),h(q,"fill",t[0]),h(R,"transform","rotate(180 50 50)"),h(W,"attributeName","opacity"),h(W,"values","1;0"),h(W,"keyTimes","0;1"),h(W,"dur","1s"),h(W,"begin","-0.3333333333333333s"),h(W,"repeatCount","indefinite"),h(D,"x","48"),h(D,"y","28"),h(D,"rx","2"),h(D,"ry","2.1"),h(D,"width","3"),h(D,"height","8"),h(D,"fill",t[0]),h(F,"transform","rotate(210 50 50)"),h(de,"attributeName","opacity"),h(de,"values","1;0"),h(de,"keyTimes","0;1"),h(de,"dur","1s"),h(de,"begin","-0.25s"),h(de,"repeatCount","indefinite"),h(me,"x","48"),h(me,"y","28"),h(me,"rx","2"),h(me,"ry","2.1"),h(me,"width","3"),h(me,"height","8"),h(me,"fill",t[0]),h(X,"transform","rotate(240 50 50)"),h(Z,"attributeName","opacity"),h(Z,"values","1;0"),h(Z,"keyTimes","0;1"),h(Z,"dur","1s"),h(Z,"begin","-0.16666666666666666s"),h(Z,"repeatCount","indefinite"),h(ee,"x","48"),h(ee,"y","28"),h(ee,"rx","2"),h(ee,"ry","2.1"),h(ee,"width","3"),h(ee,"height","8"),h(ee,"fill",t[0]),h(H,"transform","rotate(270 50 50)"),h(K,"attributeName","opacity"),h(K,"values","1;0"),h(K,"keyTimes","0;1"),h(K,"dur","1s"),h(K,"begin","-0.08333333333333333s"),h(K,"repeatCount","indefinite"),h(re,"x","48"),h(re,"y","28"),h(re,"rx","2"),h(re,"ry","2.1"),h(re,"width","3"),h(re,"height","8"),h(re,"fill",t[0]),h(te,"transform","rotate(300 50 50)"),h($,"attributeName","opacity"),h($,"values","1;0"),h($,"keyTimes","0;1"),h($,"dur","1s"),h($,"begin","0s"),h($,"repeatCount","indefinite"),h(Te,"x","48"),h(Te,"y","28"),h(Te,"rx","2"),h(Te,"ry","2.1"),h(Te,"width","3"),h(Te,"height","8"),h(Te,"fill",t[0]),h(fe,"transform","rotate(330 50 50)"),rt(r,"margin","auto"),rt(r,"background","none"),rt(r,"display","block"),rt(r,"shape-rendering","auto"),h(r,"width",t[1]),h(r,"height",t[2]),h(r,"viewBox","0 0 100 100"),h(r,"preserveAspectRatio","xMidYMid")},m(We,et){Ce(We,r,et),U(r,e),U(e,n),U(n,i),U(r,a),U(a,o),U(o,s),U(r,u),U(u,l),U(l,c),U(r,f),U(f,d),U(d,v),U(r,p),U(p,y),U(y,k),U(r,I),U(I,C),U(C,L),U(r,R),U(R,q),U(q,z),U(r,F),U(F,D),U(D,W),U(r,X),U(X,me),U(me,de),U(r,H),U(H,ee),U(ee,Z),U(r,te),U(te,re),U(re,K),U(r,fe),U(fe,Te),U(Te,$)},p(We,[et]){et&1&&h(n,"fill",We[0]),et&1&&h(o,"fill",We[0]),et&1&&h(l,"fill",We[0]),et&1&&h(d,"fill",We[0]),et&1&&h(y,"fill",We[0]),et&1&&h(C,"fill",We[0]),et&1&&h(q,"fill",We[0]),et&1&&h(D,"fill",We[0]),et&1&&h(me,"fill",We[0]),et&1&&h(ee,"fill",We[0]),et&1&&h(re,"fill",We[0]),et&1&&h(Te,"fill",We[0]),et&2&&h(r,"width",We[1]),et&4&&h(r,"height",We[2])},i:Ge,o:Ge,d(We){We&&Me(r)}}}function Nke(t,r,e){let{color:n="white"}=r,{width:i=160}=r,{height:a=160}=r;return t.$$set=o=>{"color"in o&&e(0,n=o.color),"width"in o&&e(1,i=o.width),"height"in o&&e(2,a=o.height)},[n,i,a]}class Q0 extends It{constructor(r){super(),Rt(this,r,Nke,Oke,Et,{color:0,width:1,height:2})}}function Ake(t){Zt(t,"svelte-sle8t8","button.svelte-sle8t8.svelte-sle8t8{margin:0;padding:0}.form-container-revly__2023.svelte-sle8t8.svelte-sle8t8{box-sizing:border-box;display:flex;flex-direction:column;justify-content:space-between;gap:16px;height:100%;max-height:calc(100% - 90px)}.connectBtn-revly__2023.svelte-sle8t8.svelte-sle8t8{box-sizing:border-box;border-radius:40px !important;background:var(--primaryColor) !important;color:#fff !important;width:100%;display:flex;justify-content:center;align-items:center;gap:4px !important;padding:10px !important;align-self:end;font-size:16px !important}.connectBtn-revly__2023.svelte-sle8t8>img.svelte-sle8t8{width:20px}.connectBtn-revly__2023.svelte-sle8t8>span.svelte-sle8t8{font-weight:600;line-height:20px}.visitor-details_form__revly__2023.svelte-sle8t8.svelte-sle8t8{display:flex;flex-direction:column;justify-content:space-between;gap:16px;height:100%}.inputFields__revly__2023.svelte-sle8t8.svelte-sle8t8{display:flex;flex-direction:column;gap:16px;flex-grow:1;overflow-y:scroll}.add-participant-btn-revly__2023.svelte-sle8t8.svelte-sle8t8{color:var(--fontColor);margin-top:-16px;font-size:12px;cursor:pointer;width:fit-content;margin-left:auto}.error-text-revly__2023.svelte-sle8t8.svelte-sle8t8{color:var(--fontColor);text-align:center;font-size:14px;font-weight:400;line-height:20px}")}function Rx(t,r,e){const n=t.slice();return n[18]=r[e],n}function Ix(t,r,e){const n=t.slice();return n[18]=r[e],n}function Pke(t){let r,e,n={ctx:t,current:null,token:null,hasCatch:!0,pending:Uke,then:Lke,catch:Dke,value:17,error:23,blocks:[,,,]};return F1(t[9],n),{c(){r=Fn(),n.block.c()},m(i,a){Ce(i,r,a),n.block.m(i,n.anchor=a),n.mount=()=>r.parentNode,n.anchor=r,e=!0},p(i,a){t=i,$1(n,t,a)},i(i){e||(_e(n.block),e=!0)},o(i){for(let a=0;a<3;a+=1){const o=n.blocks[a];Ee(o)}e=!1},d(i){i&&Me(r),n.block.d(i),n.token=null,n=null}}}function xke(t){let r,e,n;return e=new Q0({props:{color:t[6].primaryColor}}),{c(){r=ie("div"),Ke(e.$$.fragment),rt(r,"margin","auto")},m(i,a){Ce(i,r,a),Je(e,r,null),n=!0},p:Ge,i(i){n||(_e(e.$$.fragment,i),n=!0)},o(i){Ee(e.$$.fragment,i),n=!1},d(i){i&&Me(r),Xe(e)}}}function Dke(t){let r,e=yi.getErrorMsgKey(t[23])+"",n;return{c(){r=ie("div"),n=Nt(e),h(r,"class","error-text-revly__2023 svelte-sle8t8")},m(i,a){Ce(i,r,a),U(r,n)},p:Ge,i:Ge,o:Ge,d(i){i&&Me(r)}}}function Lke(t){let r,e,n,i,a,o,s,u,l,c,f,d,v,p,y,k=t[17].fieldJson,I=[];for(let D=0;D<k.length;D+=1)I[D]=Ox(Ix(t,k,D));const C=D=>Ee(I[D],1,1,()=>{I[D]=null});let L=t[1],R=[];for(let D=0;D<L.length;D+=1)R[D]=Nx(Rx(t,L,D));const q=D=>Ee(R[D],1,1,()=>{R[D]=null});let z=t[0].isParticipantsAllowed&&Ax(t),F=t[2].length&&Px(t);return{c(){r=ie("form"),e=ie("div");for(let D=0;D<I.length;D+=1)I[D].c();n=Le();for(let D=0;D<R.length;D+=1)R[D].c();i=Le(),z&&z.c(),a=Le(),F&&F.c(),o=Le(),s=ie("button"),u=ie("span"),u.textContent="Choose Time Slot",l=Le(),c=ie("img"),h(e,"class","inputFields__revly__2023 svelte-sle8t8"),h(u,"class","svelte-sle8t8"),Jt(c.src,f=Ike)||h(c,"src",f),h(c,"alt","chevron-right-icon"),h(c,"class","svelte-sle8t8"),h(s,"class","connectBtn-revly__2023 svelte-sle8t8"),h(s,"style",d=`border-radius: ${t[4].buttonBorder} !important`),h(s,"type","submit"),h(r,"class","visitor-details_form__revly__2023 svelte-sle8t8")},m(D,W){Ce(D,r,W),U(r,e);for(let X=0;X<I.length;X+=1)I[X].m(e,null);U(e,n);for(let X=0;X<R.length;X+=1)R[X].m(e,null);U(e,i),z&&z.m(e,null),U(e,a),F&&F.m(e,null),U(r,o),U(r,s),U(s,u),U(s,l),U(s,c),v=!0,p||(y=nt(r,"submit",Qv(t[7])),p=!0)},p(D,W){if(W&576){k=D[17].fieldJson;let X;for(X=0;X<k.length;X+=1){const me=Ix(D,k,X);I[X]?(I[X].p(me,W),_e(I[X],1)):(I[X]=Ox(me),I[X].c(),_e(I[X],1),I[X].m(e,n))}for(ar(),X=k.length;X<I.length;X+=1)C(X);or()}if(W&70){L=D[1];let X;for(X=0;X<L.length;X+=1){const me=Rx(D,L,X);R[X]?(R[X].p(me,W),_e(R[X],1)):(R[X]=Nx(me),R[X].c(),_e(R[X],1),R[X].m(e,i))}for(ar(),X=L.length;X<R.length;X+=1)q(X);or()}D[0].isParticipantsAllowed?z?z.p(D,W):(z=Ax(D),z.c(),z.m(e,a)):z&&(z.d(1),z=null),D[2].length?F?F.p(D,W):(F=Px(D),F.c(),F.m(e,null)):F&&(F.d(1),F=null),(!v||W&16&&d!==(d=`border-radius: ${D[4].buttonBorder} !important`))&&h(s,"style",d)},i(D){if(!v){for(let W=0;W<k.length;W+=1)_e(I[W]);for(let W=0;W<L.length;W+=1)_e(R[W]);v=!0}},o(D){I=I.filter(Boolean);for(let W=0;W<I.length;W+=1)Ee(I[W]);R=R.filter(Boolean);for(let W=0;W<R.length;W+=1)Ee(R[W]);v=!1},d(D){D&&Me(r),Fa(I,D),Fa(R,D),z&&z.d(),F&&F.d(),p=!1,y()}}}function Ox(t){let r,e;return r=new Sv({props:{formField:t[18],labelColor:t[6].fontColor,fontColor:t[6].fontColor,primaryColor:t[6].primaryColor,required:!0}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p:Ge,i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function Nx(t){let r,e;return r=new Sv({props:{formField:t[18],labelColor:t[6].fontColor,fontColor:t[6].fontColor,primaryColor:t[6].primaryColor,required:t[18].required}}),r.$on("input",t[12]),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&2&&(a.formField=n[18]),i&2&&(a.required=n[18].required),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function Ax(t){let r,e,n;return{c(){r=ie("div"),r.textContent="Add Participants",h(r,"class","add-participant-btn-revly__2023 svelte-sle8t8")},m(i,a){Ce(i,r,a),e||(n=nt(r,"click",t[8]),e=!0)},p:Ge,d(i){i&&Me(r),e=!1,n()}}}function Px(t){let r,e;return{c(){r=ie("div"),e=Nt(t[2]),rt(r,"font-size","12px"),rt(r,"color","red"),rt(r,"margin-top",(t[0].isParticipantsAllowed?-30:-15)+"px")},m(n,i){Ce(n,r,i),U(r,e)},p(n,i){i&4&&tr(e,n[2]),i&1&&rt(r,"margin-top",(n[0].isParticipantsAllowed?-30:-15)+"px")},d(n){n&&Me(r)}}}function Uke(t){let r,e,n;return e=new Q0({props:{color:t[6].primaryColor}}),{c(){r=ie("div"),Ke(e.$$.fragment),rt(r,"margin","auto")},m(i,a){Ce(i,r,a),Je(e,r,null),n=!0},p:Ge,i(i){n||(_e(e.$$.fragment,i),n=!0)},o(i){Ee(e.$$.fragment,i),n=!1},d(i){i&&Me(r),Xe(e)}}}function jke(t){let r,e,n,i;const a=[xke,Pke],o=[];function s(u,l){return u[3]?0:1}return e=s(t),n=o[e]=a[e](t),{c(){r=ie("div"),n.c(),h(r,"class","form-container-revly__2023 svelte-sle8t8")},m(u,l){Ce(u,r,l),o[e].m(r,null),i=!0},p(u,[l]){let c=e;e=s(u),e===c?o[e].p(u,l):(ar(),Ee(o[c],1,1,()=>{o[c]=null}),or(),n=o[e],n?n.p(u,l):(n=o[e]=a[e](u),n.c()),_e(n,1),n.m(r,null))},i(u){i||(_e(n),i=!0)},o(u){Ee(n),i=!1},d(u){u&&Me(r),o[e].d()}}}function Vke(t,r,e){let n,i,{campaignId:a}=r,{onSubmit:o}=r,s,u=[{label:"Email",placeholder:"Enter",type:"email",required:!0}];const l=new Set(Tx);let c="",f=["email","workemail","otherparticipantemail"];const d=Gv("RevlyScheduler");xr(t,d,R=>e(13,i=R));let v=i.themeConfig,p=!1;async function y(){let{data:R}=await Kr.get(`visitors/scheduler-template/${a}`);return gs(d,i.duration=R.meetingDuration,i),e(0,s=R),e(0,s.fieldJson=R.fieldJson.filter(q=>q.label.toLowerCase()!=="email"),s),R.isPersonalEmailAllowed||e(1,u=u.map(q=>(q.label=q.label.replace(/Email/gi,"Work Email"),q))),s}async function k(R){const q=new FormData(R.target),z=[],F={},D=ui.get(ws)||{};for(let[W,X]of q)if(f.includes(W.toLowerCase())){if(!s.isPersonalEmailAllowed){const me=q0.extractDomain(X.toString().toLowerCase());if(l.has(me)){e(2,c="Enter your work email");return}}X.toString().length&&(z.push(X),(W.toLowerCase()==="email"||W.toLowerCase()=="workemail")&&(D[W]=X))}else F[W]=X;ui.set(ws,{...D,...F}),e(3,p=!0),await o(F,Array.from(new Set(z))),e(3,p=!1)}async function I(){u.push({label:"Other Participant Email",placeholder:"Enter (optional)",type:"email",required:!1}),e(1,u)}const C=y(),L=()=>e(2,c="");return t.$$set=R=>{"campaignId"in R&&e(10,a=R.campaignId),"onSubmit"in R&&e(11,o=R.onSubmit)},e(4,n=Uc[v.border]),[s,u,c,p,n,d,v,k,I,C,a,o,L]}class Fke extends It{constructor(r){super(),Rt(this,r,Vke,jke,Et,{campaignId:10,onSubmit:11},Ake)}}function $ke(t){Zt(t,"svelte-1sf96ro",".footer-revly__2023.svelte-1sf96ro{display:flex;justify-content:center;align-items:center;gap:4px;font-size:10px;font-weight:500;line-height:12px}.poweredby-revly__2023.svelte-1sf96ro{color:var(--fontColor) !important }")}function zke(t){let r,e,n,i,a,o;return a=new Lc({props:{color:"black",height:"18px",width:"68px"}}),{c(){r=ie("a"),e=ie("div"),n=ie("p"),n.textContent=`${Cr.powered_by}`,i=Le(),Ke(a.$$.fragment),h(n,"class","poweredby-revly__2023 svelte-1sf96ro"),h(e,"class","footer-revly__2023 svelte-1sf96ro"),h(r,"href",t[0]),h(r,"target","_blank"),rt(r,"text-decoration","none")},m(s,u){Ce(s,r,u),U(r,e),U(e,n),U(e,i),Je(a,e,null),o=!0},p(s,[u]){(!o||u&1)&&h(r,"href",s[0])},i(s){o||(_e(a.$$.fragment,s),o=!0)},o(s){Ee(a.$$.fragment,s),o=!1},d(s){s&&Me(r),Xe(a)}}}function Wke(t,r,e){let n,{utmParams:i}=r;function a(o){const s=Zu.service.baseUrl.includes("revly")?"https://revly.io":"https://stage.revly.io",u=new URL(s);return o!=null&&o.campaignId&&u.searchParams.append("id",o.campaignId),u.searchParams.append("source","floater"),u.toString()+`&referrer_url=${window.location.href}`}return t.$$set=o=>{"utmParams"in o&&e(1,i=o.utmParams)},t.$$.update=()=>{t.$$.dirty&2&&e(0,n=a(i))},[n,i]}class Bke extends It{constructor(r){super(),Rt(this,r,Wke,zke,Et,{utmParams:1},$ke)}}function Zke(t){let r,e,n,i;return{c(){r=qe("svg"),e=qe("path"),h(e,"d","M12.5 15L7.5 10L12.5 5"),h(e,"stroke",t[0]),h(e,"stroke-width","2"),h(e,"stroke-linecap","round"),h(e,"stroke-linejoin","round"),h(r,"width","20"),h(r,"height","20"),h(r,"viewBox","0 0 20 20"),h(r,"fill","none"),h(r,"xmlns","http://www.w3.org/2000/svg")},m(a,o){Ce(a,r,o),U(r,e),n||(i=nt(r,"click",t[1]),n=!0)},p(a,[o]){o&1&&h(e,"stroke",a[0])},i:Ge,o:Ge,d(a){a&&Me(r),n=!1,i()}}}function qke(t,r,e){let{color:n="white"}=r;function i(a){Hr.call(this,t,a)}return t.$$set=a=>{"color"in a&&e(0,n=a.color)},[n,i]}class xx extends It{constructor(r){super(),Rt(this,r,qke,Zke,Et,{color:0})}}function Qke(t){let r,e;return{c(){r=qe("svg"),e=qe("path"),h(e,"d","M7.5 15L12.5 10L7.5 5"),h(e,"stroke",t[0]),h(e,"stroke-width","2"),h(e,"stroke-linecap","round"),h(e,"stroke-linejoin","round"),h(r,"width","20"),h(r,"height","20"),h(r,"viewBox","0 0 20 20"),h(r,"fill","none"),h(r,"xmlns","http://www.w3.org/2000/svg")},m(n,i){Ce(n,r,i),U(r,e)},p(n,[i]){i&1&&h(e,"stroke",n[0])},i:Ge,o:Ge,d(n){n&&Me(r)}}}function Yke(t,r,e){let{color:n="white"}=r;return t.$$set=i=>{"color"in i&&e(0,n=i.color)},[n]}class Dx extends It{constructor(r){super(),Rt(this,r,Yke,Qke,Et,{color:0})}}function Gke(t){Zt(t,"svelte-1o8ykbq",".date-picker-title-revly__2023.svelte-1o8ykbq{display:flex;justify-content:space-between}.navigationBtn-revly__2023.svelte-1o8ykbq:hover{opacity:0.7}.navigationBtn-revly__2023.svelte-1o8ykbq:disabled{opacity:0.5;cursor:default}.date-picker-headertext-revly__2023.svelte-1o8ykbq{color:var(--fontColor);font-size:14px;font-style:normal;font-weight:500;line-height:20px}.date-picker-date-contaier-revly__2023.svelte-1o8ykbq{display:flex;align-items:center;gap:8px;overflow:scroll;scroll-behavior:smooth;margin-top:12px}.date-picker-date-contaier-revly__2023.svelte-1o8ykbq::-webkit-scrollbar{display:none}.date-picker-btn-revly__2023.svelte-1o8ykbq{box-sizing:border-box;border:1px solid #5e5e5e;background-color:white !important;color:#5e5e5e !important;border-radius:8px;text-align:center;min-width:43px;height:58px;font-size:12px;font-weight:500;line-height:20px;display:flex;flex-direction:column;justify-content:center;align-items:center}.date-picker-btn-revly__2023.svelte-1o8ykbq:hover{border:1px solid var(--primaryColor)}.date-picker-selected-revly__2023.svelte-1o8ykbq{background-color:var(--primaryColor) !important;color:white !important}")}function Lx(t,r,e){const n=t.slice();return n[12]=r[e],n}function Ux(t){let r,e,n=Vx(t[12])+"",i,a,o,s=new Date(t[12]).getUTCDate()+"",u,l,c,f;function d(){return t[10](t[12])}return{c(){r=ie("button"),e=ie("div"),i=Nt(n),a=Le(),o=ie("div"),u=Nt(s),l=Le(),rt(o,"font-size","16px"),h(r,"class","date-picker-btn-revly__2023 svelte-1o8ykbq"),zr(r,"date-picker-selected-revly__2023",t[1]===t[12])},m(v,p){Ce(v,r,p),U(r,e),U(e,i),U(r,a),U(r,o),U(o,u),U(r,l),c||(f=nt(r,"click",d),c=!0)},p(v,p){t=v,p&1&&n!==(n=Vx(t[12])+"")&&tr(i,n),p&1&&s!==(s=new Date(t[12]).getUTCDate()+"")&&tr(u,s),p&3&&zr(r,"date-picker-selected-revly__2023",t[1]===t[12])},d(v){v&&Me(r),c=!1,f()}}}function Hke(t){let r,e,n,i,a,o,s,u,l,c,f,d,v,p,y,k;i=new xx({props:{color:t[3].fontColor}}),c=new Dx({props:{color:t[3].fontColor}});let I=t[0],C=[];for(let L=0;L<I.length;L+=1)C[L]=Ux(Lx(t,I,L));return{c(){r=ie("div"),e=ie("div"),n=ie("button"),Ke(i.$$.fragment),o=Le(),s=ie("div"),s.textContent=`${t[6]()}`,u=Le(),l=ie("button"),Ke(c.$$.fragment),d=Le(),v=ie("div");for(let L=0;L<C.length;L+=1)C[L].c();h(n,"class","navigationBtn-revly__2023 svelte-1o8ykbq"),n.disabled=a=t[5]===0,h(s,"class","date-picker-headertext-revly__2023 svelte-1o8ykbq"),h(l,"class","navigationBtn-revly__2023 svelte-1o8ykbq"),l.disabled=f=t[5]===100,h(e,"class","date-picker-title-revly__2023 svelte-1o8ykbq"),h(v,"class","date-picker-date-contaier-revly__2023 svelte-1o8ykbq")},m(L,R){Ce(L,r,R),U(r,e),U(e,n),Je(i,n,null),U(e,o),U(e,s),U(e,u),U(e,l),Je(c,l,null),U(r,d),U(r,v);for(let q=0;q<C.length;q+=1)C[q].m(v,null);t[11](v),p=!0,y||(k=[nt(n,"click",t[7]),nt(l,"click",t[8]),nt(v,"scroll",t[9])],y=!0)},p(L,[R]){const q={};R&8&&(q.color=L[3].fontColor),i.$set(q),(!p||R&32&&a!==(a=L[5]===0))&&(n.disabled=a);const z={};if(R&8&&(z.color=L[3].fontColor),c.$set(z),(!p||R&32&&f!==(f=L[5]===100))&&(l.disabled=f),R&7){I=L[0];let F;for(F=0;F<I.length;F+=1){const D=Lx(L,I,F);C[F]?C[F].p(D,R):(C[F]=Ux(D),C[F].c(),C[F].m(v,null))}for(;F<C.length;F+=1)C[F].d(1);C.length=I.length}},i(L){p||(_e(i.$$.fragment,L),_e(c.$$.fragment,L),p=!0)},o(L){Ee(i.$$.fragment,L),Ee(c.$$.fragment,L),p=!1},d(L){L&&Me(r),Xe(i),Xe(c),Fa(C,L),t[11](null),y=!1,kr(k)}}}const jx=100;function Vx(t){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date(t).getUTCDay()]}function Jke(t,r,e){let{dates:n}=r,{value:i}=r,{onChange:a}=r,{themeConfig:o}=r,s,u=0;function l(){return`${new Date(n.at(0)).toLocaleDateString("en-US",{day:"numeric",month:"short"})} - ${new Date(n.at(-1)).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}`}function c(){s.scrollLeft>0&&e(4,s.scrollLeft-=jx,s)}function f(){const y=s.scrollWidth-s.clientWidth;s.scrollLeft<y&&e(4,s.scrollLeft+=jx,s)}function d(){e(5,u=s.scrollLeft/(s.scrollWidth-s.clientWidth)*100)}const v=y=>a(y);function p(y){ta[y?"unshift":"push"](()=>{s=y,e(4,s)})}return t.$$set=y=>{"dates"in y&&e(0,n=y.dates),"value"in y&&e(1,i=y.value),"onChange"in y&&e(2,a=y.onChange),"themeConfig"in y&&e(3,o=y.themeConfig)},[n,i,a,o,s,u,l,c,f,d,v,p]}class Xke extends It{constructor(r){super(),Rt(this,r,Jke,Hke,Et,{dates:0,value:1,onChange:2,themeConfig:3},Gke)}}function Kke(t){Zt(t,"svelte-ftbxvh",".time-picker-title-revly__2023.svelte-ftbxvh{display:flex;justify-content:space-between}.time-picker-title-revly__2023.svelte-ftbxvh{display:flex;justify-content:space-between}.navigationBtn-revly__2023.svelte-ftbxvh:hover{opacity:0.7}.navigationBtn-revly__2023.svelte-ftbxvh:disabled{opacity:0.5;cursor:default}.time-picker-headertext-revly__2023.svelte-ftbxvh{color:var(--fontColor);font-size:14px;font-style:normal;font-weight:500;line-height:20px}.time-picker-times-contaier-revly__2023.svelte-ftbxvh{display:flex;align-items:center;flex-wrap:wrap;gap:8px;margin-top:12px;max-height:72px;transition:all 0.5s ease-in-out}.time-picker-times-contaier-revly__2023.svelte-ftbxvh::-webkit-scrollbar{display:none}.time-picker-btn-revly__2023.svelte-ftbxvh{box-sizing:border-box;border:1px solid #5e5e5e;background-color:white !important;color:#5e5e5e !important;border-radius:8px;text-align:center;min-width:76px;height:32px;font-size:12px;font-weight:500;line-height:20px}.time-picker-btn-revly__2023.svelte-ftbxvh:hover{border:1px solid var(--primaryColor)}.time-picker-selected-revly__2023.svelte-ftbxvh{background-color:var(--primaryColor) !important;color:white !important}")}function Fx(t,r,e){const n=t.slice();return n[15]=r[e],n}function eTe(t){let r;return{c(){r=ie("div"),r.textContent="No time slots available",rt(r,"margin","auto"),h(r,"class","time-picker-headertext-revly__2023 svelte-ftbxvh")},m(e,n){Ce(e,r,n)},p:Ge,d(e){e&&Me(r)}}}function tTe(t){let r,e=t[7],n=[];for(let i=0;i<e.length;i+=1)n[i]=$x(Fx(t,e,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();r=Fn()},m(i,a){for(let o=0;o<n.length;o+=1)n[o].m(i,a);Ce(i,r,a)},p(i,a){if(a&134){e=i[7];let o;for(o=0;o<e.length;o+=1){const s=Fx(i,e,o);n[o]?n[o].p(s,a):(n[o]=$x(s),n[o].c(),n[o].m(r.parentNode,r))}for(;o<n.length;o+=1)n[o].d(1);n.length=e.length}},d(i){Fa(n,i),i&&Me(r)}}}function $x(t){let r,e=zx(t[15].startDate)+"",n,i,a,o;function s(){return t[12](t[15])}return{c(){r=ie("button"),n=Nt(e),i=Le(),h(r,"class","time-picker-btn-revly__2023 svelte-ftbxvh"),zr(r,"time-picker-selected-revly__2023",t[1]===t[15].startDate.toString())},m(u,l){Ce(u,r,l),U(r,n),U(r,i),a||(o=nt(r,"click",s),a=!0)},p(u,l){t=u,l&128&&e!==(e=zx(t[15].startDate)+"")&&tr(n,e),l&130&&zr(r,"time-picker-selected-revly__2023",t[1]===t[15].startDate.toString())},d(u){u&&Me(r),a=!1,o()}}}function rTe(t){let r,e,n,i,a,o,s,u,l,c,f,d,v,p,y,k;i=new xx({props:{color:t[3].fontColor}}),c=new Dx({props:{color:t[3].fontColor}});function I(R,q){return R[0].length?tTe:eTe}let C=I(t),L=C(t);return{c(){r=ie("div"),e=ie("div"),n=ie("button"),Ke(i.$$.fragment),o=Le(),s=ie("div"),s.textContent=`${t[9]()}`,u=Le(),l=ie("button"),Ke(c.$$.fragment),d=Le(),v=ie("div"),L.c(),h(n,"class","navigationBtn-revly__2023 svelte-ftbxvh"),n.disabled=a=t[4]===0,h(s,"class","time-picker-headertext-revly__2023 svelte-ftbxvh"),h(l,"class","navigationBtn-revly__2023 svelte-ftbxvh"),l.disabled=f=t[5]>=t[0].length,h(e,"class","time-picker-title-revly__2023 svelte-ftbxvh"),h(v,"class","time-picker-times-contaier-revly__2023 svelte-ftbxvh")},m(R,q){Ce(R,r,q),U(r,e),U(e,n),Je(i,n,null),U(e,o),U(e,s),U(e,u),U(e,l),Je(c,l,null),U(r,d),U(r,v),L.m(v,null),t[13](v),p=!0,y||(k=[nt(n,"click",t[10]),nt(l,"click",t[11])],y=!0)},p(R,[q]){const z={};q&8&&(z.color=R[3].fontColor),i.$set(z),(!p||q&16&&a!==(a=R[4]===0))&&(n.disabled=a);const F={};q&8&&(F.color=R[3].fontColor),c.$set(F),(!p||q&33&&f!==(f=R[5]>=R[0].length))&&(l.disabled=f),C===(C=I(R))&&L?L.p(R,q):(L.d(1),L=C(R),L&&(L.c(),L.m(v,null)))},i(R){p||(_e(i.$$.fragment,R),_e(c.$$.fragment,R),p=!0)},o(R){Ee(i.$$.fragment,R),Ee(c.$$.fragment,R),p=!1},d(R){R&&Me(r),Xe(i),Xe(c),L.d(),t[13](null),y=!1,kr(k)}}}function zx(t){return new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}function nTe(t,r,e){let n,i,{slots:a}=r,{value:o}=r,{onChange:s}=r,{themeConfig:u}=r,l,c=0,f=6;const d=Gv("RevlyScheduler");xr(t,d,C=>e(14,i=C));function v(){return`Time slot ( ${i.duration} mins )`}function p(){c>0&&(e(4,c-=6),e(5,f-=6))}function y(){a.length>f&&(e(4,c+=6),e(5,f+=6))}const k=C=>s(C);function I(C){ta[C?"unshift":"push"](()=>{l=C,e(6,l)})}return t.$$set=C=>{"slots"in C&&e(0,a=C.slots),"value"in C&&e(1,o=C.value),"onChange"in C&&e(2,s=C.onChange),"themeConfig"in C&&e(3,u=C.themeConfig)},t.$$.update=()=>{t.$$.dirty&1&&a!==void 0&&(e(4,c=0),e(5,f=6)),t.$$.dirty&49&&e(7,n=a.slice(c,f))},[a,o,s,u,c,f,l,n,d,v,p,y,k,I]}class iTe extends It{constructor(r){super(),Rt(this,r,nTe,rTe,Et,{slots:0,value:1,onChange:2,themeConfig:3},Kke)}}function aTe(t){Zt(t,"svelte-15hwjtj",".slotpicker-container-revly__2023.svelte-15hwjtj{height:100%;display:flex;flex-direction:column;gap:24px;margin-top:8px}")}function oTe(t){let r,e=yi.getErrorMsgKey(t[10])+"",n;return{c(){r=ie("div"),n=Nt(e)},m(i,a){Ce(i,r,a),U(r,n)},p:Ge,i:Ge,o:Ge,d(i){i&&Me(r)}}}function sTe(t){var a;let r,e,n,i;return r=new Xke({props:{themeConfig:t[2],dates:Object.keys(t[9]),value:t[3],onChange:t[5]}}),n=new iTe({props:{themeConfig:t[2],slots:t[3]?t[9][t[3]]:[],value:(a=t[0])==null?void 0:a.startDate.toString(),onChange:t[1]}}),{c(){Ke(r.$$.fragment),e=Le(),Ke(n.$$.fragment)},m(o,s){Je(r,o,s),Ce(o,e,s),Je(n,o,s),i=!0},p(o,s){var c;const u={};s&4&&(u.themeConfig=o[2]),s&8&&(u.value=o[3]),r.$set(u);const l={};s&4&&(l.themeConfig=o[2]),s&8&&(l.slots=o[3]?o[9][o[3]]:[]),s&1&&(l.value=(c=o[0])==null?void 0:c.startDate.toString()),s&2&&(l.onChange=o[1]),n.$set(l)},i(o){i||(_e(r.$$.fragment,o),_e(n.$$.fragment,o),i=!0)},o(o){Ee(r.$$.fragment,o),Ee(n.$$.fragment,o),i=!1},d(o){Xe(r,o),o&&Me(e),Xe(n,o)}}}function uTe(t){let r,e,n;return e=new Q0({props:{color:t[2].primaryColor}}),{c(){r=ie("div"),Ke(e.$$.fragment),rt(r,"margin","auto")},m(i,a){Ce(i,r,a),Je(e,r,null),n=!0},p(i,a){const o={};a&4&&(o.color=i[2].primaryColor),e.$set(o)},i(i){n||(_e(e.$$.fragment,i),n=!0)},o(i){Ee(e.$$.fragment,i),n=!1},d(i){i&&Me(r),Xe(e)}}}function lTe(t){let r,e,n={ctx:t,current:null,token:null,hasCatch:!0,pending:uTe,then:sTe,catch:oTe,value:9,error:10,blocks:[,,,]};return F1(t[4],n),{c(){r=ie("div"),n.block.c(),h(r,"class","slotpicker-container-revly__2023 svelte-15hwjtj")},m(i,a){Ce(i,r,a),n.block.m(r,n.anchor=null),n.mount=()=>r,n.anchor=null,e=!0},p(i,[a]){t=i,$1(n,t,a)},i(i){e||(_e(n.block),e=!0)},o(i){for(let a=0;a<3;a+=1){const o=n.blocks[a];Ee(o)}e=!1},d(i){i&&Me(r),n.block.d(),n.token=null,n=null}}}function cTe(t,r,e){let{campaignId:n}=r,{onChange:i}=r,{selectedSlot:a}=r,{themeConfig:o}=r,s,u;async function l(){const{data:d}=await Kr.post("visitors/meetings/slots",{campaignId:n,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone});return u=d,f(Object.keys(d).at(0)),d}const c=l(),f=d=>{e(3,s=d),s&&(e(0,a=u[s].at(0)),a&&i(a))};return t.$$set=d=>{"campaignId"in d&&e(6,n=d.campaignId),"onChange"in d&&e(1,i=d.onChange),"selectedSlot"in d&&e(0,a=d.selectedSlot),"themeConfig"in d&&e(2,o=d.themeConfig)},[a,i,o,s,c,f,n]}class fTe extends It{constructor(r){super(),Rt(this,r,cTe,lTe,Et,{campaignId:6,onChange:1,selectedSlot:0,themeConfig:2},aTe)}}function dTe(t){Zt(t,"svelte-1rahgy1",".choose-timeslot-container-revly__2023.svelte-1rahgy1.svelte-1rahgy1{box-sizing:border-box;height:100%;display:flex;flex-direction:column;justify-content:space-between}.connectBtn-revly__2023.svelte-1rahgy1.svelte-1rahgy1{box-sizing:border-box;border-radius:40px !important;background:var(--primaryColor) !important;color:#fff !important;width:100%;display:flex;justify-content:center;align-items:center;gap:4px !important;padding:10px !important;align-self:end;font-size:16px !important}.connectBtn-revly__2023.svelte-1rahgy1>span.svelte-1rahgy1{font-weight:600;line-height:20px}")}function Wx(t){let r,e,n=t[5].isBooking?"Scheduling...":"Confirm",i,a,o,s,u;return{c(){r=ie("button"),e=ie("span"),i=Nt(n),h(e,"class","svelte-1rahgy1"),h(r,"class","connectBtn-revly__2023 svelte-1rahgy1"),h(r,"style",a=`border-radius: ${t[4].buttonBorder} !important`),r.disabled=o=!t[3].startDate},m(l,c){Ce(l,r,c),U(r,e),U(e,i),s||(u=nt(r,"click",t[8]),s=!0)},p(l,c){c&32&&n!==(n=l[5].isBooking?"Scheduling...":"Confirm")&&tr(i,n),c&16&&a!==(a=`border-radius: ${l[4].buttonBorder} !important`)&&h(r,"style",a),c&8&&o!==(o=!l[3].startDate)&&(r.disabled=o)},d(l){l&&Me(r),s=!1,u()}}}function pTe(t){let r,e,n,i;e=new fTe({props:{themeConfig:t[1],campaignId:t[0],selectedSlot:t[3],onChange:t[7]}});let a=t[3]&&Wx(t);return{c(){r=ie("div"),Ke(e.$$.fragment),n=Le(),a&&a.c(),h(r,"class","choose-timeslot-container-revly__2023 svelte-1rahgy1")},m(o,s){Ce(o,r,s),Je(e,r,null),U(r,n),a&&a.m(r,null),i=!0},p(o,[s]){const u={};s&2&&(u.themeConfig=o[1]),s&1&&(u.campaignId=o[0]),s&8&&(u.selectedSlot=o[3]),e.$set(u),o[3]?a?a.p(o,s):(a=Wx(o),a.c(),a.m(r,null)):a&&(a.d(1),a=null)},i(o){i||(_e(e.$$.fragment,o),i=!0)},o(o){Ee(e.$$.fragment,o),i=!1},d(o){o&&Me(r),Xe(e),a&&a.d()}}}function vTe(t,r,e){let n,i,{campaignId:a}=r,{themeConfig:o}=r,{onSubmit:s}=r,u;const l=Gv("RevlyScheduler");xr(t,l,d=>e(5,i=d));const c=d=>e(3,u=d),f=()=>s(u);return t.$$set=d=>{"campaignId"in d&&e(0,a=d.campaignId),"themeConfig"in d&&e(1,o=d.themeConfig),"onSubmit"in d&&e(2,s=d.onSubmit)},t.$$.update=()=>{t.$$.dirty&2&&e(4,n=Uc[o.border])},[a,o,s,u,n,i,l,c,f]}class hTe extends It{constructor(r){super(),Rt(this,r,vTe,pTe,Et,{campaignId:0,themeConfig:1,onSubmit:2},dTe)}}function mTe(t){let r,e,n,i,a,o,s,u,l,c,f,d,v;return{c(){r=qe("svg"),e=qe("g"),n=qe("path"),i=qe("path"),a=qe("path"),o=qe("path"),s=qe("path"),u=qe("path"),l=qe("path"),c=qe("path"),f=qe("defs"),d=qe("clipPath"),v=qe("rect"),h(n,"d","M51.7344 7.96094C51.7344 4.40699 48.843 1.51562 45.2891 1.51562H44V6.78906C44 7.75984 43.213 8.54688 42.2422 8.54688C41.2714 8.54688 40.4844 7.75984 40.4844 6.78906V1.51562H32.75V6.78906C32.75 7.75984 31.963 8.54688 30.9922 8.54688C30.0214 8.54688 29.2344 7.75984 29.2344 6.78906V1.51562H21.5V6.78906C21.5 7.75984 20.713 8.54688 19.7422 8.54688C18.7714 8.54688 17.9844 7.75984 17.9844 6.78906V1.51562H10.25V6.78906C10.25 7.75984 9.46297 8.54688 8.49219 8.54688C7.52141 8.54688 6.73438 7.75984 6.73438 6.78906V1.51562H5.44531C1.89137 1.51562 -1 4.40699 -1 7.96094V13.2344H51.7344V7.96094Z"),h(n,"fill",t[0]),h(i,"d","M10.25 -0.242188C10.25 -1.21297 9.46297 -2 8.49219 -2C7.52141 -2 6.73438 -1.21297 6.73438 -0.242188V1.51562H10.25V-0.242188Z"),h(i,"fill",t[0]),h(a,"d","M44 -0.242188C44 -1.21297 43.213 -2 42.2422 -2C41.2714 -2 40.4844 -1.21297 40.4844 -0.242188V1.51562H44V-0.242188Z"),h(a,"fill",t[0]),h(o,"d","M32.75 -0.242188C32.75 -1.21297 31.963 -2 30.9922 -2C30.0214 -2 29.2344 -1.21297 29.2344 -0.242188V1.51562H32.75V-0.242188Z"),h(o,"fill",t[0]),h(s,"d","M21.5 -0.242188C21.5 -1.21297 20.713 -2 19.7422 -2C18.7714 -2 17.9844 -1.21297 17.9844 -0.242188V1.51562H21.5V-0.242188Z"),h(s,"fill",t[0]),h(u,"d","M46.1094 28.7031C48.0845 28.7031 49.9791 29.0541 51.7344 29.6966V16.75H-1V43.1172C-1 46.025 1.36566 48.3906 4.27344 48.3906H30.033C29.8169 47.3301 29.7031 46.2327 29.7031 45.1094C29.7031 36.063 37.063 28.7031 46.1094 28.7031ZM39.5469 22.9023H42.4766C43.4473 22.9023 44.2344 23.6894 44.2344 24.6602C44.2344 25.6309 43.4473 26.418 42.4766 26.418H39.5469C38.5761 26.418 37.7891 25.6309 37.7891 24.6602C37.7891 23.6894 38.5761 22.9023 39.5469 22.9023ZM29.1172 22.9023H32.0469C33.0177 22.9023 33.8047 23.6894 33.8047 24.6602C33.8047 25.6309 33.0177 26.418 32.0469 26.418H29.1172C28.1464 26.418 27.3594 25.6309 27.3594 24.6602C27.3594 23.6894 28.1464 22.9023 29.1172 22.9023ZM11.1875 42.2383H8.25781C7.28703 42.2383 6.5 41.4513 6.5 40.4805C6.5 39.5097 7.28703 38.7227 8.25781 38.7227H11.1875C12.1583 38.7227 12.9453 39.5097 12.9453 40.4805C12.9453 41.4513 12.1583 42.2383 11.1875 42.2383ZM11.1875 34.3281H8.25781C7.28703 34.3281 6.5 33.5411 6.5 32.5703C6.5 31.5995 7.28703 30.8125 8.25781 30.8125H11.1875C12.1583 30.8125 12.9453 31.5995 12.9453 32.5703C12.9453 33.5411 12.1583 34.3281 11.1875 34.3281ZM21.6172 42.2383H18.6875C17.7167 42.2383 16.9297 41.4513 16.9297 40.4805C16.9297 39.5097 17.7167 38.7227 18.6875 38.7227H21.6172C22.588 38.7227 23.375 39.5097 23.375 40.4805C23.375 41.4513 22.588 42.2383 21.6172 42.2383ZM21.6172 34.3281H18.6875C17.7167 34.3281 16.9297 33.5411 16.9297 32.5703C16.9297 31.5995 17.7167 30.8125 18.6875 30.8125H21.6172C22.588 30.8125 23.375 31.5995 23.375 32.5703C23.375 33.5411 22.588 34.3281 21.6172 34.3281ZM21.6172 26.418H18.6875C17.7167 26.418 16.9297 25.6309 16.9297 24.6602C16.9297 23.6894 17.7167 22.9023 18.6875 22.9023H21.6172C22.588 22.9023 23.375 23.6894 23.375 24.6602C23.375 25.6309 22.588 26.418 21.6172 26.418ZM27.3594 32.5703C27.3594 31.5995 28.1464 30.8125 29.1172 30.8125H32.0469C33.0177 30.8125 33.8047 31.5995 33.8047 32.5703C33.8047 33.5411 33.0177 34.3281 32.0469 34.3281H29.1172C28.1464 34.3281 27.3594 33.5411 27.3594 32.5703Z"),h(u,"fill",t[0]),h(l,"fill-rule","evenodd"),h(l,"clip-rule","evenodd"),h(l,"d","M45 32C51.6268 32 57 37.3732 57 44C57 50.6268 51.6268 56 45 56C38.3732 56 33 50.6268 33 44C33 37.3732 38.3732 32 45 32Z"),h(l,"fill",t[0]),h(c,"d","M36.8679 46.4539C36.4301 46.0647 36.389 45.3987 36.7781 44.9609C37.1635 44.5268 37.8296 44.4857 38.2674 44.8711L42.2561 48.4071L51.1542 37.2827C51.5171 36.8262 52.1794 36.7551 52.6359 37.118C53.0887 37.481 53.1635 38.1433 52.8006 38.5998L43.244 50.5511C43.2215 50.5773 43.1991 50.6073 43.1766 50.6335C42.7912 51.0675 42.1252 51.1087 41.6874 50.7233L36.8679 46.4539Z"),h(c,"fill","white"),h(e,"clip-path","url(#clip0_7523_1713)"),h(v,"width","60"),h(v,"height","60"),h(v,"fill","white"),h(d,"id","clip0_7523_1713"),h(r,"xmlns","http://www.w3.org/2000/svg"),h(r,"width","60"),h(r,"height","60"),h(r,"viewBox","0 0 60 60"),h(r,"fill","none")},m(p,y){Ce(p,r,y),U(r,e),U(e,n),U(e,i),U(e,a),U(e,o),U(e,s),U(e,u),U(e,l),U(e,c),U(r,f),U(f,d),U(d,v)},p(p,[y]){y&1&&h(n,"fill",p[0]),y&1&&h(i,"fill",p[0]),y&1&&h(a,"fill",p[0]),y&1&&h(o,"fill",p[0]),y&1&&h(s,"fill",p[0]),y&1&&h(u,"fill",p[0]),y&1&&h(l,"fill",p[0])},i:Ge,o:Ge,d(p){p&&Me(r)}}}function gTe(t,r,e){let{color:n="#5157E8"}=r;return t.$$set=i=>{"color"in i&&e(0,n=i.color)},[n]}class yTe extends It{constructor(r){super(),Rt(this,r,gTe,mTe,Et,{color:0})}}function bTe(t){Zt(t,"svelte-10r4u0g",".confirmation-container-revly__2023.svelte-10r4u0g{height:100%;text-align:center;display:flex;flex-direction:column;justify-content:center;align-items:center}.success-text-revly__2023.svelte-10r4u0g{color:var(--fontColor);font-size:16px;font-weight:600;line-height:20px;margin-top:12px}.timeslot-text-revly__2023.svelte-10r4u0g{color:var(--fontColor);font-size:12px;font-weight:500;line-height:20px;margin-top:12px}.footer-text-revly__2023.svelte-10r4u0g{color:var(--fontColor);font-size:12px;font-weight:400;line-height:20px;margin-top:32px}")}function _Te(t){let r,e,n,i,a,o,s=Ev(t[1].startDate)+"",u,l,c=Ev(t[1].endDate)+"",f,d,v,p;return e=new yTe({props:{color:t[0].primaryColor}}),{c(){r=ie("div"),Ke(e.$$.fragment),n=Le(),i=ie("div"),i.textContent="Your meeting is confirmed!",a=Le(),o=ie("div"),u=Nt(s),l=Nt(" - "),f=Nt(c),d=Le(),v=ie("div"),v.textContent="A calendar invitation has been sent to your email address",h(i,"class","success-text-revly__2023 svelte-10r4u0g"),h(o,"class","timeslot-text-revly__2023 svelte-10r4u0g"),h(v,"class","footer-text-revly__2023 svelte-10r4u0g"),h(r,"class","confirmation-container-revly__2023 svelte-10r4u0g")},m(y,k){Ce(y,r,k),Je(e,r,null),U(r,n),U(r,i),U(r,a),U(r,o),U(o,u),U(o,l),U(o,f),U(r,d),U(r,v),p=!0},p(y,[k]){const I={};k&1&&(I.color=y[0].primaryColor),e.$set(I),(!p||k&2)&&s!==(s=Ev(y[1].startDate)+"")&&tr(u,s),(!p||k&2)&&c!==(c=Ev(y[1].endDate)+"")&&tr(f,c)},i(y){p||(_e(e.$$.fragment,y),p=!0)},o(y){Ee(e.$$.fragment,y),p=!1},d(y){y&&Me(r),Xe(e)}}}function Ev(t){const r=new Date(t).toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"2-digit"});return`${new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})} ${r}`}function wTe(t,r,e){let{themeConfig:n}=r,{timeslot:i}=r;return t.$$set=a=>{"themeConfig"in a&&e(0,n=a.themeConfig),"timeslot"in a&&e(1,i=a.timeslot)},[n,i]}class kTe extends It{constructor(r){super(),Rt(this,r,wTe,_Te,Et,{themeConfig:0,timeslot:1},bTe)}}function TTe(t){Zt(t,"svelte-yg8ghq",".header-text-revly__2023.svelte-yg8ghq{color:var(--fontColor);text-align:center;font-size:14px;font-weight:400;line-height:20px}")}function STe(t){let r,e;return{c(){r=ie("div"),e=Nt(t[0]),h(r,"class","header-text-revly__2023 svelte-yg8ghq")},m(n,i){Ce(n,r,i),U(r,e)},p(n,[i]){i&1&&tr(e,n[0])},i:Ge,o:Ge,d(n){n&&Me(r)}}}function ETe(t,r,e){let{text:n=""}=r;return t.$$set=i=>{"text"in i&&e(0,n=i.text)},[n]}class MTe extends It{constructor(r){super(),Rt(this,r,ETe,STe,Et,{text:0},TTe)}}function CTe(t){Zt(t,"svelte-4tdncv",".container-revly__2023.svelte-4tdncv{box-sizing:border-box;position:relative;background:var(--fillColor) !important;border:1px solid var(--primaryColor);width:300px;height:408px;padding:24px 24px 16px 24px;display:flex;flex-direction:column;justify-content:space-between;gap:16px;overflow:hidden}.heading-revly__2023.svelte-4tdncv{color:var(--fontColor) !important;display:flex;justify-content:space-between;align-items:center;font-size:16px;font-style:normal;font-weight:500;line-height:20px}.sub-heading-revly__2023.svelte-4tdncv{color:var(--fontColor) !important;font-size:12px;font-style:normal;font-weight:400;line-height:16px;margin-top:8px;margin-right:-3px}.closeBtn-revly__2023.svelte-4tdncv{box-sizing:border-box;background-color:var(--primaryColor);cursor:pointer;width:20px;height:20px;padding:1px}")}function Bx(t){let r;return{c(){r=ie("div"),r.textContent="Please enter the details below to schedule",h(r,"class","sub-heading-revly__2023 svelte-4tdncv")},m(e,n){Ce(e,r,n)},d(e){e&&Me(r)}}}function RTe(t){let r,e;return r=new MTe({props:{text:t[3]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&8&&(a.text=n[3]),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function ITe(t){let r,e;return r=new kTe({props:{themeConfig:t[2],timeslot:t[6].selectedSlot}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&4&&(a.themeConfig=n[2]),i&64&&(a.timeslot=n[6].selectedSlot),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function OTe(t){let r,e;return r=new hTe({props:{campaignId:t[1],themeConfig:t[2],onSubmit:t[9]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&2&&(a.campaignId=n[1]),i&4&&(a.themeConfig=n[2]),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function NTe(t){let r,e;return r=new Fke({props:{campaignId:t[1],onSubmit:t[8]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&2&&(a.campaignId=n[1]),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function ATe(t){let r,e,n,i,a=Zx(t[4])+"",o,s,u,l,c,f,d,v,p,y,k,I,C,L,R;l=new yo({});let q=t[4]===1&&Bx();const z=[NTe,OTe,ITe,RTe],F=[];function D(W,X){return W[4]===1?0:W[4]==2?1:W[4]==3&&W[6].selectedSlot?2:W[4]===4?3:-1}return~(v=D(t))&&(p=F[v]=z[v](t)),k=new Bke({props:{utmParams:{source:"scheduler-form"}}}),{c(){r=ie("div"),e=ie("div"),n=ie("div"),i=ie("span"),o=Nt(a),s=Le(),u=ie("div"),Ke(l.$$.fragment),f=Le(),q&&q.c(),d=Le(),p&&p.c(),y=Le(),Ke(k.$$.fragment),h(u,"class","closeBtn-revly__2023 svelte-4tdncv"),h(u,"style",c=`border-radius: ${t[5].closeBtnBorder} !important`),h(n,"class","heading-revly__2023 svelte-4tdncv"),h(r,"class","container-revly__2023 svelte-4tdncv"),h(r,"style",I=`border-radius: ${t[5].frameBorder} !important`),rt(r,"--primaryColor",t[2].primaryColor),rt(r,"--fillColor",t[2].fillColor),rt(r,"--fontColor",t[2].fontColor)},m(W,X){Ce(W,r,X),U(r,e),U(e,n),U(n,i),U(i,o),U(n,s),U(n,u),Je(l,u,null),U(e,f),q&&q.m(e,null),U(r,d),~v&&F[v].m(r,null),U(r,y),Je(k,r,null),C=!0,L||(R=nt(u,"click",Ju(function(){Mn(t[0])&&t[0].apply(this,arguments)})),L=!0)},p(W,[X]){t=W,(!C||X&16)&&a!==(a=Zx(t[4])+"")&&tr(o,a),(!C||X&32&&c!==(c=`border-radius: ${t[5].closeBtnBorder} !important`))&&h(u,"style",c),t[4]===1?q||(q=Bx(),q.c(),q.m(e,null)):q&&(q.d(1),q=null);let me=v;v=D(t),v===me?~v&&F[v].p(t,X):(p&&(ar(),Ee(F[me],1,1,()=>{F[me]=null}),or()),~v?(p=F[v],p?p.p(t,X):(p=F[v]=z[v](t),p.c()),_e(p,1),p.m(r,y)):p=null),(!C||X&32&&I!==(I=`border-radius: ${t[5].frameBorder} !important`))&&h(r,"style",I),X&4&&rt(r,"--primaryColor",t[2].primaryColor),X&4&&rt(r,"--fillColor",t[2].fillColor),X&4&&rt(r,"--fontColor",t[2].fontColor)},i(W){C||(_e(l.$$.fragment,W),_e(p),_e(k.$$.fragment,W),C=!0)},o(W){Ee(l.$$.fragment,W),Ee(p),Ee(k.$$.fragment,W),C=!1},d(W){W&&Me(r),Xe(l),q&&q.d(),~v&&F[v].d(),Xe(k),L=!1,R()}}}function Zx(t){return t===4?"Thank You!":t===3?"Meeting Scheduled":t===2?"Choose Date & Time":"Enter Details"}function PTe(t,r,e){let n,i,{onClose:a}=r,{campaignId:o}=r,{themeConfig:s}=r,{disqualificationText:u=""}=r,l,c=[],f=1;const d=ra({duration:0,themeConfig:s,campaignId:o,isBooking:!1,disqualificationText:u});xr(t,d,k=>e(6,i=k)),qD("RevlyScheduler",d);const v=k=>e(4,f=k);async function p(k,I){if(c=I,l=k,go(bi.Scheduler,_v.FilledSchedulerForm,{visitorEmails:I,visitorDetails:k,campaignId:o}),!await Mr.waitForQWidgetScheduler(o)){v(4);return}const{qualify:L}=await Mr.waitForQfieldApi(o);if(!L){v(4);return}v(2)}async function y(k){gs(d,i.isBooking=!0,i),gs(d,i.selectedSlot=k,i);try{const{data:I}=await Kr.post("visitors/meetings/booking",{slot:k,campaignId:o,visitors:c,formData:l});return v(3),go(bi.Scheduler,_v.ScheduledMeeting,{slot:k,campaignId:o,visitorEmails:c}),I}catch{}finally{gs(d,i.isBooking=!1,i)}}return t.$$set=k=>{"onClose"in k&&e(0,a=k.onClose),"campaignId"in k&&e(1,o=k.campaignId),"themeConfig"in k&&e(2,s=k.themeConfig),"disqualificationText"in k&&e(3,u=k.disqualificationText)},t.$$.update=()=>{t.$$.dirty&4&&e(5,n=Uc[s.border])},[a,o,s,u,f,n,i,d,p,y]}class qx extends It{constructor(r){super(),Rt(this,r,PTe,ATe,Et,{onClose:0,campaignId:1,themeConfig:2,disqualificationText:3},CTe)}}function xTe(t){let r,e;return r=new mke({props:{templateConfig:t[2].templateConfig,agents:t[3].availableAgentsProfile,displayImage:t[8],callDescription:t[10],schedulerDescription:t[9],footerLink:t[7],uiConfig:t[2],isMinimized:t[3].isMinimized,isSchedulerEnable:[Wa.ExternalLink,Wa.Revly].includes(t[2].scheduler.type),availableAgentCount:t[3].availableAgentCount,onCall:t[11],onSchedule:t[12],onMaximized:t[16],onMinimized:t[17]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&4&&(a.templateConfig=n[2].templateConfig),i&8&&(a.agents=n[3].availableAgentsProfile),i&256&&(a.displayImage=n[8]),i&1024&&(a.callDescription=n[10]),i&512&&(a.schedulerDescription=n[9]),i&128&&(a.footerLink=n[7]),i&4&&(a.uiConfig=n[2]),i&8&&(a.isMinimized=n[3].isMinimized),i&4&&(a.isSchedulerEnable=[Wa.ExternalLink,Wa.Revly].includes(n[2].scheduler.type)),i&8&&(a.availableAgentCount=n[3].availableAgentCount),i&1&&(a.onMaximized=n[16]),i&1&&(a.onMinimized=n[17]),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function DTe(t){let r,e;return r=new qx({props:{onClose:t[15],themeConfig:t[2].templateConfig.themeConfig,disqualificationText:t[2].schedulerDisqualificationText,campaignId:t[1]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&32&&(a.onClose=n[15]),i&4&&(a.themeConfig=n[2].templateConfig.themeConfig),i&4&&(a.disqualificationText=n[2].schedulerDisqualificationText),i&2&&(a.campaignId=n[1]),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function LTe(t){var n;let r,e;return r=new Mx({props:{themeConfig:t[2].templateConfig.themeConfig,onClose:t[14],initCallOptions:{campaignId:t[1],enableQueuing:!1,callSettings:t[6],disqualificationText:((n=t[2])==null?void 0:n.callDisqualificationText)||""},config:t[6].visitorDetailsForm.formJson}}),{c(){Ke(r.$$.fragment)},m(i,a){Je(r,i,a),e=!0},p(i,a){var s;const o={};a&4&&(o.themeConfig=i[2].templateConfig.themeConfig),a&16&&(o.onClose=i[14]),a&70&&(o.initCallOptions={campaignId:i[1],enableQueuing:!1,callSettings:i[6],disqualificationText:((s=i[2])==null?void 0:s.callDisqualificationText)||""}),a&64&&(o.config=i[6].visitorDetailsForm.formJson),r.$set(o)},i(i){e||(_e(r.$$.fragment,i),e=!0)},o(i){Ee(r.$$.fragment,i),e=!1},d(i){Xe(r,i)}}}function UTe(t){let r,e,n,i;const a=[LTe,DTe,xTe],o=[];function s(u,l){return u[4]?0:u[5]?1:u[2].template===1?2:-1}return~(r=s(t))&&(e=o[r]=a[r](t)),{c(){e&&e.c(),n=Fn()},m(u,l){~r&&o[r].m(u,l),Ce(u,n,l),i=!0},p(u,[l]){let c=r;r=s(u),r===c?~r&&o[r].p(u,l):(e&&(ar(),Ee(o[c],1,1,()=>{o[c]=null}),or()),~r?(e=o[r],e?e.p(u,l):(e=o[r]=a[r](u),e.c()),_e(e,1),e.m(n.parentNode,n)):e=null)},i(u){i||(_e(e),i=!0)},o(u){Ee(e),i=!1},d(u){~r&&o[r].d(u),u&&Me(n)}}}function jTe(t,r,e){let n,i,a,o,s,u,l,c,f;xr(t,Ts,q=>e(3,f=q));let{handleFloaterEvent:d}=r,v=!1,p=!1;async function y(){fx()||(d(ps.ClickedCallBtn),i&&(o.visitorDetailsForm.isEnable?e(4,v=!0):await Mr.initCall({campaignId:i,enableQueuing:!1,callSettings:o,disqualificationText:(a==null?void 0:a.callDisqualificationText)||""})))}async function k(){a.scheduler.type===Wa.ExternalLink?window.open(a.scheduler.link,"_blank"):px(i),d(ps.ClickedSchedulerBtn)}const I=()=>e(4,v=!1),C=()=>e(5,p=!1),L=()=>d(ps.FloaterMaximized),R=()=>d(ps.FloaterMinimized);return t.$$set=q=>{"handleFloaterEvent"in q&&e(0,d=q.handleFloaterEvent)},t.$$.update=()=>{var q;t.$$.dirty&8&&e(13,n=f.availableAgentsProfile.find(z=>z.isAvailble)),t.$$.dirty&8&&e(1,i=f.campaignId),t.$$.dirty&8&&e(2,a=f.uiConfig),t.$$.dirty&8&&e(6,o=f.callSettings),t.$$.dirty&8196&&e(10,s=a==null?void 0:a.templateConfig.callDescriptionText.replaceAll("{{agent_name}}",n==null?void 0:n.name).replaceAll("{{designation}}",n==null?void 0:n.designation)),t.$$.dirty&8196&&e(9,u=a==null?void 0:a.scheduler.description.replaceAll("{{agent_name}}",n==null?void 0:n.name).replaceAll("{{designation}}",n==null?void 0:n.designation)),t.$$.dirty&8204&&e(8,l=(a.templateConfig.imageType===Tv.Agent?n==null?void 0:n.profilePic:(q=f.availableAgentsProfile.find(z=>z.role.includes(Cx.Admin)))==null?void 0:q.profilePic)||B0),t.$$.dirty&2&&e(7,c=wv({...i&&{campaignId:i},source:"floater"}))},[d,i,a,f,v,p,o,c,l,u,s,y,k,n,I,C,L,R]}class VTe extends It{constructor(r){super(),Rt(this,r,jTe,UTe,Et,{handleFloaterEvent:0})}}function FTe(t){Zt(t,"svelte-1tysbgv",".floater-parent-revly__2023.svelte-1tysbgv{position:fixed;z-index:9995;display:flex;justify-content:flex-end;align-items:flex-end}.top-left-revly__2023.svelte-1tysbgv{top:16px;left:16px}.top-right-revly__2023.svelte-1tysbgv{top:16px;right:16px}.bottom-left-revly__2023.svelte-1tysbgv{bottom:16px;left:16px}.bottom-right-revly__2023.svelte-1tysbgv{bottom:16px;right:16px}@media(max-width: 550px){.floater-parent-revly__2023.svelte-1tysbgv:not(:has(.minimized-floater-revly__2023)){transform:scale(var(--scale));margin:calc(-15px + var(--margin)) var(--margin)}}")}function Qx(t){let r,e,n,i;return e=new VTe({props:{handleFloaterEvent:t[8]}}),{c(){r=ie("div"),Ke(e.$$.fragment),h(r,"class",an(`floater-parent-revly__2023 ${t[0]()}`)+" svelte-1tysbgv"),rt(r,"--scale",Math.min(1,t[5])),rt(r,"--margin",`-${(t[1]*(1-t[5])/2).toFixed()}px`)},m(a,o){Ce(a,r,o),Je(e,r,null),i=!0},p(a,o){t=a,o&32&&rt(r,"--scale",Math.min(1,t[5])),o&34&&rt(r,"--margin",`-${(t[1]*(1-t[5])/2).toFixed()}px`)},i(a){i||(_e(e.$$.fragment,a),n||Cn(()=>{n=th(r,xa,{y:t[4].startsWith("top")?-200:200,easing:zwe}),n.start()}),i=!0)},o(a){Ee(e.$$.fragment,a),i=!1},d(a){a&&Me(r),Xe(e)}}}function Yx(t){let r,e,n=!t[6].visible&&!t[7].visible&&t[2].visible&&t[3]&&Qx(t);return{c(){n&&n.c(),r=Fn()},m(i,a){n&&n.m(i,a),Ce(i,r,a),e=!0},p(i,a){!i[6].visible&&!i[7].visible&&i[2].visible&&i[3]?n?(n.p(i,a),a&204&&_e(n,1)):(n=Qx(i),n.c(),_e(n,1),n.m(r.parentNode,r)):n&&(ar(),Ee(n,1,1,()=>{n=null}),or())},i(i){e||(_e(n),e=!0)},o(i){Ee(n),e=!1},d(i){n&&n.d(i),i&&Me(r)}}}function $Te(t){let r=t[4],e,n,i=Yx(t);return{c(){i.c(),e=Fn()},m(a,o){i.m(a,o),Ce(a,e,o),n=!0},p(a,[o]){o&16&&Et(r,r=a[4])?(ar(),Ee(i,1,1,Ge),or(),i=Yx(a),i.c(),_e(i,1),i.m(e.parentNode,e)):i.p(a,o)},i(a){n||(_e(i),n=!0)},o(a){Ee(i),n=!1},d(a){a&&Me(e),i.d(a)}}}function zTe(t,r,e){let n,i,a,o,s,u,l,c;xr(t,Ts,y=>e(2,u=y)),xr(t,Wt,y=>e(6,l=y)),xr(t,_r,y=>e(7,c=y));let f=0,d=null;function v(){return n===rl.TopLeft?"top-left-revly__2023":n===rl.TopRight?"top-right-revly__2023":n===rl.bottomLeft?"bottom-left-revly__2023":"bottom-right-revly__2023"}async function p(y){y===ps.FloaterMinimized?(ui.set(sh,"YES"),Ts.update(C=>({...C,isMinimized:!0}))):y===ps.FloaterMaximized&&(ui.set(sh,"NO"),Ts.update(C=>({...C,isMinimized:!1})));let k=u.availableAgentsProfile.at(0);const I={campaignId:u.campaignId,campaignType:_s.FloatingButton,...k&&{agentId:k.id}};await go(bi.Floater,y,I)}return ea(()=>{d=setInterval(()=>{f++,f>=u.uiConfig.delayInSec&&(e(3,s=!0),d&&clearInterval(d))},1e3)}),Ku(()=>{d&&clearInterval(d)}),t.$$.update=()=>{var y;t.$$.dirty&4&&e(4,n=(y=u.uiConfig)==null?void 0:y.position),t.$$.dirty&514&&e(5,o=+(i/a).toFixed(1))},e(9,i=window.innerWidth*.6),e(1,a=300),e(3,s=!1),[v,a,u,s,n,o,l,c,p,i]}class WTe extends It{constructor(r){super(),Rt(this,r,zTe,$Te,Et,{getPosition:0},FTe)}get getPosition(){return this.$$.ctx[0]}}const BTe="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEwNThfMTE0MzcpIj4KPHBhdGggb3BhY2l0eT0iMC40IiBkPSJNMTQuMTg5NCAxMy42MTY5QzEzLjc0NTcgMTMuMDY0IDEyLjkzODcgMTIuOTc0OCAxMi4zODUyIDEzLjQxNzhMMTEuMjYxNiAxNC4zMTY3VjkuOTI1MDZDMTEuMjYxNiA5LjIxNTYxIDEwLjY4NyA4LjY0MDk2IDkuOTc3NTIgOC42NDA5NkM5LjI2ODA3IDguNjQwOTYgOC42OTM0MiA5LjIxNTYxIDguNjkzNDIgOS45MjUwNlYxNC4zMTY3TDcuNTY5ODMgMTMuNDE3OEM3LjAwMjg3IDEyLjk5MjIgNi4xOTc3NiAxMy4xMDY0IDUuNzcyMDkgMTMuNjczNEM1LjM2NTAyIDE0LjIxNTMgNS40NDkxMiAxNC45ODA2IDUuOTY0NzEgMTUuNDIxTDkuMTc0OTggMTcuOTg5MkM5LjY0NDMyIDE4LjM2NDggMTAuMzEwOCAxOC4zNjQ4IDEwLjc4MDEgMTcuOTg5MkwxMy45OTA0IDE1LjQyMUMxNC41NDMxIDE0Ljk3OCAxNC42MzI0IDE0LjE3MDMgMTQuMTg5NCAxMy42MTY5WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTIuNjY0NTMgMy4wMjI5NUMxLjI5MDU1IDMuNTQzMDMgMC4wMzg1MTU2IDQuNDI5MDkgMCA1LjY4NzQ5QzAuMDE0NzY1NiA2LjM4Mjg0IDAuMDY2MTMyOCA3LjA3NzUyIDAuMTU0MTAyIDcuNzY3NzZDMC4yMzExMzMgOC40NDA2NSAwLjgzOTE4IDguOTIzNDYgMS41MTIwMyA4Ljg0NjM5QzEuNTI4MDkgOC44NDQ0OCAxLjU0NDE0IDguODQyNTIgMS41NjAyIDguODM5OTlMNS40MTI1NCA4LjIzMDAyQzUuODk2NjQgOC4xNTIzMyA2LjI4ODMyIDcuNzk0MDkgNi40MDc3MyA3LjMxODMxTDYuOTA4NTYgNS4zMjc5NUM4LjgyNzY2IDQuOTU5NCAxMC43OTc1IDQuOTMzNzQgMTIuNzI1NiA1LjI1MDkyTDEzLjA4NTEgNS4zMDg3TDEzLjU5MjMgNy4zMTE5QzEzLjcxMTggNy43ODc2OCAxNC4xMDM0IDguMTQ1OTIgMTQuNTg3NSA4LjIyMzYyTDE4LjQzOTkgOC44MzM1OEMxOS4xMDg5IDguOTM3NiAxOS43MzU1IDguNDc4NTQgMTkuODM5NiA3LjgwOTUyQzE5Ljg0MjEgNy43OTM0NiAxOS44NDQxIDcuNzc3NDEgMTkuODQ2IDcuNzYxMzVDMTkuOTMzOSA3LjA3MTE2IDE5Ljk4NTMgNi4zNzY0MyAyMC4wMDAxIDUuNjgxMDhDMTkuOTYxNiA0LjM5Njk4IDE4LjcxNiAzLjU3NTE0IDE3LjMzNTUgMy4wMTY1NUMxMy4wNzg3IDEuMjU3MzMgNy4wNzU0MyAxLjM0MDc3IDIuNjY0NTMgMy4wMjI5NVoiIGZpbGw9IndoaXRlIi8+CjwvZz4KPGRlZnM+CjxjbGlwUGF0aCBpZD0iY2xpcDBfMTA1OF8xMTQzNyI+CjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K";var Da=(t=>(t.Default="default-closed",t.Decline="decline-closed",t.LostInternet="lost-internet-closed",t.TabLeaved="tab-leaved-closed",t.TabClosed="tab-closed",t.CallAccepted="call-accepted-closed",t))(Da||{});function ZTe(t){Zt(t,"svelte-11eqy4u",".container-revly__2023.svelte-11eqy4u{position:relative;display:flex;justify-content:center;align-items:center}img.svelte-11eqy4u{border-radius:50%;height:180px;width:180px}.svg-ring.svelte-11eqy4u{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);z-index:1;height:180px;width:180px}svg.svelte-11eqy4u{transform:scale(1.28)}circle.svelte-11eqy4u{transition:stroke-dasharray 1s linear;stroke-width:1;fill:transparent;stroke-linecap:round}.donut-segment.svelte-11eqy4u{stroke:#f1b69a}")}function qTe(t){let r,e,n,i,a;return{c(){r=ie("div"),e=ie("img"),i=Le(),a=ie("div"),a.innerHTML='<svg viewBox="0 0 40 40" class="donut svelte-11eqy4u"><circle id="c1" class="donut-segment donut-segment svelte-11eqy4u" cx="20" cy="20" r="15.9" fill="transparent" stroke-dasharray="100 0" stroke-dashoffset="25"></circle></svg>',Jt(e.src,n=t[0])||h(e,"src",n),h(e,"alt","agentCallIncomingIconIcon"),h(e,"class","svelte-11eqy4u"),h(a,"class","svg-ring svelte-11eqy4u"),h(r,"class","container-revly__2023 svelte-11eqy4u")},m(o,s){Ce(o,r,s),U(r,e),U(r,i),U(r,a)},p(o,[s]){s&1&&!Jt(e.src,n=o[0])&&h(e,"src",n)},i:Ge,o:Ge,d(o){o&&Me(r)}}}function QTe(t,r,e){let{timer:n=15}=r,{agentImage:i=B0}=r,a;function o(s){var u=s,l=1,c=0,f=100;l++,a=setInterval(function(){if(l>u){clearInterval(a);return}c=l/s*100,f=100-c,document.getElementById("c1").style.strokeDasharray=`${[f,c]}`,l++},1e3)}return o(n),Ku(()=>{a&&clearInterval(a)}),t.$$set=s=>{"timer"in s&&e(1,n=s.timer),"agentImage"in s&&e(0,i=s.agentImage)},[i,n]}class YTe extends It{constructor(r){super(),Rt(this,r,QTe,qTe,Et,{timer:1,agentImage:0},ZTe)}}var Y0=(t=>(t.LeftBottom="left_bottom",t.RightBottom="right_bottom",t.Center="center",t))(Y0||{});function GTe(t){Zt(t,"svelte-1dnqr76","h4.svelte-1dnqr76.svelte-1dnqr76,p.svelte-1dnqr76.svelte-1dnqr76,img.svelte-1dnqr76.svelte-1dnqr76,button.svelte-1dnqr76.svelte-1dnqr76{margin:0;padding:0}.modal-revly__2023.svelte-1dnqr76.svelte-1dnqr76{position:fixed;top:0;right:0;bottom:0;left:0;z-index:9999}.backdrop-revly__2023.svelte-1dnqr76.svelte-1dnqr76{background:rgba(0, 0, 0, 0.6)}.container-revly__2023.svelte-1dnqr76.svelte-1dnqr76{box-sizing:border-box;padding:24px;word-break:break-word;text-align:center;font-style:normal;display:flex;flex-direction:column;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);gap:16px;border-radius:24px;width:384px;border:2px solid #f1b69a;background:#1c1c1c !important}.left-bottom-revly__2023.svelte-1dnqr76.svelte-1dnqr76{left:20px;bottom:20px;top:auto;transform:none}.right-bottom-revly__2023.svelte-1dnqr76.svelte-1dnqr76{right:20px;bottom:20px;left:auto;top:auto;transform:none}.description-revly__2023.svelte-1dnqr76.svelte-1dnqr76{font-size:16px !important;line-height:24px;text-align:center;color:#dadada !important;font-weight:500}.profileImage-revly__2023.svelte-1dnqr76.svelte-1dnqr76{display:flex;justify-content:center;align-items:center}.footer-revly__2023.svelte-1dnqr76.svelte-1dnqr76{display:flex;justify-content:center;align-items:center;gap:4px;font-size:10px;font-weight:500;margin-bottom:-14px}.poweredby-revly__2023.svelte-1dnqr76.svelte-1dnqr76{color:#d1d1d1 !important }.call-action-container.svelte-1dnqr76.svelte-1dnqr76{display:flex;justify-content:center;align-items:center;gap:24px}button.svelte-1dnqr76.svelte-1dnqr76{border-radius:50% !important;width:64px;height:64px;display:flex;justify-content:center;align-items:center}.button-reject-revly__2023.svelte-1dnqr76.svelte-1dnqr76{background:#e52810 !important;box-shadow:9.6px 9.6px 16px 0px rgba(238, 42, 17, 0.3)}.button-accept-revly__2023.svelte-1dnqr76.svelte-1dnqr76{background:#16c872;box-shadow:9.6px 9.6px 16px 0px rgba(20, 163, 94, 0.3)}button.svelte-1dnqr76>img.svelte-1dnqr76{width:32px}.button-accept-revly__2023.svelte-1dnqr76>img.svelte-1dnqr76{transform:translateY(2px);transform-origin:center;animation:svelte-1dnqr76-vibration 1s infinite}@keyframes svelte-1dnqr76-vibration{0%{transform:translateY(0)}25%{transform:translateY(-2px)}50%{transform:translateY(2px)}75%{transform:translateY(-2px)}100%{transform:translateY(0)}}@media(max-width: 550px){.container-revly__2023.svelte-1dnqr76.svelte-1dnqr76{width:calc(100% - 64px);max-width:320px;padding:16px}.description-revly__2023.svelte-1dnqr76.svelte-1dnqr76{font-size:12px !important;line-height:18px}button.svelte-1dnqr76.svelte-1dnqr76{width:48px;height:48px}button.svelte-1dnqr76>img.svelte-1dnqr76{width:18px}}")}function HTe(t){var D,W;let r,e,n,i,a,o,s,u,l,c,f,d,v,p,y,k,I,C,L,R,q,z,F;return n=new YTe({props:{agentImage:(D=t[3])==null?void 0:D.profilePic,timer:(W=t[2])==null?void 0:W.closeInSec}}),R=new Lc({props:{height:"17px",width:"63px"}}),{c(){var X,me;r=ie("div"),e=ie("div"),Ke(n.$$.fragment),i=Le(),a=ie("h4"),o=Nt(t[1]),s=Le(),u=ie("div"),l=ie("button"),c=ie("img"),d=Le(),v=ie("button"),p=ie("img"),k=Le(),I=ie("div"),C=ie("p"),C.textContent=`${Cr.powered_by}`,L=Le(),Ke(R.$$.fragment),h(a,"class","description-revly__2023 svelte-1dnqr76"),Jt(c.src,f=BTe)||h(c,"src",f),h(c,"alt","call-reject-icon"),h(c,"class","svelte-1dnqr76"),h(l,"class","button-reject-revly__2023 svelte-1dnqr76"),Jt(p.src,y=kv)||h(p,"src",y),h(p,"alt","call-accept-icon"),h(p,"class","svelte-1dnqr76"),h(v,"class","button-accept-revly__2023 svelte-1dnqr76"),h(u,"class","call-action-container svelte-1dnqr76"),h(C,"class","poweredby-revly__2023 svelte-1dnqr76"),h(I,"class","footer-revly__2023 svelte-1dnqr76"),h(e,"class","container-revly__2023 "+t[5]((X=t[2])==null?void 0:X.position)+" svelte-1dnqr76"),h(r,"class","modal-revly__2023 "+((me=t[2])!=null&&me.isBackdrop?"backdrop-revly__2023":"")+" svelte-1dnqr76")},m(X,me){Ce(X,r,me),U(r,e),Je(n,e,null),U(e,i),U(e,a),U(a,o),U(e,s),U(e,u),U(u,l),U(l,c),U(u,d),U(u,v),U(v,p),U(e,k),U(e,I),U(I,C),U(I,L),Je(R,I,null),q=!0,z||(F=[nt(l,"click",t[6]),nt(v,"click",t[4])],z=!0)},p(X,[me]){(!q||me&2)&&tr(o,X[1])},i(X){q||(_e(n.$$.fragment,X),_e(R.$$.fragment,X),q=!0)},o(X){Ee(n.$$.fragment,X),Ee(R.$$.fragment,X),q=!1},d(X){X&&Me(r),Xe(n),Xe(R),z=!1,kr(F)}}}function JTe(t,r,e){var D;let n,i,a,o;xr(t,fs,W=>e(12,o=W));let{onClose:s}=r;const{uiConfig:u,campaignId:l,config:c,agentInfo:f,callSettings:d}=o;let v,p;async function y(){if(!l)return;const W=l;s(Da.CallAccepted),await Mr.initCall({campaignId:W,isIncommingCall:!0,callSettings:d,disqualificationText:(u==null?void 0:u.callDisqualificationText)||""})}async function k(){let W=(u==null?void 0:u.closeInSec)||10;v=setInterval(()=>{W-=1,W===0&&(clearInterval(v),s(Da.Default))},1e3)}function I(){p=setTimeout(()=>s(Da.TabLeaved),n*1e3)}function C(){p=setTimeout(()=>{s(Da.LostInternet)},i*1e3)}function L(){s(Da.TabClosed)}function R(){p&&clearTimeout(p)}function q(W){switch(W){case Y0.LeftBottom:return"left-bottom-revly__2023";case Y0.RightBottom:return"right-bottom-revly__2023";default:return""}}const z=new Audio(u==null?void 0:u.ringtone);(D=u==null?void 0:u.ringtone)!=null&&D.includes("ringtone")&&(z.loop=!0),z.volume=.8,ea(()=>{z.play(),k(),window.addEventListener("blur",I),window.addEventListener("focus",R),window.addEventListener("offline",C),window.addEventListener("online",R),window.addEventListener("beforeunload",L),gi&&window.addEventListener("pagehide",L)}),Ku(()=>{z.pause(),clearInterval(v),window.removeEventListener("blur",I),window.removeEventListener("focus",R),window.removeEventListener("offline",C),window.removeEventListener("online",R),window.removeEventListener("beforeunload",L),gi&&window.removeEventListener("pagehide",L)});const F=()=>s(Da.Decline);return t.$$set=W=>{"onClose"in W&&e(0,s=W.onClose)},n=c.inactiveCloseInSec,i=c.lostInternetCloseInSec,e(1,a=u==null?void 0:u.description.replaceAll("{{agent_name}}",f==null?void 0:f.name).replaceAll("{{designation}}",f==null?void 0:f.designation)),[s,a,u,f,y,q,F]}let XTe=class extends It{constructor(r){super(),Rt(this,r,JTe,HTe,Et,{onClose:0},GTe)}};function Gx(t){let r,e;return r=new XTe({props:{onClose:t[2]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p:Ge,i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function KTe(t){let r,e,n=!t[1].visible&&t[0].visible&&Gx(t);return{c(){n&&n.c(),r=Fn()},m(i,a){n&&n.m(i,a),Ce(i,r,a),e=!0},p(i,[a]){!i[1].visible&&i[0].visible?n?(n.p(i,a),a&3&&_e(n,1)):(n=Gx(i),n.c(),_e(n,1),n.m(r.parentNode,r)):n&&(ar(),Ee(n,1,1,()=>{n=null}),or())},i(i){e||(_e(n),e=!0)},o(i){Ee(n),e=!1},d(i){n&&n.d(i),i&&Me(r)}}}function eSe(t,r,e){let n,i;xr(t,fs,o=>e(0,n=o)),xr(t,Wt,o=>e(1,i=o));async function a(o){var u;const s={campaignId:n.campaignId,reason:o,agentId:(u=n.agentInfo)==null?void 0:u.id};ax.reset(),[Da.LostInternet,Da.CallAccepted].includes(o)||await go(bi.IncomingPopup,"popup-closed",s)}return[n,i,a]}class tSe extends It{constructor(r){super(),Rt(this,r,eSe,KTe,Et,{})}}const Hx="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIHZpZXdCb3g9IjAgMCA5MCA5MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQ1IDE2LjI5NzdDNDMuNDk5OSAxNi4yOTc3IDQyLjI4MzcgMTUuMDgxNyA0Mi4yODM3IDEzLjU4MTRWMi43MTYzNUM0Mi4yODM3IDEuMjE2MDUgNDMuNDk5OSAwIDQ1IDBDNDYuNTAwMSAwIDQ3LjcxNjQgMS4yMTYwNSA0Ny43MTY0IDIuNzE2MzVWMTMuNTgxNkM0Ny43MTY0IDE1LjA4MTcgNDYuNTAwMSAxNi4yOTc3IDQ1IDE2LjI5NzdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNjcuNSA2LjAyODg4QzY4Ljc5OTIgNi43Nzg5MyA2OS4yNDQzIDguNDQwMjQgNjguNDk0MiA5LjczOTQ0TDYzLjA2MTcgMTkuMTQ5QzYyLjMxMTYgMjAuNDQ4MiA2MC42NTAzIDIwLjg5MzMgNTkuMzUxMSAyMC4xNDMyQzU4LjA1MTkgMTkuMzkzMiA1Ny42MDY5IDE3LjczMTkgNTguMzU2OSAxNi40MzI3TDYzLjc4OTQgNy4wMjMwOUM2NC41Mzk1IDUuNzI0MDcgNjYuMjAwOCA1LjI3ODgyIDY3LjUgNi4wMjg4OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0zMC42NDg5IDIwLjE0M0MyOS4zNDk3IDIwLjg5MzEgMjcuNjg4NCAyMC40NDggMjYuOTM4MyAxOS4xNDg4TDIxLjUwNTggOS43MzkyNEMyMC43NTU3IDguNDQwMDQgMjEuMjAwOCA2Ljc3ODczIDIyLjUgNi4wMjg2N0MyMy43OTkyIDUuMjc4NjEgMjUuNDYwNSA1LjcyMzY5IDI2LjIxMDYgNy4wMjI4OUwzMS42NDMxIDE2LjQzMjVDMzIuMzkzMSAxNy43MzE3IDMxLjk0ODEgMTkuMzkzIDMwLjY0ODkgMjAuMTQzWiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC45Ii8+CjxwYXRoIGQ9Ik0yMC4xNDMxIDMwLjY0ODhDMTkuMzkzMSAzMS45NDggMTcuNzMxOCAzMi4zOTMxIDE2LjQzMjYgMzEuNjQzTDcuMDIzMDEgMjYuMjEwNUM1LjcyMzgxIDI1LjQ2MDQgNS4yNzg3MyAyMy43OTkxIDYuMDI4NzkgMjIuNDk5OUM2Ljc3ODg1IDIxLjIwMDcgOC40NDAxNiAyMC43NTU3IDkuNzM5MzYgMjEuNTA1N0wxOS4xNDg5IDI2LjkzODJDMjAuNDQ4MSAyNy42ODgzIDIwLjg5MzIgMjkuMzQ5NiAyMC4xNDMxIDMwLjY0ODhaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjgiLz4KPHBhdGggZD0iTTE2LjI5NzcgNDVDMTYuMjk3NyA0Ni41MDAyIDE1LjA4MTcgNDcuNzE2NCAxMy41ODE0IDQ3LjcxNjRIMi43MTYzNUMxLjIxNjA1IDQ3LjcxNjQgMCA0Ni41MDAyIDAgNDVDMCA0My40OTk5IDEuMjE2MDUgNDIuMjgzNyAyLjcxNjM1IDQyLjI4MzdIMTMuNTgxNkMxNS4wODE3IDQyLjI4MzcgMTYuMjk3NyA0My40OTk5IDE2LjI5NzcgNDVaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjciLz4KPHBhdGggZD0iTTIwLjE0MzEgNTkuMzUxQzIwLjg5MzIgNjAuNjUwMiAyMC40NDgxIDYyLjMxMTUgMTkuMTQ4OSA2My4wNjE2TDkuNzM5MzYgNjguNDk0MUM4LjQ0MDE2IDY5LjI0NDIgNi43Nzg4NSA2OC43OTkxIDYuMDI4NzkgNjcuNDk5OUM1LjI3ODczIDY2LjIwMDcgNS43MjM4MSA2NC41Mzk0IDcuMDIzMDEgNjMuNzg5M0wxNi40MzI2IDU4LjM1NjhDMTcuNzMxOCA1Ny42MDY3IDE5LjM5MzEgNTguMDUxOCAyMC4xNDMxIDU5LjM1MVoiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNiIvPgo8cGF0aCBkPSJNMzAuNjQ4OSA2OS44NTdDMzEuOTQ4MSA3MC42MDcxIDMyLjM5MzEgNzIuMjY4NCAzMS42NDMxIDczLjU2NzZMMjYuMjEwNiA4Mi45NzcyQzI1LjQ2MDUgODQuMjc2NCAyMy43OTkyIDg0LjcyMTUgMjIuNSA4My45NzE0QzIxLjIwMDggODMuMjIxMyAyMC43NTU3IDgxLjU2IDIxLjUwNTggODAuMjYwOEwyNi45MzgzIDcwLjg1MTNDMjcuNjg4NCA2OS41NTIxIDI5LjM0OTcgNjkuMTA3IDMwLjY0ODkgNjkuODU3WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjxwYXRoIGQ9Ik00NSA5MC4wMDAxQzQzLjQ5OTkgOTAuMDAwMSA0Mi4yODM3IDg4Ljc4NCA0Mi4yODM3IDg3LjI4MzdWNzYuNDE4NUM0Mi4yODM3IDc0LjkxODQgNDMuNDk5NyA3My43MDIxIDQ1IDczLjcwMjFDNDYuNTAwMSA3My43MDIxIDQ3LjcxNjQgNzQuOTE4MiA0Ny43MTY0IDc2LjQxODVWODcuMjgzN0M0Ny43MTY0IDg4Ljc4NCA0Ni41MDAxIDkwLjAwMDEgNDUgOTAuMDAwMVoiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNCIvPgo8cGF0aCBkPSJNNjcuNSA4My45NzA5QzY2LjIwMDggODQuNzIxIDY0LjUzOTUgODQuMjc1OSA2My43ODk0IDgyLjk3NjdMNTguMzU2OSA3My41NjcxQzU3LjYwNjkgNzIuMjY3OSA1OC4wNTE5IDcwLjYwNjYgNTkuMzUxMSA2OS44NTY2QzYwLjY1MDMgNjkuMTA2NSA2Mi4zMTE2IDY5LjU1MTYgNjMuMDYxNyA3MC44NTA4TDY4LjQ5NDIgODAuMjYwM0M2OS4yNDQzIDgxLjU1OTcgNjguNzk5MiA4My4yMjA4IDY3LjUgODMuOTcwOVoiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuMyIvPgo8cGF0aCBkPSJNODMuOTcxMiA2Ny40OTk5QzgzLjIyMTIgNjguNzk5MSA4MS41NTk5IDY5LjI0NDIgODAuMjYwNyA2OC40OTQxTDcwLjg1MTEgNjMuMDYxNkM2OS41NTE5IDYyLjMxMTUgNjkuMTA2OCA2MC42NTAyIDY5Ljg1NjkgNTkuMzUxQzcwLjYwNjkgNTguMDUxOCA3Mi4yNjgzIDU3LjYwNjcgNzMuNTY3NSA1OC4zNTY4TDgyLjk3NyA2My43ODkzQzg0LjI3NiA2NC41Mzk0IDg0LjcyMTMgNjYuMjAwNyA4My45NzEyIDY3LjQ5OTlaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjIiLz4KPHBhdGggZD0iTTkwIDQ1QzkwIDQ2LjUwMDIgODguNzgzOSA0Ny43MTY0IDg3LjI4MzcgNDcuNzE2NEg3Ni40MTg0Qzc0LjkxODMgNDcuNzE2NCA3My43MDIxIDQ2LjUwMDMgNzMuNzAyMSA0NUM3My43MDIxIDQzLjQ5OTkgNzQuOTE4MSA0Mi4yODM3IDc2LjQxODQgNDIuMjgzN0g4Ny4yODM3Qzg4Ljc4MzkgNDIuMjgzNyA5MCA0My40OTk5IDkwIDQ1WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC4xIi8+Cgo8L3N2Zz4K",G0="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjkzIiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDI5MyAxMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8cmVjdCB4PSIwLjI1IiB5PSIwLjI1IiB3aWR0aD0iMjkyLjUiIGhlaWdodD0iMTE5LjUiIGZpbGw9InVybCgjcGF0dGVybjApIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjAuNSIvPgo8ZGVmcz4KPHBhdHRlcm4gaWQ9InBhdHRlcm4wIiBwYXR0ZXJuQ29udGVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgd2lkdGg9IjEiIGhlaWdodD0iMSI+Cjx1c2UgeGxpbms6aHJlZj0iI2ltYWdlMF84ODUwXzM1MDAiIHRyYW5zZm9ybT0ibWF0cml4KDAuMDAyMjc1MzEgMCAwIDAuMDA1NTU1NTYgLTAuMDAwNTY4ODI4IDApIi8+CjwvcGF0dGVybj4KPGltYWdlIGlkPSJpbWFnZTBfODg1MF8zNTAwIiB3aWR0aD0iNDQwIiBoZWlnaHQ9IjE4MCIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFiZ0FBQUMwQ0FZQUFBRG1memw4QUFBQUNYQklXWE1BQUJDY0FBQVFuQUVtelRvMEFBQUFBWE5TUjBJQXJzNGM2UUFBQUFSblFVMUJBQUN4and2OFlRVUFBRE5GU1VSQlZIZ0I3WjBIZEp4bm1lK2ZLZXJWbG9zc1daWXRGN25FTm5iYzBra2Nrc0JTa2tDV2NBaEpnR1U1SVFtN2U4L1pBSUhkZXltaExPZmN1MHRaN3Ixc3VKRENYVnBpRWs0cWFVNGpybkd2a3ExcU5hdlhHV2xtbi84ejg4a3prNUVzMlpJbGovNC8rREx0cSs4blAvLzNLZS83dWRyYjI0TkhqeDRURUxUL0JHUWdFTlNYZ1BQTm1kOGl3UmV1MEdzd0dMUTN3Y0gzaEJCQ3lEaWpHdVJ5dWNUdGNvZmVoNy9PenM2UjVjdVhmZE1MY2Z2QzM5NGovZjErNmVudFVXRUxpc2ZqRnJmYkk0SEF3TkE3RGd0Y01FYmd6dnhJQ0NHRWpCOHVGVFlJbk0vWFo1ODlIcStrcGFiSmhvMGI1QmNQLzEveDRrdS8zNmNDTjJCQzVYTFpWaXB3b1EwSklZU1F5UXAwS2hnTWhON3Ivd0w2M3FQNkJiend0U0J3Zm4rL3BLYW1Eb1lZR1dva2hCQXkyWUZXSlNVbDIvdUFwdFo2ZXJvUlQ3VFBidVRhOEtYTFJWRWpoQkJ5Y1FPUHJyKy8zOTY3QTFaTTRoS3ZOMGtJSVlTUWl4V2sxcEtUVTZUZjc3ZlBYbmh1WHE4M0hNZWtCMGNJSWVUaXhlUHhETDUzNDRQWDY2RzRFVUlJdWVpQmxxV2xwOXQ3OTh5Wk02V2dvRUFJSVlTUVJHREY4cVgyYXJXVVNVbk12eEZDQ0VrTTB0TXo3TlVFanVGSlFnZ2hpWU16VENBOEN3a2hoQkNTU0xoRHM1Vnd4aEpDQ0NHSlFTQklENDRRUWtnaTRnaGM2SU1RUWdnaFl3NmloRmljNmJTR0l6UnN6VHRtOHlDN2hSQkNDQmtuSUZoWjJUbXlkTmt5ZmMyMjJVYmlBWEVyS0p3cjh4ZVVTRnBhbXJqYzV5OXk5alNCSUYwNFFnZ2g0MEIyVG80VUZCVEt1ZzBiN2JXeXFsS09IRG9vb1draXozaDRWMXgxdGN5YW5XL2Y0MmtBSjA2VWk4L25rM1BCR1JuZ0ZVSUlJV1Njd01USFBsMjhHcUlzS0NveWQ2cTlyVlZxcXF2dDkvU01ESms1YTVZVXErY0diNis5clUxNitucGxZR0JBemhjS0hDR0VrSEVEZ2hWUXNXcHFhcEE1Y3dwa2ZrbUp1RHh1cVR0MXluNkh1SzI1ZEozTW5EbExHaHNicExHaFhtcXFxc1pHNE15Vlk0U1NFRUxJT0FDTjZlam9rS2VlK0lPRkllR3BsWll1a3d5Ykw5SWxtWm1aTWtQRjdVUjVtZXpldVVNcUswNE9oaS9QbDNBT2poQkNDQmsvSUZxSE5mZUd2TnJpMHFVbWFzRHY5NXZuQm5GcjB0ZXhuRm1MVlpTRUVFTEdIUWhYVTJPam5LbzdKYjA5UGVxNVpkbUN1WkE3TzlxbHFySkN1cnE2S0hDRUVFSXVVZ0xCd1psR0FBUXRFQmpiT0tLelB4YVpFRUlJR1hjdy9tM0RaWmZMdkhuRmtqZGpwbmxzSURVdFRZcUxGOGoxTjM1UTl1OTlWMDdWMW81dERvNFFRZ2daRDBLem1DVEpvaVZMWk83Y3VaS1JtU2x0YmExeVlOOWUrMzNtck5uaVhlU1Znc0pDQzExaTNZcVRKOGNrVkVtQkk0UVFNbTVnaHBMTXJDeFpzWEtWNU9aT0YxOWZuMVNyOTRhQ0U5RFczaWFwNldsU3VtU1p6SnMvWHp4SkhxbXpQRjJ2bkM4VU9FSUlJZVBHakprelpYN0pRaWtxS3JidzQ3R2poNjFpMGdsRDFsWlhTNTErbjU2V2JwV1ZDRmVlYm15U1F3ZjJjeVlUUWdnaGs1ZjI5bmFwcXFpUVBSa1pjcUtzVE9ycjY2SnliS0VpazRDOCtmcFdEV0hPazZUa0pCdm83ZS8zeS9sQ2dTT0VFREp1SUNUWjNIeGF5bzhmazRhR0J1bU9NeFFnTklTZ1FZSXFkTWtwS2RMUjBUNG1BN1E1MlRJaGhKQnhBM05SWWpsUlhqN3NldkRpTU9CN0xIQWV0MlBqNEZ4OG9qY2hoSkFFSVJqNXdGTjZjSVFRUWhJTnptUkNDQ0VrSVFrSjNBVnk0TEt5c21URCtuVlNVRkF3NURyNGJlblMwdlBhUnl3UFBmUnQrZHBYSDVDeEFzY2Y3aHdKSVlSTUhORTVPTmVGeWNFdFhicFVmdm5MWDhpZGQ5NHg1RG8vK2ZHL3lhOTBuYXpzckxpL2I5NThuZTJqc0hEa0FyZGgvWG83OWxpQTQrTDRYL3ZxVjZLL1A0c3dKd3BveDlGMExzN0dWR2szUXNpRkl5WUhkMkhZdm4yN2JOdStRMjY1K1dOeGYzZThOM2hwUzB2akc3MmJkZHVhMmxyZDF3NlpDTnJiTytTblAvMlpQTG5sajRQZlFmUmVmUEU1Mlh6ZGRaTElvS1B3eEI5K0t4czJySmV4WUtxMEd5RmtZZ2hYVVY0NHRtL2JiZ0syWHNOOHNkejVtWkJuaDRmanhSTkJDQ0RDZ3krOTlMSk1GRGkzbi83N3oyUkxoTUFSUWdpWmZGendnZDViL3ZoSHVmZmVleXpVR091RjRUc0lSMDFOcllVeHMzN3dMOUtoSHBPRDR6bEVpZ3ZFRWw0ZFBML0N3a0k1ZlBpd1BQTElZMUtyWGw0c1dCZjdkY0tWRU1wNFFvWDlRWUNkL2VFOEkwWDEzaS9kSTRlUEhMSHZQcU9pWEJnTzJhM2ZzRTd1bFh2cy9TT1BQVFo0N3ZCOFBuYnpSMjEvdFRVMThzaWpqK2wrajhoUVhIZmR0YkpNenpGeUgvR09IUW5PRjhlQitBNjJwM3BHMTIyK05xcGQ0RFZGcm9kMnczbzQxckxTcFlQbkdkdU9PSzRURnQ2TWZZYXYyZGxQWk52aS9YRDNBWXkyM2RDeEdPcCtFVUpJSkZFNXVBczVUQURpRlM5TUNXTUdBL3JTeTYvWTcvSENsUER3WU53ZGNZQkg5OFFmZmlmM3FXRENBTUk3aEVnaWh4Y3ZUNFIxY1p5TzluYkoxdjEvOTZGdld3RktKRi85NmdQMlBab0grNE1SL3ZHUC90VkV6OEVFV2tYSU9lOWx5MEtDQ1VNTUVZNE00V0hkWC83eVljbkp6cmI5T2VjeFhCNnlvNlBUdHJ2bFkrOXRJM3ovbWMrOGQ5dnZQdlNkcU9QaU9uNzg0MytWdVdGUmhXQ2lYZENHMkljREJBbWZ2L2FWMFBxNGJyUVAxbnZ5aWQ4TjVrS3hiNmRqZ05mSTYzVHVnNFdQOVZnUU41enJuelg4T0ZRdWRhVHQ1cHkvYzcvR3NsaUlFSktZVE9oY2xPaUpJOVFJcjhQeDRtN1duanB5YTQ1bkFpRzhTMFhBK2QzSnp6MzQ5WDhhM0ErRURSYjUxby9mWnVzRGVFZFBQQkVTdmNoMWNTemt6aUk5bksrcVViOHpmQXg0QnFVcXFERHMzLy8rdjloK0hJWXJhTG4veTM4WHlpVzk4SnhzZWZLUFVmdS9UajBqZUQ2eCswTWVEOThqanhmcm9RSGtLaUhZMTZsWVIyNkhOc0wzc1cySDg4WTVPTWVHZU9BNnNDMk83WUJqUm9wYkpPdFZYQ0xiY2IzdTQxY3FNQkJaN09ldXV6OW4rNFhvb0IwalBTbDBWbkQ4RDl4dzArRDJUcHZIdTc2UnRsdnMvWExPLzVCMmNPakpFVUxPeG9TTWczT01FN3d0QnhoVXg4Tngxc0YzamdmZzVPZGcvQjNnTVdDYlNLTUtBVUJvTEhMZnp2ZVJ4aExnTTc2L2ZuUElHK3ZzREJualdFSEQvaU9QTVZKdUNRdFNwRWlCUnpVTUZ4cnVNSFN4QnE0QlFoYnBBZUdhZnZMVG40VkY3c3kyZDkwWjNUWVFRanRPekhGeHZVTmR4Nk42dk1qZjRJV0JrVlE0NGxwQTdPT2J6clVRNkpidytTTmNHWWx6djI0ZW9raUpFRUlpbVJBUERrYktDVlBDdzBDUEhhTHk0TmZQOU1yeGV5Z1VHTXJMT1RrN3h3ZzdJdVFNUFlnRVlVWEg2RHJFeTNuaFBPQk5sWmFHUW1YWU43d3FoQUJMZGI4dzh0aHVtNHJvVUxtazRVRG9EY1NlbjBQc09VYnkwc3N2Mi9YZmVjY2RadGhoMUxIK3kvbzlyZytlcHlQWTZBZzR1VXRRRU01WnhSTXpYRk04ajdTOUk5clQ2dWlJNzNuRkE0SzkrZnJyTENTSis0Wk9oMU14ZXk1a2FUZ1g1eDdQKzhQM2hXTTRUSUVRa25nNE9iZ0plNXBBWkpnU0hsUnM2YjlqSUdIWUR4MDZIQldDaTJUTGxpM3k1NWRlT2V2eGhzb0ZtU0dQS0NQOXVvWTF0Mng1eWdvcGtMZUNDRU1FRVZJYnJqQmtLSEJkRHo3NGpmakg3aHhhUkV4WTlmb1JPcFN3d0RrQ2p6d2xCQTV0aDNsRVl6c0h3d0h4R0d0d1RuZHJDSE85alRjc3RjNEl4Qm5mMy9xSjI0WU1VdzVGOWpEQ0R5RWVybU5BQ0NFT0V6WlZGendPWnpnQWpIZTgwbjk0QXN2VVlONFh6aHRGaGljaE90Z2UzZ3E4cTNoTEpPYlZ4WWljRmJMby9sSEVFSFZjUFE0OFMrU2RrSmZLMXUzdUd5SjNOUnptTGVseElXVHh6dTlzaHQvcEJLQjk4T3FNdmNQNVFUd2dKRTd1TXJKemNGZzdCTGkyZUtJK1h0NFB6Z2YzRk8yR05ydnI3cytiOEo3TEdEZkh5NHgzL3ZoN09CZHZtaEF5OVpnd2dZTTRvVmpBeWFmRTVvc0FoaFRBVU1PUUl6UVhtMnVEQUNBM0Y1c25Ra0ZLYko0Rys3bnZTOUVpNVZReU9oNWd2TzF3VElocFZ0YlFuazk3V0tqV3h3eUFmbEk5d1hqSEJiRTV3bmc0blFBbi80aXdaZVJ2dDlod2h1amNaV2k5MFBXZ2lDWVNlRldqbVFFbWxwcmFVRWRnUTh3WXh2VnhwazdEUXc3QmNLSE80ZG9OeExZYnpoL3QrU1FMVEFnaEkyQkNIM2lLS3JrTnYzellTdi9qNVl1Y0lRVXdxUEhDa045VGJ3SGloaEwxYlJhK3E3RzhGM3I1VG1Xa0EwSitNTVJZOTVCNkNBZy9ZbHVzNDZ5SGJWR0tEa0U1RkM2eXdIZnc0TzcvOGcrR3ZBNUhiSjFweEJCaXUvLyt2ek5QQzljSXc0dzhJNjRUaHYvNnNMaGRqMnJKWWJ3NHkxV0doejVzaWFtNGRNWVR3dURmL2RubzBHM2tjVkdNc2swLzR6b2dicGJET2tlUmMrNEhPZ0h3bkhHZDhOYnV2ZmRMZG8rY2UyRFhwdWNjV1JWN1B1M21uUCtHY0NVc0t5Z0pJY1BoREJQdy9QM2YvLzMvZU9hWlo2VzF0VTB1TkRCd3ZqNmYvT1kzdngweTdBUkJPSEhpWkZ3UHorZlRiWC83T3pPa0lEVWx4ZDdEQ1A3SGYwUVhka0R3dnZtdDcwaWZiak5YRFh4VFU1TUo1S09QUGo2NERzNEJ3cEdTbkdLaWh0UWNoUEdiMy9xMm5VUFUvbmJzME85T0RINSs5dG5uN05ndzB1WDYvUnR2dm1uWFprSUxUelM4UHl6UDZMb1BmdU9mUnBTYndqR2FtazViSVVla04yUUZNcnJndVBHcUZmRWRSQnB0aEhiWlp0Zi9iZHNYcmlseUczd0hVY0hyZS9ZVGM1MFFKTFRGNEhXKzhhWUpEbzZWb3NmQnNaeHJ4UEhRQnNNeFhMdFprWXJyekgzOW4vL3JYN1V0bnhKQ0NCa09tL2hpdzRiWFhHcThnbCs2OTM0NWViSkNDQ0dFa0l1ZEw5M3pSYm52dm51L3llZkJFVUlJU1VqNFJHOUNDQ0VKQ1QwNFFnZ2hDVVgwQTA4djZBTnpDQ0dFa1BHSEhod2hoSkNFSXVhSjNzekJFVUlJU1N6b3dSRkNDRWtvWW5Kd2hCQkNTR0lSOXVBb2NZUVFRaEtEbUJ3Y0lZUVFrbGd3UkVrSUlTU2g2Tzd1c1ZjV21SQkNDRWtvNnVxYjdKWERCQWdoaENRVVZkWDE5a29QamhCQ1NFSkNnU09FRUpKWWhBdExLSENFRUVJU0Vnb2NJWVNRaElRQ1J3Z2hKQ0dod0JGQ0NFbElLSENFRUVJU0NwY3JKRzFlK3pDQmM1a2tKeWRMVG02dUxGMjJYSkpUVXNYWDF5dUhEaHlRMXJZVzZmZjNDeUdFRURJYTB0T1M3ZFVyRXdnZWFaQ1psU1VyVnE2U3dybEY0dlY2cGIrL1g5eHVqK3pkczF0YVcxb0dKODBrRnkrNHJ3TURBN3lYaEpBTFFrSEJMSHVkVUlIemVEeVNrNTBqeTFlc1ZPOHRSZHdxZURDQzJkblpVbkd5WERyYTJxVi9ZUHk5dU5UVVZGczZPenROWUdQUE1VWFBEVWE2dmIxZHlNaEIyeVVsSmNuczJiT2x2cjVlL0g2L0NkMWtJVzk2bnYxOTRaeHc3d2toaVVIK3JCbjJPcUZUZFdWbVprck90RndURjNmNEFYWHc2dExTMGlVM2Q3cGtxSGQzSWRpd1lZUGNmZmZkTW5mdVhEdVhTUERkWlpkZEpsLzR3aGRNZU1uSWdiQmRmZlhWOHF0Zi9VbysvT0VQUzJGaG9Vd203di95bCtXZWUrNlJHMjY0UVFnaGlZUGJIY3JCVFdpUmlVdFB3alhFS1VEb1BPN3hQejNrSHd2bUZNaWFOV3RrMnJScGt1Uk5pdm85SnlkSGlvdUxaZTNhdFpLYWxpcGs1TFMydFVwWldaazgvZlRUY3VqUUlXbHFhcExKaE52dHNuOEl6dE4vQ1NHSmdmTnZlb0tMVEZ4REc1Y0xhSFFnWFBET1VQQVNxN2ZKS2NtU25wNXU0amY0bmE2WHBkNWxibTZ1R1VpRU5adWJtNldqbzBNQ2dZQ3RnL0RjakJrenpFdEZtSzZucDhjTWZydUdYZVBsb3JDL3RMUTBXNys4dkR6cXQ4SzVoUklZQ0ZnWURjZkF1V1psNnZycGFmWjdXMXViOVBUMlNHZEg1K0MrekN2V2N6dDkrclNkSDg0SDIrRmErbnI3cEtXMXhjTER1RDc4aGlVakkwT3FhNnFsbzcwajZ2Z0l6ODdJbTJHaFBJL1hZL3RHMkJZaDIrN3ViZ3M5T3Q1WmIyK3Y1azVicGF1N3k0cUVzRTVkWFoxZE45YUxiWnZrcEdUcDdlczE4ZXZxNnJMMnczbGgvMG5KU2JZdTJnWFhYbE5UWTUrblQ1OGUybGJ2UTE5Zm54MmpQUnpPUmx2anZ1QmFjTzA0RHI3RG4zaDlYZjNnK1FMODdXSEJzUmJNWDJESDgvbDhkaDZOalkxUmJXRG5tNUZwNitEK3RXaCtHT3ZoZXUxM2JSKzBONkloYU9PVWxGUnRyMzY3dHBycW1xaDlvZE9FZTRSelJKdmlQTEVmL0kwUVFzYU9DYzNCWGF5WVFWeXdRQzY1NUJJei9qQk1PM2Z1Tk1NSkF3cGdmQmN1WEdnTGpCbU1QTHdZaUZDOFBCU01kbEZSa2N5Yk4rODlBcmQyemRwQkF3K0J5OHZMazhXTEYyc2l0Y0FNL3ZIang2V2lvbUpRNEdiT25DbXpaczB5dzc1dCs3Wnc0WTdiUkdoT3dSeHBhbXlTOW81MktacFhaR0lRTXNncGR2d1gvL3lpSEc0L0hIVjhYR1BwMGxJVEU2d0xZNDl6d0hFckt5dk4wRjl6elRXMkxnei83dDI3cGFjcS9Ed21QUzYyZDduUGRGaHdYaVVsSmRZMk9EN0VEZHVjUEhuU2psRlFXR0FkQ29nWWpqZHI1aXdwUDFGdTE0OTJuVDkvdnJVLzJxeFp4ZUhvc1dOeTdPZ3g2ZS91TnpIRXZpRlkyM2RzSC9UTWNSNnZ2ZmFhbkRwMXlqb0VEaEM0VkJXakRSczMyTGswdHpTYklNVUtIUGFKOXNFNmFNODllL1pJZFhYMW9NQ2hFd0xCZ3ZqaHZ1Q1lFRXVJVjZ6QTRUNlVMQ2l4MXo1Zm4remZ2MStxcXFvb2NJU01FWTRUWVFJM09SK1hFNVRKK0t6eFJZc1d5YVpObStUem4vKzh2UERDQy9ZZGpCaysvK0FIUHpDaGcxRjc2S0dIVEFRZ1pnY1BIcFJQZmVwVDB0cmFLbi81eTEvazRZY2ZmczkrWVRSaFJELzN1Yy9KOXUzYnBhNitUbng5UGhPcXUrNjZ5N1pEb2NiNjlldmxiNy80dDVLV21tWUdIMGIwSXgvNWlBbmNVMDg5SlMrOTlKS2Q0NnBWcTB3Zzl1M2JaeDRiaE9GOTczdWY1UnRoVUkrcEtNRDRmK0FESHpDUEFzSzVhOWN1RTh4WTRMRmh2V1hMbHRueElHb1FrdXV2djk2TU9nenptMisrYVVZZVlvVHovWnN2L0kzMDl2U2FzZi9zWno4ckowNmNNQzhYN2ZIOTczL2ZSQkx2Y1M2MzNYYWJmUFNqSDdYMzMvdmU5MlRGaWhWeStlV1gyeXUyT1hyMHFIbVdPRGRzaTNaRmUrSGFycnp5U3Z0anh2c2YvZWhISm5wWFhIR0Z0Y2tkWFhmSWdRTUhKQkFNMkhuZGV1dXRsZzk4NWVWWDVGVGRLYnMyZEZLUVk4VTlnaWVJOXNIK3NhOWR1M2VaMTRhMi9NZC8vRWM1Y3VTSWlURkU5L2JiYjVkWFhubEYvdlNuUDltMjY5YXRzK1BpZnFHREFvSEVOV0pidEJYRTluVFRhZXVZZlAwYlg1ZnVydTVCd2I3NTVwdnRQQjk5OUZFNWZQaXdFRUxHaHBBSE4wbXJ0eWZqYVNGOEJ1R0FwL2JXVzIrWlVZUUF3RmhCMkdEd0VRcEUzdTZkZDk2UnZYdjNXazhmb3JCeTVVcnowTEt5czh3akN3Yk9YQ0VNT1l3aWpHQnBhZWxneUdycHNxV0RJVE40UnpkOThDYnp3SkRiZ3RlRGtCN0VDVjdiKzkvL2ZoTzQwUUN2RThJQ3NXNW9hSkRxcXVvaDE4VTU0cmp3OGp4dWo5eHl5eTNtMVVBc24zdnVPU3NxZ1dDZ29HVDZ0T25Tb3YrTEJKN3M3UHpadHMyT0hUdE1sT0MxSFQxeVZKYVVMakhSZ3JnNFlWOTBDSDcrODUrYng0WDJnTmVHYmJkdDJ6YTRMYzRkb2dRaGhRQTcxWkFRNGpmZWVFUGVmdnR0K3c0aWMvLzk5MXM3elY4d2YxRGcwSFlRcmQvKzVyZldGaHMzYmJTT0FPN1QvZ1A3WmM2Y09kYXV1SmRZY0V4NHBMZC84bmE3MXhBMkNCekFPY0pUZit5eHgrejQ2R2hnWFp3M3hCRi8wUEIwVDVTZk1HLyszWGZmTmRHKzVlWmJiSHQwT0Nod2hKdy8wVG00QzVUdXdqOTI1Q2FtNVUyWDJtb1kwcUFNQk9LWGplTjdHRzhZdTRLNWM2WGxkTE9HYzNvbmZ2QzNLK1Qrd29DaEVhM0V2S3ZUREMwRUFnWUxSaGllaEpNekEzakZ0Y0RBSWw4RHJ3cjdjSUNZUVVBcUtpdGsrYkxsVWxsVktZR21nTDJIZ2NlK3NmNnFTMVpKV1htWkhOaC93THhGa0orZkw1ZGVlcWt0b3dWQ0RmSGQrdHJXc3c3SmdNRENPOW01STNUY3E2NjZTbkp6Y3MwN3cvWFgxdGJhTlVMNE10SXpCc08xRHZCOGl1WVdXUWNBNFUxNGZkZ25RbmpJVmFHajRIaVF1RlpjTTg0TGZ3dndqQ0JnRU1ualphRnRJWUE0ZDRpYmhYZUw1MW1vMHRrZUhpazZHRGdHN2hVOFJhZnpBZUVENktDZ0F3SVBDK1ROeUxQOTRYandrbk55YzJUNTh1WHk2MS8vZWpDTUNpQnNFTUdsUzVjT1hoODZJaEE0Q0REQTN3YkNxUkQrbE5RVVNmT255YXJWcTZTcG9jbkUwTG4veUZmaTd5VnlYNFNROHllY2c3c3dDcGVWbFcwemxseDI1Vlh5djMveWJ6TFFQMkJodUhqNE5CY0RnWVBSKyt2YlB5MHZQditzVkdnZXB0MS9ZY2VpdVdJS1lXQlFZWXpBTjc3eERmUGFZQ0FScm9LQmd3R0ZnY1EyOEdSdXZQSEd3VzJSNTBLWUVUMTc1SUppZ1VHSGwvRHhqMy9jY21kK245OUNrdGczam9FT0FuSm8rQTFGSWc0MXRUVVcrbktLWGtaVEZRaFJoVkNNWkx3aGpEZldkNENYaGVJV1I4UmhxQjBQeXB2c0hTelZkWURBb1czUVRtZzNDQS9BdFR6Ly9QT0Q2K0crWXo4UUFPZThzQzI4S1d6YmZEcDB6Z0RIeGpsaGZYaU5UcTRQQWdMUnhmb0FuUko4Um00TzV4QjUvY2gvT1dBL09CL3NDN2s1aUJ3OGRnaHk1Rmc1L0IxZ0NBbk9LWEpma2ZjVm5SWjRoeEE1Q0RmQ2tZVUZoYmFzdUdTRmZQS1RuN1QxOEQydWxXUHhDQmtiWW5Kd0Y0YU9qbmIxZGpxc1p6dDNYckhVYTVpb3NhRmVRMVNIWllIbW41S1NRdi9ReTdXSGZsb05nOXVsM2x2eGZET2s3V3JRdWpxN1pLeEIvaEdOZ2RsVFpzL09OME1XQ1F3cndsc29ma0JEd1RCRGNGQmtzR0w1Q3NzN3dZQmhuQnh5V1Uybm04eXd3VWcvOWZSVHN1ZmRQWVA3Z3NGSFVVRjVXYm05eGdMeFF5RUU5b1g4MDV6OE9kYjdoK2VBSEJ2RUh2dUcwSGs5WitxRDB0UFN6VWdpeEliajRub2djazcxSUhBcUJpY1MzSGNJam5scTd1aGNIOFFmN1FOUGJxaHRjZTN4dHNXMVkzdm5IZ0VJQ25LakVFTEhVMExuQSswZUtTUm9xOGlxVm5zZi91anorMnhiSEJ1ZW83Vm5HR2QybGtndkZkczZWYlREWGNQZVBYdmwwT0ZEZzk0Zy9zNGg1UERxQ1NGalIzaVl3SVVCb2FaT0ZhbFQ2bkVzV0ZDaS82QjdwS1c1UlE0ZFBDQWRHaXB5cHVxcTBqQWRqQlU4cFFVbEM2VzJwdG84aGFIQ21lY0xqRzViVzZ2bFhxbzBOR2lDcXVlRHNOZVNKVXVzbHc1amhPL3hIVUtDeUwrZ0Y0K3FPM2dSR05BTWdXdG9iREJ2QzhZT3ZYKzhJdWVTUHlmZlFtTXdrbVhIeTh3empDM3V3VFhEcTRFWEFOR0VoNERjR3haSDJPQnQ0UGlvZ0VUaEJjNEoxWWhvSzNoWXpuNWdhQ0dPS0pLQUp3ampEczhSWWoxUm9KMXgvaENma29VbHNxeG1tZVh2ME1aWXdNc3Z2eHhWY1JtNUxkb1YyeTRvV1NDbFMwb3RWSXY4RnFvUjhUMnUzNmxRaGVnaFpJdDdneEF2N2hlODNOcWFXbWxzYWh6UitlTGVvZDNoV1NOLzZuaUt1QThJSitJWUNNdU9GSWdscmo4OUk5M3VEem8wdUZmWU40UTdOcVJMQ0RrM29uSndGd29VVmJTcnNUbWlpZlExYXkvVjNqWG1taFJwMUgvb0hmbzlEQW9NVkw4dU1OakZHazVDU0c2SDVqVEd3M3R6cUtxdXNvUS9ER0o5L1FiTHd6UTNOY3Z5RmN0bDlhclY0dmE0NVpWWFg3RVFISXdrREJMeU1sdWUzR0k5YjNnZUVFUVkwOGFHeHNHaUVveFZROUVGUXJHTGx5eTI0Z2JrRU9FQnhxdGN4YlZqUVVVZERMNVRCWW54Yzg0MFZ3aGhvcWhpNVNVcnpVaGlmemdHREtTVCs0RkJSNWdOQlJ2d0JLMnpvSGxQaUVHc0Z6ZlMrU0VqUFp0enhjbEpWbFZXbVhodjNyelpoQmRWcVJDTWh2b0dlZjMxMTZPUEdRWUNoMXdmMmhZaHhtdXZ1MVp5cCtYYUFId0lQdG9kK1VIY0t3RHhRYjRMeDROSW9mT0I5ZENlNkhDRTluLzJjMFpib3FyMWtoV1htUGVPdjB0NGk3ai82S2dneitlYzY5bmFFbjhqdUVjYk4yNjA2OGYrY0c2clY2OE9kWHpLeW9RUU1uWmM4R0VDelJyQ2c3QXRYYnJNNXFCY2pKNzQ4V01tQ1AxcXhGUFU2eWxXNzZVa1hJRUd6KzdnL24zRGhuN09sOTI3ZHF0WGVjcks5RC95MFk5WWdZUXJQQzhtUEF5SXloTi9lTUlFQnFGQzVMcFFOdi9QLy8yZnpYTkF6eHlpOU83dWQrWG9zYU1tS0k4Ly9yamwzMjY3OGphNTQ0NDdiS0QybnIxN3JGb3hNbzhWRHhoTkdIRmNQd3BKbk1JYUdNamYvLzczTm9maVpaZGZKaC84MEFmdGUxUndibjE5cTFVQ0FoUmh3SHU4ZnZQMThzQUREOWkxUUNEUnhqRDhzWVo0eENJbnd4dHhkR0FHZjQ5enU1QVhnMUE5OHVnamxwOUVlZnduUHZFSmE5ZFhYMzNWcWg1aDlLUDJFN0V0RnBUUzMzVGpUZkt4bXo5bXBmcG9hMVJrdnZEaWkrWmxGODh2SHJ3bWhQd3dCUnZFRFVCY2NDL1JtWEd1Nkd5Z3FoR2krc01mL3RDS1ZES3pNbTB6VkU3dTJMbGpWRldyOE1SeC85QkpRaWNGYllCN0EyRi82KzIzN1BvSkllZVBZejljMmlzTzNuUHZmVkp4c2xJdUZQWVVBZlZ1NEtFVmFkZ091Uyt2NXQ4d2RSS0V6Sys1ajhxS2sxS3ZvYnBLRlpTdXJzNXhuWW5ldkJyOVB3b0xFTUtEZ0dFTUUzclV5TmxBd05wYTI4SzVPcmQ1Q2ROeXA1bmh4QmdyQ0JBOEJSaGI5TWl4bmpPQk0wSmoySi9OTnFLL1laMnpGUk5ndkJaQ25oQ2xiMzNyVzZFaEJjNE5zN2s2MDh6endmNFI2dXp1NlphT3pnNGJkNGIyYy9KdDhEYXdRRURzM0RUTWErdHJLQXdMUEVSSG9NODJ5QmplRW9RSEltTzVMZ1hYQnM4RDIyTi9UanZPbmpYYmNwR09mcUF0SVd6T2RlQzhrZHRFWGd2WEFjT1BZaU8wTmRaenpndExiR2Nnc2wyeGZWdDdxRjJ4UGM0QkF2ZnhXejh1bXpadWtuLzRiLzlnblFTY0kxNFJFc1M2enVCc1p6eGQ1R1RMOE01c2RoZk44em5YaXV1YU5uMmFGWjFnWDJoalJCVFE3bGpIdVNac2k3OEhaeVlZZENhYy9DRE9EY2QyN2d2MmcyM3dPLzUyc0dCZnNaTjlFMEpHejVmdSthTGNkOSs5MzV5UW1VeGdFRHJWSUNPMzFxMWh2M3JObmF6UWtKdFRUWFpnLzE2Ym9RS2UzbmlMbTNNK1RnRUppamRRbUlDOEN6NDdSUnNPK0l3RlJoa2VsUk5XaloyZHhQRTRzQTd5YWs1ZWJMaHJRZGdLQTRNUndvS2hoOERpTmJZSUFzWVMrM1lxSm1FVVk5ZkJnZ28rR0c0Y045NDVqcVpxRDlOdnhlSlVLRVllRiszbzVBSWRZajg3d2dFaFFCdkhuc2R3NXhYWnJoQS9SMkRpZ1U2Rk15MFgyaXBXeEhIc1dIQmVqb0JIWGhmR0o5cU1MQzdYNE45QTVIR2Q4NG9FZjh1eDFaRzJMejB1enNjUmNhd3puaEVLUXFZYUU1S0Rpd1QvMEp1YlQ5c0NVTWlScnIxeUdNMWQ0VEZKRXdGeWFqQklJekgrc1lZd0hqQmNJeTBld0JnNWpDMURxQlRGRnZ2MzdSL1M4RGxHOW16RUd0M0pBdTYvdjk4di9rNi9uQXU0OW5oZUovS2R1SGNvSkRIdk91eWhqUVZqNlYwNTk4OFJZRUxJMk1PNUtDY1J5Q0ZoUURFOEUzaDlyS29iUGJXYVMvMzk3MzR2eno3enJFMkhSUWladWt3YWdhdlJSRDVtYXUrZHdoUE93bnRGSlNBOEJZekJJcU1uR0F4TlhZYlpaUWdoVTV0SkkzQjFkYUZwbmxCdE9GVnhjamJrM0hGQ240UVFNbmtFTHM3VVZZUVFRc2hvY1FyQWJGVHN4RDN3bEJCQ0NCa2YzRUlJSVlRa0lCUTRRZ2doQ1lrSjNPUjhvamNoaEJCeTd0Q0RJNFFRa2xBNE01bXd5SVFRUWtoQ1FnK09FRUpJUWhFMVRJQTVPRUlJSVlsR3lJT2p2aEZDQ0VrUW9uTndMdWJnQ0NHRUpCYk13UkZDQ0Vrb21JTWpoQkNTMEhDWUFDR0VrSVFpS2dkSENDR0VKQm9NVVJKQ0NFa29vbkp3aEJCQ1NLSkJnU09FRUpKUU1BZEhDQ0Vrb2FIQUVVSUlTVWdvY0lRUVFoSVNDaHdoaEpDRXhJdi9jS0EzSVlSRTQzSzd4TzF5eTdScDB5UXBLVWxRdDBCYmVYNzA5dlpLYjErZnZRNE1ETWg0NFF3VDhBb2hoSkQza0phYUpybTV1ZkxkNzM1SGl1Y1ZTVTVPanFTbXBnbzVkM2J0MmkxYnQ3NHVmM3pxYWFtdnI1ZnhoZ0pIeUNURDdYYmI0dlVtY1JLRzg4VHh0M3crbndRQ2dSRnZsNU9kSTVldXUxUSsvZW5iNWVqUm8vS1VHdVRXMWpieDkvdUZqQjdjQjNRWWl1Y1h5OHlaTStYQnIzMUZ2dldkaDZTdHJVMzYvZjB5WGxEZ0NKbGt1RDBlRTdoZ01FQjVHeE5jNHRFMkJTTVZ1UlVybHN1SzVjc2tTVHNaOERvT0hUNGlUVTFONHZkVDRNNEZDRnhLU29vME5EYktldTA0TEZxOFVDN2J0RW0ydnY2NnRMZTF5M2hoQXNkZUlpR1RBNi9YT3lodVBoK042VmlBUWI4d3JuanQ3eDlRa1R0Nzd1ZktLNitROVBRMGVlYVo1K1RWVjE4YnRRZEkza3VmNXQ1Mjc5NHQ3ZTN0bXQ5MHk2YytkYnNjUDM1OFhBV09WWlNFVENKU1VsSmxvTDlmL0JTM01RTUZCeWhxY0xzOWtwUTBzcURWY3ZYZ2tITjdkZXRXMjViaU5uWlVWbGJLU3krOUxJc1dsbWduSWwzR2c4R1pURkRKTXA0eFVFTEl5R0UwWlR3WlhkdjJxMjNzNnVvV01yWkFjOUJwZ0xpNXc2SGpzUWJlSW5CRDZSeTFJNFJNUEpTNDhXRzA3UXF2YldDQW5mK3hCdTJLRUR6eW91T3RQRzdFK3ozZThWRlJRZ2doNUVLVG5KeHNyNkVjSEx1TWhCQkNFb1NvcHdrd1JFa0lJU1JSNEFOUENTR0VKRFFtY0t6Y0lvUVFrbWlFUXBTY1FKUVFRa2lDd0NkNkUwSUlTV2dZb2lTRUVKSlFzTWlFRUVKSVFzT25DUkF5RmRDY3hJcE5OMHRhNWpSN1ArRHZzMG1IKzMyOTB0ZlRJU2NQdkc2emR0akV4R25aY3ZsSDdwZVdocE5TYzJ5SDFGY2VrTEZrMVZXZmxPeThBZ25xOGQ1OCtzY3kxY21iczFEeUNoWkw5dlFDT2Y3dVM5TFJYS3YzNHN4Y3BEa3ppclROL2xvQy9YNHAyL2VxdEordWxxTFNqVEovK1ZWeVF1L2IwWjNQQ29uR3ljRlI0QWlaSWhRdDJTQXA2VG5pVjFIcjZXeVJwT1FVeEhJc1FSRUk5RXQ5eFVIcDdXb1ZqemRaQ2hldWtRRTFxRTNwUjJXc3laa3hWMmJNV1JSbHhLY3FibzlYcHMxZUlDVXJycGFNbk5uU1hGK2g3ZDRuSFMxMWcrc2twYVRMek1KUys3N3l5RHQyZjdLbXpaRTVlbythYW84SkdSb0tIQ0ZUQUZSS3p5aGNJdDZrRk9scWF4U2ZlbTNwV1htU21UTkxzcWJubTBlMTQ0V0hwVm85dGdzMzd3T3J0eUZXMC9NWFN2R0txK3hwQi9uRks3U1QwUklsY0dkZ2U0MFdDaHdoVTRqbXVoTWExbnBOOXIzeGUvczhjKzVTV2JqcU9sbHo3UjJTcm1JSGd6c1VNTVN6aXBhcVVKWmFhTE9qdVU1T256b21kUlg3b3RhYlhiUmNwczhwa2R4WnhicS9GR21zUG14TGMxMTUzUDFDZExQeUN2VThyclY5TnRib3VxZktaQ3BRc3VJYW1hSGh5YUNHaTV0T0haZlo4MVRndWx1bHRteVhqSmIwN0JreWJkWjgzY2R5OWZEeXBWTTdNZ2d6Vng1KzIwTFM4QlJ4NzFMU3MrVHc5aitKdjdkYmt0TXlaZFdWZjYzclZVcXJybnRhenlGRDkxT3djSzJHcXJPazV2aE9hZE9RYU9BaW5YU2FBa2ZJRkNVbE5WUERZck1rZDNheGRMWTJpSys3WFExWi9MRGhvdFdiTmUrenlReHdSOHNwOFdyWWJNNkMxU3BnSDViWG52Z1g4emlRSTVxZVh5THJyditjR3M0c0RVSDZMTXc1WjhFcURYOGVVTzl3dTVSckRpa1NDR3FKQ216eDBrM3FTUmJJOXVmL1EzbzZXbVNxTUx2NEVnMFZwMHBUelZHcE9yWk5GbDd5ZnNuVm5GdGFScTcwYUxoNEpMaGNic3V0cnJubTB6SkRPeURKeVdsNlArdXRRekpQMjdXZzVIMnkrK1ZISlRrMVEzTjlpNlI0MlJWU2NlQU5jYnU4a3EzaDRxWHIvc3BFclBMUTJ5WndzNHRYeWdJTm1lSlJOaWYyYjdXWi95ODJvcW9vT2RDYmtLbEJlbmFlR2RYU2RSK1NKV3R2VW1HNVRITHppcVNoY3I5NkRtMkRodUVNTGx0UTFBQ1BESjdicVJON3BFNlg3czVtTlpCRk1xZGtqYVJtNU9pU0s0V0xMcFZwK1F2RTM5ZXQ2K3lWVStYdjZqWjlab0N6OCtaRzdOWmxkbWZ1a2syNnpWcjcvWFR0Y1dscnFySnRFeDE3K0tvSzBYUnRLOUNvQWxkL2NwL2xROU15cHFrbnRtREUrL0lrSlV1ZWl0bU1vbEpKVGN2V3ZOeFJ2VWZ2U250enJYVWdpaGF2bDdTczZlSnlleTNubXFQM0FmY3JjOXBzRmRPNTlsdGUvaUw3akp3Z0JCWi9KOTZrVlBIaFhnUXYzbUZrOU9BSW1VSWdoSVZsOGZ0dXNNOG1hTnBEZi9mVng2M1hIdy8wNUJHeTZsVVByMHE5c0YwdlA2TEcwaU1sSzYreENzRDU2aEcwYVBnUkhnY3ErM3c5blJvRzNTcjczM3JDOWozZzkwbG03bXhKUndYbklDcHZ1dC8zWFhPN0d2UWM5U0JxWlBjcmowcUhuZ1BDZFlrTzJnOGRndXk4T1JxYUxKT0c2a05TWDNsUStucmFUWER5RjZ5VTJoTzdSN1F2anlkSk94bXJMWi9hVUhWSWRyejRDL09vNFdIRFcwUDRPWGZHUEExWk5rakg2Vm84STAyeXB4ZGEzeVYzNWp6clVDQlVpZk5CdUJoQ2gzdlFvN2xBZjErWFhNeFE0QWlaUXNBQTFwYnRsS083WDVSa0RUTkM3QW9XcnBGclAvbWc3SHJsTVRtcElhbnVqdE9ENnllSEsvaVFTK3RVbzFsZnNkKytod0hzYkdtUXFpUGJwUFRTbTh3ajZOYzhUOTZjUlpiZmFXMm9NSEVENzc3MitIdk9JeTF6dXVUTUtMVDNsVWYrb3N2YjVuRk1GZEpWeE5CdTN1UjBTVTNQMFR6Y0lzbkt6WmVrbEF3VG1sSU5HNklqTVJMY0tuQXppNWFKVDNOcWFFT25RS1ZKODZPNEx5Q3ZvRVE3RDNYU1ZGZW1YbG1YNXVJV2E4Z3kwOFQwNEYrMnlJSkxydEYxczAwUVVXMkxQR2pkeVgxeXNXTUN4NWxNQ0prYURQVDdiTnhiWjB1OWhhUDZOQ3paMWQ0b2k5ZmNZQjVXZXM3TUtJSEQyTGcrOWR6RW5zRHN0YkNhZzhmcjFUeGVoaGxXRkNFRUF3SHQ4ZmVvS0dhWUorQ0EzSS9iazZ4ZWkxdnphK0Y5Qndla1g4K2xzL21VNWdGblNzSDgxVGJtcmswOWpLbmd3V0c0UnI1NldMQytHQWFRUGExQUJyTDcxYnZ5YXJzbVdSdkNrNExYZkZiMDN2UjFkMWhoU1dTUmtOZWJxZ0lhdWw4K3ZTL0lod1lEdlJZS2hrZU5ZaExrU3N2MnZHVDVUNjkyWWpCOEl6VXpWLzlHdXFSTDg3SVhPNXpKaEpBcFJWQUNnVUQ0ZFVEOG1oOURTQkY0a3RJa1NmTXUwYXNQcUpIdE1POHNTWVVxZS9vY3E2NkRCd1poeWxCRENZSHM3K3MxQTlyZDBXUWVDSXBYa0ZmRHVqTUxsMnJlYjRVTlUzQndoQk9GRlFFTllVN0xMNUhDaFpkYURnbENtTWpBNDBwTno3YUNuSjdPVm1uWDhDekN3eEQvMDNXaFBDUkViN3JtNGRKMHZiT0JNSE8zM2dNTWJrN1Y5czdPS3pUdkRQY0tvVWo4M3R2VnB2ZTZSKytqVDFycXkwTkRSS2JOc1E1S1MzMkZOTmVma0w3ZVRxdXlSQ2NHUXhYYVdrN0p4UTVEbElSTUlSQUNRMDhmd3dPODJ0dEhEaVovd1NyN3JhZnp0SFIxTkVhdER5RkMyVHFFQzcxK2hMTHFOY3lacmdLSDRoRGtlUTY4L2FUMHFDZUlYRTVEMVVITnpWMHJmbitQZWdHZHR1M2xINzdQakN4Sy82c092MjM3eFRnOEREWi81OW4vSSt0ditCdXIybHYzZ2M5WkNOUU1zWG9haVVxbWRneFE2QUVQYXR2elA5Y3c3MThzZEF3Z2JDaitRYlhxWEEwVm92QW4xQ0VaR25qbHA3VnRFVjdFZlYxeDJTMXlVbk9nSlN2ZmI3bFRlTVR3MnJyYm15emszS1R2RjZ5OFRrVXczY1MxV1VVVjU0U0NrOExGNjJ6OTFzYnFVSmo1SWlWcUpoTldVUkl5TlpnK2U0RWExMElUb1JCQkdmRDdaVGZ5YndkZnQzRlRTY2taN3ltY2UvdVpmN2R0VU1hKytmWi9Wb3NSdEJsUlRwWHZscDB2L1QvTDZ3ejRmR2F3NGNIbHpTNlJncHRYbTNIdTkvZEsrWjVYcEd6Zkt6Rm5FNVIrRmJORDd6eGxZcmYraHMvTCtwdStJRWQyUGkvbGUxK1dSR1hHM0ZLWlZiemNSTC82K0U1cGFhd2MvQTN0MGFtNXN2cVQrNlZFT3hOMUovZHFYczN4cE9Lbmt0QWhLTi8vcXViVHBrbkJnalZTdXZhREtwSTNXc2k0dGFsU3RqN3hRN3V2MkRlODdPcWoyMlR0ZFhkSnAzWkFHcXNPMjNsZ09yYWNtVVUyeUwrdThxQjVjQmZqOEFBSHB4cVlIaHdoVXdEOGc5L3orbTl0N0Z2RXQ5WmJSOWdLQnE2dHFkcnlhY0VBMXYxUDY5M2pPOUJhWHlrVm5qZHR2QndLSkRDUEpEdzA1T3NnVGpibGw5cVVubzVtT2Jyek9adEtLbFRnZ1BEWmFSdkVqTEZXQU9PdEdxdVAyTEZ4WGdoeFZoMTl4M0tDWGVwbElFU1h5TUF6Z2xQUm9jS0ZlU1VIZkdlOFZiUUhmai93emhZTEk3YXErQ0c4ZUdqYjB4WlNibXV1dG5hdkxkdHRZZU1HRlNPQTNHZk44VjJhTjJ0U2dUcGdvVWUvcjF2dlY2T0pKTHk4VU1Yc2dIVHIvY0w5eGJqRmpwYjZ3ZTFSVkxMOWhZZE5VRnVzU09qaXI4MWdrUWtoVTRLZzdIdjlOeU5hMDZlNW1MMWIvelBxTzVTdlkzWU5lR3dvWE1EY2xjR0JBVE82a2VCem1YcGZLSFpBQ0JSR0ZZWTJjbnhkeGVHM1lvN1haUU9kc1V3Rk1LUExVTE82QUF5WndCSUpCQzZTV3IwUFdDSnhab3dCNkZ4Z0RCdEVMSkpRSVZEM2UrNHZCdVVqdkl3bGtRaDVjTlEzUXNnSU1NRWF3VUJzZUF4WXlNUUFyMjhxRS9WRWI1ZUxPVGhDQ0NHSkFYTndoQkJDenBrMERmMWRFdXlWTHZXVHVuVnAxNlhaNVpISkJITndoQkJDUm8xbVl1WDJZSWZVdUx4U0lVbHlYSmRtbVlRQ3gyRUNoQkJDUm9OZmRhUE1sU1JYQjN2a1F4S2FzN0lyNkpaaktuUmxybVFwMDllZGtpSWRLbnErQzV3R2l4b0hSdytPRUVMSWFFRDk3REZKbGcxeVpwaERpbnAxUmRJdjA0TUJXU0krMlNnOTBxUmh5OGFnVjA2bzRGV3A1SFJjZ0FtMG1JTWpoQkJ5enZTckIxZXVBZ2ZCd3BCd3lCWUVKVStsTDAvT0RCOXBEbnFrVGtVdVg5ZWRveUxYcEd0bUJuMHlVSGxDVXZ1NkxkVFpNMDZpUjRFamhCQXlhbnpoRUdXYmlwTS9DTzh0UHROVjdLWUhCMlM1aElhTjlPaDIzYTBCNlhyODU1SmZWeVV6OUxjcUZ3V09FRUxJSkdPL1NsdUdlbUVyWldUakhsRjltZGJaSXAyUC9FeStxSjgvcjRMWEYzVEpHNjQwcVZSSk9xbGUzZ0hkWjVlSzNya216Nkp5Y0lRUVFzaTVVSzh5MG5JZTFaTWVsYkVVRzNMUUovUEZMK3MxcDdkWnVrM3NzTzhHWFFPaTE2bUNOekRLZ2tnS0hDR0V4QkFZR0xBNU9UM2V5VlgyUGhreEVYSjV6M2xHTEVnV2hLaFFzM3FSSE5LY1hUa3FNblhCTVhwRVpMUlBDdVR6NEFpWlJMZzRhR2ZjR0UzTDl2WDFXU1ZlUm5xR2tPRTVvZUpXT3g2K2tncW1ONXpiTzlkUUpUMDRRaVlSZlgyOWtwU1VKRzZQUi93K3p1VTRGaUFmazVLYUl2MSsvMW1mcmVaUVZWTXR1VG01OGxjZnVra2UvL1gvRHdsZWdNT3A0dEdyZmxLamhoSGhjUzJUYy8rYnhmWTFLa2tuWEVtVzE2dTM4WE51ODlwNnRYTXltb2YzUkEwVFlKK1JrTW5CZ0liR1lKQ3hKQ1VsQzJkQ1AxOUN0aTB3RURDakZ4emhJMkIyYk44cHExZXZrazJiTnNyZXZmdWtvckpTT2pvNlRTVEplK2tLQnVSRUlFMldqWEtDYlF3eHdOZzRpQnNHaDdlcnFEWHJkeEM2N3ZNb01uR2dCMGZJSkFJR3VMKy9YN3plSkYyOG5JVGhQRUhuSFczcTgvV05TdUMyYmRzdTZXbHBjdlZWVjhyYXRXc2tLeXRiNmhzYXBMYzNjWjgwZmo1a0QvUkpsNzlUcEhMdnFMYkQrTGZqS203UHVES2t3cFVzWXcwRmpwQkpoajJTeHUremhVd01yYTJ0OHNLTGY1YnRPM2JJVjcveWdOeDE1MmNrTnpkWFNIeUMzVjBTYURrdDlkZXZIdFYyczZSZlZraWZ0S3JRUFNMakpIRHNKUkpDU0RUSXV6VTFOY21QZnZRVHljektOSythRE1GQXYyam9RUjdRRUNObUpra2RoYWJNMWl6YmpjRXVxUXVIS3F0Y1k5Zk85T0FJSVNRT3lJZGlPWGI4dUpDUlVhMlNVaVQrVVFsY3BncGlwcjVlSWFFSDZXSVM1N294a2lZS0hDR0VrREhobUhwZjJjRUJ5UjFWeldPSUs0TEliMXJXVk9wY21YSStSRC9SbTFXVWhCQkN6cE0zSlYwYTR2aE5tSmdaejR2ck9ZdldYS0ZyZkNiWUxuY0cyOHl6TzFlY1lpSU85Q2FFRURJbVZMbTgwdXJ5U094Z0NnamJrK3FWdmVaS3Q1bEpobU82Q3RzVndSNjVYSmVpNExrTnkrQmNsSVFRUXNZVVBORzdSY1dzWFgybnZMQUhCb2xxMGMvYlhHblNIdlRZK0xhTVlFRHloNWg0SzFsRGxBdkRjMUxhOWtITnlibk9UYXBZUlVrSUlXVE1xTEluZWlkSlhyRFBQbU13ZDExNFF1YTNWZVFhZ2w0YmYzOXJzR1BZL1Z3YjdMWkg3V1M2QXZLRVpNbTV3SmxNQ0NHRWpCbVlsN0phUlc2RGhBU3VRdDl2ZDZVTy9vNHc1aDgwd3dhM3loR3hvY0RVWC9uQjBDVE1yMnA0czNtVVR5MWdpSklRUXNpWWNVcTl0NVBCTTA4R3FGZEJPK2c2OHpoVVBDZ1YzdHdMcmd4enJWWUhleTBrR1ErRUs2ZHBxQlBqNU1BZVNiRXB2VVlLQlk0UVFzaVlnVmxKOEhpYlRwVXZWREhDNnpvVjQzblowOERoMlVtcWhTdEhrcE5icUZ0aHYyVXljaWh3aEJCQ3hneUlGMFN1VEtVSlQvckdBMHZiaHdndEluVFpIUFRZdzB3eE5HQ3NvY0FSUWdnWlU5cFU0SGFxZUdIUWR1VlpaTWJKeVVFTU4yQm9RTXlEVHp0MVg4OXIvdTBGWGFkcWxOV1U0U0lUUWdnaFpHem9VNC9zYURBMDNxM3BMS0lFancvTFc1SW1HTDdtaThqSjFhbm5CMDhRdjlXN1BMYmVTSWdlQjBlRkk0UVFNa1pnWVBmSmNERkk5d2puRTlualNyRjhHNWdkTGxMQmNJTzNORSszSjZJS2N5U0U5VTI4anRJUlFnZ2hZd0dtNW1vYVpVay9RTkVKSG9DS25CeEdhS05xY3JUaUZvblg3WFpMZW5xNnBLUWtTMThmbno5RkNDRms0bWpXVU9UemttN3Z1MFk1bTZUYjdWSXRTNUcwdERUNzdFMU5UZFVQNlFLaEk0UVFRaVlTNU5ucXo3SCtFUkZKajJwWlptYm9hUVR1NU9Sa3lkSVBJMzJVT3lHRUVESVpnWXhoNnNsWnMyYlpaL1BnTm0zYWdKOWsrNDZkMHRYZExjRUF4WTRRUXNqRlEwcHFpc3hXWVZ1L2JxM01uVHZYdnJNaWs0VUxGMHAvZjcvMDlQYksvdjBIeE85SEJVdVFPVGxDQ0NHVEZvL0hJMTR2d3BsQktWSlJXN2FzVkRadTNHaDVPR0NCenZ6OGZISHJpajA5UFNwMEE5TFoyU205S25iZFhWM2lSQzZIZStKQTFHOTAvZ2doaEp3THJ0aVA4YXY4QjhlNWVaTWtWVDIzckt3c1dicDBpWlF1V1NKTGRIRUV6alV3TUJDRTk0WWNISmErdnI3QlJYK3psZUxsNTVpekk0UVFNdDdFRzhybWZJZmlTQ3dRT05TVE9NV1NZYy91bS84Rk9NUkp2bnFrL09VQUFBQUFTVVZPUks1Q1lJST0iLz4KPC9kZWZzPgo8L3N2Zz4K",rSe="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjkwIiBoZWlnaHQ9IjgwIiB2aWV3Qm94PSIwIDAgMjkwIDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KPHJlY3QgeD0iMC4yNSIgeT0iMC4yNSIgd2lkdGg9IjI4OS41IiBoZWlnaHQ9Ijc5LjUiIGZpbGw9InVybCgjcGF0dGVybjApIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjAuNSIvPgo8ZGVmcz4KPHBhdHRlcm4gaWQ9InBhdHRlcm4wIiBwYXR0ZXJuQ29udGVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgd2lkdGg9IjEiIGhlaWdodD0iMSI+Cjx1c2UgeGxpbms6aHJlZj0iI2ltYWdlMF84ODM0XzMxMjAiIHRyYW5zZm9ybT0ibWF0cml4KDAuMDAxNjg5MTkgMCAwIDAuMDA2MTIzMzEgMCAtMC4wMDIxMTE0OSkiLz4KPC9wYXR0ZXJuPgo8aW1hZ2UgaWQ9ImltYWdlMF84ODM0XzMxMjAiIHdpZHRoPSI1OTIiIGhlaWdodD0iMTY0IiB4bGluazpocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQWxBQUFBQ2tDQVlBQUFCWWZoQmpBQUFBQ1hCSVdYTUFBQllsQUFBV0pRRkpVaVR3QUFBQUFYTlNSMElBcnM0YzZRQUFBQVJuUVUxQkFBQ3hqd3Y4WVFVQUFETVNTVVJCVkhnQjdkMEhXSlpsK3did2s3MFJRY1NCb09BQ1FkeTczRms1VXR2Wit0c2V0cjdxeTlhWDdjenFhKzloKzZ0Y0RTdEhXbTdOaFJOa0NJcUNzdmZtZjEyM1FpaVl2dmhpQXVmdk9EamtuVHd2OHQ3ditWelgvZHlQVFVob2VBV0lpSWlJNkpSVVZGVEFGa1JFUkVSa0VRWW9JaUlpSWdzeFFCRVJFUkZaaUFHS2lJaUl5RUlNVUVSRVJFUVdZb0FpSWlJaXNoQURGQkVSRVpHRjdFRkVSTlRFMk52Ync4UERFM2IyL0Jocy9DcFFVbEtDN093c1ZKUmJiK2xML3VVUUVWR1Q0dWJtaHFEZ2pzak56VVZ4Y1RHbzhmUDBiSWEyL3Y2STNiTUhSVVZGc0FZR0tDSWlhakswOHFUaGFXOThQSEp5c2tGTlI0c1d2bWdmRklROVVWRW9MeS9INmVJY0tDSWlhaktjbkoxUlhGTE04TlFFcGFlbndjN09EdllPRHJBR0JpZ2lJbW95N0d4dFVWSlNDbXA2dE9wVVVRSFl3RG9Zb0lpSWlLaUpzTjRrY2dZb0lpSWlJZ3N4UUJFUkVSRlp5R29CU2c4UmRIZjNNSWVIT2prNW9UN3BVUlNEenprWDdRSUNZQ21kUERaMHhFalpWbmNRRVJFUjFZVlZsakhRTUhMOWpUZEJaMmVWbFplanFMQVEreElUc2ZLUDVjakx5NE8xYVlBSzd0VEpyTitoUDhmU2JlM1NwU3ZpWW1MTUdpQkVSRVJFbHJMejlmVjdBcWZKMmRrWnZmdjB4Y29WZjJEVmloWEl6c3BDOXg0OXpPR0NpUWtKNWo2T2pvN3c5bW1CRWdrOWxlc3YyTm5abXpCVVhsNG10L21ZeGEwY3BFSlVJVUZNRHpWMWNYRXhJY25XMWhiTnZiMVJYRktDQ25sc2FXa3BFdUwzWXYrK1JKU1ZsWm5uMHZ0cU9EcCtnU3hudVY1WG15MHNMRENYQ3lYY3hjWEdJQzA5dFdvNzlENzY4NHVQMlRZN3N5MzYvTTJiZTh1L3BjZXNHMUc1VGJxNnFUWFdreUFpb3ZxbkhSSlhOM2RrcEtlakxnSzZEa1RyRGhGbzBiWXp2Rm9Hb3Jnd1I3N3kwWmg1dHdyQytKdi9pL3pzTkdRZXRxeG80ZTNYQWVOdmVRMFpoL1lpSnlNWi96VGZsaTNOLzMxbGRqZ2RWbDFJTXpNekU2bUhENW12OWgwNm9HT256bGkxOGc5MGoraUpjNFlPTTBGRFE4a3ZQLzJJcU4yN01HVG91UWdKNldZZXE2RnA3cmZmWVBKbGx5RW5PMGRDUzNNVG9uWnMzNDdXYlZxYkZxR05qUTNtZlBNMVVwS1RjZG1WVnlGeTZ4WnMyYlFSWXk0Y2k0REE5dWI1aXlWQXpaLzdIZExUMG5EKzJIR3lIVUhtK2pJSlhmUG1mSXZjbkJ5cGx0Mk1iNy8rQ2tuNzkySEl1Y1BRczNkdmxNc3ZVK2ZtTC83MUYwVEx0dlh0UDhDRXdzek1EQlA4MUk4TDVpTStMaGFoWVdFWU5tS1UrUTl3a1cxY3UzWU4xcTVhQ1NJaWF0ejZubmNqbXZuNm8wUkNrNDNzU0R1N05jT3V0UXV3OHZ0WHpRNitOVjN6OER3cy8rNTU3SXRlaDM5U2ZrNjZCS0FFNU9kbXdGS0YrZG5JelV4R1FXNG1HcHQ2V1luY3M1bVhWR2Q4Y09oUUNueThXMkR3a0hPd1RjUE9sczBTU3ZwZ3hPanpFQjIxMjl6WHhkVVZLMzVmanRpWVBTaklQMUlsMG9yVVYxOStqbDY5ZWlNOG9vZTVYYXROWThkZmhLNGhvU1pBVmRMS2thNHErOFA4ZVVoTlBZdysvZnBYQlo3TzBxcjdZY0U4cEIwK2NyMlBYSzhCcWxLYnR2NXlmVDlwTmY2T21PaG85TzdiRDhOSGpNVGhRNGZNN1JyZ3RtK0xORzNDc2VNbm9JL2N2amMrRHYzNkQ4VEJwUDFZOU12UDZOdzF4S3h1YXU5Z2oxS3VMVUpFMU9nZFN0aUJoUjgvQ0Vkbk4vUWFjUzNDQmszRzFoWGZJRHN0Q1c3TmZOR3Vjei9wVXRnaEtYWVRzbEwzbThjNHVYbWlqVlN1WE55OWtYNHdGaW1KTzB6aFFQbDM3QVB2MWtISWtzY2ZpTjBzbnlXRnBzcmwzcndsL0R2MWtjNU5BWkwzUmxiOWZEc0hKN1RyMUJkcHliRm82ZDhWRG80dUVySTJJQy83c0xuZHdja1ZiVHYyZ3FkM0cvTnpEdTNiWmNKZGl6YWR6SDNMeWt1a2d0WUZNWnVYb0hYN2NPUmtwa2lWcVlOVU1teXdiODhHTlBjTmdJL2NOL1ZBRkZMa3RaYVhGaVBxejRYSWsvc3BWL2ZtOEpQSHVVaDRURW5jaFhUWkRuMHRicDYrNXVmcXEwcExpa1o2U3J4VTUzS3hhOTMzOGhxT1ZPbWNYRDNsOTlQZkJNL1VBOUZJamoveXVwcExOYy9kc3lYeWNsUGx1YnNqSnpVSlNYR2J6SGJyNzdKdHg5NW8xc0lmR1NrSk9LRFhWMWh2T1lLNnNtcUFHaVhCU0FPSW5welJWcXBGbXpmK0NhK2psU1Q5ZDRnRUtVY3BuMnE3VGN0b0tqTWpBOXNpdDVwNVU5cm1VOXNpSTVHZW1vcWtBMGtJbGlwVzFLNmR5SkhnbzNPVzNOeU9uZnlkbloyTkFtblBEUjgxQ25FeHNZalpFNDE5MGpiVU1tMnB0TmVHRFI5cFFzOXVxU3BwQ0hOMmNxNTZySCs3ZHNqUHo1Y3ExemJrNStWSlJXdXphVDE2ZVhtWjIzWCtWblJVbEFTN2ZBbFZoMDFZMHlwWVNrcXlDWExuanh0dnpxdXo0dmRsREU5RVJFMUVSVVc1ZEMxS1VaaVhoWU54V3hCeDdoVndsbURnS01GbDlOVlBtbisxODlIL3dsdngvYnQzbWRiWCtkYzlEM2N2MlluUFBJeVc3VUt4K1BQSEVMZjlkL1FkY3hNaXpya1UyUmtwRWx6YUlYTGx0OWo4MjJmb1BmSTY4N002aEo5cmlnclZBNVNHbmZPdmYwRStkd3Jrc3pQWEJKcWM5SU9ZLytidEpteWRNL0UrZEFnYktqL3JFQWFPdlJNcjVyK0VuUkppK3AxL0V3SzZEREFkbDBQN2QrUHd2dDBZZmMxVHBwcFdXbG9FaithdEpXenRORUhHVnJwRkdyWitlTzl1bEJZWFlmU1VKN0hzMitkUUpxOTMzRTJ2U0JCcUpsV2xkSnd6Nlg3OCtQNjk1bmN4OXFhWFVaQ1RJUm5BQWE0ZTNwanoybzJ3ZDNUR2VkYzhnMTgvZXhURkJYa1ljODNURXVRNm82Z2dSd0pYQzltMmw3RnIvUS9vTmZKYUJJV1BrR3BYcWdRbWU3bk5HMHUrZWhJeFc1YmkzSXNma05kenJnVFBPUGkyNjRwdDhqdGE5L083K0tkWk5VQWxKT3pGSVFrWHVUbTVKclRvbkNLZHNLMmhRNE5TUVVHQldRSDBRRktTbVl1a2REN1Q4UXRiNlIrTGNmVHFzcU9YOVkvMmVGcFIrdnpqajB5bHlyOWRBQ0o2OXNSS3FWaXRYN2NXSDMvNHZyVGJ3aEVZR0loSmt5L0JodlhycGVYMzV6R1AxKzJwN0lWcW9xMmVhdlY3RFdGbW02cjk3RVUvTHpTVDBBUGJ0MGYvZ1lOTXErK3oyUitiOWlFUkVUVnVIdDZ0RVRiNFloTXd1dmE1MEZTQ05NRDBIWE1qOUZObDN0dDNvS3lrR09OdW5JV2V3NmRna3dRaXY4QXdySlN3RUwzcEZ3U0dEakdmY3c1T0xpWW9iZmoxZld4Zk13OUJFaEtHU1BpSmpWd3V3ZVVlM1BiaUtxeGIrSTVjWGxaakcrUmpGVHZsTVdzV3ZtMnFTWk51ZXd0ZCtsNkl3MGxSNk5UelBBazd6eUpoMTJyMFAvOW05Qmg2WmRWejVFbVltL3ZHemNqTE9neGZxVjZwSFd2bjQ4L0ZIMkg0WlEralMrL3o4Y21URStUNWJYSGwvVitZQ3RqZUhhdXFmcTY3bDYrcFR2MHllem9PU3ZXb1haZis1clBaTDdDYmVUMi96M2tSQjJJMklxVC9lTmhMa0VTMXo4N092Y2FnVFZCUC9PK1ZhNUdSSEM4L2J6cjZTWUNNalZ4cWJpK1dVTFZBZm5lNmpaZmUvUkU2OXp3ZjhkdFhTT2diaU8ycjUySHI3MTlLK0F3eGxhNnpnVlVEMUI1cGc4VktCYWk2MUxRMFU4SFJ4S3NuOE5PeklZZUVkc09Xelp0Z0RXMzkyMkhnNENGWXZYSUZkdTNZamdtVEpxT1pWM1BUbmhzNFpEQTJyRnVIUFZKOUdqOXhFdHc5anExZTdVdE1NQUdvVis4K3N1MVJadDZUVnAweU10TGgxNnBWclQ5UHcrQkZreTlHa3JUd1ZxOWFpWHdKaFQxNzlUSVQ2Um1naUlnYVAxZHB3d1dIRHplVHlMWGQ5dk9IMDFHUWwybmFVRnA1bVhEenExWDMwL20zV29HS2pWd2kxYURiRURIMENxa21iY2VHUlIvQTJ5L0lmS2FFRGI1RUFzY0VVN214czNlRWgxZExISkxXMjhra1JLMDFMYTRNYVpWbEh0NG4yeE53cE9WbFp5Yy82dzRUVGh4ZDNPSGc0R3lxWWlvcmRaOEpUOVdsSFlnNWNsdDZrbnlPRlVnMUtkTzB6WXFsbXFWQnFyb2NxWlFsN2w2RFVWYytqdHlzVkFsUlc3Qnh5U2NTZWxLUm1iSlhLbFV6SkV3ZXdQNllQNUc3WWFHMElmMnFIdHVpYlNlcFdtV1k4R1MyZi9kYWRPd3hHcDQrYmMxbGJVRnExVXpseWpZNnVyako3NjhZdXpmOGdQREJseUpVUXRuaC9kRVNTRC9GMmNES2M2QnE5aVRUVWcvanQ2VkxNRkxhZXhHOWVwdi9YSjBMVlhTMEFsWGpNUlVuZnM3Szc2cTNQblcra2xhS0xybjhDbk5FbkQ2dlRpN1hFT1FnZjRnWFRiclkvQUZyTU5xK2Rlc3h6M3p3d0FFSldHdE5pT3Jicno5SzVIN0xaVnV6TWs4ODJVMS9sczZKMHREV3AyOS9jN1Rlbit2WElTZWJKNllrSW1vS2RGN1JUeC9lajY1OXgySFlwZFBSVWlwQW1ZY1N6RVJwYmJWcFc2ckNkRTVzVEFEUTl0YVNMNTZRNm8wZkFrTUdTNlhxQm1tQnVXUFZndGZNWitKeXFSYWxKOGNkZlhZYjA5NnFJa0htUkR5YnQwRVNOc0xld1FtT3pxNm1SVmFRSjkwZStYbUxwRVdZbTNHdzZqa3JqNENycVBWVUpoV25jTTBSK2xvV2Z2U0FoQjUvQkhVZkx0V3RLOHhyWERIdlphbTgzUTZ2RnUwUTNIMEVlby82UHhPV0VuYitWYjNLVGpzZ29jZ0ROdkthOVBlakxieXlraUtVRkJYVStLSFZPMDRiRm4xb3FtUnRPdlJFanhGWFkrZ2xEK0NibDYreitxUjlTMWtsUU9rOHBGZG16VHpoN1RxSGFVL1ViclBNZ001anFqenMvL2ZmZmp2bWZ0cnllL2V0TjZvdWEwVkp2eXA5KzlXWFZkKy85L2FiVmQvcmtYbDZkSjh1aWFCdHdrcGZmL0ZacmRlLzh1SUxWZCt2a1NxU2hpaFhOemZURHF6Y3RyV3JWNW12U3RxMnE2VDMxOUNraTRicUhDb3VZMEJFMVBURWJWdUdiZ011a3FyU1ZhWWFwRWZMRGIzNFFYU1J0bDYyVkdINmpiN0JUTXJlczJreExwdzZVOXBRYzNBZ2JndUs4bk5RVXBCdnFrRjZlSCsvTWJkZ3l4OWZvVlZnS0lJalJ1Rm5DU2dwaVR0TnVBZ2JPQkVGT1dsbWNubDFXa2pvTVd5S21jamVxbjJZbWFTZXNHdVZDVW82UDBzclhiRmJsa2hMYml4Y1BKcWJ1VXpXMEY3YWoyT3VmY2FFR3ExNkZlVm5temxVNFVNdWxkQjBuYlFDUDBHNmhNbnlzaElKZE1ldXRhanp4ZlExamJ6OEVSemN1dzA5WmZzMWpPcmsreE54Y2ZmQ3BmZk94cjZvZFlqZHV0UlU4NXhkUGM2S1NlUldXUWZxVk9pTDFUV2E2dXRGbHg5ZEgrcFVyei8rUG5YWk5nMThaOE4vSWhFUm5aclRYUWVxVlVBM1pFdGxaLytlUDZYeVVtSW1jZnUwN2lqdHEzaFRiU2t2TDBWZzEwSHdDd2d6YmF3Tml6OHlZVXExQ2VwaDVoU2xKa1ZqNDlMWktNelBRa3JDTmpOL1NJK3FzNU5XMjVibFh5QXg2c2l5QlZvdDhwSktqLzZjZy9GL2RWRGNtcldRZHRZRXhFY3VRNXZnWGxMTjhrRGtpbStrVGZpYnFSQmxwaWFZdVVaNmRKOU95dDd3NjRkbS9TWTlZaytYSk5nWHZkNDhqN2IxdkZxMk45dXQ3VE1QcjFabVhsZU1CQzl0TGJhVjdVMldJSmVkdGgvTi9kcWIxbDF5d25iWTJ0aVoxNkd2SnpsK0d6WXQvOXkwRVYwOWZlUjE5SkhmVVJqMmJGbHNKb2ZyaEhCOWJQeU9QMHhZeXNvNGdJQXUvYzN2UjQvZVcvN3Q4eWdwTG9SdjI4Nm1EWm9vUVZUcDVkeXNROWk3WTRVSmhYcGtZMERYQVNhVXJWMzRUbzAyNUtteTVqcFFOaUdoNFV3QVJFVFVKSGg2ZXFKRlN6L0V4ZXhCZmRFanozVG5XcXN0MWRuWk9aajVTUm9ZcXRONVJscEpLaTdNcTNHd2xLNDFWVkd1SDlOL2ZWVHJrV2dYVC9zQUM5NjUweXd6b0dGSDIyalYyZHJwVVhST1I1L1QraC96T2w5THQ3djB1TmRvTHlGUTIzTmxaU1YvODFoSDJUNTdhZDJkK2dLazJ2YXpkM0Q4cTkxWFJ5SGR1cG1Ed0lwT2M4NnkvazdyWlIwb0lpS2lwcXIwdUlCVVNVTkZiY0ZDUTlNeDg1NnEzMWJMRkJGOS9oUnBnZW0vNVNjSUtucDlVY0dKUTh6cDBxcFliWFJTL2NrZlcxd2o4SjJNaHJMVERVL1d4Z0JGUkVUVWdHU2s3TVc4dDI0RC9iTnNRVVJFUkVRV1lZQWlJaUlpc2hBREZCRVJOU2sySURwOURGQkVSTlJrNk9IcmVpUWNOVDIydHJZU25tMnN0bllqQXhRUkVUVVpldm90QndkN2VIazFCelV0dWdhVW5uTHRaR3REbmlxdUEwVkVSRTJLbnFHaVUrY3VLSlZxbEo3cXF3TDhHR3pjYk9CZ2YyVFJnYmpZR0hQYXQ5UEZkYUNJaUtqSjBRL1FxTjI3NE9MaVl0bzYxUGhwMVVsUDZXYk5SVVVab0lpSXFNblJ1VkI2YmxhaXVtTDBKaUlpSXJJUUF4UVJFUkdSaFJpZ2lJaUlpQ3pFQUVWRVJFUmtJUVlvSWlJaUlnc3hRQkVSRVJGWmlBR0tpSWlJeUVJTVVFUkVSRVFXNGtLYVJFUlVkeFZBV1htWjFVN1FTbFFmYkcxc1lHZG5yMmQxc1JvR0tDSWlxaE05TFVaaFFRSEt5cXh6Y2xhaStxU243WEYyZFpVd1paM21HMXQ0UkVSVUozcG1lNFluYWlpMFNscGt4ZlBoTVVBUkVWR2Q2QWxhaVJxU3NySnk2VG96UUJFUjBUK29vb0x6bnFpaHNVNTRVZ3hRUkVSRVJCWmlnQ0lpSWlLeUVBTVVFUkVSa1lXYXhESUducDZlQ09zZWdZREFRTGg3ZUNJdkx3OHgwVkhZdldzSGNySnpRRVJFUkdTSlJoK2dtbmw1WWRMRmw4TGJ4NmZxT2cxVXJWdTNScGVRRUh3L2R3NnlzN05CUkVSRWRLb2FkUXZQd2NFQkY0d2RkMHg0cXE1bFN6K011WEFzN096c1lDMWp6ajhmclZxMXdwbWkyejc5NFljeFlzUUlFQkdkalM2YU9CSGR3c0pPZWo5SFIwZmNmYys5R0RobzBFbnY2K2JtaGtjZWZReEJRVUUxYmhzdTQrRzB1KzQybndGL0p5SWlBaSsvOGwvY2MrKzlxSXNMNWZOanl0WFgxTGplMmRrWno3M3dBcnhrQjU0YXIwWWRvQUk3ZEVEck5tM045N3FBMXM0ZDIvSDkvTG1JMlJOZGRaKzIvdTNreXgvVzhxOS8vVXNHaW02b1R6ZmVkQk1lZVBCQjg3MitMbDBKdUtDd0VFUkVaNXVBZ0FBOCt0amptSHJEalNlOXIrNFFob2FHd2wvRzVaUFJrT1RuNTRmazVPUWF0K24xSWRKaDBKV25UMFREMmkyMzNZWUNHVCtYTEY2Q3V0RFBqbTdkam96M0dxVCsvZEIwODMyaGpNZTZXT1AxVTZlQ0dxOUczY0pyMWFvMWJHeU9uUGptOE9GRCtHM0pZck55N3I2RUJIaGUwUXd0NVUybWI3QTJiZjJSS05mVk4zMmpCUVlHNHRDaFE0amNHb25pa21KenZidTdPN3AzNzI3Mmx2YnUzWXVFbzl1aWIzQzl2bG16WnRpM2J4L2k0dUpNU3pKSWdxSHU0ZlRvMFFOYkk3ZGl3ZmNMa0p1ZGF4NWpiMitQenAwN280UGNaLy8rL2RnZHRSdEZoVVh3OXZhR3I2K3ZHYUMwZlpsMElFbUNaQXdYd2lPaWVqVjAySERzbC9FclRNYS9UcDA2WWMrZVBlWjZIWHM3ZHV5RTRJNGQ1ZlpFN042OXU4WmpQVDJieVgwNklscDJlbk56anAydk9tblNaQ3o4NlVmazUrZWJ5NEdCN2MzT2ExcHFHbHhkWFkrNWIyRDc5aWFZNVdSblk5T21UZVl4Z3dZTk50V3JiemI4RDdsNVI4WlBIUnM3ZCtsaWxncUtqWTB4WTZpenM0dHNZekNpbzZKUVVsSUNGMWNYR1lPREVCMzkxNDU0Y3hsZk84cDkyc3BuU1krZXZlUyt1N0ZnL253VEhEK2RQUnZwYVdrZzYvRnA0WXVSNTQyQmkzd08xdVp3Nm1Fc1d2aFR2WCsrTmVvQVZSbWVWRWxKS2NxTy9qTDFsMXBTV2xKMW00YU8rbmJycmJkaTNQaHgyTEo1aXdsU0crVk4vTnl6ejVydzlNU01HV2pSb2dYUzVFMFdIQnlNWjU1K0JwczNiOEtMczJhaGVmUG1PSERnQUxwMjdZclhYM3NOUlVYRjhHL1hEazVPVGhnd2NDQzJiOStPSjU2WWdaOSsvQkZ6NTg3Rm5kT21ZZmp3NGRpNlpRdDY5dXFONWN1WFlkYUxMMkxreUpHNCtwcHJaSEJKUllvRXVQRHc3cGc1OHdYODhmdnZJQ0txRDdvVE9HbnlKTXlaODUwSkxNT0dqNmdLVUhmZGZROHVISHNoRnYyNlNOcHRkK0dINzcvSEp4OS9WUFZZZjZudXZQcmE2MWdpTzc0NkhoNnZvK3dvN3ZsdmpQaytJcUlIbnA4NUV5bFNqZEtkeEJheXN4Z3ZPNXhxd0lDQitJK01zWHE1dlFTcG1KZ1lQUGpBL2JJOWcrRGk0b3JlZmZxWXNkZFJkbUJmZWZVMTJZSGRhNEtienBXOTd0cHJFQndVakVjZWV3eTNTT1gvMEtFVTlPOC9BTk9tM1kxcnJyNnFhbHQwcDdWVHA4NW1aMWVuVTJpWFEzZFFQVHc4VERXTUFjcTYwaVFnN2RnV2liRVRKcHBpUW5YSnlRZXhidlhxTTFJY2FOUUJLaVA5cnovYU5tM2FZT0NRSVlpVVlCRWFHbWFxVTMvZEx4MzFxWjBFbnZQT0g0UHBVdDdkdG0yYnFRUjk5dm5uNkQ5Z2dQbGVxMUpUcGt4Qmdld1ZUWnc0U2FwTzRXYkErTzdiYjgzZVVubEZPZTYrKzI0WkNBYmc2YWVmUnQrK2Zjd2V6enR2djMzTXora2llMDZqUm8zQ2ZkTFBqNUs5SmIzOCtodHZ5S0Qwc2JtOXVMZ1lOOTk4cy9uRDB0RFdyVnNvQXhRUjFSdWRZK1R0N1lOdnYvbkdCSnZSVWpYNC9MTlB6VmdVRmg2T05Xdlc0dDEzM3NhWFgzNGg0MlJBMWVPMFVuWDU1WmZqNTRVTDhkRkhIOVk0ZDVtR2t0eWNiR1JsWlpuTFYwMjVDdHNpSS9IdzlJZE1KZitaNTU2SHMreGtxaHRsekZ1MmJCbmVldU4xTTk1KzhOSEhDQXNMeDF0dnZZbSsvZnZocXkrL3hNb1ZLMHcxNnZubm5zWEdqWCtpaFk4djNwVHhWVU5SZVhtWmVaNXErK00xckZ1N1ZzYnRDTFBkTDc4MHkxeW4weXNPSHo1c3FsVzdkdTRFV1pjR0tHMlZYbnpaNWFaS3FEUThmVEg3WStUbDV1Sk1hTlFCYXYrKy9TYVV1T2pabDZWYzNLLy9RTm5iNkhmTXBIRXR5ZTdmdncvMVNmZDZQRDA4VGJWSTZadEtqL3p6a1JDa2J6Z05TUVZIeTlEejU4OHovK29nNE5lcUZXWks5VWlyVkxwSHBWV2x2Nk9EZ3c0b0J3OGVOSmZqNCtPUmtaR0JYcjE2bWN1SmlZbFZxVHhUcm5kMzl3QVJVWDBaTjJFQ2l1UkQ3bC8zUDJDcTdEcmVCVWxGWjhlTzdaajczYmU0NWJiYjhlbm5YMkRuOWgyWVBmdVRxc2ZwcEhNZG0rZk5tMnVDeVBGYXRteHBwaVlVRkJ3Wk56dkp6dUpuMGlyVDhVMi9kdTdZVVRYdTZjOXMzYm9WK3ZYdGF6NEh0SG9mMFNOQ0tsRjdqbmxPclVKZGU5MzF1UDJPTytIbTVtcCtocWVuQnpJek0xRVhHaEx6cERYbzdlTU5xaCt4VXVsYk1IY09McHA4c2ZsL09wUGhTVFhxQUpXWm1ZRW82YXYzT1BwR1VzY2ZjYmN0Y2l1eWorN0YxSmNjNmQwWEZSV1pjcTRHSjIwdGFvKytVSzVMa2g3N3VlZWVXM1ZmSHg4ZmN6K2RzNlRWb3VrUFBXVG1QOTBrMyt0Uko1VnNhOWtkeXBFL0hEZDVYc2VqZTE1ZTB2NXpjWEV4a3l5MXRGeFdWbFoxWCt1ZERZaUlxQ1k5K3Jsbno1Nm02cTVWSEcxLzZWaDAzcGp6VElCYUtOV2xkZXZXb1lOVWZtNjcvUTQ4OXZqanVQbW1JeFBOZi96aEIybUxkY0pEMHgrV01mRGZOZG94cWFtcGNOYXhUbHFFS2wwdXQ1WXVReVYzOTcvR3lxeXNUSHo0L2dkWXQzNmR1YXdqcDM3WU9oMGRKeXZwTnVpMlBESjlPdXdkN1BIOEN6UE45VHB1Nmc1dDVXZUhsNHlsSjFKOTJvZyt4dG5KMmV6RVV2MkoyclVULy91eTBNeVJPNVBoU1RYNmxjaFhydmo5bUZaZWRUb2ZhT1Vmdjljb0Q1K3VMbDI2NHR5aFE4Mlg5dGwxOHJkV2cvNTEvLzNvSS8zMnU2UWRwNVdpSFZLUjBzR2xyWDliMDhMVEZ0MnNXYk13ZHR3NGxNcWJWdCtMR29hNmhvUkl1KzJ2UTRDekpJVHBkZHIzcjA0bndxZkxtMVdEbCs1OTNURDFCaFBlSXFXMFRVUjBKdlhyMjA4cVBuWjQrdW1ucERYMm5QbjY2SU1QTUhIU1pMT0QrTG0wem02NTlUWVpuek9reGJYam1KQ2tFOG9mZWZoaGRJL29qanZ2dXF2R2MydVYzZDNWelR5UFdpRXRPSjMrTUhic09QUDhFeTZhV0hYZnBVdVdZdXFOTjVxajh2cEtGZW85MlFadEh4N1B6dDVPZGppZHpkSURRNGNOTTlNK1ZMTDhMTjE1MVNWeGV2WHVoVXVsWlZTYjB0SVNCQVVIbXpsU1d1blNuV1R0SE1RZG5ZdEY5U2NoUHM3TWl6clQ3SHg5L1o1QUk2WjdEMXJsNlNpOTdNcTlGYVc5MDNuZmZXUDF4QnJSbzRjcFZldWJWYi8wQ0JJTk1FdVhMTUdnd1lNeFRONllXaVY2Y2VaTWM3U2RIcEduUjNybytsRWFydlMrNzcvM0hsS2x6YWZiZThINUY2QmRRRHRzbDZDbDEybTc3MEJTa2ptcXBHdElGNnhldmRxc3I3SlRldXc3cEd5dEZiZSsvZnFaaVl5bFphVjRjc1lNNU1wcjFLTkxkQkw5NXMyYnpYWUdCZ1NZYXRpT28yMUZJaUpMRlJjWG5mQzJzZVBHWTdkVUIzUitVYVdNakhRSkdVRXlUa1hKMkxYR1ZOL0hUaGlQOHJKeVBQdnNNMlpKZ2M1ZE9tUDN6bDJ5Y3htSnVOZzRHVE9IbTBCMWZDV24zNEQrNW1nNm5Sb1JIUlZ0cGpxY0orT29qblhMbHYxbVduSWJOcXhINU5hdHBySi93UVVYb2xQbnp2ajZxeS94MjlLbFp2Sng1ODVkOEtmY1I4Zmh4SVJFMCs0Yk0yYU1hUTlxaTIvOSt2Vm02a04yZGhhR2p4aHVEdHhadldhTm1YS3hmTmt5TTgxQ3V3czZaMVhIOFRBWmkvWG82TitYTDBkd2NFY1R4TjUvOTEzVGpxU3poNE44dHRyODNhUzJVMlFURWhyZUpMbzVmV1d2WU1pNVE4MHZUU3RPaTM1ZUtPRmhHODQwRFVYNlpqcSs2bVZqYXdNNzJWczd2bFN0cFdRZFhJNmZCNkN2UTc5cW14K2cxMWYrbk5wdUp5S3lCcDNJZlRvcXh5cWRMMlJwSitDYWE2OUY3OTY5OGRDLy8yMTJpSlcyNVU3MFhIcWJqcS9WcHpMVVJ1K25vZWg0ZXJTMlB1L0pIbC81R1RQanlTZk5hY05tdnZBQzZPemlLbUhiMXViMEduRDZmOXhrVGlhOFZmWVFrdllkbVN5dWE0NUVSZTNHUCtGRWIrNks4b3BhRDdzc0xTbXROUVRwYzV3b0hPbHRPZ0F3UEJIUjJheHlyS3JMTklyNTgrY2pJek1UYmR1MnJicnU3NTVMYnp0WitLbThYMjFPSlh3cC9ma2F3dlRvdzQ4LytnalVlRFdaQ3BTSzZORVR3MGFPd3RMRnYySTc1d1VSRVoyVzA2MUFFZjBUckZXQmF2UW5FNjV1VDNTVStYZjNybDBnSWlJaXFxc21GYUIwd3VIV0xadEJSRVJFZERxYXpCd29JaUlpSW10aGdDSWlvanF4eHFIZ1JHZVVGZjltR2FDSWlLaE9IQjExTlcrR0tHbzRIT3p0VDNzQ2VTVUdLQ0lpcWhON0J3YzRPRHF3RWtWblAva2IxYjlYeCtOTzRYTTZtdFFrY2lJaXNoNE5UazVPem5Cd2NEeTYvaExQc2tsbkl4dlR1ZE5UQzFrVEF4UVJFWjBXUGZjYlVWUER2M29pSWlJaUN6RkFFUkVSRVZtSUFZcUlpSWpJUWd4UVJFUkVSQlppZ0NJaUlpS3lFQU1VRVJFUmtZVVlvSWlJaUlnc3hBQkZSRVJFWkNFR0tDSWlJaUlMTVVBUkVSRVJXWWdCaW9pSWlNaENERkJFUkVSRUZ1TEpoSW1JcU01S1MwdFFYRnlNOHJJeUVKMnRiR3h0NGVqZ0NBZEhSMWdMQXhRUkVkV0pocWZDZ2dJUW5lMHF5c3RSVkZTSWlvb0tPRG81d1JyWXdpTWlvanJSeWhOUlExSlNVb0x5aW5KWUF3TVVFUkhWQ2R0MjFOQlVXQ2s4S1FZb0lpSWlJZ3N4UUJFUkVSRlppQUdLaUlpSXlFSU1VRVJFUkVRV1lvQWlJaUlpc2hBRFZEMnl0Yk1ERVJIVkZCQVlpSzVkdThMVzFoWmhZZUZvM3J3NWlCcVNScnVRNW9CQmc5SE15K3R2NzVPZmw0ZFZLLzVBZVhrNUhCd2NVVkp5K211YXVMcTZZdW9OTitEQ0N5ODBsN096c2pCNzltejgvUFBQSUNKcWFweWNuUEREVHo5aHdmd0ZlUE9OMTZ1dXYvTEtxK0RoNllGbm5ub0swKzY2Qy9QbXpzVXZ2M0NjcElhajBRYW9nWU9Id01iRzVxVDMyN0o1RTRvS0NuSEIrUEZZTUhjT1R0ZE5OOTJFNFNOR1lNYU1HVWc5ZkJpREJnM0NiYmZmanVUa1pHemV2Tm5jUjdmTHpkVU51WG01TlI2dlM4M0Q1cThGNnR6ZDNaR2JlK3o5Ykd4dDRPNHExK2Zub3FLODRwamJkRy9PMGRFUmhZV0Y1cks5dlQxc2JXeFJYTUlGNzRqb3pPdlhyeC9jM054eHpybm40cXN2djBCNmV2cEpIMlBHT0hsTVhsNis3T0J5clNrNmxwT3pDMXExYW5YQzI4dEtTK1V6OXlCSzVkLzYxR2dEMUttRUo2VmhZL1NZODlHK1F4Qk9sMWFmeG80YmovZmZleGZyMXE0MTE4WEd4cUswck16OForczJYWEhsbFJnN2RpeGM1QThnSVRFQnI3MzZLdmJ1M1l1Wkw3NW9LbUtkdTNReFM4M1BuVE1IUTRjTmczL2J0b2lMajhlc0YyZVpQNGh1M2JyaGdRY2ZoS2VuSnc2bHBPRHBwNS9HL3YzN2NmMzExeU9pUncvNCt2cWF5MDlLZ0h2NGtVZlFSWjVQSzJ5clY2M0NXMis5WlZaaEpTSTZVNjZRU3RPeTMzNURlUGZ1Nk5teko1WXVYZnEzOXg4eTVCemNjOTk5OFBEd1FHWm1KbWErOER4Mjd0aUJUejc5MUl4ck83WnZ4MzltUEltc3JFejg5K1dYRVI0ZWp2c2ZlQkMzM1hvTDh2UHpRWTJmRFNyUXUxOS9oSVYzcjNHYmhxWmZGLzRvbjRQN1VOK2EvQnlvY1JNbVdpVThxYURnWUhOdXFHM3lCcS91cXkrL05DMDhMMmtwRGh3NEVMTS8rUVQzM1hldkNVcVRKazB5OS9IMjlvYXpxd3NlK3ZlL3NYN0RCdHg2MiszeW1JVW1MT2x0dzRjUE13SHNLUWxNYTlhc3dWM1RwaUV4TVJGUHlFQmk3K0FBejJiTlRIaDY3OTEzSld5OWlENTkrcGhBOTZpRXFKZGxrQmw5M25sbzE2NGRpSWpPbEtDZ0lIUU5DY0hISDMySTFhdFhZOVRvOC81MjU5Ykhwd1VlZmZ3eExKT1FkZE1OVTdIaWp6OHc2NldYelk1dWVWa0ZPblhxYklKVm45NjlwYm8vMkl4eC9XVk1MWllkUTRhbnBrTTdMTi9QL1U0NlNCdVB1VjQvZjMvNmZqNDJibGlQTTZISkJ5aWZGaTFnTGRvdTA5YmJpY3FHR1JrWlVqRjZDZ1VGQmFhMXA1TW1uWjJkcXdhVTVjdVdtMUQwKzdKbFp1OXE1Y3FWaUpNS1ZsUlVsTGx2c0FRME56YzMwNlliY3M0NTBnTE1ROXUyYmVCOWRQTGxybDI3OEljTU9LbXBxZVpmclRoMTZOQUJQYVV5cGRvRkJJQ0k2RXdaTkhpSUdSTjFqTnNiRjRmK0F3YkltTlgyaFBmWFNlVkZSY1dZTzNlT0dRdS8rdXBMVXpWdjM3NERsaTVaak40U25DSWllcGl3cEJYN3JsMURURlYrMGErL2dKb1cvWnhkdFBBbmJOOFdlZlJ5aVZTZWZzTFd6WnR3cGpUYUZ0NnAwdmFXQmhKck9IamdnTms3YXR1bURXTDI3S202dm8xYzFwNStXV2taWHBKcWtBYWNmVEk0SEsrNHFMaHFteXJQTWFWVktsUWNtZWVrZTJkNnVabFVtMXhjWE15Z3RIang0cXE1VkVXRlJWWFBOWEhpUkZ3MVpZb3BkeGNWRmFGTW51L1VtcHBFUktkUGR3NUhqaHhweHF2M1B2alFYS2R6T3Z0SzYwV25HZFRHemQzTmpGZVYxYVFTQ1YrNncrbmwzUnhidDI3RmlGR2p6QnpUcFV1WHdGdkd3eUhubm9PT0hUdmluYmZmQmpVOWxaVW90VGMrRHB2T1VPV3BVcE92UVAwbWV6WDZocldHbEpRVTA2dWZJc0hGeDhmSFZLVDgvZjN4M1BQUFkrQ0FnUWlSVXJiT1hYcit1ZWZ3d1FjZklQVndxa1hQdjJuVFJwTzZOMjdjaURkZWZ4MEw1czlIWWtKQ2pZbmtTdWNiSkNVbDRkbG5uOFgzMzM5dnRvV0k2RXdKREd5UER0TEN1L1NTaXpGaTJGRHpOWHYySjdqazBrdE8yTWJidFhNbmZMeTlNWGpJRUJQQWV2ZnBZMEpYbEZUWDQrVURVcThiTlhvME5xeGZqN1hTRWh3L2ZvTHNBTnNoYXZkdVVOT2tuNGx6di9uNmpJY24xZVEvVmJXc25KNldpZ3ZHam9jMXZQVFNTMmJ5OXB2U1Bzdk96amJsNmo4M2JNQVBQL3hnNWtEcGRjKy84SUk1dEZkbFpGUS9JdVZJRUtxb3FLajF1YldVL2FFRXIzdnV2Z2VYWDM2NWVlNzU4K2FaUGJRalZhcS9IcmQrM1RyY09XMmEyUTRkZ0hTUHJnSkVSR2ZHSlpkZGh1aW9LQ1JWcXphdGtkQXphZUlraElaMk8zSkZSZVUvRmVaYjNRbjk0dlBQY045OS84SzExMTJQZ0lBQXZDTmptQjdGYkdkbmg2MWJOcU5mL3dHSWlZa3hPNk5hZ1ZpK2JCbUkvZ2sySWFIaGpmSno5Wlk3cHBuNVFuK25zTEFBSDczL0hnb2xnT2o4b05yYWFuV2g0YWk3VklCMDh2Y3UyVFBTNVF3cVM5SzZCNldUelhNa1NPa1JKaHFXZEprQ3ZhL09GZER2dGFYWXNtVkxNMmdvRFVDcWNqa0R2VTByV3dlVEQ1b3FsZ1lyWFU5RmwwQklTMHVyMmc1OVRwMDRydVh5c3ZJeWVYd2VTbmtVSGhGWlNXNU85Z2x2MHgxR0hRczFGRlhTc2MzUHo4L3NTT3EwQWdjSEIrVGs1Smc1bmpxK1ZSNGwzTHAxYS9qTDJKVjg4S0FaQnl1djEwbmpqdktjbVJrWjVyS0dLSDJldkx3OEVKMHFWL2xNMWVWOVRvZCtkamZhQUVWRVJQWHI3d0lVMGRuS1dnR0twM0loSWlJaXNoQURGQkVSRVpHRkdLQ0lpSWlJTE1RQVJVUkVSR1FoQmlnaUlxb2JHeTdQU3cyTjlmNW1HYUNJaUtoTzdPMjRRQzgxTExxVWhvMlZRaFFERkJFUjFZbXV5V1N0VTJFUjFUOGJzemFaalpVcXA5eDlJQ0tpT3RIdzVPemlhazZub2Vmd0JNOTNRR2NsR3hPYUhPenRZV3RuQjJ0aGdDSWlvanJURU9YbzZBaWlwb2ExVnlJaUlpSUxNVUFSRVJFUldZZ0Jpb2lJaU1oQ0RGQkVSRVJFRm1LQUlpSWlJcklRQXhRUkVSR1JoUnIwTWdiQnRqYUlzTE9ERzA4blFFUkVSQmFJTFMvSDFySnk1RlhVYmYyeUJobWdJdXhzY2JXVGd3bFBSRVJFUkhVMXI2UUVueGFWV2h5a0dseUFtdVJvajl1Y2ppemFsaXN2ZGxGSkdlTE1DcmhFUkVSRUorY21YeEgydGhoa2I0OUpEZzRZWkdlUCt3c0trVkorNmlIS0ppUTB2TUdzdlQvSTNnNVB1RGlaNzk4dUxKYlVXQW9pSWlLaXV2Q3p0VEc1SXRqVzFvU25XL01MVDZrU1ZTSDNhVkNUeUcrVHRwMWllQ0lpSXFMVHBhSHBnZndpTXg5S3c5UmtoMU52ekRXWUFIV2V2Q2cvU1lpTEpEZ3hQQkVSRVpFMTZIU2dKd3FLelBjNlRlaFVEMHhyTUhPZ0JoNmRNTDY2dEF4RVJIUjIwRlpHV1ZrWnlzczROdFBaeTBaQ2taMFVZbXh0YXE4YmFTVnFxL3dONjhGcGVvUi9aTm5KMjNnTkprQzFzajJTQ0dNNVlaeUk2S3lnNGFtd0lOOEVLS0t6blcySkxaeGRYR0ZyVzN1SWlwUFFGR0duZWNOV0F0VEpzMGFEYWVHNWM2a25JcUt6U2xGUkljTVROUmpsVW9BcExDd3d3YjgydVJZdVk4Q1Z5SW1JcUU1S1MwcEExSkJvcTdrQzFsbDhnQUdLaUlpSXlFSU1VRVJFUkVRV1lvQWlJaUlpc2xDVENsRDJEdmJ3YWRFQ1RzN09JQ0lpSXFxckJua3k0YnJRNERSODVDajR0V3FObEpSa0xQcDVJYkt6c2tCRVJFUmtxU1pUZ1FydEZvYUF3UFp3Y25KQ1FFQWdJbnIwQkJFUkVWRmROSmtBNWVybTlyZVhyZVgvcGs1Rjc5NjlhMXpmc1dOSDNIRGpqWEIzZDBmWHJsMHgrOVBQMEtsVEo5UzNlKys5RDVkZGRobUlpTTRrRnhjWC9QdWg2Ymo3M250eDUxMTM0Y3FycHNDL1hidXEyNTkrNWxsTW1qd1pkYVZqcUwrL1A0aitLWnhFYm1WWFhYVVYvdStHcVhBK2JwNlZoaGo5YXRXcUZUSXlNckIrM1ZvY1BIZ1E5YzNQencrZXpacUJpT2hNYXRiTXl3U2tNS24rQndjRjQ2S0xMc0w3NzMrQTd0MGp6TzB0ZkgzaDI3SWw2cXBkWUdDOTdRZ1RuWW9tTXdlcUJ1dXNvMVdyMEpCUWRBanFnRjA3ZDVuTGdmSkdIekJnUU5YdFJVVkZTRTFMcTFvTk5TZzRHQmRjY0FIS1NrdXhkdDA2Yk5tODJRU2ZrU05INHNDQkF3Z05EY1YzYzc1RFZtYVdDV0V0NVRZTlgxOS85WlZaV1ZWdjE3WmtlWGtad3NMQ2taUzBIOTk4ODAzVjg3dktudUNVS1ZQZzVlV0ZWYXRYbStkWDJzNnMvbnovKy9wcnM2cHdTRWdJZ21XYlZMQlV6cUtqby9EendwL05aVDJmME9TTEwwWkF1d0FrSngvRS9QbnpVVkJRQUNLaTQrbVk5TmlqajhoWWtReEhSMGQ4OE5ISDZDVVYrc2pJcmNmY3o5blp4WXdyZ2UwRGNTRHBBQmJNbjRmTXpFeHptMWFaSmx3MDBWUzBObS9haUdYTGx0VllTWHJzdUhIbStiOWZzSUFyb3pjQlByNHRjZEdraTAxSHB6WXhNWHV3YU9HUEtKWFAxUHJVWkN0UUZmV1VvUFEvN1BEaHc3anMwci9hWm1QR2pFRmNmSHpWbTc1NTgrYTQ0b29yNE9IaGlTNWR1dUNGRjE0d2cwUkwyUnViT2ZORkRCbzh5RlNxdE9WM28zenBlWHZjM2R6eDdIUFA0WHdKV2tXRmhaZzBjWktVeHg4eXp4Y1dIbzc3L25VZkxyLzhjdWhKcEsrU3NIVEhuWGRXL1h3ZFhEUUkrZmo0WU1hTUdRZ0pEWkh3NUZ6aitaNTYrbW5ZMjl1YlFEWk5TdTVEaHc0MVAvc2VhUU9PR2ozS2ZLL1hYM25sbGViM04zN0NCRHorK09NbVZCRVIxV1JqZHRCMGg3QlBuejVtcHkwcWF2Y3g5OUJ4NWM2N3B1RnlHUk9MWmVkeTRxUkplT0hGV2VhK0xWcjQ0dlUzM2tSRWp4NG1RRTEvNUZGY2QvMzFWWS9WOGVyL2JyZ0JkMDY3QzN1aTl6QThOUkZwaHcvaDE0VS9tU1BydmVUenRQcFhhdXBoTEYzMFM3MkhKOVdvSzFCZHBKTFN6TE9aYVpkVkhIY1M0ckxTSTIrMEhySTNWSkNiVitOTmZUcVdMRmxpS2twdVVsNTJjSERBZ0lFRFRiVkk1ejRkYi9UbzBWSXhTc0xERHo5c3RuR3lsTHlkSmR6a3lUYXBPeVVJNlo1WWJ4bDh3cnVINDVMSkZ5TTdPeHNMRnk3RXE2KytCdjkyUitZQTZIWFRaQkRLejh0SDVMWnR1UG5tbXpGNzlpZm10blZTMVhycXlTZE4wSms3Yng3YVNmWEkxZFd0MXVmVDhLUktTa293ZmZwMDgwZW93YXRYcjk3WXVpWFNoTUdaTTJkaXgvYnQyTHg1RXg1NDRFRzBhZFBHdkFZaW91cnM3T3p3My8rK2lqSVoyM1E4akkySndiN0V4R1B1NHl1dHZBa1RMc0tOTjB4RmRGUVVmdnpoUjd6Nit1dG0zdWpnd1VOUVVGaUEyMjY1MmV5QXJsMnpCaDZlSGlaMDJjcDRObVhLMWVqUnN5ZHVuUHAvSElPYW1LVDlpWmp6emY5TUpVcURrOXEvTHhGenYvbmFGQVhPaEVaZGdYSjBkRUtvdExUVVB2bkZsaDhOVVhyK3B2ajRPUE45ejU2OTRTQjdPdGEwYytkT1U0V2FJQlVhZlhOcmFYbk4yclcxM3RmZnY1MXBxVlVHdkxsejUrSzMzMzR6M3hmS0gwRmxHYnVGaEpqQ2drSVRkbFJjWEp5VXZaM2cxY3pMWEU2V0ZweUdKN1Y2MVNvMGE5Yk1ERXhxLy83OVp2RFIxNStUa3dNN0dYeHFlejRuSjBmNHR2UTkrbnpKVlFuK1VFcUsyZnRyS2JmcDNLNjc3N2tINzc3M25wbWc3aUtYTlVBUkVSMnZyS3dVMCs2OEExZGNkaWt1di9RU3BCeEt3ZVAvZWVLWSs3UnExUnE1dWJsSWtUYWYwdmFMVGlubzBxVXJXdW5PbVl4Zk9uYnBHTFpreVdMTWt6R3kvR2dnRzMzZWFIUC9KR243VWRPVElKL2pjNzc5bnpsQmNNeWVhSHp4NlNmbWMvTk1hZFFWcVBqWUdBd2FjbzYwckxwaHQ0UWFMUThIZGdoQ25MemhFaEwyb2x0NGR6aEl5TnA3TkV4WmpielJ2NUtLMDlTcFUwM3ZmOUd2dnlMbmFGQTUzb0VEU2FhOXBudFVPaWgwNzk1ZGdzdVI2bGoxSnFNT01GclMxcjJ2bk93Y1V4WFN2YnI4Z2lPaHliT1pwMVNWWEpHZm40K3dzREF6THlrNzY4alBMSzlXZmF0c0k5YjJmT1Z5VzNwYXVnbGw1UlhsTmJaVko3OFhGUlpoMmgxM21MMDlyYTU1ZTNzakl6MERSRVMxU1V0THEvcmFzSDREYnJuMTFtTnVQeXd0RncxRE91azhLeXZMN0pEcE5JZDkrL2VodFh6ZnVYTm4yTWo0cUR1WkFZR0I4UEgyd1pZdG0xRmNYSXpYWG4wVjExNTNIVzZXQ3RWNzc3NExhbnFTcERqeTRidnZ5R2RhemhtclBGVnExQUZLUThMS1A1YmpuS0hESkNoNElsWVM2c0dEcTB4d0dEQndNSHIzN1llRlAzNlBYS25LV0p1V211K1RDbzJIaHdmZWV2UE5FOTV2eFlxVmVQVFJSODNjSXEwRzZUeW01NTU3RHBrWng0WVNiY3ZGeDhmamlTZG1tQXJUMkxGakVSa1ppY1NFUlBUcDAxZXFRMzZtRGJoRGd1SkZVdmxhSnhVdkhiQk9wTGJuMnk1dHVXMXlmVkJRVUsyUDBUQzQ0YzhOZU9iWlo4MWt6VzRTMUhUSmhpdXZ1RUo2ZmlBaU9vYXRyUjB1dnVRU0ZFdlYzMC9HcUtFeUZ2KzhjT0V4OTlHZFN4MkRaanoxSkJiOThpdEdqaG9wMWZROGJKUHhUUStjdVdqaVJQeEhxbFp4Y2JHNCt1cHI4UFhYWDV2cEEwVVNvUFRmSkFsYVR6ejVsSFFaOXRWNGJtb2EwaVNFL3hQc2ZIMzlua0FETU5uUkh1N1M4NTVYVW9vOEMrWi9wMG9yVFNzay9RWU1NSUVwdkh1RVdVUlRaKzh2L3ZVWHExZWZkTExrMWkxYmtDSnRyOVRVTkNRbUptRGx5cFdtOHVQWHFwVnAxMmwxU0FQZHhnMS9ZdS9lZUNUSWZYcEtxMC9iYmxxZTFxTk1La3ZVYTQrMi9yUjZwbk9aT3NuZW1FNDhqNWVXMnl1dnZHemFjQnBrM0tUNnRHUEhEb1JMVlMxcTkyNjg5ZFpiWmc5TlYyQlBURWlRaWx1Q2VaNFdjams2T3RwY3J1MzVkTnYwZDZOSmZvdThEdVVwMjZxdFJHMU4vcmxoZzd6R1Z1aldMZFMwQTNVUFVGOHJFVFU5eGNWRmYzdTdqMDhMTTQ3cGpxUk84UDVSZGxnLy8vd3psTXYzN3U0ZWlKVXVRY3llUFZndlk1RWVTYXp6TW5XbjhLV1haaUU5UGQzc0JQNHA0MlRQbmozTWRJZGZGLzJLdVhPK00yTmI2OWF0c1hIalJyUGpwenZMb2RKcDJMUnhrMVR3dVRkSGY4L0IwYkhXZzU4aTdPd1FZVytIMWRJRmlpMHZQK256MklTRWh0ZmpBZjNXODVtYk0veWtqSHROWGdGU3l1dXl5VGJvMHJVcnhsdzRGcjhzL0FsN29uYlhPQlMyb2JwTXFsWjkrL2JGQS9mZkR5S2lNeVUzSnh0RURZMnJGQWxzYldwT0FiL0cwUUhYT0RsZ1ZtRXhGcFg4L1ZGOG1oK2EwRHBRRmNpVHNyRE9UOUx5Y0dNSlQrcEFVaEwrNUVvQ1JFUkVaMHlUV2tpem9DQWZPM2Z0TlA4Mkp0b2lKQ0lpb2pPblNRV290TlJVTFBubFp4QVJFUkdkRHA0TGo0aUlpTWhDREZCRVJFUkVGbUtBSWlLaU90RUZnSWthRW11ZXU1Vi8vVVJFVkNkNkpnZGRJb2Fvb2JDM2Q2aDFDWU82YURBQktyZnhyRHBBUk5RbzJOdmJtek03MkxBU1JXYzdxVHpwQXBxT2YzUHVXM2NMcTFNTjVpZzhYUlUwMk03V3JCUzZxTHdVUkVUMHo3STUrcUZrNytDQUNuQXZsODVlR28xc1RsSjVDckk3RXFDU1QyRVZjdFZnQXRUaWtsS2M1MkF2WDNZblhTR1VpSWpPSEExU05temxVUU1XY2JSQWsxeGVnY2l5VXd0UURhYnV1bFZla0ZhaHVzc0wxS1hXaVlpSWlFNlhuNjBON25kMk5OOS9WbnpxNTFKc1VJM3JXUVZGeUsyb01PZXIwUmVyTDVxSWlJaW9MclR5Tk12RnlaeHJkM1ZwcWVsMm5hb0djekxoU3NFU212NGpMN2JWMFVtTGtXVmxpQ21yUUY0ak9yY2RFUkVSMVI4dHdPaTg2dUNqV1VMRDA0dUZKYWVjSmZSOHVnMHVRQ2w5NFZxRjBqbFJSRVJFUkhXaFU0UG1GbHRXZVZJTk5rQlZwK1UzUHg1Q1MwUkVSQmJZS2gyc2xQSzZSU0FOVVA4UDFJNVBnMXlSZEpJQUFBQUFTVVZPUks1Q1lJST0iLz4KPC9kZWZzPgo8L3N2Zz4K",nSe={"extra-small":"12px",small:"16px",normal:"20px",medium:"24px",large:"32px","extra-large":"40px"},iSe={"extra-small":"8px",small:"10px",normal:"12px",medium:"16px",large:"20px","extra-large":"24px"};function aSe(t){let r,e;return{c(){r=ie("img"),Jt(r.src,e=t[0])||h(r,"src",e),h(r,"height",t[2]),h(r,"width",t[2]),h(r,"alt",t[1])},m(n,i){Ce(n,r,i)},p(n,[i]){i&1&&!Jt(r.src,e=n[0])&&h(r,"src",e),i&4&&h(r,"height",n[2]),i&4&&h(r,"width",n[2]),i&2&&h(r,"alt",n[1])},i:Ge,o:Ge,d(n){n&&Me(r)}}}function oSe(t,r,e){let n,{src:i}=r,{size:a="medium"}=r,{alt:o}=r;return t.$$set=s=>{"src"in s&&e(0,i=s.src),"size"in s&&e(3,a=s.size),"alt"in s&&e(1,o=s.alt)},t.$$.update=()=>{t.$$.dirty&8&&e(2,n=iSe[a])},[i,o,n,a]}class H0 extends It{constructor(r){super(),Rt(this,r,oSe,aSe,Et,{src:0,size:3,alt:1})}}function sSe(t){Zt(t,"svelte-1d6bhzy","p.svelte-1d6bhzy.svelte-1d6bhzy{margin:0;padding:0;font-size:14px;font-weight:300;line-height:20px;color:white}button.svelte-1d6bhzy.svelte-1d6bhzy{display:flex;justify-content:center;align-items:center}.closeBtn-revly__2023.svelte-1d6bhzy.svelte-1d6bhzy{background-color:transparent;color:white !important;width:20px;height:20px;padding:0;position:absolute;top:16px;right:16px}.container-revly__2023.svelte-1d6bhzy.svelte-1d6bhzy{box-sizing:border-box;background:#000000 !important;font-size:16px;line-height:30px;border-radius:14px;width:410px;height:274px;padding:12px 16px;display:flex;flex-direction:column;position:fixed;bottom:8px;right:8px}.header-revly__2023.svelte-1d6bhzy.svelte-1d6bhzy{font-weight:500;color:white !important}.header-text-revly__2023.svelte-1d6bhzy.svelte-1d6bhzy{color:#fff;font-size:18px;line-height:28px}.footer-revly__2023.svelte-1d6bhzy.svelte-1d6bhzy{display:flex;justify-content:center;align-items:center;gap:8px}.section-revly__2023.svelte-1d6bhzy.svelte-1d6bhzy{font-weight:400;color:#fff !important;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;white-space:pre-wrap;flex-grow:1}.section-revly__2023.svelte-1d6bhzy>.loader-revly__2023.svelte-1d6bhzy{animation:svelte-1d6bhzy-rotate 2.5s linear infinite;margin-bottom:8px}.retry-callbtn-revly__2023.svelte-1d6bhzy.svelte-1d6bhzy{color:white !important;background:#625ffb !important;padding:8px 16px;font-size:16px;font-weight:500;line-height:20px;gap:8px;border-radius:40px !important;margin-top:24px}@keyframes svelte-1d6bhzy-rotate{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}@media(max-width: 550px){.container-revly__2023.svelte-1d6bhzy.svelte-1d6bhzy{transform:scale(0.85);margin:0 -30px 0 -30px}}")}function Jx(t){let r,e,n,i,a;return e=new yo({}),{c(){r=ie("button"),Ke(e.$$.fragment),h(r,"class","closeBtn-revly__2023 svelte-1d6bhzy")},m(o,s){Ce(o,r,s),Je(e,r,null),n=!0,i||(a=nt(r,"click",t[6]),i=!0)},p:Ge,i(o){n||(_e(e.$$.fragment,o),n=!0)},o(o){Ee(e.$$.fragment,o),n=!1},d(o){o&&Me(r),Xe(e),i=!1,a()}}}function uSe(t){let r,e,n,i;return{c(){r=ie("img"),n=Le(),i=ie("p"),i.textContent=`${Cr.mic_permission_timeout}`,Jt(r.src,e=G0)||h(r,"src",e),rt(r,"margin-bottom","16px"),h(r,"width","293px"),h(r,"alt","AllowMicImage"),h(i,"class","svelte-1d6bhzy")},m(a,o){Ce(a,r,o),Ce(a,n,o),Ce(a,i,o)},p:Ge,d(a){a&&Me(r),a&&Me(n),a&&Me(i)}}}function lSe(t){let r,e,n,i;return{c(){r=ie("img"),n=Le(),i=ie("p"),i.textContent=`${Cr.mic_permission_dismissed}`,Jt(r.src,e=G0)||h(r,"src",e),rt(r,"margin-bottom","16px"),h(r,"width","293px"),h(r,"alt","AllowMicImage"),h(i,"class","svelte-1d6bhzy")},m(a,o){Ce(a,r,o),Ce(a,n,o),Ce(a,i,o)},p:Ge,d(a){a&&Me(r),a&&Me(n),a&&Me(i)}}}function cSe(t){let r,e,n,i;return{c(){r=ie("img"),n=Le(),i=ie("p"),i.textContent=`${Cr.mic_permission_blocked}`,Jt(r.src,e=rSe)||h(r,"src",e),rt(r,"margin-bottom","16px"),h(r,"width","290px"),h(r,"alt","AllowBlockedMicImage"),h(i,"class","svelte-1d6bhzy")},m(a,o){Ce(a,r,o),Ce(a,n,o),Ce(a,i,o)},p:Ge,d(a){a&&Me(r),a&&Me(n),a&&Me(i)}}}function fSe(t){let r,e,n,i;return{c(){r=ie("img"),n=Le(),i=ie("p"),i.textContent=`${Cr.requesting_mic_permission}`,Jt(r.src,e=G0)||h(r,"src",e),rt(r,"margin-bottom","16px"),h(r,"width","293px"),h(r,"alt","AllowMicImage"),h(i,"class","svelte-1d6bhzy")},m(a,o){Ce(a,r,o),Ce(a,n,o),Ce(a,i,o)},p:Ge,d(a){a&&Me(r),a&&Me(n),a&&Me(i)}}}function dSe(t){let r=Cr.call_completed+"",e;return{c(){e=Nt(r)},m(n,i){Ce(n,e,i)},p:Ge,d(n){n&&Me(e)}}}function pSe(t){let r=Cr.all_agent_offline+"",e;return{c(){e=Nt(r)},m(n,i){Ce(n,e,i)},p:Ge,d(n){n&&Me(e)}}}function vSe(t){let r=Cr.call_ended+"",e;return{c(){e=Nt(r)},m(n,i){Ce(n,e,i)},p:Ge,d(n){n&&Me(e)}}}function hSe(t){let r=Cr.agent_left+"",e;return{c(){e=Nt(r)},m(n,i){Ce(n,e,i)},p:Ge,d(n){n&&Me(e)}}}function mSe(t){let r=(t[1].disqualificationText||Cr.all_agent_offline)+"",e;return{c(){e=Nt(r)},m(n,i){Ce(n,e,i)},p(n,i){i&2&&r!==(r=(n[1].disqualificationText||Cr.all_agent_offline)+"")&&tr(e,r)},d(n){n&&Me(e)}}}function gSe(t){let r,e,n,i;function a(u,l){return u[1].isRetryCall?bSe:ySe}let o=a(t),s=o(t);return{c(){r=ie("img"),n=Le(),s.c(),i=Fn(),Jt(r.src,e=Hx)||h(r,"src",e),h(r,"alt","LoadingIcon"),h(r,"width","90"),h(r,"class","loader-revly__2023 svelte-1d6bhzy")},m(u,l){Ce(u,r,l),Ce(u,n,l),s.m(u,l),Ce(u,i,l)},p(u,l){o===(o=a(u))&&s?s.p(u,l):(s.d(1),s=o(u),s&&(s.c(),s.m(i.parentNode,i)))},d(u){u&&Me(r),u&&Me(n),s.d(u),u&&Me(i)}}}function ySe(t){let r=Cr.waiting_for_agent+"",e;return{c(){e=Nt(r)},m(n,i){Ce(n,e,i)},p:Ge,d(n){n&&Me(e)}}}function bSe(t){let r=Cr.waiting_for_agent_retry+"",e;return{c(){e=Nt(r)},m(n,i){Ce(n,e,i)},p:Ge,d(n){n&&Me(e)}}}function Xx(t){let r,e,n,i,a,o,s;return e=new H0({props:{src:kv,alt:"call-Icon",size:"large"}}),{c(){r=ie("button"),Ke(e.$$.fragment),n=Le(),i=ie("span"),i.textContent="Retry Call",h(r,"class","retry-callbtn-revly__2023 svelte-1d6bhzy")},m(u,l){Ce(u,r,l),Je(e,r,null),U(r,n),U(r,i),a=!0,o||(s=nt(r,"click",t[7]),o=!0)},p:Ge,i(u){a||(_e(e.$$.fragment,u),a=!0)},o(u){Ee(e.$$.fragment,u),a=!1},d(u){u&&Me(r),Xe(e),o=!1,s()}}}function Kx(t){let r,e,n,i;return n=new Lc({}),{c(){r=ie("p"),r.textContent=`${Cr.connected_via}`,e=Le(),Ke(n.$$.fragment),h(r,"class","svelte-1d6bhzy")},m(a,o){Ce(a,r,o),Ce(a,e,o),Je(n,a,o),i=!0},p:Ge,i(a){i||(_e(n.$$.fragment,a),i=!0)},o(a){Ee(n.$$.fragment,a),i=!1},d(a){a&&Me(r),a&&Me(e),Xe(n,a)}}}function _Se(t){let r,e,n,i=t[8](t[0])+"",a,o,s,u,l,c,f,d,v,p,y,k,I=t[3]&&Jx(t);function C(F,D){if(F[0]===He.WatingForAgentJoin)return gSe;if(F[0]===He.Disqualified)return mSe;if(F[0]===He.AgentLeft)return hSe;if(F[0]===He.VisitorEndedCall)return vSe;if(F[0]===He.AllAgentOffline)return pSe;if(F[0]===He.CallCompleted)return dSe;if(F[0]===He.RequestingMicPermission)return fSe;if(F[0]===He.MicPermissionBlocked)return cSe;if(F[0]===He.MicPermissionDismissed)return lSe;if(F[0]===He.MicPermissionTimeout)return uSe}let L=C(t),R=L&&L(t),q=(t[0]===He.AgentLeft||t[0]===He.VisitorEndedCall||t[0]===He.CallCompleted)&&Xx(t),z=t[4]&&Kx();return{c(){r=ie("div"),e=ie("div"),n=ie("div"),a=Nt(i),o=Le(),I&&I.c(),s=Le(),u=ie("section"),R&&R.c(),l=Le(),q&&q.c(),c=Le(),f=ie("a"),d=ie("div"),z&&z.c(),h(n,"class","header-text-revly__2023 svelte-1d6bhzy"),h(e,"class","header-revly__2023 svelte-1d6bhzy"),h(u,"class","section-revly__2023 svelte-1d6bhzy"),h(d,"class","footer-revly__2023 svelte-1d6bhzy"),h(f,"href",v=wv({...t[2]&&{campaignId:t[2]},source:"call-feedback"})),h(f,"target","_blank"),rt(f,"text-decoration","none"),h(r,"class","container-revly__2023 svelte-1d6bhzy")},m(F,D){Ce(F,r,D),U(r,e),U(e,n),U(n,a),U(e,o),I&&I.m(e,null),U(r,s),U(r,u),R&&R.m(u,null),U(u,l),q&&q.m(u,null),U(r,c),U(r,f),U(f,d),z&&z.m(d,null),p=!0,y||(k=[nt(window,"beforeunload",t[5]),nt(window,"pagehide",t[5])],y=!0)},p(F,[D]){(!p||D&1)&&i!==(i=F[8](F[0])+"")&&tr(a,i),F[3]?I?(I.p(F,D),D&8&&_e(I,1)):(I=Jx(F),I.c(),_e(I,1),I.m(e,null)):I&&(ar(),Ee(I,1,1,()=>{I=null}),or()),L===(L=C(F))&&R?R.p(F,D):(R&&R.d(1),R=L&&L(F),R&&(R.c(),R.m(u,l))),F[0]===He.AgentLeft||F[0]===He.VisitorEndedCall||F[0]===He.CallCompleted?q?(q.p(F,D),D&1&&_e(q,1)):(q=Xx(F),q.c(),_e(q,1),q.m(u,null)):q&&(ar(),Ee(q,1,1,()=>{q=null}),or()),F[4]?z?(z.p(F,D),D&16&&_e(z,1)):(z=Kx(),z.c(),_e(z,1),z.m(d,null)):z&&(ar(),Ee(z,1,1,()=>{z=null}),or()),(!p||D&4&&v!==(v=wv({...F[2]&&{campaignId:F[2]},source:"call-feedback"})))&&h(f,"href",v)},i(F){p||(_e(I),_e(q),_e(z),p=!0)},o(F){Ee(I),Ee(q),Ee(z),p=!1},d(F){F&&Me(r),I&&I.d(),R&&R.d(),q&&q.d(),z&&z.d(),y=!1,kr(k)}}}function wSe(t,r,e){let n,i,a,o,s;xr(t,_r,p=>e(1,s=p));let{onClose:u}=r,l;ea(()=>{l&&clearTimeout(l),a&&(l=setTimeout(()=>u(),1e4))}),Yv(()=>{l&&clearTimeout(l),a&&(l=setTimeout(()=>u(),1e4))}),Ku(()=>{l&&clearTimeout(l)});function c(p){var y;if(n===He.WatingForAgentJoin){p.preventDefault(),Pr.setCookie(rh,(y=s.callId)==null?void 0:y.toString(),10),Pr.setCookie(nh,s.callType,10),Pr.setCookie(ih,n,10);let k="Call in progress. Are you sure you want to leave this page?";return p.returnValue=k,k}}function f(){u(),l&&clearTimeout(l)}function d(){i&&(l&&clearTimeout(l),dx(i))}function v(p){return p===He.MicPermissionBlocked?"Microphone Permission Blocked":p===He.MicPermissionDismissed||p===He.MicPermissionTimeout?"Microphone Permission Not Given":p===He.RequestingMicPermission?"Allow Microphone Permission":""}return t.$$set=p=>{"onClose"in p&&e(9,u=p.onClose)},t.$$.update=()=>{t.$$.dirty&2&&e(0,n=s.dialogType),t.$$.dirty&2&&e(2,i=s.lastCampaignId||s.campaignId),t.$$.dirty&1&&e(3,a=[He.AllAgentOffline,He.AgentLeft,He.VisitorEndedCall,He.CallCompleted,He.MicPermissionBlocked,He.MicPermissionDismissed,He.MicPermissionTimeout,He.Disqualified].includes(n)),t.$$.dirty&1&&e(4,o=[He.AllAgentOffline,He.AgentLeft,He.VisitorEndedCall,He.CallCompleted,He.Disqualified].includes(n))},[n,s,i,a,o,c,f,d,v,u]}class kSe extends It{constructor(r){super(),Rt(this,r,wSe,_Se,Et,{onClose:9},sSe)}}const{window:Mv}=JD;function TSe(t){Zt(t,"svelte-1pykydn",".draggable-revly__2023.svelte-1pykydn{user-select:none;cursor:move;position:fixed;z-index:99999999999999999999}")}function SSe(t){let r,e,n,i;const a=t[8].default,o=Qu(a,t,t[7],null);return{c(){r=ie("section"),o&&o.c(),rt(r,"left",t[0]+"px"),rt(r,"top",t[1]+"px"),h(r,"class","draggable-revly__2023 svelte-1pykydn")},m(s,u){Ce(s,r,u),o&&o.m(r,null),e=!0,n||(i=[nt(Mv,"mouseup",t[4]),nt(Mv,"touchend",t[4]),nt(Mv,"mousemove",t[6]),nt(Mv,"touchmove",t[3]),nt(r,"mousedown",t[5]),nt(r,"touchstart",t[2])],n=!0)},p(s,[u]){o&&o.p&&(!e||u&128)&&Gu(o,a,s,s[7],e?Yu(a,s[7],u,null):Hu(s[7]),null),(!e||u&1)&&rt(r,"left",s[0]+"px"),(!e||u&2)&&rt(r,"top",s[1]+"px")},i(s){e||(_e(o,s),e=!0)},o(s){Ee(o,s),e=!1},d(s){s&&Me(r),o&&o.d(s),n=!1,kr(i)}}}function ESe(t,r,e){let{$$slots:n={},$$scope:i}=r,{left:a=1}=r,{top:o=1}=r,s=1,u=1,l=!1,c=0,f=0;function d(L){l=!0,c=L.touches[0].clientX-a,f=L.touches[0].clientY-o}function v(L){if(l){const R=L.touches[0].clientX-c,q=L.touches[0].clientY-f;C(R,q)}}function p(){l=!1}function y(L){l=!0,c=L.clientX-a,f=L.clientY-o}function k(L){if(l){const R=L.clientX-c,q=L.clientY-f;C(R,q)}}ea(()=>{const L=document.querySelector(".draggable-revly__2023");if(L){const R=L.getBoundingClientRect();s=R.height,u=R.width,e(1,o=window.innerHeight-s-8),e(0,a=window.innerWidth-u-8),C(a,o)}}),Yv(()=>{const L=document.querySelector(".draggable-revly__2023");L&&I(L)});function I(L){const R=L.getBoundingClientRect();(s!==R.height||u!==R.width)&&(s=R.height,u=R.width,C(R.left,R.top))}function C(L,R){const q=L>=0&&L<=window.innerWidth-u?L:L<=0?0:window.innerWidth-u,z=R>=0&&R<=window.innerHeight-s?R:R<=0?0:window.innerHeight-s;e(0,a=q),e(1,o=z)}return t.$$set=L=>{"left"in L&&e(0,a=L.left),"top"in L&&e(1,o=L.top),"$$scope"in L&&e(7,i=L.$$scope)},[a,o,d,v,p,y,k,i,n]}class e4 extends It{constructor(r){super(),Rt(this,r,ESe,SSe,Et,{left:0,top:1},TSe)}}function MSe(t){Zt(t,"svelte-1mzq4fp","p.svelte-1mzq4fp{margin:0;padding:0}.container.svelte-1mzq4fp{box-sizing:border-box;background:#000000 !important;border-radius:12px;width:252px;height:66px;padding:12px}p.svelte-1mzq4fp{font-size:12px;font-weight:500;color:#fff !important;line-height:18px}section.svelte-1mzq4fp{font-size:12px;margin-top:8px;display:flex;justify-content:space-between;align-items:center}.description.svelte-1mzq4fp{color:#9c9c9c !important;font-size:12px;font-weight:500;line-height:16px}button.svelte-1mzq4fp{border-radius:4px !important;padding:1px 6px;background:#e52810 !important;box-shadow:4px 4px 10px rgba(238, 42, 17, 0.3);color:#fff !important;cursor:pointer;width:fit-content;font-size:10px !important;max-height:16px;display:flex;justify-content:center;align-items:center}")}function CSe(t){let r,e,n,i,a,o,s=Cr.queue_desc+"",u,l,c,f,d,v,p;return{c(){r=ie("div"),e=ie("div"),n=ie("p"),n.textContent=`${Cr.queue_head}`,i=Le(),a=ie("section"),o=ie("p"),u=Nt(s),l=Le(),c=Nt(t[0]),f=Le(),d=ie("button"),d.textContent=`${Cr.leaveBtn}`,h(n,"class","svelte-1mzq4fp"),h(o,"class","description svelte-1mzq4fp"),h(d,"class","svelte-1mzq4fp"),h(a,"class","svelte-1mzq4fp"),h(r,"class","container svelte-1mzq4fp")},m(y,k){Ce(y,r,k),U(r,e),U(e,n),U(r,i),U(r,a),U(a,o),U(o,u),U(o,l),U(o,c),U(a,f),U(a,d),v||(p=nt(d,"click",t[1]),v=!0)},p(y,k){k&1&&tr(c,y[0])},d(y){y&&Me(r),v=!1,p()}}}function RSe(t){let r,e;return r=new e4({props:{$$slots:{default:[CSe]},$$scope:{ctx:t}}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,[i]){const a={};i&9&&(a.$$scope={dirty:i,ctx:n}),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function ISe(t,r,e){let n,i;xr(t,_r,o=>e(2,i=o));async function a(){await Mr.leaveQueue()}return t.$$.update=()=>{t.$$.dirty&4&&e(0,n=i.queueLength)},[n,a,i]}class OSe extends It{constructor(r){super(),Rt(this,r,ISe,RSe,Et,{},MSe)}}var jc=(t=>(t.TopLeft="top_left",t.TopRight="top_right",t.bottomLeft="bottom_left",t.bottomRight="bottom_right",t.center="center",t))(jc||{});function NSe(t){Zt(t,"svelte-1s2ul2n",".visitor-form-revly__2023.svelte-1s2ul2n{position:fixed;z-index:9995;display:flex;justify-content:flex-end;align-items:flex-end}.top-left-revly__2023.svelte-1s2ul2n{top:16px;left:16px}.top-right-revly__2023.svelte-1s2ul2n{top:16px;right:16px}.bottom-left-revly__2023.svelte-1s2ul2n{bottom:16px;left:16px}.bottom-right-revly__2023.svelte-1s2ul2n{bottom:16px;right:16px}.center-revly__2023.svelte-1s2ul2n{top:50%;left:50%;transform:translate(-50%, -50%)}@media(max-width: 550px){.visitor-form-revly__2023.svelte-1s2ul2n{transform:scale(var(--scale));margin:calc(-15px + var(--margin)) var(--margin)}}")}function t4(t){let r,e,n,i;const a=[DSe,xSe,PSe,ASe],o=[];function s(u,l){return u[6]===He.WatingForAgentJoin&&!u[4]||u[6]===He.AgentLeft||u[6]===He.VisitorEndedCall||u[6]===He.AllAgentOffline||u[6]===He.CallCompleted||u[2]||u[6]===He.Disqualified?0:u[6]===He.InQueue&&!u[5]?1:u[6]===He.VisitorDetails&&u[1].initCallOptions&&u[1].themeConfig?2:u[6]===He.Scheduler&&u[1].campaignId&&u[1].themeConfig?3:-1}return~(r=s(t))&&(e=o[r]=a[r](t)),{c(){e&&e.c(),n=Fn()},m(u,l){~r&&o[r].m(u,l),Ce(u,n,l),i=!0},p(u,l){let c=r;r=s(u),r===c?~r&&o[r].p(u,l):(e&&(ar(),Ee(o[c],1,1,()=>{o[c]=null}),or()),~r?(e=o[r],e?e.p(u,l):(e=o[r]=a[r](u),e.c()),_e(e,1),e.m(n.parentNode,n)):e=null)},i(u){i||(_e(e),i=!0)},o(u){Ee(e),i=!1},d(u){~r&&o[r].d(u),u&&Me(n)}}}function ASe(t){let r,e,n,i;return e=new qx({props:{campaignId:t[1].campaignId,onClose:t[9],themeConfig:t[1].themeConfig,disqualificationText:t[1].disqualificationText}}),{c(){r=ie("div"),Ke(e.$$.fragment),h(r,"class",n=an(`visitor-form-revly__2023 ${t[10](t[1].position)}`)+" svelte-1s2ul2n"),rt(r,"--scale",Math.min(1,t[3])),rt(r,"--margin",`-${(t[0]*(1-t[3])/2).toFixed()}px`)},m(a,o){Ce(a,r,o),Je(e,r,null),i=!0},p(a,o){const s={};o&2&&(s.campaignId=a[1].campaignId),o&2&&(s.themeConfig=a[1].themeConfig),o&2&&(s.disqualificationText=a[1].disqualificationText),e.$set(s),(!i||o&2&&n!==(n=an(`visitor-form-revly__2023 ${a[10](a[1].position)}`)+" svelte-1s2ul2n"))&&h(r,"class",n),o&8&&rt(r,"--scale",Math.min(1,a[3])),o&9&&rt(r,"--margin",`-${(a[0]*(1-a[3])/2).toFixed()}px`)},i(a){i||(_e(e.$$.fragment,a),i=!0)},o(a){Ee(e.$$.fragment,a),i=!1},d(a){a&&Me(r),Xe(e)}}}function PSe(t){let r,e,n,i;return e=new Mx({props:{onClose:t[9],config:t[1].callSettings.visitorDetailsForm.formJson,initCallOptions:t[1].initCallOptions,themeConfig:t[1].themeConfig}}),{c(){r=ie("div"),Ke(e.$$.fragment),h(r,"class",n=an(`visitor-form-revly__2023 ${t[10](t[1].position)}`)+" svelte-1s2ul2n"),rt(r,"--scale",Math.min(1,t[3])),rt(r,"--margin",`-${(t[0]*(1-t[3])/2).toFixed()}px`)},m(a,o){Ce(a,r,o),Je(e,r,null),i=!0},p(a,o){const s={};o&2&&(s.config=a[1].callSettings.visitorDetailsForm.formJson),o&2&&(s.initCallOptions=a[1].initCallOptions),o&2&&(s.themeConfig=a[1].themeConfig),e.$set(s),(!i||o&2&&n!==(n=an(`visitor-form-revly__2023 ${a[10](a[1].position)}`)+" svelte-1s2ul2n"))&&h(r,"class",n),o&8&&rt(r,"--scale",Math.min(1,a[3])),o&9&&rt(r,"--margin",`-${(a[0]*(1-a[3])/2).toFixed()}px`)},i(a){i||(_e(e.$$.fragment,a),i=!0)},o(a){Ee(e.$$.fragment,a),i=!1},d(a){a&&Me(r),Xe(e)}}}function xSe(t){let r,e;return r=new OSe({}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p:Ge,i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function DSe(t){let r,e;return r=new kSe({props:{onClose:t[9]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p:Ge,i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function LSe(t){let r,e,n,i=(!t[8].visible||t[6]===He.CallCompleted)&&t[7]&&t4(t);return{c(){r=ie("div"),i&&i.c()},m(a,o){Ce(a,r,o),i&&i.m(r,null),n=!0},p(a,[o]){(!a[8].visible||a[6]===He.CallCompleted)&&a[7]?i?(i.p(a,o),o&448&&_e(i,1)):(i=t4(a),i.c(),_e(i,1),i.m(r,null)):i&&(ar(),Ee(i,1,1,()=>{i=null}),or())},i(a){n||(_e(i),Cn(()=>{e||(e=za(r,lx,{duration:300},!0)),e.run(1)}),n=!0)},o(a){Ee(i),e||(e=za(r,lx,{duration:300},!1)),e.run(0),n=!1},d(a){a&&Me(r),i&&i.d(),a&&e&&e.end()}}}function USe(t,r,e){let n,i,a,o,s,u,l,c,f,d;xr(t,_r,y=>e(1,f=y)),xr(t,Wt,y=>e(8,d=y));function v(){Mr.resetState()}function p(y){switch(y){case jc.TopLeft:return"top-left-revly__2023";case jc.TopRight:return"top-right-revly__2023";case jc.bottomLeft:return"bottom-left-revly__2023";case jc.bottomRight:return"bottom-right-revly__2023";default:return"center-revly__2023"}}return t.$$.update=()=>{t.$$.dirty&2&&e(7,n=f.visible),t.$$.dirty&2&&e(6,i=f.dialogType),t.$$.dirty&2&&e(5,a=f.isHideQueueScreen),t.$$.dirty&2&&e(4,o=f.isHideConnectingScreen),t.$$.dirty&2049&&e(3,l=+(s/u).toFixed(1)),t.$$.dirty&2&&e(2,c=[He.RequestingMicPermission,He.MicPermissionBlocked,He.MicPermissionDismissed,He.MicPermissionTimeout].includes(f.dialogType))},e(11,s=window.innerWidth*.6),e(0,u=300),[u,f,c,l,o,a,i,n,d,v,p,s]}class jSe extends It{constructor(r){super(),Rt(this,r,USe,LSe,Et,{},NSe)}}const r4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQgMS41SDIuNUMyLjIzNDc4IDEuNSAxLjk4MDQzIDEuNjA1MzYgMS43OTI4OSAxLjc5Mjg5QzEuNjA1MzYgMS45ODA0MyAxLjUgMi4yMzQ3OCAxLjUgMi41VjRNMTAuNSA0VjIuNUMxMC41IDIuMjM0NzggMTAuMzk0NiAxLjk4MDQzIDEwLjIwNzEgMS43OTI4OUMxMC4wMTk2IDEuNjA1MzYgOS43NjUyMiAxLjUgOS41IDEuNUg4TTggMTAuNUg5LjVDOS43NjUyMiAxMC41IDEwLjAxOTYgMTAuMzk0NiAxMC4yMDcxIDEwLjIwNzFDMTAuMzk0NiAxMC4wMTk2IDEwLjUgOS43NjUyMiAxMC41IDkuNVY4TTEuNSA4VjkuNUMxLjUgOS43NjUyMiAxLjYwNTM2IDEwLjAxOTYgMS43OTI4OSAxMC4yMDcxQzEuOTgwNDMgMTAuMzk0NiAyLjIzNDc4IDEwLjUgMi41IDEwLjVINCIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cjwvc3ZnPgo=",n4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMuMzMzMzcgMTEuNjY2Nkg4LjMzMzM3VjE2LjY2NjYiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xNi42NjY2IDguMzMzMzdIMTEuNjY2NlYzLjMzMzM3IiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8cGF0aCBkPSJNMTEuNjY2NiA4LjMzMzMzTDE3LjUgMi41IiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8cGF0aCBkPSJNMi41IDE3LjVMOC4zMzMzMyAxMS42NjY2IiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K",i4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE1IDNIMjFWOSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPHBhdGggZD0iTTkgMjFIM1YxNSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPHBhdGggZD0iTTIxIDNMMTQgMTAiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0zIDIxTDEwIDE0IiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K",a4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMCAyMSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwLjIwODEgMS4yNUM5LjU0NTA5IDEuMjUgOC45MDkyIDEuNTEzMzkgOC40NDAzNiAxLjk4MjIzQzcuOTcxNTIgMi40NTEwNyA3LjcwODEzIDMuMDg2OTYgNy43MDgxMyAzLjc1VjEwLjQxNjdDNy43MDgxMyAxMS4wNzk3IDcuOTcxNTIgMTEuNzE1NiA4LjQ0MDM2IDEyLjE4NDRDOC45MDkyIDEyLjY1MzMgOS41NDUwOSAxMi45MTY3IDEwLjIwODEgMTIuOTE2N0MxMC44NzEyIDEyLjkxNjcgMTEuNTA3MSAxMi42NTMzIDExLjk3NTkgMTIuMTg0NEMxMi40NDQ3IDExLjcxNTYgMTIuNzA4MSAxMS4wNzk3IDEyLjcwODEgMTAuNDE2N1YzLjc1QzEyLjcwODEgMy4wODY5NiAxMi40NDQ3IDIuNDUxMDcgMTEuOTc1OSAxLjk4MjIzQzExLjUwNzEgMS41MTMzOSAxMC44NzEyIDEuMjUgMTAuMjA4MSAxLjI1WiIgZmlsbD0iIzNENDA0MyIgc3Ryb2tlPSIjM0Q0MDQzIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPHBhdGggZD0iTTE2LjA0MTcgOC43NTA0OVYxMC40MTcyQzE2LjA0MTcgMTEuOTY0MyAxNS40MjcxIDEzLjQ0OCAxNC4zMzMxIDE0LjU0MTlDMTMuMjM5MiAxNS42MzU5IDExLjc1NTQgMTYuMjUwNSAxMC4yMDgzIDE2LjI1MDVDOC42NjEyNCAxNi4yNTA1IDcuMTc3NTEgMTUuNjM1OSA2LjA4MzU0IDE0LjU0MTlDNC45ODk1OCAxMy40NDggNC4zNzUgMTEuOTY0MyA0LjM3NSAxMC40MTcyVjguNzUwNDkiIHN0cm9rZT0iIzNENDA0MyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMC4yMDgxIDE2LjI1MDVWMTkuNTgzOCIgc3Ryb2tlPSIjM0Q0MDQzIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPHBhdGggZD0iTTYuODc1IDE5LjU4NEgxMy41NDE3IiBzdHJva2U9IiMzRDQwNDMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K",o4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzQwNzhfMjA5MTEpIj4KPHBhdGggZD0iTTcuNSA3LjQ5OTc1VjkuOTk5NzVDNy41MDA0MyAxMC40OTM5IDcuNjQ3MjkgMTAuOTc2OCA3LjkyMjAzIDExLjM4NzVDOC4xOTY3NiAxMS43OTgyIDguNTg3MDQgMTIuMTE4MyA5LjA0MzU5IDEyLjMwNzRDOS41MDAxMyAxMi40OTY0IDEwLjAwMjUgMTIuNTQ1OSAxMC40ODcxIDEyLjQ0OTZDMTAuOTcxOCAxMi4zNTM0IDExLjQxNyAxMi4xMTU2IDExLjc2NjcgMTEuNzY2NE0xMi41IDcuNzgzMDhWMy4zMzMwOEMxMi41MDA2IDIuNzEzMTEgMTIuMjcwOSAyLjExNTAyIDExLjg1NTMgMS42NTQ5MkMxMS40Mzk4IDEuMTk0ODIgMTAuODY4MSAwLjkwNTUzNiAxMC4yNTEyIDAuODQzMjI5QzkuNjM0NDEgMC43ODA5MjIgOS4wMTY0MyAwLjk1MDAzNiA4LjUxNzI2IDEuMzE3NzRDOC4wMTgxIDEuNjg1NDUgNy42NzMzNyAyLjIyNTUxIDcuNTUgMi44MzMwOCIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xNC4xNjY3IDE0LjEyNTJDMTMuMzUzMSAxNC45NTU1IDEyLjMxMDEgMTUuNTIzOSAxMS4xNzEzIDE1Ljc1NzNDMTAuMDMyNiAxNS45OTA4IDguODUwMDIgMTUuODc4NyA3Ljc3NTQxIDE1LjQzNTRDNi43MDA3OSAxNC45OTIxIDUuNzgzMTMgMTQuMjM3OSA1LjE0MDEzIDEzLjI2OTVDNC40OTcxNCAxMi4zMDEgNC4xNTgxNiAxMS4xNjI2IDQuMTY2NjYgMTAuMDAwMlY4LjMzMzVNMTUuODMzMyA4LjMzMzVWMTAuMDAwMkMxNS44MzMgMTAuMzQzOSAxNS44MDI0IDEwLjY4NjkgMTUuNzQxNyAxMS4wMjUyIiBzdHJva2U9IndoaXRlIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPHBhdGggZD0iTTEwIDE1LjgzM1YxOS4xNjYzIiBzdHJva2U9IndoaXRlIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPHBhdGggZD0iTTYuNjY2NzUgMTkuMTY2NUgxMy4zMzM0IiBzdHJva2U9IndoaXRlIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPHBhdGggZD0iTTAuODMzMjUyIDAuODMzMDA4TDE5LjE2NjYgMTkuMTY2MyIgc3Ryb2tlPSIjRTUyODEwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF80MDc4XzIwOTExIj4KPHJlY3Qgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=",s4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTkuMTY2NyA1LjgzMzAxTDEzLjMzMzQgOS45OTk2N0wxOS4xNjY3IDE0LjE2NjNWNS44MzMwMVoiIGZpbGw9IiMzRDQwNDMiIHN0cm9rZT0iIzNENDA0MyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS42NjY3IDQuMTY2MDJIMi41MDAwNEMxLjU3OTU3IDQuMTY2MDIgMC44MzMzNzQgNC45MTIyMSAwLjgzMzM3NCA1LjgzMjY4VjE0LjE2NkMwLjgzMzM3NCAxNS4wODY1IDEuNTc5NTcgMTUuODMyNyAyLjUwMDA0IDE1LjgzMjdIMTEuNjY2N0MxMi41ODcyIDE1LjgzMjcgMTMuMzMzNCAxNS4wODY1IDEzLjMzMzQgMTQuMTY2VjUuODMyNjhDMTMuMzMzNCA0LjkxMjIxIDEyLjU4NzIgNC4xNjYwMiAxMS42NjY3IDQuMTY2MDJaIiBmaWxsPSIjM0Q0MDQzIiBzdHJva2U9IiMzRDQwNDMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K",u4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzM2MDFfMTgwMTcpIj4KPHBhdGggZD0iTTEzLjMzMzQgMTMuMzMzN1YxNC4xNjdDMTMuMzMzNCAxNC42MDkgMTMuMTU3OCAxNS4wMzI5IDEyLjg0NTIgMTUuMzQ1NUMxMi41MzI3IDE1LjY1ODEgMTIuMTA4NyAxNS44MzM3IDExLjY2NjcgMTUuODMzN0gyLjUwMDA0QzIuMDU4MDEgMTUuODMzNyAxLjYzNDA5IDE1LjY1ODEgMS4zMjE1MyAxNS4zNDU1QzEuMDA4OTcgMTUuMDMyOSAwLjgzMzM3NCAxNC42MDkgMC44MzMzNzQgMTQuMTY3VjUuODMzNjZDMC44MzMzNzQgNS4zOTE2MyAxLjAwODk3IDQuOTY3NzEgMS4zMjE1MyA0LjY1NTE1QzEuNjM0MDkgNC4zNDI1OSAyLjA1ODAxIDQuMTY2OTkgMi41MDAwNCA0LjE2Njk5SDQuMTY2NzFNOC44ODMzNyA0LjE2Njk5SDExLjY2NjdDMTIuMTA4NyA0LjE2Njk5IDEyLjUzMjcgNC4zNDI1OSAxMi44NDUyIDQuNjU1MTVDMTMuMTU3OCA0Ljk2NzcxIDEzLjMzMzQgNS4zOTE2MyAxMy4zMzM0IDUuODMzNjZWOC42MTY5OUwxNC4xNjY3IDkuNDUwMzNMMTkuMTY2NyA1LjgzMzY2VjE0LjE2NyIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0wLjgzMzM3NCAwLjgzMzAwOEwxOS4xNjY3IDE5LjE2NjMiIHN0cm9rZT0iI0U1MjgxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjwvZz4KPGRlZnM+CjxjbGlwUGF0aCBpZD0iY2xpcDBfMzYwMV8xODAxNyI+CjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K",l4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9ImNoYXQiPgo8bWFzayBpZD0ibWFzazBfNTE3N18xODg1OSIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIj4KPHJlY3QgaWQ9IkJvdW5kaW5nIGJveCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF81MTc3XzE4ODU5KSI+CjxwYXRoIGlkPSJjaGF0XzIiIGQ9Ik01LjIwODI1IDExLjQ1ODJIMTEuNDU4MlYxMC4yMDgzSDUuMjA4MjVWMTEuNDU4MlpNNS4yMDgyNSA4Ljk1ODIxSDE0Ljc5MTVWNy43MDgyNUg1LjIwODI1VjguOTU4MjFaTTUuMjA4MjUgNi40NTgyMUgxNC43OTE1VjUuMjA4MjVINS4yMDgyNVY2LjQ1ODIxWk0yLjA4MzI1IDE3LjUzMTlWMy41ODk2N0MyLjA4MzI1IDMuMTY4NzIgMi4yMjkwOSAyLjgxMjQyIDIuNTIwNzUgMi41MjA3NUMyLjgxMjQyIDIuMjI5MDkgMy4xNjg3MiAyLjA4MzI1IDMuNTg5NjcgMi4wODMyNUgxNi40MTAxQzE2LjgzMTEgMi4wODMyNSAxNy4xODc0IDIuMjI5MDkgMTcuNDc5IDIuNTIwNzVDMTcuNzcwNyAyLjgxMjQyIDE3LjkxNjUgMy4xNjg3MiAxNy45MTY1IDMuNTg5NjdWMTMuMDc2OEMxNy45MTY1IDEzLjQ5NzcgMTcuNzcwNyAxMy44NTQgMTcuNDc5IDE0LjE0NTdDMTcuMTg3NCAxNC40Mzc0IDE2LjgzMTEgMTQuNTgzMiAxNi40MTAxIDE0LjU4MzJINS4wMzE5NkwyLjA4MzI1IDE3LjUzMTlaTTMuMzMzMjMgMTQuNTEyN0w0LjUxMjczIDEzLjMzMzJIMTYuNDEwMUMxNi40ODQ5IDEzLjMzMzIgMTYuNTQ2NCAxMy4zMDkyIDE2LjU5NDQgMTMuMjYxMUMxNi42NDI1IDEzLjIxMyAxNi42NjY2IDEzLjE1MTYgMTYuNjY2NiAxMy4wNzY4VjMuNTg5NjdDMTYuNjY2NiAzLjUxNDg4IDE2LjY0MjUgMy40NTM0NCAxNi41OTQ0IDMuNDA1MzZDMTYuNTQ2NCAzLjM1NzI3IDE2LjQ4NDkgMy4zMzMyMyAxNi40MTAxIDMuMzMzMjNIMy41ODk2N0MzLjUxNDg4IDMuMzMzMjMgMy40NTM0NCAzLjM1NzI3IDMuNDA1MzYgMy40MDUzNkMzLjM1NzI3IDMuNDUzNDQgMy4zMzMyMyAzLjUxNDg4IDMuMzMzMjMgMy41ODk2N1YxNC41MTI3Wk0zLjMzMzIzIDMuNTg5NjdWMy4zMzMyM1YxNC41MTI3VjMuNTg5NjdaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjwvZz4KPC9zdmc+Cg==",c4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzQwNzhfMjA5NTkiIHN0eWxlPSJtYXNrLXR5cGU6YWxwaGEiIG1hc2tVbml0cz0idXNlclNwYWNlT25Vc2UiIHg9IjAiIHk9IjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCI+CjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iI0Q5RDlEOSIvPgo8L21hc2s+CjxnIG1hc2s9InVybCgjbWFzazBfNDA3OF8yMDk1OSkiPgo8cGF0aCBkPSJNNS4yMDgyNSAxMS40NTg1SDExLjQ1ODJWMTAuMjA4NUg1LjIwODI1VjExLjQ1ODVaTTUuMjA4MjUgOC45NTg0NUgxNC43OTE1VjcuNzA4NUg1LjIwODI1VjguOTU4NDVaTTUuMjA4MjUgNi40NTg0NUgxNC43OTE1VjUuMjA4NUg1LjIwODI1VjYuNDU4NDVaTTIuMDgzMjUgMTcuNTMyMVYzLjU4OTkxQzIuMDgzMjUgMy4xNjg5NyAyLjIyOTA5IDIuODEyNjYgMi41MjA3NSAyLjUyMUMyLjgxMjQyIDIuMjI5MzMgMy4xNjg3MiAyLjA4MzUgMy41ODk2NyAyLjA4MzVIMTYuNDEwMUMxNi44MzExIDIuMDgzNSAxNy4xODc0IDIuMjI5MzMgMTcuNDc5IDIuNTIxQzE3Ljc3MDcgMi44MTI2NiAxNy45MTY1IDMuMTY4OTcgMTcuOTE2NSAzLjU4OTkxVjEzLjA3N0MxNy45MTY1IDEzLjQ5OCAxNy43NzA3IDEzLjg1NDMgMTcuNDc5IDE0LjE0NkMxNy4xODc0IDE0LjQzNzYgMTYuODMxMSAxNC41ODM1IDE2LjQxMDEgMTQuNTgzNUg1LjAzMTk2TDIuMDgzMjUgMTcuNTMyMVoiIGZpbGw9IiMzRDQwNDMiLz4KPC9nPgo8L3N2Zz4K",VSe="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkiIGhlaWdodD0iNyIgdmlld0JveD0iMCAwIDE5IDciIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0yLjUxNTI5IDYuMzQ4N0wxLjEyODU1IDUuMDA1M0MwLjk5OTI5MyA0Ljg4MTEgMC44OTgyMzggNC43MzIxMSAwLjgzMTg1NyA0LjU2Nzg4QzAuNzY1NDc2IDQuNDAzNjQgMC43MzUyMzQgNC4yMjc3OSAwLjc0MzA2NiA0LjA1MTU4QzAuNzUwODk5IDMuODc1MzggMC43OTY2MzQgMy43MDI2OSAwLjg3NzM0NCAzLjU0NDZDMC45NTgwNTIgMy4zODY1IDEuMDcxOTUgMy4yNDY0OCAxLjIxMTc2IDMuMTMzNUMyLjc4ODcyIDEuOTA1MjcgNC42NDEwOSAxLjA1MjUxIDYuNjIwMDMgMC42NDM3MjlDOC40NDY1OSAwLjI0OTI5MSAxMC4zNDA0IDAuMjQ5MjkxIDEyLjE2NyAwLjY0MzcyOUMxNC4xNTQxIDEuMDU1MTYgMTYuMDEzMiAxLjkxNDI1IDE3LjU5MzcgMy4xNTE0MUMxNy43MzMxIDMuMjY0MDUgMTcuODQ2NyAzLjQwMzU3IDE3LjkyNzQgMy41NjEwOUMxOC4wMDgxIDMuNzE4NjEgMTguMDU0IDMuODkwNjggMTguMDYyMyA0LjA2NjMzQzE4LjA3MDUgNC4yNDE5OSAxOC4wNDA5IDQuNDE3MzggMTcuOTc1NCA0LjU4MTM2QzE3LjkwOTkgNC43NDUzMyAxNy44MDk4IDQuODk0MjggMTcuNjgxNiA1LjAxODc0TDE2LjI5NDggNi4zNjIxNEMxNi4wNzI3IDYuNTgxNiAxNS43NzU4IDYuNzE1MzIgMTUuNDU5NCA2LjczODM5QzE1LjE0MyA2Ljc2MTQ2IDE0LjgyODggNi42NzIzIDE0LjU3NTMgNi40ODc1MkMxNC4wNzMgNi4xMTQzMSAxMy41Mjg3IDUuNzk3MzQgMTIuOTUyOCA1LjU0MjY2QzEyLjcyNTEgNS40NDI2MyAxMi41MzE5IDUuMjgxNDggMTIuMzk1OSA1LjA3ODMxQzEyLjI1OTkgNC44NzUxMyAxMi4xODY5IDQuNjM4NDQgMTIuMTg1NSA0LjM5NjNMMTIuMTg1NSAzLjI1ODg4QzEwLjM3MDIgMi43NzUyNiA4LjQ1MzggMi43NzUyNiA2LjYzODUyIDMuMjU4ODhWNC4zOTYyOUM2LjYzNzEyIDQuNjM4NDQgNi41NjQwOSA0Ljg3NTEzIDYuNDI4MSA1LjA3ODMxQzYuMjkyMSA1LjI4MTQ4IDYuMDk4ODMgNS40NDI2MyA1Ljg3MTE5IDUuNTQyNjZDNS4yOTUzMSA1Ljc5NzM0IDQuNzUxMDMgNi4xMTQzMSA0LjI0ODcxIDYuNDg3NTJDMy45OTI0OSA2LjY3NDM2IDMuNjc0MzIgNi43NjM0NSAzLjM1NDcxIDYuNzM3ODZDMy4wMzUxMSA2LjcxMjI2IDIuNzM2MzYgNi41NzM3NyAyLjUxNTI5IDYuMzQ4N1oiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=";function FSe(t){Zt(t,"svelte-i3yicd",".iconBtn-revly__2023.svelte-i3yicd{background-color:#3d4043 !important;border-radius:100% !important;display:flex;justify-content:center;align-items:center;position:relative}.iconBtn-revly__2023.svelte-i3yicd:not(.active-revly__2023):hover{opacity:1 !important;background-color:#797a7c !important}.unread-revly__2023.svelte-i3yicd{position:absolute;top:6px;right:2px;width:20px;height:20px}.unread-revly__2023_v1.svelte-i3yicd{top:4px;right:-5px}.active-revly__2023.svelte-i3yicd{background-color:#fff !important}")}function f4(t){let r,e;return{c(){r=qe("svg"),e=qe("circle"),h(e,"cx","8"),h(e,"cy","4"),h(e,"r","4"),h(e,"fill","#E52810"),h(r,"class","unread-revly__2023 svelte-i3yicd"),zr(r,"unread-revly__2023_v1",Number(t[6].split("px")[0])<=32)},m(n,i){Ce(n,r,i),U(r,e)},p(n,i){i&64&&zr(r,"unread-revly__2023_v1",Number(n[6].split("px")[0])<=32)},d(n){n&&Me(r)}}}function $Se(t){let r,e,n,i,a,o,s=t[4]&&f4(t);return n=new H0({props:{src:t[1],size:t[5],alt:t[2]}}),{c(){r=ie("button"),s&&s.c(),e=Le(),Ke(n.$$.fragment),rt(r,"height",t[6]),rt(r,"width",t[6]),h(r,"class","iconBtn-revly__2023 svelte-i3yicd"),h(r,"id",t[3]),zr(r,"active-revly__2023",t[0])},m(u,l){Ce(u,r,l),s&&s.m(r,null),U(r,e),Je(n,r,null),i=!0,a||(o=[nt(r,"click",t[8]),nt(r,"mouseenter",t[9]),nt(r,"mouseleave",t[10]),nt(r,"keydown",t[11]),nt(r,"keyup",t[12]),nt(r,"focus",t[13]),nt(r,"blur",t[14]),nt(r,"submit",t[15]),nt(r,"input",t[16])],a=!0)},p(u,[l]){u[4]?s?s.p(u,l):(s=f4(u),s.c(),s.m(r,e)):s&&(s.d(1),s=null);const c={};l&2&&(c.src=u[1]),l&32&&(c.size=u[5]),l&4&&(c.alt=u[2]),n.$set(c),(!i||l&64)&&rt(r,"height",u[6]),(!i||l&64)&&rt(r,"width",u[6]),(!i||l&8)&&h(r,"id",u[3]),(!i||l&1)&&zr(r,"active-revly__2023",u[0])},i(u){i||(_e(n.$$.fragment,u),i=!0)},o(u){Ee(n.$$.fragment,u),i=!1},d(u){u&&Me(r),s&&s.d(),Xe(n),a=!1,kr(o)}}}function zSe(t){return{"extra-large":"large",large:"medium",medium:"normal",normal:"small",small:"small","extra-small":"extra-small"}[t]}function WSe(t,r,e){let n,i,{isActive:a=!1}=r,{src:o}=r,{size:s="medium"}=r,{alt:u}=r,{id:l}=r,{showBadge:c=!1}=r;function f(R){Hr.call(this,t,R)}function d(R){Hr.call(this,t,R)}function v(R){Hr.call(this,t,R)}function p(R){Hr.call(this,t,R)}function y(R){Hr.call(this,t,R)}function k(R){Hr.call(this,t,R)}function I(R){Hr.call(this,t,R)}function C(R){Hr.call(this,t,R)}function L(R){Hr.call(this,t,R)}return t.$$set=R=>{"isActive"in R&&e(0,a=R.isActive),"src"in R&&e(1,o=R.src),"size"in R&&e(7,s=R.size),"alt"in R&&e(2,u=R.alt),"id"in R&&e(3,l=R.id),"showBadge"in R&&e(4,c=R.showBadge)},t.$$.update=()=>{t.$$.dirty&128&&e(6,n=nSe[s]),t.$$.dirty&128&&e(5,i=zSe(s))},[a,o,u,l,c,i,n,s,f,d,v,p,y,k,I,C,L]}class J0 extends It{constructor(r){super(),Rt(this,r,WSe,$Se,Et,{isActive:0,src:1,size:7,alt:2,id:3,showBadge:4},FSe)}}function BSe(t){Zt(t,"svelte-wa5jb7",".rev-tooltip.svelte-wa5jb7.svelte-wa5jb7{position:relative;display:inline-block}.rev-tooltip-text.svelte-wa5jb7.svelte-wa5jb7{white-space:nowrap;line-height:16px;font-size:12px;background:#3d4043;color:#e8eaed;border-radius:4px;padding:4px 8px;position:absolute;opacity:0;transition:opacity 0.3s ease-out}.rev-tooltip.svelte-wa5jb7:hover .rev-tooltip-text.svelte-wa5jb7{opacity:1}.top.svelte-wa5jb7.svelte-wa5jb7{bottom:calc(100% + 10px);left:50%;transform:translateX(-50%)}.bottom.svelte-wa5jb7.svelte-wa5jb7{top:calc(100% + 10px);left:50%;transform:translateX(-50%)}")}function ZSe(t){let r,e,n,i,a,o;const s=t[3].default,u=Qu(s,t,t[2],null);return{c(){r=ie("div"),u&&u.c(),e=Le(),n=ie("span"),i=Nt(t[0]),h(n,"class",a="rev-tooltip-text "+t[1]+" svelte-wa5jb7"),h(r,"class","rev-tooltip svelte-wa5jb7")},m(l,c){Ce(l,r,c),u&&u.m(r,null),U(r,e),U(r,n),U(n,i),o=!0},p(l,[c]){u&&u.p&&(!o||c&4)&&Gu(u,s,l,l[2],o?Yu(s,l[2],c,null):Hu(l[2]),null),(!o||c&1)&&tr(i,l[0]),(!o||c&2&&a!==(a="rev-tooltip-text "+l[1]+" svelte-wa5jb7"))&&h(n,"class",a)},i(l){o||(_e(u,l),o=!0)},o(l){Ee(u,l),o=!1},d(l){l&&Me(r),u&&u.d(l)}}}function qSe(t,r,e){let{$$slots:n={},$$scope:i}=r,{title:a=""}=r,{placement:o="top"}=r;return t.$$set=s=>{"title"in s&&e(0,a=s.title),"placement"in s&&e(1,o=s.placement),"$$scope"in s&&e(2,i=s.$$scope)},[a,o,i,n]}class Cv extends It{constructor(r){super(),Rt(this,r,qSe,ZSe,Et,{title:0,placement:1},BSe)}}function QSe(t){Zt(t,"svelte-zkdc0x",".bubble.svelte-zkdc0x{position:relative;display:inline-block;z-index:10000}.hide.svelte-zkdc0x{display:none}.text.svelte-zkdc0x{display:flex;z-index:1;width:138px;padding:8px 10px;line-height:16px;font-size:12px;background-color:white;color:black;border-radius:12px;position:absolute;box-sizing:border-box;justify-content:center;align-items:center}.top.svelte-zkdc0x{bottom:calc(100% + 14px);left:50%;transform:translateX(-50%)}.bottom.svelte-zkdc0x{top:calc(100% + 14px);left:50%;transform:translateX(-50%)}.message-body.svelte-zkdc0x{display:-webkit-box;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;text-align:center}.arrow.svelte-zkdc0x{width:24px;position:absolute;color:white;align-self:center;left:50%;transform:translateX(-50%)}.arrow-top.svelte-zkdc0x{bottom:calc(100% + 5px)}.arrow-bottom.svelte-zkdc0x{top:calc(100% + 5px)}.animation.svelte-zkdc0x{animation:svelte-zkdc0x-fade 5s;-webkit-animation:svelte-zkdc0x-fade 5s;-moz-animation:svelte-zkdc0x-fade 5s;-o-animation:svelte-zkdc0x-fade 5s;-ms-animation:svelte-zkdc0x-fade 5s}@keyframes svelte-zkdc0x-fade{0%,100%{opacity:0}20%,80%{opacity:1}}")}function YSe(t){let r,e,n,i,a,o,s,u,l,c,f,d,v,p;const y=t[4].default,k=Qu(y,t,t[3],null);return{c(){r=ie("div"),k&&k.c(),e=Le(),n=ie("span"),i=ie("span"),a=ie("p"),o=Nt(t[0]),u=Le(),l=ie("span"),c=qe("svg"),f=qe("path"),h(a,"class","message-body svelte-zkdc0x"),h(i,"class",s="text "+t[1]+" svelte-zkdc0x"),h(f,"d","M0 0H24L13.5185 12.2284C12.7203 13.1596 11.2797 13.1596 10.4815 12.2284L0 0Z"),h(f,"fill","white"),h(c,"xmlns","http://www.w3.org/2000/svg"),h(c,"width","100%"),h(c,"height","100%"),h(c,"viewBox","0 0 24 12"),h(c,"fill","none"),h(l,"class",d="arrow arrow-"+t[1]+" svelte-zkdc0x"),h(n,"class",v="animation "+(t[2]?"":"hide")+" svelte-zkdc0x"),h(r,"class","bubble svelte-zkdc0x")},m(I,C){Ce(I,r,C),k&&k.m(r,null),U(r,e),U(r,n),U(n,i),U(i,a),U(a,o),U(n,u),U(n,l),U(l,c),U(c,f),p=!0},p(I,[C]){k&&k.p&&(!p||C&8)&&Gu(k,y,I,I[3],p?Yu(y,I[3],C,null):Hu(I[3]),null),(!p||C&1)&&tr(o,I[0]),(!p||C&2&&s!==(s="text "+I[1]+" svelte-zkdc0x"))&&h(i,"class",s),(!p||C&2&&d!==(d="arrow arrow-"+I[1]+" svelte-zkdc0x"))&&h(l,"class",d),(!p||C&4&&v!==(v="animation "+(I[2]?"":"hide")+" svelte-zkdc0x"))&&h(n,"class",v)},i(I){p||(_e(k,I),p=!0)},o(I){Ee(k,I),p=!1},d(I){I&&Me(r),k&&k.d(I)}}}function GSe(t,r,e){let{$$slots:n={},$$scope:i}=r,{body:a=""}=r,{placement:o="top"}=r,{show:s=!1}=r;return t.$$set=u=>{"body"in u&&e(0,a=u.body),"placement"in u&&e(1,o=u.placement),"show"in u&&e(2,s=u.show),"$$scope"in u&&e(3,i=u.$$scope)},[a,o,s,i,n]}class HSe extends It{constructor(r){super(),Rt(this,r,GSe,YSe,Et,{body:0,placement:1,show:2},QSe)}}function JSe(t){Zt(t,"svelte-1a6sfjl",".footer-container-revly_2023.svelte-1a6sfjl{color:#9c9c9c;display:flex;justify-content:center;align-items:center;gap:24px}.full-screen-revly .footer-container-revly_2023{gap:32px !important;margin:12px 0 !important}.mini-screen-revly .footer-container-revly_2023{gap:16px !important}.icon-button-revly__2023.svelte-1a6sfjl{background-color:transparent;display:flex;justify-content:center;align-items:center}#callEndBtn.svelte-1a6sfjl{background-color:#e52810 !important;height:32px;width:48px;border-radius:20px !important}.mini-screen-revly #callEndBtn{height:24px;width:36px}.full-screen-revly #callEndBtn{height:40px;width:60px}")}function XSe(t){let r,e;return r=new J0({props:{size:t[4],src:t[0].mic?a4:o4,alt:"micIcon",isActive:t[0].mic,id:"micBtnRevly"}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&16&&(a.size=n[4]),i&1&&(a.src=n[0].mic?a4:o4),i&1&&(a.isActive=n[0].mic),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function KSe(t){let r,e;return r=new J0({props:{size:t[4],src:t[0].camera?s4:u4,alt:"videoIcon",isActive:t[0].camera,id:"cameraBtnRevly"}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&16&&(a.size=n[4]),i&1&&(a.src=n[0].camera?s4:u4),i&1&&(a.isActive=n[0].camera),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function e2e(t){let r,e;return r=new J0({props:{showBadge:t[1],size:t[4],src:t[0].chat?c4:l4,alt:"chatIcon",isActive:t[0].chat,id:"chatBtnRevly"}}),r.$on("click",xn.toggleChat),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&2&&(a.showBadge=n[1]),i&16&&(a.size=n[4]),i&1&&(a.src=n[0].chat?c4:l4),i&1&&(a.isActive=n[0].chat),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function t2e(t){let r,e;return r=new Cv({props:{title:"Chat with everyone",$$slots:{default:[e2e]},$$scope:{ctx:t}}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&83&&(a.$$scope={dirty:i,ctx:n}),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function r2e(t){let r,e,n;return e=new H0({props:{src:VSe,size:t[4],alt:"callHangIcon"}}),{c(){r=ie("button"),Ke(e.$$.fragment),h(r,"id","callEndBtn"),h(r,"class","icon-button-revly__2023 svelte-1a6sfjl")},m(i,a){Ce(i,r,a),Je(e,r,null),n=!0},p(i,a){const o={};a&16&&(o.size=i[4]),e.$set(o)},i(i){n||(_e(e.$$.fragment,i),n=!0)},o(i){Ee(e.$$.fragment,i),n=!1},d(i){i&&Me(r),Xe(e)}}}function n2e(t){let r,e,n,i,a,o,s,u,l;return e=new Cv({props:{title:"Turn "+(t[0].mic?"off":"on")+" microphone",$$slots:{default:[XSe]},$$scope:{ctx:t}}}),i=new Cv({props:{title:"Turn "+(t[0].camera?"off":"on")+" camera",$$slots:{default:[KSe]},$$scope:{ctx:t}}}),o=new HSe({props:{body:t[3],show:t[1]&&t[2],$$slots:{default:[t2e]},$$scope:{ctx:t}}}),u=new Cv({props:{title:"Leave call",$$slots:{default:[r2e]},$$scope:{ctx:t}}}),{c(){r=ie("div"),Ke(e.$$.fragment),n=Le(),Ke(i.$$.fragment),a=Le(),Ke(o.$$.fragment),s=Le(),Ke(u.$$.fragment),h(r,"class","footer-container-revly_2023 svelte-1a6sfjl")},m(c,f){Ce(c,r,f),Je(e,r,null),U(r,n),Je(i,r,null),U(r,a),Je(o,r,null),U(r,s),Je(u,r,null),l=!0},p(c,[f]){const d={};f&1&&(d.title="Turn "+(c[0].mic?"off":"on")+" microphone"),f&81&&(d.$$scope={dirty:f,ctx:c}),e.$set(d);const v={};f&1&&(v.title="Turn "+(c[0].camera?"off":"on")+" camera"),f&81&&(v.$$scope={dirty:f,ctx:c}),i.$set(v);const p={};f&8&&(p.body=c[3]),f&6&&(p.show=c[1]&&c[2]),f&83&&(p.$$scope={dirty:f,ctx:c}),o.$set(p);const y={};f&80&&(y.$$scope={dirty:f,ctx:c}),u.$set(y)},i(c){l||(_e(e.$$.fragment,c),_e(i.$$.fragment,c),_e(o.$$.fragment,c),_e(u.$$.fragment,c),l=!0)},o(c){Ee(e.$$.fragment,c),Ee(i.$$.fragment,c),Ee(o.$$.fragment,c),Ee(u.$$.fragment,c),l=!1},d(c){c&&Me(r),Xe(e),Xe(i),Xe(o),Xe(u)}}}const i2e=5;function a2e(t,r,e){let n,i;xr(t,Wt,l=>e(0,i=l));let a=!1,o=!1,s="",u;return Zi.getInstance().hasUnreadMessages.subscribe(l=>{e(1,a=l),e(2,o=l)}),Zi.getInstance().messages.subscribe(l=>{var c;l.at(-1)!==void 0&&e(3,s=((c=l.at(-1))==null?void 0:c.body)||"New Message"),e(2,o=!0)}),ZD(()=>{o&&(u&&clearTimeout(u),u=setTimeout(()=>{e(2,o=!1)},i2e*1e3))}),t.$$.update=()=>{t.$$.dirty&1&&e(4,n=i.screenSize==Xt.Mini?"medium":i.screenSize==Xt.Full?"extra-large":"large")},[i,a,o,s,n]}class o2e extends It{constructor(r){super(),Rt(this,r,a2e,n2e,Et,{},JSe)}}const s2e="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9ImNoZXZyb24tZG93biI+CjxwYXRoIGlkPSJWZWN0b3IiIGQ9Ik0zIDQuNUw2IDcuNUw5IDQuNSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjwvZz4KPC9zdmc+Cg==";function u2e(t){Zt(t,"svelte-1vziu5",".overlay.svelte-1vziu5{height:100dvh;width:100dvw;background-color:rgba(0, 0, 0, 0.5);position:fixed;z-index:1000;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center}.hide.svelte-1vziu5{display:none}")}function l2e(t){let r,e,n,i,a;const o=t[3].default,s=Qu(o,t,t[2],null);return{c(){r=ie("div"),s&&s.c(),h(r,"class",e=an(`overlay ${t[0]?"":"hide"}`)+" svelte-1vziu5")},m(u,l){Ce(u,r,l),s&&s.m(r,null),n=!0,i||(a=nt(r,"click",function(){Mn(t[1])&&t[1].apply(this,arguments)}),i=!0)},p(u,[l]){t=u,s&&s.p&&(!n||l&4)&&Gu(s,o,t,t[2],n?Yu(o,t[2],l,null):Hu(t[2]),null),(!n||l&1&&e!==(e=an(`overlay ${t[0]?"":"hide"}`)+" svelte-1vziu5"))&&h(r,"class",e)},i(u){n||(_e(s,u),n=!0)},o(u){Ee(s,u),n=!1},d(u){u&&Me(r),s&&s.d(u),i=!1,a()}}}function c2e(t,r,e){let{$$slots:n={},$$scope:i}=r,{open:a=!1}=r,{onClose:o}=r;return t.$$set=s=>{"open"in s&&e(0,a=s.open),"onClose"in s&&e(1,o=s.onClose),"$$scope"in s&&e(2,i=s.$$scope)},[a,o,i,n]}class f2e extends It{constructor(r){super(),Rt(this,r,c2e,l2e,Et,{open:0,onClose:1},u2e)}}const d4="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIj4KICA8cGF0aAogICAgZD0iTTQuOTY4NzUgMjRIMTkuMDMxMkMyMC4xOTQ0IDI0IDIxLjE0MDYgMjMuMDUzOCAyMS4xNDA2IDIxLjg5MDZWNy4wMzEyNUgxNi4yMTg4QzE1LjA1NTYgNy4wMzEyNSAxNC4xMDk0IDYuMDg1MDMgMTQuMTA5NCA0LjkyMTg4VjBINC45Njg3NUMzLjgwNTU5IDAgMi44NTkzOCAwLjk0NjIxOSAyLjg1OTM4IDIuMTA5MzhWMjEuODkwNkMyLjg1OTM4IDIzLjA1MzggMy44MDU1OSAyNCA0Ljk2ODc1IDI0Wk03Ljc4MTI1IDkuODkwNjJIMTYuMjE4OEMxNi42MDc0IDkuODkwNjIgMTYuOTIxOSAxMC4yMDUxIDE2LjkyMTkgMTAuNTkzOEMxNi45MjE5IDEwLjk4MjQgMTYuNjA3NCAxMS4yOTY5IDE2LjIxODggMTEuMjk2OUg3Ljc4MTI1QzcuMzkyNjEgMTEuMjk2OSA3LjA3ODEyIDEwLjk4MjQgNy4wNzgxMiAxMC41OTM4QzcuMDc4MTIgMTAuMjA1MSA3LjM5MjYxIDkuODkwNjIgNy43ODEyNSA5Ljg5MDYyWk03Ljc4MTI1IDEyLjcwMzFIMTYuMjE4OEMxNi42MDc0IDEyLjcwMzEgMTYuOTIxOSAxMy4wMTc2IDE2LjkyMTkgMTMuNDA2MkMxNi45MjE5IDEzLjc5NDkgMTYuNjA3NCAxNC4xMDk0IDE2LjIxODggMTQuMTA5NEg3Ljc4MTI1QzcuMzkyNjEgMTQuMTA5NCA3LjA3ODEyIDEzLjc5NDkgNy4wNzgxMiAxMy40MDYyQzcuMDc4MTIgMTMuMDE3NiA3LjM5MjYxIDEyLjcwMzEgNy43ODEyNSAxMi43MDMxWk03Ljc4MTI1IDE1LjUxNTZIMTYuMjE4OEMxNi42MDc0IDE1LjUxNTYgMTYuOTIxOSAxNS44MzAxIDE2LjkyMTkgMTYuMjE4OEMxNi45MjE5IDE2LjYwNzQgMTYuNjA3NCAxNi45MjE5IDE2LjIxODggMTYuOTIxOUg3Ljc4MTI1QzcuMzkyNjEgMTYuOTIxOSA3LjA3ODEyIDE2LjYwNzQgNy4wNzgxMiAxNi4yMTg4QzcuMDc4MTIgMTUuODMwMSA3LjM5MjYxIDE1LjUxNTYgNy43ODEyNSAxNS41MTU2Wk03Ljc4MTI1IDE4LjMyODFIMTMuNDA2MkMxMy43OTQ5IDE4LjMyODEgMTQuMTA5NCAxOC42NDI2IDE0LjEwOTQgMTkuMDMxMkMxNC4xMDk0IDE5LjQxOTkgMTMuNzk0OSAxOS43MzQ0IDEzLjQwNjIgMTkuNzM0NEg3Ljc4MTI1QzcuMzkyNjEgMTkuNzM0NCA3LjA3ODEyIDE5LjQxOTkgNy4wNzgxMiAxOS4wMzEyQzcuMDc4MTIgMTguNjQyNiA3LjM5MjYxIDE4LjMyODEgNy43ODEyNSAxOC4zMjgxWiIKICAgIGZpbGw9IiM2MDYwNjAiCiAgLz4KICA8cGF0aAogICAgZD0iTTE2LjIxODggNS42MjQ4OEgyMC43Mjg2TDE1LjUxNTYgMC40MTE4NjVWNC45MjE3NkMxNS41MTU2IDUuMzA5NjkgMTUuODMwOCA1LjYyNDg4IDE2LjIxODggNS42MjQ4OFoiCiAgICBmaWxsPSIjNjA2MDYwIgogIC8+Cjwvc3ZnPgo=";function d2e(t){Zt(t,"svelte-12omfmq",".chat-preview-img.svelte-12omfmq.svelte-12omfmq{width:50%;border-radius:4px;margin:0.6em 0;cursor:pointer}.file-container.svelte-12omfmq.svelte-12omfmq{padding:0.8em 1em;margin:0.6em 0;border:2px solid #e4e7e9;border-radius:4px;display:flex;color:black;cursor:pointer;box-sizing:border-box;width:100%;gap:1em;line-height:1.5}.icon-container.svelte-12omfmq.svelte-12omfmq{display:flex;align-items:center;min-width:40px}.icon-container.svelte-12omfmq img.svelte-12omfmq{height:100%;object-fit:contain;max-width:100%}.media-info.svelte-12omfmq.svelte-12omfmq{display:flex;flex-direction:column;justify-content:center;min-width:0}.media-info.svelte-12omfmq p.svelte-12omfmq{margin:0;font-size:12px}.filename.svelte-12omfmq.svelte-12omfmq{font-weight:700;overflow:hidden;text-overflow:ellipsis}.size.svelte-12omfmq.svelte-12omfmq{font-weight:400}.close-img-preview.svelte-12omfmq.svelte-12omfmq{background-color:transparent;color:white;border:none;height:100%;max-width:40px;display:flex;align-items:center;justify-content:center}.preview-modal.svelte-12omfmq.svelte-12omfmq{display:flex;flex-direction:column;align-items:center;position:relative;height:95%;width:80%;background-color:#1c2124;border-radius:16px;overflow:hidden}.preview-modal.svelte-12omfmq img.svelte-12omfmq{max-height:100%;margin:auto;max-width:100%}.modal-header.svelte-12omfmq.svelte-12omfmq{height:80px;width:100%;display:flex;justify-content:space-between;align-items:center;padding:0 20px;background:linear-gradient(0deg, rgba(255, 255, 255, 0) 0%, rgba(0, 0, 0, 1) 100%);color:white;position:absolute;box-sizing:border-box;font-weight:700}@media(max-width: 550px){.preview-modal.svelte-12omfmq.svelte-12omfmq{height:100dvh;width:100dvw;border-radius:0}}")}function p2e(t){let r,e,n,i,a,o,s,u=t[0].filename+"",l,c,f,d=X0(t[0].size)+"",v,p,y,k;return{c(){r=ie("div"),e=ie("div"),n=ie("img"),a=Le(),o=ie("div"),s=ie("p"),l=Nt(u),c=Le(),f=ie("p"),v=Nt(d),p=Nt(" - Click to open"),Jt(n.src,i=d4)||h(n,"src",i),h(n,"alt","file"),h(n,"class","svelte-12omfmq"),h(e,"class",an("icon-container")+" svelte-12omfmq"),h(s,"class",an("filename")+" svelte-12omfmq"),h(f,"class",an("size")+" svelte-12omfmq"),h(o,"class",an("media-info")+" svelte-12omfmq"),h(r,"class","file-container svelte-12omfmq")},m(I,C){Ce(I,r,C),U(r,e),U(e,n),U(r,a),U(r,o),U(o,s),U(s,l),U(o,c),U(o,f),U(f,v),U(f,p),y||(k=nt(r,"click",t[5]),y=!0)},p(I,C){C&1&&u!==(u=I[0].filename+"")&&tr(l,u),C&1&&d!==(d=X0(I[0].size)+"")&&tr(v,d)},i:Ge,o:Ge,d(I){I&&Me(r),y=!1,k()}}}function v2e(t){let r,e,n,i,a,o,s,u;return a=new f2e({props:{open:t[2],onClose:t[4],$$slots:{default:[h2e]},$$scope:{ctx:t}}}),{c(){r=ie("img"),i=Le(),Ke(a.$$.fragment),Jt(r.src,e=t[1])||h(r,"src",e),h(r,"alt",n=t[0].filename),h(r,"class","chat-preview-img svelte-12omfmq")},m(l,c){Ce(l,r,c),Ce(l,i,c),Je(a,l,c),o=!0,s||(u=[nt(r,"click",t[3]),nt(r,"keydown",t[6])],s=!0)},p(l,c){(!o||c&2&&!Jt(r.src,e=l[1]))&&h(r,"src",e),(!o||c&1&&n!==(n=l[0].filename))&&h(r,"alt",n);const f={};c&4&&(f.open=l[2]),c&131&&(f.$$scope={dirty:c,ctx:l}),a.$set(f)},i(l){o||(_e(a.$$.fragment,l),o=!0)},o(l){Ee(a.$$.fragment,l),o=!1},d(l){l&&Me(r),l&&Me(i),Xe(a,l),s=!1,kr(u)}}}function h2e(t){let r,e,n,i=t[0].filename+"",a,o,s,u,l,c,f,d,v,p,y;return u=new yo({}),{c(){r=ie("div"),e=ie("div"),n=ie("p"),a=Nt(i),o=Le(),s=ie("button"),Ke(u.$$.fragment),l=Le(),c=ie("img"),h(s,"class","close-img-preview svelte-12omfmq"),h(e,"class","modal-header svelte-12omfmq"),Jt(c.src,f=t[1])||h(c,"src",f),h(c,"alt",d=t[0].filename),h(c,"class","svelte-12omfmq"),h(r,"class","preview-modal svelte-12omfmq")},m(k,I){Ce(k,r,I),U(r,e),U(e,n),U(n,a),U(e,o),U(e,s),Je(u,s,null),U(r,l),U(r,c),v=!0,p||(y=[nt(s,"click",t[4]),nt(r,"click",Ju(y2e))],p=!0)},p(k,I){(!v||I&1)&&i!==(i=k[0].filename+"")&&tr(a,i),(!v||I&2&&!Jt(c.src,f=k[1]))&&h(c,"src",f),(!v||I&1&&d!==(d=k[0].filename))&&h(c,"alt",d)},i(k){v||(_e(u.$$.fragment,k),v=!0)},o(k){Ee(u.$$.fragment,k),v=!1},d(k){k&&Me(r),Xe(u),p=!1,kr(y)}}}function m2e(t){let r,e,n,i,a;const o=[v2e,p2e],s=[];function u(l,c){return c&3&&(e=null),e==null&&(e=!!(g2e(l[0].contentType)&&l[1])),e?0:1}return n=u(t,-1),i=s[n]=o[n](t),{c(){r=ie("div"),i.c(),h(r,"class","container")},m(l,c){Ce(l,r,c),s[n].m(r,null),a=!0},p(l,[c]){let f=n;n=u(l,c),n===f?s[n].p(l,c):(ar(),Ee(s[f],1,1,()=>{s[f]=null}),or(),i=s[n],i?i.p(l,c):(i=s[n]=o[n](l),i.c()),_e(i,1),i.m(r,null))},i(l){a||(_e(i),a=!0)},o(l){Ee(i),a=!1},d(l){l&&Me(r),s[n].d()}}}function X0(t,r=0){const e=["bytes","KB","MB","GB"];return t<1e3?+t.toFixed(2)+" "+e[r]:X0(t/1024,r+1)}function g2e(t){return t.includes("image")}const y2e=()=>{};function b2e(t,r,e){let{media:n}=r,i=null,a=!1;const o=()=>{e(2,a=!0)},s=()=>{e(2,a=!1)},u=async()=>{i||e(1,i=await n.getContentTemporaryUrl()||"");const c=document.createElement("a");c.href=i,c.target="_blank",c.rel="noopener",setTimeout(()=>{c.click()})};ea(()=>{n.getContentTemporaryUrl().then(c=>{e(1,i=c)})});const l=c=>{c.code};return t.$$set=c=>{"media"in c&&e(0,n=c.media)},[n,i,a,o,s,u,l]}class _2e extends It{constructor(r){super(),Rt(this,r,b2e,m2e,Et,{media:0},d2e)}}function w2e(t){Zt(t,"svelte-al0agv","p.svelte-al0agv{color:rgba(32, 33, 36, 1);font-size:14px;white-space:pre-wrap}")}function k2e(t){let r,e;return{c(){r=ie("p"),e=Nt(t[0]),h(r,"class","svelte-al0agv")},m(n,i){Ce(n,r,i),U(r,e),t[2](r)},p(n,[i]){i&1&&tr(e,n[0])},i:Ge,o:Ge,d(n){n&&Me(r),t[2](null)}}}function T2e(t){const r=/([\w+]+:\/\/)?([\w\d-]+\.)*[\w-]+[.:]\w+([/?=&#.]?[\w-]+)*\/?/gm;return t.replace(r,function(e){let n=e;return(!n.match("^https?://")||!n.match("^http?://")||!n.match("^www?."))&&(n="http://"+n),'<a href="'+n+'" target="_blank" rel="noopener noreferrer" style="color:blue;text-decoration:underline;">'+e+"</a>"})}function S2e(t,r,e){let{messageBody:n}=r,i;ea(()=>{e(1,i.innerHTML=T2e(n),i)});function a(o){ta[o?"unshift":"push"](()=>{i=o,e(1,i)})}return t.$$set=o=>{"messageBody"in o&&e(0,n=o.messageBody)},[n,i,a]}class E2e extends It{constructor(r){super(),Rt(this,r,S2e,k2e,Et,{messageBody:0},w2e)}}function M2e(t){Zt(t,"svelte-mtcmy5",".info.svelte-mtcmy5.svelte-mtcmy5{display:flex;width:100%;gap:12px;font-size:14px}.info.svelte-mtcmy5>p.svelte-mtcmy5:nth-child(1){color:rgba(32, 33, 36, 1);font-weight:700}.info.svelte-mtcmy5>p.svelte-mtcmy5:nth-child(2){color:#606367}")}function p4(t){let r,e,n,i,a,o;return{c(){r=ie("div"),e=ie("p"),n=Nt(t[2]),i=Le(),a=ie("p"),o=Nt(t[0]),h(e,"class","svelte-mtcmy5"),h(a,"class","svelte-mtcmy5"),h(r,"class","info svelte-mtcmy5")},m(s,u){Ce(s,r,u),U(r,e),U(e,n),U(r,i),U(r,a),U(a,o)},p(s,u){u&4&&tr(n,s[2]),u&1&&tr(o,s[0])},d(s){s&&Me(r)}}}function C2e(t){let r,e;return r=new _2e({props:{media:t[5][0]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p:Ge,i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function R2e(t){let r,e;return r=new E2e({props:{messageBody:t[3]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p:Ge,i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function I2e(t){let r,e,n,i,a,o,s=t[1]&&p4(t);const u=[R2e,C2e],l=[];function c(f,d){return f[4]==="text"&&f[3]?0:f[4]==="media"&&f[5]?1:-1}return~(n=c(t))&&(i=l[n]=u[n](t)),{c(){r=ie("div"),s&&s.c(),e=Le(),i&&i.c(),h(r,"style",a=t[1]?"margin-top:12px;":"")},m(f,d){Ce(f,r,d),s&&s.m(r,null),U(r,e),~n&&l[n].m(r,null),o=!0},p(f,[d]){f[1]?s?s.p(f,d):(s=p4(f),s.c(),s.m(r,e)):s&&(s.d(1),s=null),i&&i.p(f,d),(!o||d&2&&a!==(a=f[1]?"margin-top:12px;":""))&&h(r,"style",a)},i(f){o||(_e(i),o=!0)},o(f){Ee(i),o=!1},d(f){f&&Me(r),s&&s.d(),~n&&l[n].d()}}}function O2e(t,r,e){let n,i,a;xr(t,Wt,p=>e(8,a=p));let{message:o}=r,{time:s}=r,{shouldDisplayMessageInfo:u}=r,{author:l,body:c,type:f,attachedMedia:d}=o;const v=Ar.cookieId;return t.$$set=p=>{"message"in p&&e(6,o=p.message),"time"in p&&e(0,s=p.time),"shouldDisplayMessageInfo"in p&&e(1,u=p.shouldDisplayMessageInfo)},t.$$.update=()=>{var p;t.$$.dirty&256&&e(7,n=a.participants),t.$$.dirty&128&&e(2,i=l===v?"You":l&&n[l]&&((p=n[l])!=null&&p.name)?n[l].name:"Agent")},[s,u,i,c,f,d,o,n,a]}class N2e extends It{constructor(r){super(),Rt(this,r,O2e,I2e,Et,{message:6,time:0,shouldDisplayMessageInfo:1},M2e)}}function A2e(t){Zt(t,"svelte-p6d5zi",".close-btn.svelte-p6d5zi{border-radius:100%;background-color:rgba(141, 141, 141, 1);padding:2px;color:white;height:14px;width:14px;box-sizing:border-box;display:flex}.spinner.svelte-p6d5zi{background-color:rgba(141, 141, 141, 1);border-radius:100%;height:14px;width:14px;color:white;display:flex;align-items:center;justify-content:center;box-sizing:border-box;padding:2px;display:flex}.loader.svelte-p6d5zi{animation:svelte-p6d5zi-rotate 2.5s linear infinite;width:8px;height:8px}.imgClose.svelte-p6d5zi{display:flex;align-items:center;position:absolute;top:2px;right:-5px}.fileClose.svelte-p6d5zi{display:flex;align-items:center;position:absolute;top:-5px;right:-8px}@keyframes svelte-p6d5zi-rotate{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}")}function P2e(t){let r,e,n,i,a;return e=new yo({}),{c(){r=ie("div"),Ke(e.$$.fragment),h(r,"class","close-btn svelte-p6d5zi")},m(o,s){Ce(o,r,s),Je(e,r,null),n=!0,i||(a=nt(r,"click",function(){Mn(t[2])&&t[2].apply(this,arguments)}),i=!0)},p(o,s){t=o},i(o){n||(_e(e.$$.fragment,o),n=!0)},o(o){Ee(e.$$.fragment,o),n=!1},d(o){o&&Me(r),Xe(e),i=!1,a()}}}function x2e(t){let r,e,n;return{c(){r=ie("div"),e=ie("img"),Jt(e.src,n=Hx)||h(e,"src",n),h(e,"alt","spinner"),h(e,"class","loader svelte-p6d5zi"),h(r,"class","spinner svelte-p6d5zi")},m(i,a){Ce(i,r,a),U(r,e)},p:Ge,i:Ge,o:Ge,d(i){i&&Me(r)}}}function D2e(t){let r,e,n,i,a;const o=[x2e,P2e],s=[];function u(l,c){return l[0]?0:1}return e=u(t),n=s[e]=o[e](t),{c(){r=ie("div"),n.c(),h(r,"class",i=an(t[1]?"imgClose":"fileClose")+" svelte-p6d5zi")},m(l,c){Ce(l,r,c),s[e].m(r,null),a=!0},p(l,[c]){let f=e;e=u(l),e===f?s[e].p(l,c):(ar(),Ee(s[f],1,1,()=>{s[f]=null}),or(),n=s[e],n?n.p(l,c):(n=s[e]=o[e](l),n.c()),_e(n,1),n.m(r,null)),(!a||c&2&&i!==(i=an(l[1]?"imgClose":"fileClose")+" svelte-p6d5zi"))&&h(r,"class",i)},i(l){a||(_e(n),a=!0)},o(l){Ee(n),a=!1},d(l){l&&Me(r),s[e].d()}}}function L2e(t,r,e){let{isSendingFile:n=!1}=r,{img:i}=r,{onCancel:a}=r;return t.$$set=o=>{"isSendingFile"in o&&e(0,n=o.isSendingFile),"img"in o&&e(1,i=o.img),"onCancel"in o&&e(2,a=o.onCancel)},[n,i,a]}class v4 extends It{constructor(r){super(),Rt(this,r,L2e,D2e,Et,{isSendingFile:0,img:1,onCancel:2},A2e)}}function U2e(t){Zt(t,"svelte-4sg41p",".container.svelte-4sg41p.svelte-4sg41p{display:flex;flex:1}.imgContainer.svelte-4sg41p.svelte-4sg41p{position:relative}.imgContainer.svelte-4sg41p img.svelte-4sg41p{max-width:100%;max-height:96px;border-radius:4px;margin:8px 0}.fileContainer.svelte-4sg41p.svelte-4sg41p{position:relative;margin:8px 0;border-radius:4px;display:flex;padding:8px;gap:8px;width:180px;background-color:white;border:1px solid rgba(48, 48, 48, 0.5);color:rgba(48, 48, 48, 1);line-height:1.5}.iconContainer.svelte-4sg41p.svelte-4sg41p{display:flex;align-items:center;min-width:30px}.filename.svelte-4sg41p.svelte-4sg41p{font-weight:700;overflow:hidden;text-overflow:ellipsis;font-size:12px;word-wrap:break-word;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}")}function j2e(t){let r,e,n,i,a,o,s=t[1].name+"",u,l,c,f;return c=new v4({props:{img:!1,isSendingFile:t[2],onCancel:t[3]}}),{c(){r=ie("div"),e=ie("div"),n=ie("img"),a=Le(),o=ie("p"),u=Nt(s),l=Le(),Ke(c.$$.fragment),Jt(n.src,i=d4)||h(n,"src",i),h(n,"alt","file"),h(e,"class","iconContainer svelte-4sg41p"),h(o,"class","filename svelte-4sg41p"),h(r,"class","fileContainer svelte-4sg41p")},m(d,v){Ce(d,r,v),U(r,e),U(e,n),U(r,a),U(r,o),U(o,u),U(r,l),Je(c,r,null),f=!0},p(d,v){(!f||v&2)&&s!==(s=d[1].name+"")&&tr(u,s);const p={};v&4&&(p.isSendingFile=d[2]),v&8&&(p.onCancel=d[3]),c.$set(p)},i(d){f||(_e(c.$$.fragment,d),f=!0)},o(d){Ee(c.$$.fragment,d),f=!1},d(d){d&&Me(r),Xe(c)}}}function V2e(t){let r,e,n,i,a,o,s;return o=new v4({props:{img:!0,isSendingFile:t[2],onCancel:t[3]}}),{c(){r=ie("div"),e=ie("img"),a=Le(),Ke(o.$$.fragment),Jt(e.src,n=URL.createObjectURL(t[1]))||h(e,"src",n),h(e,"alt",i=t[1].name),h(e,"class","svelte-4sg41p"),h(r,"class","imgContainer svelte-4sg41p")},m(u,l){Ce(u,r,l),U(r,e),U(r,a),Je(o,r,null),s=!0},p(u,l){(!s||l&2&&!Jt(e.src,n=URL.createObjectURL(u[1])))&&h(e,"src",n),(!s||l&2&&i!==(i=u[1].name))&&h(e,"alt",i);const c={};l&4&&(c.isSendingFile=u[2]),l&8&&(c.onCancel=u[3]),o.$set(c)},i(u){s||(_e(o.$$.fragment,u),s=!0)},o(u){Ee(o.$$.fragment,u),s=!1},d(u){u&&Me(r),Xe(o)}}}function F2e(t){let r,e,n,i;const a=[V2e,j2e],o=[];function s(u,l){return u[0]==="image"?0:u[0]==="document"?1:-1}return~(e=s(t))&&(n=o[e]=a[e](t)),{c(){r=ie("div"),n&&n.c(),h(r,"class","container svelte-4sg41p")},m(u,l){Ce(u,r,l),~e&&o[e].m(r,null),i=!0},p(u,[l]){let c=e;e=s(u),e===c?~e&&o[e].p(u,l):(n&&(ar(),Ee(o[c],1,1,()=>{o[c]=null}),or()),~e?(n=o[e],n?n.p(u,l):(n=o[e]=a[e](u),n.c()),_e(n,1),n.m(r,null)):n=null)},i(u){i||(_e(n),i=!0)},o(u){Ee(n),i=!1},d(u){u&&Me(r),~e&&o[e].d()}}}function $2e(t,r,e){let{fileType:n}=r,{file:i}=r,{isSendingFile:a}=r,{onCancel:o}=r;return t.$$set=s=>{"fileType"in s&&e(0,n=s.fileType),"file"in s&&e(1,i=s.file),"isSendingFile"in s&&e(2,a=s.isSendingFile),"onCancel"in s&&e(3,o=s.onCancel)},[n,i,a,o]}class z2e extends It{constructor(r){super(),Rt(this,r,$2e,F2e,Et,{fileType:0,file:1,isSendingFile:2,onCancel:3},U2e)}}function W2e(t){Zt(t,"svelte-4sqi23",".snackbar.svelte-4sqi23{position:fixed;z-index:1000000}.top.svelte-4sqi23{top:0}.bottom.svelte-4sqi23{bottom:0}.left.svelte-4sqi23{left:0}.right.svelte-4sqi23{right:0}.mobile-view.svelte-4sqi23{width:100vw;left:0;right:0;padding:0 16px;box-sizing:border-box}")}function B2e(t){let r,e,n,i;const a=t[4].default,o=Qu(a,t,t[3],null);return{c(){r=ie("div"),o&&o.c(),h(r,"class",e="snackbar "+t[0].vertical+" "+(gi?"mobile-view":t[0].horizontal)+" svelte-4sqi23")},m(s,u){Ce(s,r,u),o&&o.m(r,null),i=!0},p(s,[u]){o&&o.p&&(!i||u&8)&&Gu(o,a,s,s[3],i?Yu(a,s[3],u,null):Hu(s[3]),null),(!i||u&1&&e!==(e="snackbar "+s[0].vertical+" "+(gi?"mobile-view":s[0].horizontal)+" svelte-4sqi23"))&&h(r,"class",e)},i(s){i||(_e(o,s),Cn(()=>{n||(n=za(r,xa,{x:200},!0)),n.run(1)}),i=!0)},o(s){Ee(o,s),n||(n=za(r,xa,{x:200},!1)),n.run(0),i=!1},d(s){s&&Me(r),o&&o.d(s),s&&n&&n.end()}}}function Z2e(t,r,e){let{$$slots:n={},$$scope:i}=r,{origin:a={vertical:"top",horizontal:"right"}}=r,{autoHideDuration:o=null}=r,{onClose:s}=r,u=$a();return ea(()=>{o&&setTimeout(()=>{s(),u.$destroy()},o)}),t.$$set=l=>{"origin"in l&&e(0,a=l.origin),"autoHideDuration"in l&&e(1,o=l.autoHideDuration),"onClose"in l&&e(2,s=l.onClose),"$$scope"in l&&e(3,i=l.$$scope)},[a,o,s,i,n]}class q2e extends It{constructor(r){super(),Rt(this,r,Z2e,B2e,Et,{origin:0,autoHideDuration:1,onClose:2},W2e)}}function Q2e(t){let r,e,n,i;return{c(){r=qe("svg"),e=qe("path"),n=qe("path"),i=qe("path"),h(e,"d","M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"),h(e,"stroke",t[0]),h(e,"stroke-width","2"),h(e,"stroke-linecap","round"),h(e,"stroke-linejoin","round"),h(n,"d","M12 8V12"),h(n,"stroke",t[0]),h(n,"stroke-width","2"),h(n,"stroke-linecap","round"),h(n,"stroke-linejoin","round"),h(i,"d","M12 16H12.01"),h(i,"stroke",t[0]),h(i,"stroke-width","2"),h(i,"stroke-linecap","round"),h(i,"stroke-linejoin","round"),h(r,"xmlns","http://www.w3.org/2000/svg"),h(r,"width","100%"),h(r,"height","100%"),h(r,"viewBox","0 0 24 24"),h(r,"fill","none")},m(a,o){Ce(a,r,o),U(r,e),U(r,n),U(r,i)},p(a,[o]){o&1&&h(e,"stroke",a[0]),o&1&&h(n,"stroke",a[0]),o&1&&h(i,"stroke",a[0])},i:Ge,o:Ge,d(a){a&&Me(r)}}}function Y2e(t,r,e){let{color:n="#F18C7F"}=r;return t.$$set=i=>{"color"in i&&e(0,n=i.color)},[n]}class G2e extends It{constructor(r){super(),Rt(this,r,Y2e,Q2e,Et,{color:0})}}function H2e(t){Zt(t,"svelte-1oq6pzt",'p.svelte-1oq6pzt,button.svelte-1oq6pzt,textarea.svelte-1oq6pzt{margin:0;padding:0}textarea.svelte-1oq6pzt::placeholder{color:rgba(172, 175, 176, 1)}.chat-container-revly__2023.svelte-1oq6pzt{box-sizing:border-box;width:100%;max-width:330px;height:100%;padding:24px;background:#ffffff;border-radius:16px;display:flex;flex-direction:column;gap:16px;position:relative}.chat-texts.svelte-1oq6pzt{position:relative;flex:1}.scroll-container-revly__2023.svelte-1oq6pzt{position:absolute;top:0;bottom:0;left:0;right:0;overflow-y:scroll;-ms-overflow-style:"none";scrollbar-width:"none"}.scroll-container-revly__2023.svelte-1oq6pzt::-webkit-scrollbar{display:none}.header-revly__2023.svelte-1oq6pzt{display:flex;justify-content:space-between;align-items:center;color:black !important;font-size:16px;background-color:white}.chat-input-revly__2023.svelte-1oq6pzt{display:flex;justify-content:space-between;align-items:center;min-height:48px;background-color:rgba(241, 243, 244, 1);border-radius:24px;width:100%;padding:0 16px;box-sizing:border-box}textarea.svelte-1oq6pzt{background:none;outline:none;border:none;color:black;overflow:hidden;text-overflow:ellipsis;font-size:14px;font-family:Mulish;font-style:normal;font-weight:500;line-height:20px;padding:0;resize:none;width:100%;padding:8px 14px}.new-msg-btn.svelte-1oq6pzt{display:flex;justify-content:space-between;align-items:center;color:white !important;position:absolute;bottom:16px;right:16px;padding:8px 12px;border-radius:24px;background:#3d4043 !important}.hide.svelte-1oq6pzt{display:none !important}.close-btn.svelte-1oq6pzt{background:none;display:flex;justify-content:center;align-items:center;color:black;height:100%;width:24px}.pin-btn.svelte-1oq6pzt{color:rgba(61, 64, 67, 1);padding:0.56em;min-width:auto;background-color:transparent;display:flex;justify-content:center;align-items:center;opacity:1}.pin-btn.svelte-1oq6pzt:hover{background-color:transparent}.send-btn.svelte-1oq6pzt{background:none;display:flex;justify-content:center;align-items:center;color:rgba(61, 64, 67, 1);padding:0.56em;min-width:auto}.send-btn.svelte-1oq6pzt:disabled{opacity:0.6}.send-btn.svelte-1oq6pzt:disabled:hover{opacity:0.6}.send-btn.svelte-1oq6pzt:hover{opacity:0.8;border-color:transparent}.send-btn.svelte-1oq6pzt:focus,.send-btn.svelte-1oq6pzt:focus-visible{outline:none}.error-alert.svelte-1oq6pzt{background-color:rgba(253, 240, 238, 1);color:rgba(229, 40, 16, 1);font-weight:700;border:1px solid rgba(229, 40, 16, 1);margin-top:104px;margin-right:40px;padding:12px;display:flex;gap:12px;border-radius:6px;align-items:center}.mobile-alert.svelte-1oq6pzt{width:100%}.alert-icon.svelte-1oq6pzt{width:24px;display:flex;align-items:center}.mobile-view.svelte-1oq6pzt{height:100% !important;width:100vw !important;max-width:100vw !important;position:fixed;border-radius:0;left:0;right:0;top:0;bottom:0;z-index:10000000}.mobile-header-revly__2023.svelte-1oq6pzt{position:fixed;top:0;left:0;right:0;display:flex;width:100vw;padding:24px 24px 16px 24px;box-sizing:border-box}.mobile-text.svelte-1oq6pzt{margin-top:32px}')}function h4(t,r,e){const n=t.slice();return n[28]=r[e],n[30]=e,n}function m4(t){let r,e;return r=new q2e({props:{onClose:t[18],autoHideDuration:6e3,$$slots:{default:[J2e]},$$scope:{ctx:t}}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i[0]&256&&(a.onClose=n[18]),i[0]&256|i[1]&1&&(a.$$scope={dirty:i,ctx:n}),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function J2e(t){let r,e,n,i,a,o,s;return n=new G2e({}),{c(){r=ie("div"),e=ie("div"),Ke(n.$$.fragment),i=Le(),a=ie("p"),o=Nt(t[8]),h(e,"class","alert-icon svelte-1oq6pzt"),h(a,"class","svelte-1oq6pzt"),h(r,"class","error-alert "+(gi?"mobile-alert":"")+" svelte-1oq6pzt")},m(u,l){Ce(u,r,l),U(r,e),Je(n,e,null),U(r,i),U(r,a),U(a,o),s=!0},p(u,l){(!s||l[0]&256)&&tr(o,u[8])},i(u){s||(_e(n.$$.fragment,u),s=!0)},o(u){Ee(n.$$.fragment,u),s=!1},d(u){u&&Me(r),Xe(n)}}}function g4(t,r){var a;let e,n,i;return n=new N2e({props:{message:r[28],time:r[12](r[28])||"",shouldDisplayMessageInfo:r[12](r[28])!==r[12](r[2][r[30]-1])||r[28].author!==((a=r[2][r[30]-1])==null?void 0:a.author)}}),{key:t,first:null,c(){e=Fn(),Ke(n.$$.fragment),this.first=e},m(o,s){Ce(o,e,s),Je(n,o,s),i=!0},p(o,s){var l;r=o;const u={};s[0]&4&&(u.message=r[28]),s[0]&4&&(u.time=r[12](r[28])||""),s[0]&4&&(u.shouldDisplayMessageInfo=r[12](r[28])!==r[12](r[2][r[30]-1])||r[28].author!==((l=r[2][r[30]-1])==null?void 0:l.author)),n.$set(u)},i(o){i||(_e(n.$$.fragment,o),i=!0)},o(o){Ee(n.$$.fragment,o),i=!1},d(o){o&&Me(e),Xe(n,o)}}}function X2e(t){let r,e,n,i,a;return{c(){r=ie("input"),e=Le(),n=ie("textarea"),h(r,"type","file"),h(r,"class","hide svelte-1oq6pzt"),r.value="",h(r,"accept",rEe),h(n,"placeholder","Send a message"),h(n,"rows",1),h(n,"class","svelte-1oq6pzt")},m(o,s){Ce(o,r,s),t[20](r),Ce(o,e,s),Ce(o,n,s),t[21](n),j1(n,t[0]),i||(a=[nt(r,"change",t[15]),nt(n,"input",t[22]),nt(n,"keydown",nEe)],i=!0)},p(o,s){s[0]&1&&j1(n,o[0])},i:Ge,o:Ge,d(o){o&&Me(r),t[20](null),o&&Me(e),o&&Me(n),t[21](null),i=!1,kr(a)}}}function K2e(t){let r,e;return r=new z2e({props:{file:t[1],fileType:t[1].type.includes("image")?"image":"document",isSendingFile:t[7],onCancel:t[16]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i[0]&2&&(a.file=n[1]),i[0]&2&&(a.fileType=n[1].type.includes("image")?"image":"document"),i[0]&128&&(a.isSendingFile=n[7]),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function eEe(t){let r,e,n,i,a,o,s,u,l,c,f=[],d=new Map,v,p,y,k,I=t[9]<=1?"":"s",C,L,R,q,z,F,D,W,X,me,de,H,ee,Z,te,re,K,fe,Te,$,We,et,dt,$e,ue,Rr,Ue,ke,Gt,Qe,vr,At;o=new yo({props:{color:"black"}});let Oe=t[8]&&m4(t),_t=t[2];const Bt=ot=>ot[30];for(let ot=0;ot<_t.length;ot+=1){let Tt=h4(t,_t,ot),Be=Bt(Tt);d.set(Be,f[ot]=g4(Be,Tt))}const Fe=[K2e,X2e],rr=[];function Pt(ot,Tt){return ot[1]?0:1}return me=Pt(t),de=rr[me]=Fe[me](t),{c(){r=ie("div"),e=ie("div"),n=ie("p"),n.textContent="In-call messages",i=Le(),a=ie("button"),Ke(o.$$.fragment),s=Le(),Oe&&Oe.c(),u=Le(),l=ie("div"),c=ie("div");for(let ot=0;ot<f.length;ot+=1)f[ot].c();v=Le(),p=ie("button"),y=Nt(t[9]),k=Nt(" New Message"),C=Nt(I),L=Le(),R=ie("span"),q=ie("img"),W=Le(),X=ie("div"),de.c(),H=Le(),ee=ie("button"),Z=qe("svg"),te=qe("g"),re=qe("path"),fe=Le(),Te=ie("button"),$=qe("svg"),We=qe("g"),et=qe("g"),dt=qe("path"),$e=qe("defs"),ue=qe("clipPath"),Rr=qe("rect"),h(n,"class","svelte-1oq6pzt"),h(a,"class","close-btn svelte-1oq6pzt"),h(e,"class","header-revly__2023 svelte-1oq6pzt"),zr(e,"mobile-header-revly__2023",gi&&document.activeElement===t[5]),h(c,"class","scroll-container-revly__2023 svelte-1oq6pzt"),Jt(q.src,z=s2e)||h(q,"src",z),h(q,"alt","ChevronDown-icon"),h(p,"class",F="new-msg-btn "+(t[10].showButton?"":"hide")+" svelte-1oq6pzt"),h(l,"class",D="chat-texts "+(gi&&document.activeElement===t[5]?"mobile-text":"")+" svelte-1oq6pzt"),h(re,"id","Vector"),h(re,"d","M17.8666 9.20835L10.2082 16.8667C9.27005 17.8049 7.99757 18.332 6.67075 18.332C5.34393 18.332 4.07145 17.8049 3.13325 16.8667C2.19505 15.9285 1.66797 14.656 1.66797 13.3292C1.66797 12.0024 2.19505 10.7299 3.13325 9.79168L10.7916 2.13335C11.4171 1.50788 12.2654 1.15649 13.1499 1.15649C14.0345 1.15649 14.8828 1.50788 15.5082 2.13335C16.1337 2.75882 16.4851 3.60713 16.4851 4.49168C16.4851 5.37623 16.1337 6.22455 15.5082 6.85002L7.84158 14.5083C7.52885 14.8211 7.10469 14.9968 6.66242 14.9968C6.22014 14.9968 5.79598 14.8211 5.48325 14.5083C5.17051 14.1956 4.99482 13.7715 4.99482 13.3292C4.99482 12.8869 5.17051 12.4627 5.48325 12.15L12.5582 5.08335"),h(re,"stroke","#606060"),h(re,"stroke-width","2"),h(re,"stroke-linecap","round"),h(re,"stroke-linejoin","round"),h(te,"id","paperclip"),h(Z,"width","20"),h(Z,"height","20"),h(Z,"viewBox","0 0 20 20"),h(Z,"fill","none"),h(Z,"xmlns","http://www.w3.org/2000/svg"),h(ee,"class",K="pin-btn "+(t[11]?"hide":"")+" svelte-1oq6pzt"),h(dt,"id","Vector"),h(dt,"d","M0.273623 19.0873C0.109281 19.8424 0.689099 20.1621 1.2271 19.9209L19.4102 10.5973H19.4121C19.629 10.475 19.7549 10.2545 19.7549 10.0002C19.7549 9.74577 19.629 9.52518 19.4121 9.4029H19.4102L1.2271 0.0790995C0.689099 -0.16215 0.109281 0.157638 0.273623 0.912869C0.284744 0.964026 1.35971 5.75238 1.94418 8.3566L11.4361 10.0002L1.94418 11.6435C1.35971 14.2476 0.284694 19.0361 0.273623 19.0873Z"),h(dt,"fill","#606060"),h(et,"id","Group"),h(We,"id","send-message 1"),h(We,"clip-path","url(#clip0_5088_19547)"),h(Rr,"width","20"),h(Rr,"height","20"),h(Rr,"fill","white"),h(ue,"id","clip0_5088_19547"),h($,"width","20"),h($,"height","20"),h($,"viewBox","0 0 20 20"),h($,"fill","none"),h($,"xmlns","http://www.w3.org/2000/svg"),h(Te,"class","send-btn svelte-1oq6pzt"),Te.disabled=Ue=!t[0].length&&!t[1]||t[7],h(X,"class","chat-input-revly__2023 svelte-1oq6pzt"),h(r,"class","chat-container-revly__2023 "+(gi?"mobile-view":"")+" svelte-1oq6pzt")},m(ot,Tt){Ce(ot,r,Tt),U(r,e),U(e,n),U(e,i),U(e,a),Je(o,a,null),U(r,s),Oe&&Oe.m(r,null),U(r,u),U(r,l),U(l,c);for(let Be=0;Be<f.length;Be+=1)f[Be].m(c,null);t[19](c),U(l,v),U(l,p),U(p,y),U(p,k),U(p,C),U(p,L),U(p,R),U(R,q),U(r,W),U(r,X),rr[me].m(X,null),U(X,H),U(X,ee),U(ee,Z),U(Z,te),U(te,re),U(X,fe),U(X,Te),U(Te,$),U($,We),U(We,et),U(et,dt),U($,$e),U($e,ue),U(ue,Rr),t[24](Te),Qe=!0,vr||(At=[nt(a,"click",xn.toggleChat),nt(p,"click",t[13]),nt(ee,"click",t[23]),nt(Te,"click",t[14]),nt(r,"keydown",t[17])],vr=!0)},p(ot,Tt){(!Qe||Tt[0]&32)&&zr(e,"mobile-header-revly__2023",gi&&document.activeElement===ot[5]),ot[8]?Oe?(Oe.p(ot,Tt),Tt[0]&256&&_e(Oe,1)):(Oe=m4(ot),Oe.c(),_e(Oe,1),Oe.m(r,u)):Oe&&(ar(),Ee(Oe,1,1,()=>{Oe=null}),or()),Tt[0]&4100&&(_t=ot[2],ar(),f=KD(f,Tt,Bt,1,ot,_t,d,c,XD,g4,null,h4),or()),(!Qe||Tt[0]&512)&&tr(y,ot[9]),(!Qe||Tt[0]&512)&&I!==(I=ot[9]<=1?"":"s")&&tr(C,I),(!Qe||Tt[0]&1024&&F!==(F="new-msg-btn "+(ot[10].showButton?"":"hide")+" svelte-1oq6pzt"))&&h(p,"class",F),(!Qe||Tt[0]&32&&D!==(D="chat-texts "+(gi&&document.activeElement===ot[5]?"mobile-text":"")+" svelte-1oq6pzt"))&&h(l,"class",D);let Be=me;me=Pt(ot),me===Be?rr[me].p(ot,Tt):(ar(),Ee(rr[Be],1,1,()=>{rr[Be]=null}),or(),de=rr[me],de?de.p(ot,Tt):(de=rr[me]=Fe[me](ot),de.c()),_e(de,1),de.m(X,H)),(!Qe||Tt[0]&2048&&K!==(K="pin-btn "+(ot[11]?"hide":"")+" svelte-1oq6pzt"))&&h(ee,"class",K),(!Qe||Tt[0]&131&&Ue!==(Ue=!ot[0].length&&!ot[1]||ot[7]))&&(Te.disabled=Ue)},i(ot){if(!Qe){_e(o.$$.fragment,ot),_e(Oe);for(let Tt=0;Tt<_t.length;Tt+=1)_e(f[Tt]);_e(de),Cn(()=>{Gt&&Gt.end(1),ke=th(r,xa,{x:200}),ke.start()}),Qe=!0}},o(ot){Ee(o.$$.fragment,ot),Ee(Oe);for(let Tt=0;Tt<f.length;Tt+=1)Ee(f[Tt]);Ee(de),ke&&ke.invalidate(),Gt=HD(r,xa,{x:200,duration:150}),Qe=!1},d(ot){ot&&Me(r),Xe(o),Oe&&Oe.d();for(let Tt=0;Tt<f.length;Tt+=1)f[Tt].d();t[19](null),rr[me].d(),t[24](null),ot&&Gt&&Gt.end(),vr=!1,kr(At)}}}const tEe=30,rEe="audio/*, image/*, text/*, video/*, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document .xslx, .ppt, .pdf, .key, .svg, .csv",nEe=t=>{t.code==="Enter"&&!t.shiftKey&&t.preventDefault()};function iEe(t,r,e){let n;const i=Zi.getInstance();let a="",o=[],s,u,l,c,f,d=!1,v=null,p,y,k={isScrolledToBottom:!0,showButton:!1};const I=Z=>{var te;return(te=Z==null?void 0:Z.dateCreated)==null?void 0:te.toLocaleTimeString("en-us",{hour:"numeric",minute:"numeric"}).toLowerCase()},C=()=>{e(3,s.scrollTop=s.scrollHeight,s),e(9,y=0),p=!1};i.messages.subscribe(Z=>{p=Z.length-o.length>0,e(9,y=(k.isScrolledToBottom?0:y||0)+Z.length-o.length),e(2,o=[...Z])});const L=async()=>{if(f)try{e(7,d=!0),await i.sendMedia(f),e(1,f=null)}catch(Z){e(8,v="There was a problem uploading the file. Please try again."),console.log("Problem sending file: ",Z),e(4,u.files=null,u)}finally{e(7,d=!1)}else a&&(await i.sendMessage(a),e(0,a=""))},R=Z=>{var re,K,fe,Te;const te=Z.target;(re=te.files)!=null&&re[0]&&((K=te.files)==null?void 0:K[0].size)<=tEe*1e6?((fe=te.files)!=null&&fe[0]&&e(1,f=(Te=te.files)==null?void 0:Te[0]),c.focus()):(e(8,v="File is larger than 15MB"),e(4,u.files=null,u))},q=()=>{e(1,f=null)},z=()=>{if(!s)return;const Z=Math.abs(s.clientHeight+s.scrollTop-s.scrollHeight)<1;e(10,k={isScrolledToBottom:Z,showButton:Z?!1:k.showButton}),Z&&C()},F=Z=>{Z.code==="Enter"&&!Z.shiftKey&&L()};ea(()=>{C(),s.addEventListener("scroll",z),l.focus()}),Yv(()=>{k.isScrolledToBottom&&p?C():p&&e(10,k={...k,showButton:!k.isScrolledToBottom})}),Ku(()=>{s.removeEventListener("scroll",z)});const D=()=>e(8,v=null);function W(Z){ta[Z?"unshift":"push"](()=>{s=Z,e(3,s)})}function X(Z){ta[Z?"unshift":"push"](()=>{u=Z,e(4,u)})}function me(Z){ta[Z?"unshift":"push"](()=>{l=Z,e(5,l)})}function de(){a=this.value,e(0,a)}const H=()=>u.click();function ee(Z){ta[Z?"unshift":"push"](()=>{c=Z,e(6,c)})}return t.$$.update=()=>{t.$$.dirty[0]&3&&e(11,n=Boolean(f||a))},[a,f,o,s,u,l,c,d,v,y,k,n,I,C,L,R,q,F,D,W,X,me,de,H,ee]}class aEe extends It{constructor(r){super(),Rt(this,r,iEe,eEe,Et,{},H2e,[-1,-1])}}function oEe(t){Zt(t,"svelte-1dux9zh",'.container-revly__2023.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{box-sizing:border-box;background:#19171d !important;font-style:normal;border-radius:16px;width:410px;height:274px;padding:12px 16px !important;display:flex;flex-direction:column;justify-content:space-between}.container-revly__2023.full-screen-revly.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{padding:12px 24px !important;border-radius:0 !important}.container-revly__2023.mini-screen-revly.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{flex-direction:row-reverse;max-height:44px;padding:10px 16px !important}.header-revly__2023.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{color:#fff !important;font-weight:500;font-size:16px;display:flex;justify-content:space-between;align-items:center}.header-controlls.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{display:flex;justify-content:center;align-items:center;gap:16px}.mini-screen-revly.svelte-1dux9zh .header-controlls.svelte-1dux9zh.svelte-1dux9zh{gap:8px}.icon-button-revly__2023.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{background-color:transparent;display:flex;justify-content:center;align-items:center}.call-container-revly__2023.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{display:flex;justify-content:center;align-items:center;gap:24px;flex-grow:1;margin:10px 0;position:relative}#participantContainerRevly.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{height:100%;width:100%;transition:all 0.5s ease-in-out;position:relative}.participant-revly__2023{display:flex;justify-content:center;align-items:center;text-align:center;background:#292a2e !important;border-radius:16px;overflow:hidden;height:100%;max-height:100%;max-width:100%;aspect-ratio:auto 16 / 9;position:relative;border:0.8px solid #333136}#participantContainerRevly > .local-participant-revly__2023:not(:first-child){position:absolute;bottom:20px;right:0;max-height:150px;max-width:250px;z-index:1;background:#323335 !important;border:0.8px solid #333136 !important}.participant-revly__2023 > .avatar-revly__2023{width:20%;min-width:48px;max-width:120px;text-transform:capitalize;border-radius:100%;border:0px solid #ffffff33;display:flex;justify-content:center;transition:border 0.1s ease-in-out;box-sizing:content-box}.participant-revly__2023.svelte-1dux9zh:has(video)>.avatar-revly__2023.svelte-1dux9zh.svelte-1dux9zh{display:none}.participant-revly__2023::after{content:attr(data-identity);color:#fff !important;position:absolute;left:10px;bottom:10px;font-size:16px;text-transform:capitalize}video{width:100%;height:100%;position:absolute}#participantContainerRevly > .local-participant-revly__2023:not(:first-child) video{object-fit:cover}.participant-revly__2023 > video{transform:scaleX(-1)}.participant-mute::before{content:url("https://s3.ap-south-1.amazonaws.com/sdk.revly.io/mute-icon-new.svg");color:#fff !important;position:absolute;top:10px;left:10px;z-index:9999999}.full-screen-revly.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{position:fixed;inset:0;width:100dvw;height:100dvh;cursor:default}.small-screen-X.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{grid-template-columns:repeat(1, 1fr) !important;max-height:174px}.small-screen-X.svelte-1dux9zh .participant-revly__2023.svelte-1dux9zh.svelte-1dux9zh{background:#292a2e !important;border:0.8px solid #333136}.call-container-revly__2023 #screen-share + .small-screen-X{display:none}.small-screen-X div:not(:first-child){display:none}.mini-screen-revly{width:252px !important;height:66px !important}.mini-screen-revly > .call-container-revly__2023{display:none !important}#screen-share.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{height:100%;aspect-ratio:16 / 9;border-radius:16px;border:1px solid #333136;background:#292a2e !important;position:relative}.small-screen-revly.svelte-1dux9zh #screen-share.svelte-1dux9zh.svelte-1dux9zh{overflow:hidden}#screen-share.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh::after{content:"Agent is presenting";position:absolute;bottom:10px;left:10px;color:#fff !important}.full-screen-revly.svelte-1dux9zh #screen-share.svelte-1dux9zh.svelte-1dux9zh{width:65%}.full-screen-revly.svelte-1dux9zh #screen-share.svelte-1dux9zh+#participantContainerRevly.svelte-1dux9zh{grid-auto-rows:minmax(10px, 50%)}@media(max-width: 550px){.container-revly__2023.small-screen-revly.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{transform:scale(0.85);margin:-20px -30px -20px -30px}#participantContainerRevly.svelte-1dux9zh>.local-participant-revly__2023.svelte-1dux9zh.svelte-1dux9zh:not(:first-child){bottom:12px;right:12px;width:90px;aspect-ratio:0.6}.small-screen-revly.svelte-1dux9zh #screen-share.svelte-1dux9zh.svelte-1dux9zh{max-width:300px;margin:auto}.full-screen-revly.svelte-1dux9zh #screen-share.svelte-1dux9zh.svelte-1dux9zh{width:100%;aspect-ratio:unset}.call-container-revly__2023.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{display:grid;grid-template-columns:repeat(1, 1fr)}.call-container-revly__2023.svelte-1dux9zh #screen-share.svelte-1dux9zh+#participantContainerRevly.svelte-1dux9zh{grid-template-columns:repeat(2, 1fr)}.full-screen-revly.svelte-1dux9zh #screen-share.svelte-1dux9zh+#participantContainerRevly.svelte-1dux9zh{grid-auto-rows:1fr}}.rev-grid.svelte-1dux9zh.svelte-1dux9zh.svelte-1dux9zh{display:grid;align-items:center;justify-items:center;grid-template-columns:repeat(1, 1fr);grid-auto-rows:1fr;gap:24px}.width-55p{width:55% !important}')}function y4(t){let r,e;return{c(){r=ie("div"),h(r,"class",e=an(t[0].chat?"width-55p":"")+" svelte-1dux9zh"),h(r,"id","screen-share")},m(n,i){Ce(n,r,i)},p(n,i){i&1&&e!==(e=an(n[0].chat?"width-55p":"")+" svelte-1dux9zh")&&h(r,"class",e)},d(n){n&&Me(r)}}}function b4(t){let r,e;return r=new aEe({}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function sEe(t){let r,e,n,i,a,o,s,u,l,c,f,d,v,p,y,k,I,C,L,R,q,z,F,D,W,X,me,de,H,ee,Z,te,re=t[2]&&y4(t),K=t[0].chat&&t[1]===Xt.Full&&b4();return de=new o2e({}),{c(){r=ie("div"),e=ie("div"),n=ie("p"),i=Nt(t[3]),a=Le(),o=ie("div"),s=ie("button"),u=ie("img"),f=Le(),d=ie("button"),v=ie("img"),k=Le(),I=ie("div"),re&&re.c(),C=Le(),L=ie("div"),R=ie("div"),q=ie("div"),W=Le(),K&&K.c(),me=Le(),Ke(de.$$.fragment),Jt(u.src,l=t[1]==Xt.Mini?r4:Z0)||h(u,"src",l),h(u,"width",c=t[1]==Xt.Mini?16:20),h(u,"alt","screenIcon"),h(s,"class","icon-button-revly__2023 svelte-1dux9zh"),Jt(v.src,p=t[1]==Xt.Full?n4:i4)||h(v,"src",p),h(v,"width",y=t[1]==Xt.Mini?16:20),h(v,"alt","screenIcon"),h(d,"class","icon-button-revly__2023 svelte-1dux9zh"),h(o,"class","header-controlls svelte-1dux9zh"),h(e,"class","header-revly__2023 svelte-1dux9zh"),h(q,"class","avatar-revly__2023 svelte-1dux9zh"),h(R,"class",z="participant-revly__2023 "+(t[2]?"":"local-participant-revly__2023")+" svelte-1dux9zh"),h(R,"id","localParticipantRevly"),h(R,"data-identity",""),h(L,"class","rev-grid svelte-1dux9zh"),h(L,"data-screenshare",F=t[2]?"yes":""),h(L,"id","participantContainerRevly"),zr(L,"small-screen-X",t[1]==Xt.Small),h(I,"class","call-container-revly__2023 svelte-1dux9zh"),h(r,"class",H="container-revly__2023 "+(t[1]==Xt.Full?"full-screen-revly":t[1]==Xt.Mini?"mini-screen-revly":"small-screen-revly")+" svelte-1dux9zh")},m(fe,Te){Ce(fe,r,Te),U(r,e),U(e,n),U(n,i),U(e,a),U(e,o),U(o,s),U(s,u),U(o,f),U(o,d),U(d,v),U(r,k),U(r,I),re&&re.m(I,null),U(I,C),U(I,L),U(L,R),U(R,q),U(I,W),K&&K.m(I,null),U(r,me),Je(de,r,null),ee=!0,Z||(te=[nt(s,"click",t[5]),nt(d,"click",t[4])],Z=!0)},p(fe,Te){(!ee||Te&8)&&tr(i,fe[3]),(!ee||Te&2&&!Jt(u.src,l=fe[1]==Xt.Mini?r4:Z0))&&h(u,"src",l),(!ee||Te&2&&c!==(c=fe[1]==Xt.Mini?16:20))&&h(u,"width",c),(!ee||Te&2&&!Jt(v.src,p=fe[1]==Xt.Full?n4:i4))&&h(v,"src",p),(!ee||Te&2&&y!==(y=fe[1]==Xt.Mini?16:20))&&h(v,"width",y),fe[2]?re?re.p(fe,Te):(re=y4(fe),re.c(),re.m(I,C)):re&&(re.d(1),re=null),(!ee||Te&4&&z!==(z="participant-revly__2023 "+(fe[2]?"":"local-participant-revly__2023")+" svelte-1dux9zh"))&&h(R,"class",z),(!ee||Te&4&&F!==(F=fe[2]?"yes":""))&&h(L,"data-screenshare",F),(!ee||Te&2)&&zr(L,"small-screen-X",fe[1]==Xt.Small),fe[0].chat&&fe[1]===Xt.Full?K?Te&3&&_e(K,1):(K=b4(),K.c(),_e(K,1),K.m(I,null)):K&&(ar(),Ee(K,1,1,()=>{K=null}),or()),(!ee||Te&2&&H!==(H="container-revly__2023 "+(fe[1]==Xt.Full?"full-screen-revly":fe[1]==Xt.Mini?"mini-screen-revly":"small-screen-revly")+" svelte-1dux9zh"))&&h(r,"class",H)},i(fe){ee||(Cn(()=>{D||(D=za(L,xa,{},!0)),D.run(1)}),_e(K),Cn(()=>{X||(X=za(I,xa,{},!0)),X.run(1)}),_e(de.$$.fragment,fe),ee=!0)},o(fe){D||(D=za(L,xa,{},!1)),D.run(0),Ee(K),X||(X=za(I,xa,{},!1)),X.run(0),Ee(de.$$.fragment,fe),ee=!1},d(fe){fe&&Me(r),re&&re.d(),fe&&D&&D.end(),K&&K.d(),fe&&X&&X.end(),Xe(de),Z=!1,kr(te)}}}function uEe(t){let r,e,n,i;return r=new e4({props:{$$slots:{default:[sEe]},$$scope:{ctx:t}}}),{c(){Ke(r.$$.fragment)},m(a,o){Je(r,a,o),e=!0,n||(i=[nt(window,"beforeunload",t[6]),nt(window,"pagehide",t[6])],n=!0)},p(a,[o]){const s={};o&143&&(s.$$scope={dirty:o,ctx:a}),r.$set(s)},i(a){e||(_e(r.$$.fragment,a),e=!0)},o(a){Ee(r.$$.fragment,a),e=!1},d(a){Xe(r,a),n=!1,kr(i)}}}function lEe(t,r,e){let n,i,a,o;xr(t,Wt,c=>e(0,o=c));function s(){Wt.update(f=>({...f,screenSize:i===Xt.Full?Xt.Small:Xt.Full,...i===Xt.Full&&{chat:!1}}));const c=document.getElementById("participantContainerRevly");c&&(o.screenSize===Xt.Full?c.classList.remove("small-screen-X"):c.classList.add("small-screen-X"))}function u(){Wt.update(f=>({...f,screenSize:i===Xt.Mini?Xt.Small:Xt.Mini,...i===Xt.Full&&{chat:!1}}));const c=document.getElementById("participantContainerRevly");c&&o.screenSize===Xt.Small&&c.classList.add("small-screen-X")}function l(c){Pr.setCookie(oh,o.token,10),Pr.setCookie(ah,o.roomId,10)}return t.$$.update=()=>{t.$$.dirty&1&&e(3,n=o.meetingName),t.$$.dirty&1&&e(1,i=o.screenSize),t.$$.dirty&1&&e(2,a=o.screenShare)},[o,i,a,n,s,u,l]}class cEe extends It{constructor(r){super(),Rt(this,r,lEe,uEe,Et,{},oEe)}}function fEe(t){Zt(t,"svelte-5t3k4c",".lead-form-container-revly__2023.svelte-5t3k4c.svelte-5t3k4c{box-sizing:border-box;width:100%;min-width:200px;max-width:330px;max-height:calc(100vh - 200px);padding:24px;background:#ffffff;border-radius:16px;display:flex;flex-direction:column;gap:16px;position:fixed;left:50%;top:50%;transform:translate(-50%, -50%);z-index:9999999999999;border:1px solid #202a4a69;box-shadow:#202a4a69 0px 8px 24px}.form-header-revly__2023.svelte-5t3k4c.svelte-5t3k4c{display:flex;justify-content:space-between;align-items:center;color:black !important;font-size:16px;font-weight:500;background-color:white !important}.close-btn-revly__2023.svelte-5t3k4c.svelte-5t3k4c{height:20px;width:20px}.form-fields-revly__2023.svelte-5t3k4c.svelte-5t3k4c{overflow-y:scroll}.form-fields-revly__2023.svelte-5t3k4c.svelte-5t3k4c::-webkit-scrollbar{width:5px;display:none}.form-fields-revly__2023.svelte-5t3k4c>form.svelte-5t3k4c{display:flex;flex-direction:column;align-items:center;gap:16px}.submit-btn-revly__2023.svelte-5t3k4c.svelte-5t3k4c{box-sizing:border-box;background-color:#202a4a !important;color:white !important;border:1px solid black;border-radius:8px !important;text-align:center;width:100%;font-weight:600;padding:4px 0;margin-top:20px}.submit-btn-revly__2023.svelte-5t3k4c.svelte-5t3k4c:hover{opacity:0.9}@media(max-width: 550px){.lead-form-container-revly__2023.svelte-5t3k4c.svelte-5t3k4c{max-width:calc(100vw - 48px)}}")}function _4(t,r,e){const n=t.slice();return n[4]=r[e],n}function w4(t){let r,e;return r=new Sv({props:{formField:t[4]}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&1&&(a.formField=n[4]),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function dEe(t){let r,e,n,i,a,o,s,u,l,c,f,d,v,p;o=new yo({props:{color:"black"}});let y=t[0],k=[];for(let C=0;C<y.length;C+=1)k[C]=w4(_4(t,y,C));const I=C=>Ee(k[C],1,1,()=>{k[C]=null});return{c(){r=ie("div"),e=ie("div"),n=ie("p"),n.textContent=`${Cr.lead_form_header}`,i=Le(),a=ie("button"),Ke(o.$$.fragment),s=Le(),u=ie("section"),l=ie("form");for(let C=0;C<k.length;C+=1)k[C].c();c=Le(),f=ie("button"),f.textContent="Submit",h(a,"class","close-btn-revly__2023 svelte-5t3k4c"),h(e,"class","form-header-revly__2023 svelte-5t3k4c"),h(f,"class","submit-btn-revly__2023 svelte-5t3k4c"),h(f,"type","submit"),h(l,"class","svelte-5t3k4c"),h(u,"class","form-fields-revly__2023 svelte-5t3k4c"),h(r,"class","lead-form-container-revly__2023 svelte-5t3k4c")},m(C,L){Ce(C,r,L),U(r,e),U(e,n),U(e,i),U(e,a),Je(o,a,null),U(r,s),U(r,u),U(u,l);for(let R=0;R<k.length;R+=1)k[R].m(l,null);U(l,c),U(l,f),d=!0,v||(p=[nt(a,"click",t[1]),nt(l,"submit",Qv(t[2]))],v=!0)},p(C,[L]){if(L&1){y=C[0];let R;for(R=0;R<y.length;R+=1){const q=_4(C,y,R);k[R]?(k[R].p(q,L),_e(k[R],1)):(k[R]=w4(q),k[R].c(),_e(k[R],1),k[R].m(l,c))}for(ar(),R=y.length;R<k.length;R+=1)I(R);or()}},i(C){if(!d){_e(o.$$.fragment,C);for(let L=0;L<y.length;L+=1)_e(k[L]);d=!0}},o(C){Ee(o.$$.fragment,C),k=k.filter(Boolean);for(let L=0;L<k.length;L+=1)Ee(k[L]);d=!1},d(C){C&&Me(r),Xe(o),Fa(k,C),v=!1,kr(p)}}}function pEe(t,r,e){let n;xr(t,Wt,s=>e(3,n=s));let{config:i}=r;const a=()=>gs(Wt,n.leadFormConfig=[],n),o=async s=>{const u=new FormData(s.target),l={};for(let[c,f]of u)l[c]=f;try{const c=n.roomId;if(!c)return;await Kr.put(`calls/${c}/form-responce`,l),a()}catch(c){console.error(yi.getErrorMsgKey(c))}};return t.$$set=s=>{"config"in s&&e(0,i=s.config)},[i,a,o]}class vEe extends It{constructor(r){super(),Rt(this,r,pEe,dEe,Et,{config:0},fEe)}}function hEe(t){Zt(t,"svelte-wikptu",".mic-blocked-container-revly__2023.svelte-wikptu{position:fixed;z-index:1;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgb(0, 0, 0);background-color:rgba(0, 0, 0, 0.4);z-index:9999999999999}.mic-blocked-dialog-revly__2023.svelte-wikptu{box-sizing:border-box;width:100%;min-width:200px;max-width:360px;max-height:calc(100vh - 200px);padding:24px;background:#ffffff;border-radius:16px;display:flex;flex-direction:column;gap:16px;position:fixed;left:50%;top:50%;transform:translate(-50%, -50%);border:1px solid #202a4a69;box-shadow:#202a4a69 0px 8px 24px}.dialog-header-revly__2023.svelte-wikptu{display:flex;justify-content:space-between;align-items:center;color:black !important;font-size:18px;font-weight:600}.dialog-desc-revly__2023.svelte-wikptu{color:#6d6d6d !important;font-size:14px;font-weight:500}.close-btn-revly__2023.svelte-wikptu{height:20px;width:20px}.form-fields-revly__2023.svelte-wikptu{overflow-y:scroll}.form-fields-revly__2023.svelte-wikptu::-webkit-scrollbar{width:5px;display:none}@media(max-width: 550px){.mic-blocked-dialog-revly__2023.svelte-wikptu{max-width:calc(100vw - 48px)}}")}function mEe(t){let r,e,n,i,a,o,s,u,l,c,f,d,v;return s=new yo({props:{color:"black"}}),{c(){r=ie("div"),e=ie("div"),n=ie("div"),i=ie("p"),i.textContent=`${Cr.mic_blocked_dialog_header}`,a=Le(),o=ie("button"),Ke(s.$$.fragment),u=Le(),l=ie("section"),c=ie("div"),c.textContent=`${Cr.mic_blocked_dialog_desc}`,h(o,"class","close-btn-revly__2023 svelte-wikptu"),h(n,"class","dialog-header-revly__2023 svelte-wikptu"),h(c,"class","dialog-desc-revly__2023 svelte-wikptu"),h(l,"class","form-fields-revly__2023 svelte-wikptu"),h(e,"class","mic-blocked-dialog-revly__2023 svelte-wikptu"),h(r,"class","mic-blocked-container-revly__2023 svelte-wikptu")},m(p,y){Ce(p,r,y),U(r,e),U(e,n),U(n,i),U(n,a),U(n,o),Je(s,o,null),U(e,u),U(e,l),U(l,c),f=!0,d||(v=nt(o,"click",t[0]),d=!0)},p:Ge,i(p){f||(_e(s.$$.fragment,p),f=!0)},o(p){Ee(s.$$.fragment,p),f=!1},d(p){p&&Me(r),Xe(s),d=!1,v()}}}function gEe(t,r,e){let n;return xr(t,Wt,a=>e(1,n=a)),[()=>gs(Wt,n.showMicBlockedDialog=!1,n)]}class yEe extends It{constructor(r){super(),Rt(this,r,gEe,mEe,Et,{},hEe)}}function k4(t){let r,e,n,i,a;r=new cEe({});let o=t[0].leadFormConfig.length&&T4(t),s=t[0].showMicBlockedDialog&&S4();return{c(){Ke(r.$$.fragment),e=Le(),o&&o.c(),n=Le(),s&&s.c(),i=Fn()},m(u,l){Je(r,u,l),Ce(u,e,l),o&&o.m(u,l),Ce(u,n,l),s&&s.m(u,l),Ce(u,i,l),a=!0},p(u,l){u[0].leadFormConfig.length?o?(o.p(u,l),l&1&&_e(o,1)):(o=T4(u),o.c(),_e(o,1),o.m(n.parentNode,n)):o&&(ar(),Ee(o,1,1,()=>{o=null}),or()),u[0].showMicBlockedDialog?s?l&1&&_e(s,1):(s=S4(),s.c(),_e(s,1),s.m(i.parentNode,i)):s&&(ar(),Ee(s,1,1,()=>{s=null}),or())},i(u){a||(_e(r.$$.fragment,u),_e(o),_e(s),a=!0)},o(u){Ee(r.$$.fragment,u),Ee(o),Ee(s),a=!1},d(u){Xe(r,u),u&&Me(e),o&&o.d(u),u&&Me(n),s&&s.d(u),u&&Me(i)}}}function T4(t){let r,e;return r=new vEe({props:{config:t[0].leadFormConfig}}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},p(n,i){const a={};i&1&&(a.config=n[0].leadFormConfig),r.$set(a)},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function S4(t){let r,e;return r=new yEe({}),{c(){Ke(r.$$.fragment)},m(n,i){Je(r,n,i),e=!0},i(n){e||(_e(r.$$.fragment,n),e=!0)},o(n){Ee(r.$$.fragment,n),e=!1},d(n){Xe(r,n)}}}function bEe(t){let r,e,n=t[0].visible&&k4(t);return{c(){r=ie("div"),n&&n.c(),rt(r,"position","relative")},m(i,a){Ce(i,r,a),n&&n.m(r,null),e=!0},p(i,[a]){i[0].visible?n?(n.p(i,a),a&1&&_e(n,1)):(n=k4(i),n.c(),_e(n,1),n.m(r,null)):n&&(ar(),Ee(n,1,1,()=>{n=null}),or())},i(i){e||(_e(n),e=!0)},o(i){Ee(n),e=!1},d(i){i&&Me(r),n&&n.d()}}}function _Ee(t,r,e){let n;return xr(t,Wt,i=>e(0,n=i)),[n]}class wEe extends It{constructor(r){super(),Rt(this,r,_Ee,bEe,Et,{})}}function kEe(t){Zt(t,"svelte-16z8b1l",`@import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap");#main-call-revly__2023 *{font-family:"Poppins", sans-serif}#main-call-revly__2023 p, #main-call-revly__2023 h1, #main-call-revly__2023 h5{margin:0;padding:0}[id="main-call-revly__2023"] button{all:unset;border:none;cursor:pointer;-webkit-tap-highlight-color:transparent;-moz-tap-highlight-color:transparent;-ms-tap-highlight-color:transparent}[id="main-call-revly__2023"] button:hover{opacity:0.8;border-color:transparent}
      [id="main-call-revly__2023"] button:focus,
      [id="main-call-revly__2023"] button:focus-visible
    {outline:transparent}`)}function TEe(t){let r,e,n,i,a,o,s,u;return r=new wEe({}),n=new WTe({}),a=new tSe({}),s=new jSe({}),{c(){Ke(r.$$.fragment),e=Le(),Ke(n.$$.fragment),i=Le(),Ke(a.$$.fragment),o=Le(),Ke(s.$$.fragment)},m(l,c){Je(r,l,c),Ce(l,e,c),Je(n,l,c),Ce(l,i,c),Je(a,l,c),Ce(l,o,c),Je(s,l,c),u=!0},p:Ge,i(l){u||(_e(r.$$.fragment,l),_e(n.$$.fragment,l),_e(a.$$.fragment,l),_e(s.$$.fragment,l),u=!0)},o(l){Ee(r.$$.fragment,l),Ee(n.$$.fragment,l),Ee(a.$$.fragment,l),Ee(s.$$.fragment,l),u=!1},d(l){Xe(r,l),l&&Me(e),Xe(n,l),l&&Me(i),Xe(a,l),l&&Me(o),Xe(s,l)}}}class SEe extends It{constructor(r){super(),Rt(this,r,null,TEe,Et,{},kEe)}}new SEe({target:z0.getContainer()});function EEe(){var e;const t=bv.getInstance(),r=(e=document.currentScript)==null?void 0:e.getAttribute("organization-id");r&&t.init(r),Jwe(),$we.init(),Promise.all([Twe(),Bwe()]),console.log("Revly")}const MEe={call:dx,getAgentCount:Zwe,isQualified:qwe,event:kwe,lastCallInfo:Gwe,callTolastAgent:Hwe,queueNo:Qwe,leaveQueue:Ywe,isSupported:cx,openScheduler:px};window.revly=MEe,EEe()})();
